<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[Writing plan]]></title>
      <url>http://smanist.github.io/2242/01/01/Writing-Plan/</url>
      <content type="html"><![CDATA[<p>Some topics I plan to write about (or never).</p>
<a id="more"></a>
<h1 id="interesting-topics">Interesting Topics</h1>
<h2 id="development-of-modern-university.">Development of modern university.</h2>
<p>The precursor appears to be cathedral school with faculty of arts. Maybe start with examining the early universities and colleges in the US, such as UPenn. Another start could be the Humboldt University of Berlin, which appears to have the first modern university system. A third start is the Bologna University, which is among the earliest universities.</p>
<h2 id="parkinsons-law-and-peters-principle">Parkinson&#x2019;s law and Peter&#x2019;s principle</h2>
<h2 id="kakeya-set">Kakeya set</h2>
<p>A Kakeya set, or Besicovitch set, is a set of points in Euclidean space which contains a unit line segment in every direction. Besicovitch found a surprising result that the minimum area, or measure, of the set is <em>zero</em>.</p>
<p>A Kakeya needle set is a set in the plane with a stronger property, that a unit line segment can be rotated continuously. A yet surprising result is that the measure of such set can be arbitrarily small.</p>
<p><a href="https://en.wikipedia.org/wiki/Kakeya_set" target="_blank" rel="noopener">Ref1</a>, <a href="https://terrytao.wordpress.com/tag/kakeya-conjecture/" target="_blank" rel="noopener">Ref2</a></p>
<h2 id="miura-ori-and-theorema-egregium">Miura-ori and Theorema Egregium</h2>
<p>How to fold an A4 paper to reduce its area by an order of magnitude, while still easy to unfold? Miura folding is one answer. An introductory article is found <a href="https://wewanttolearn.wordpress.com/2014/11/11/miura-ori-based-curved-surface-origami-structures/" target="_blank" rel="noopener">here</a>. More interesting applications are found <a href="http://www.tsg.ne.jp/TT/index.html" target="_blank" rel="noopener">here</a>, where a scholar developed some computational origami software.</p>
<p>Concerning computational origami, there is another guy that must be mentioned: <a href="https://en.wikipedia.org/wiki/Robert_J._Lang" target="_blank" rel="noopener">Robert Lang</a>. He was a NASA physicist, but later became an <a href="http://www.langorigami.com/" target="_blank" rel="noopener">origami artist</a>. Now he is recognized as one of the leading theorists of the mathematics of origami and has developed ways to algorithmetize the design process for origami.</p>
<p>Another seemingly vague connection to origami is the shell structure. This starts with <a href="https://en.wikipedia.org/wiki/Theorema_Egregium" target="_blank" rel="noopener">Theorema Egregium</a>, or Remarkable Theorem. It is stated by Carl Friedrich Gauss that <em>If a curved surface is developed upon any other surface whatever, the measure of curvature in each point remains unchanged.</em> Essentially, the so-called Gaussian curvature is an intrinsic invariant of a surface. The curvature does not change if the surface deforms by bending only and not stretching. The implication of this result in engineering is the application of shell structure - thin and light, but strong. A flat paper can be folded into complex curved surfaces using generalized Miura-ori. Such folded structure is orders of magnitude stronger than the flat paper.</p>
<h2 id="sprite">SPRITE</h2>
<p>SPRITE for Sample Parameter Reconstruction via Iterative TEchniques. It is an awesome tool (<a href="https://peerj.com/preprints/26968v1/" target="_blank" rel="noopener">pre-print</a>) that enables the examination of statistical results in research papers that do not include the raw data - are they made up or fudged? One case found by the authors of SPRITE is related to the <a href="https://hackernoon.com/introducing-sprite-and-the-case-of-the-carthorse-child-58683c2bfeb" target="_blank" rel="noopener">carrots</a>.</p>
<h2 id="game-of-life-on-manifold">Game of life on manifold</h2>
<p>Conway&#x2019;s <a href="https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life" target="_blank" rel="noopener">Game of Life</a> is initially defined on a 2D flat discrete grid. However, nothing prevents it from generalization to grids of higher dimensions, or continous Euclidean spaces, or any proper metric spaces. A good example is found <a href="https://0fps.net/2012/11/19/conways-game-of-life-for-curved-surfaces-part-1/" target="_blank" rel="noopener">here</a> and <a href="https://0fps.net/2012/11/28/conways-game-of-life-for-curved-surfaces-part-2/" target="_blank" rel="noopener">here</a>.</p>
<h2 id="nsf-survey-of-science-engineering-doctorates">NSF Survey of Science &amp; Engineering Doctorates</h2>
<p>It turns out NSF has been surveying the doctorates earned each year in the US. It would be fun to dig into the <a href="https://ncses.nsf.gov/pubs/nsf19301" target="_blank" rel="noopener">data</a> and explore.</p>
<h2 id="optimal-control-for-frying-steaks">Optimal control for frying steaks</h2>
<p>A tasty steak is made by precisely controlling the temperature distribution of the steak on the frying pan. The evolution of the temperature in the steak is governed by the heat conduction equation. The control variables are the duration and magnitude of the heat flux from the frying pan. The question is, is it possible to achieve the given temperature response in the steak using an optimal control approach?</p>
<h1 id="more-serious-topics">More Serious Topics</h1>
<h2 id="dmd-and-higher-order-dmd">DMD and Higher-Order DMD</h2>
<p><a href="https://hal-polytechnique.archives-ouvertes.fr/hal-01020654/file/DMS0022112010001217a.pdf" target="_blank" rel="noopener">Dynamic Mode Decomposition</a> is a useful tool for post-processing spatiotemporal data (resulting from generally nonlinear dynamics) as an expansion of spatial modes times exponentials in the time variable, which exhibit generally nonzero growth rates. It has extentions like <a href="http://oa.upm.es/50185/1/INVE_MEM_2017_271038.pdf" target="_blank" rel="noopener">Higher Order Dynamic Mode Decomposition</a>.</p>
<h2 id="polynomial-rational-interpolation-and-isindy">Polynomial rational interpolation and iSINDy</h2>
<p>Polynomial curve fitting is one of the simplest tools for data modeling. However, it suffers from various issues, such as discussed <a href="https://en.wikipedia.org/wiki/Polynomial_and_rational_function_modeling" target="_blank" rel="noopener">here</a>. A better model would be polynomial rationals. But its mathematical properties are not as clear as polynomials - some materials are found <a href="https://link.springer.com/chapter/10.1007/978-1-4614-8453-0_2" target="_blank" rel="noopener">here</a>. Also, practical algorithms are developed only <a href="http://www.alglib.net/interpolation/rational.php" target="_blank" rel="noopener">recently</a>, i.e.&#xA0;the <a href="https://docs.scipy.org/doc/scipy-1.3.0/reference/generated/scipy.interpolate.BarycentricInterpolator.html" target="_blank" rel="noopener">Barycentric interpolation</a>.</p>
<p>The iSINDy method is the <a href="https://ieeexplore.ieee.org/abstract/document/7809160" target="_blank" rel="noopener">implicit</a> version of the <a href="https://www.pnas.org/content/113/15/3932.short" target="_blank" rel="noopener">SINDy</a> (Sparse Identification of Nonlinear Dynamics) method. As their names imply, the methods are used to infer the analytical form of a nonlinear dynamical system from the samples of its response. The sparsity ensures that the analytical form is as simple as possible. In SINDy, the system equation is represented by a linear combination of nonlinear features, e.g.&#xA0;polynomials, that are constructed from the state variables. In iSINDy, the system equation is represented by a rational fraction, similar to Barycentric interpolation. However, the difference is that in iSINDy the number of terms in the rational fraction is minimized, while in the latter all the possible terms might be involved.</p>
<h2 id="multi-fidelity-surrogate">Multi-fidelity surrogate</h2>
<p>Some surrogate models take in data from both high- and low-fidelity models. Usually such a &#x201C;multi-fidelity&#x201D; model is hierarchical, e.g.&#xA0;a fusion of multiple separate surrogates. <a href="http://papers.nips.cc/paper/7016-multi-information-source-optimization.pdf" target="_blank" rel="noopener">This paper</a> proposed a unified formulation for multi-fidelity surrogate, which seems to have some values in applications like surrogate-based optimization.</p>
<h2 id="gaussian-process-regression-with-discrete-variables">Gaussian process regression with discrete variables</h2>
<p>There is an <a href="https://arxiv.org/ftp/arxiv/papers/1806/1806.07504.pdf" target="_blank" rel="noopener">approach</a> based on latent variables that makes the discrete variables smooth. An application of this approach found <a href="https://arc.aiaa.org/doi/pdf/10.2514/6.2019-1971" target="_blank" rel="noopener">here</a> shows that it is better than some conventional approaches.</p>
<h2 id="non-intrusive-polynomial-chaos-expansion">Non-Intrusive Polynomial Chaos Expansion</h2>
<p>Polynomial chaos expansion (PCE) is one approach for uncertainty quantification. However, PCE is intrusive as it requires the modification of the deterministic version of the analysis code. One way to mitigate this problem is the non-intrusive version of PCE, as discussed in <a href="http://www.sci.utah.edu/publications/xiu05/Xiu_SIAM_JSC2005.pdf" target="_blank" rel="noopener">this paper</a>. One example of application is found <a href="https://arc.aiaa.org/doi/pdf/10.2514/6.2019-2216" target="_blank" rel="noopener">here</a>.</p>
<h2 id="methodology-for-uncertainty-quantification">Methodology for uncertainty quantification</h2>
<p>Nowadays people expect not only high-fidelity results from CFD-based simulation, but also its uncertainty, which may be quantified through rigorous verification, validation and uncertainty quantification (VVUQ) procedures. One such procedural framework is proposed by <a href="http://ftp.demec.ufpr.br/disciplinas/TM798/Artigos_seminarios/roy_oberkampf_2011-verification.pdf" target="_blank" rel="noopener">Roy and Oberkampf</a>.</p>
<p>In general, a solution for UQ is provided by the <a href="https://dakota.sandia.gov/" target="_blank" rel="noopener">DAKOTA software</a> from the Sandia National Lab. One application of Dakota is found <a href="https://arc.aiaa.org/doi/pdf/10.2514/6.2019-2278" target="_blank" rel="noopener">here</a>.</p>
<h2 id="sobol-sampling-v.s.-latin-hypercube-sampling">Sobol sampling v.s. Latin hypercube sampling</h2>
<p>Two sampling methods for Gaussian process regression. Also Halton sampling.</p>
<h2 id="non-intrusive-least-squares-shadowing">Non-Intrusive Least Squares Shadowing</h2>
<p>Optimization of a chaotic system can be challenging, because the gradients w.r.t. to the design variables computed naively could be &#x201C;noisy&#x201D;. This can be mitigated by the shadowing approach, which generates smooth gradients suitable for optimization. A non-intrusive version of the shadowing approach has been developed in <a href="https://www.sciencedirect.com/science/article/pii/S0021999117304783" target="_blank" rel="noopener">this paper</a>.</p>
<h2 id="openmdao">OpenMDAO</h2>
<p>The <a href="http://openmdao.org/" target="_blank" rel="noopener">OpenMDAO</a> package has evolved in the recent years into a quite comprehensive framework for large-scale multi-disciplinary optimization problems. Besides conventional aerostructural optimization, it has encompassed some interesting capabilities, e.g. <a href="https://github.com/OpenMDAO/dymos" target="_blank" rel="noopener">optimal control</a> and <a href="https://arc.aiaa.org/doi/pdf/10.2514/6.2019-1470" target="_blank" rel="noopener">topology optimization</a>. It seems Bayesian optimization is <a href="http://openmdao.org/pubs/Heath_Gray-_2012_-OpenMDAO_Frameork_for_Flexible_Multidisciplinary_Design_Analysis_and_Optimization_Methods.pdf" target="_blank" rel="noopener">supported</a> too, at least in some of the versions and some <a href="https://github.com/Kenneth-T-Moore/AMIEGO-AMD-OpenMDAO" target="_blank" rel="noopener">branches</a>.</p>
]]></content>
      
        <categories>
            
            <category> plan </category>
            
        </categories>
        
        
    </entry>
    
    <entry>
      <title><![CDATA[IFASD 2019 Digest]]></title>
      <url>http://smanist.github.io/2019/07/02/IFASD_2019_digest/</url>
      <content type="html"><![CDATA[<p>What I found interesting.</p>
<a id="more"></a>
<p>IFASD stands for <a href="http://ifasd2019.utcdayton.com/" target="_blank" rel="noopener">The International Forum on Aeroelasticity and Structural Dynamics</a>. It was held during June 10-13 in Savannah, Georgia. The bracketed number is the paper number (if applicable).</p>
<h1 id="aeroelastic-design-and-optimization">Aeroelastic Design and Optimization</h1>
<h2 id="passive-aeroelastic-tailoring-of-high-aspect-ratio-wings">Passive aeroelastic tailoring of high aspect ratio wings</h2>
<p>By Karen Taminger.</p>
<p>Three approaches were highlighted that optimize the stiffness distribution of a wing to improve its aeroelastic performance:</p>
<ol style="list-style-type: decimal">
<li>Curvilinear Spars and Ribs (SpaRibs), e.g. <a href="https://doi.org/10.2514/1.C031336" target="_blank" rel="noopener">Locatelli2011</a>, <a href="https://doi.org/10.2514/1.J057892" target="_blank" rel="noopener">Zhao2019</a></li>
<li><a href="http://gkennedy.gatech.edu/research-project/large-scale-topo/" target="_blank" rel="noopener">Structural topology optimization</a></li>
<li><a href="https://www.sciencedirect.com/science/article/pii/S0889974618306340" target="_blank" rel="noopener">Tow-steered composite wings</a></li>
</ol>
<h2 id="sizing-and-topology-design-of-an-aeroelastic-wingbox-under-uncertainty">Sizing and topology design of an aeroelastic wingbox under uncertainty</h2>
<p>By Bret K. Stanford (058)</p>
<p>A neat work on optimization under uncertainty. A two-level approach is employed. On the higher level, a non-gradient approach is employed to explore different wingbox topologies. The sizing of the wingbox topology is done by a gradient approach on the lower level. Uncertainties are introduced to the safety factors for the stress and buckling constraints, and modelled using the non-intrusive polynomial chaos expansion method. The sobol indices are used to explain the results.</p>
<h2 id="aeroelastic-prediction-workshop-no.-3">Aeroelastic prediction workshop, No. 3</h2>
<p>This will be discussed separately.</p>
<h1 id="reduced-order-modeling">Reduced Order Modeling</h1>
<h2 id="self-adaptive-pod-based-rom-3d-aeroelastic-simulations">Self adaptive POD based ROM 3D aeroelastic simulations</h2>
<p>By Ruben Moreno-Ramos (024)</p>
<p>Switch between CFD and ROM solvers during the aeroelastic simulation based on an error estimation. The CFD stage is used to generate data that updates POD modes in the projection-based ROM.</p>
<h2 id="model-order-reduction-for-coupled-nonlinear-aeroelastic-flight-mechanics-of-very-flexible-aircraft">Model order reduction for coupled nonlinear aeroelastic-flight mechanics of very flexible aircraft</h2>
<p>By Carlos E.S. Cesnik (095)</p>
<p>The goal is to reduce the coupled system of flight dynamics and aeroelastic model to a level that can be used for control-oriented applications for the flight envelope. This is achieved by combining the techniques of piecewise linear basis, local basis interpolation, and balanced truncation, where the composition of local basis is achieved using a weighted sum approach.</p>
<h2 id="aeroelastic-loads-predictions-using-cfd-based-reduced-order-models">Aeroelastic loads predictions using CFD-based reduced order models</h2>
<p>By Philipp Bekemeyer (105)</p>
<p>An interesting POD approach is used. The snapshots for POD are not only the aerodynamic loading, but concatenated vectors of aerodynamic loading and structural displacements. This approach requires very few samples and handles the static aeroelastic trimming problem well. The code implementation is based on the <a href="http://www.helmholtz-analytics.de/helmholtz_analytics/EN/Software/_node.html" target="_blank" rel="noopener">SMARTy toolbox</a>. A noteworthy method in SMARTy is the <a href="https://www.tandfonline.com/doi/full/10.1080/10618562.2014.918695" target="_blank" rel="noopener">Isomap with interpolation</a> approach.</p>
<h2 id="modal-rotations-a-modal-based-method-for-large-structural-deformations">Modal rotations: A modal-based method for large structural deformations</h2>
<p>By Ariel Drachinsky (135)</p>
<p>A modal rotation method (MRM) is developed for the static analysis of slender structures accounting for large deformations. The modes are obtained from linear modal analysis as usual. However, the modes are not defined by displacements, but by curvatures. The curvature-based formulation enables a linearized evaluation of the bending rotation change based on nonlinear kinematics.</p>
<h2 id="reduced-order-time-spectral-model-for-the-ale-formulation-of-the-compressible-navier-stokes-equations">Reduced order time spectral model for the ALE formulation of the compressible Navier-Stokes equations</h2>
<p>By Fabrizio Di Donfrancesco (134)</p>
<p>The time spectral equations are projected on to a set of POD basis. However, the issue is that generating the basis requires the unsteady simulation, but the purpose of time spectral method is usually to avoid the computationally expensive unsteady simulation.</p>
<h1 id="flutter-analysis">Flutter Analysis</h1>
<h2 id="flutter-sensitivity-analysis-for-wing-planform-optimization">Flutter sensitivity analysis for wing planform optimization</h2>
<p>By Francesco Torrigiani (029)</p>
<p>The unsteady aerodynamic analysis is carried out with the boundary element method by <a href="https://ntrs.nasa.gov/search.jsp?R=19750004821" target="_blank" rel="noopener">Morino</a>, which accounts for generic 3D body shapes.</p>
<h2 id="analysis-of-light-dynamic-stall-using-dynamic-mode-decomposition">Analysis of light dynamic stall using dynamic mode decomposition</h2>
<p>By Wrik Mallik (036). An application of DMD.</p>
<h2 id="a-state-space-model-for-loads-analysis-based-on-tangential-interpolation">A state-space model for loads analysis based on tangential interpolation</h2>
<p>By David Martin (066)</p>
<p>The <a href="https://epubs.siam.org/doi/book/10.1137/1.9780898718713" target="_blank" rel="noopener">Loewner rational interpolation</a> is employed to develop a state-space model for the aerodynamics that</p>
<ol style="list-style-type: decimal">
<li>Has complex poles - so that it works for transonic flow.</li>
<li>Does not need Hankel metrix for more efficient computation.</li>
<li>Works for delayed input (e.g.&#xA0;gust) and singularity (e.g.&#xA0;rigid modes that introduces infinite eigenvalues).</li>
<li>Describes distributed aerodynamic loading.</li>
</ol>
<h2 id="a-new-flutter-prediction-algorithm-to-avoid-p-k-method-shortcomings">A new flutter prediction algorithm to avoid p-k method shortcomings</h2>
<p>By Ludovic Colo (072)</p>
<p>For a nonlinear eigenvalue problem like flutter analysis, the conventional p-k method may fail when the eigen modes merge. This study develops a new block Newton algorithm based on the invariant pairs theory (e.g. <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/gamm.201490007" target="_blank" rel="noopener">here</a> and <a href="https://epubs.siam.org/doi/abs/10.1137/120885644?journalCode=sjmael" target="_blank" rel="noopener">here</a>). Dassault Aviation has systematically employed a hybrid p-k and block Newton methods for automated, robust, and efficient flutter analysis.</p>
<h2 id="structural-damping-models-for-passive-aeroelastic-control">Structural damping models for passive aeroelastic control</h2>
<p>By Marco Eugeni (085)</p>
<p>Three damping models suitable for finite-element-based aeroelastic analysis are compared: the viscous model, the hysteretic model, and a <a href="https://www.sciencedirect.com/science/article/pii/S0888327018307982" target="_blank" rel="noopener">generalized Biot model</a>.</p>
<h2 id="mechanisms-of-transonic-single-degree-of-freedom-flutter-of-a-laminar-airfoil">Mechanisms of transonic single degree of freedom flutter of a laminar airfoil</h2>
<p>By Marc Braune (132)</p>
<p>An energy transfer analysis is used to connect the effects of boundary layer transition, shock movement, and shock-boundary layer interaction to the aeroelastic instability and the LCO amplitude. It appears that the LCO is not due to a pure 1-DOF flutter mechanism, but introduced by the combination of the bending and heave motion.</p>
<h2 id="flutter-mechanisms-characterization-using-distributed-aeroelastic-energy-analysis">Flutter mechanisms characterization using distributed aeroelastic energy analysis</h2>
<p>By Michael Iovnovich (016)</p>
<p>The goal is to systematically classify and understand the flutter mechanisms of an aircraft with many jet store configurations. The concept of power per flutter cycle (PPC) is introduced and the PPC distribution indicates a quantitative approach to identifying the flutter mechanisms.</p>
<h1 id="panel-flutter">Panel Flutter</h1>
<h2 id="flutter-and-limit-cycle-oscillations-of-a-cantilevered-plate-in-supersonic.hypersonic-flow">Flutter and limit cycle oscillations of a cantilevered plate in supersonic.hypersonic flow</h2>
<p>By Kevin A. McHugh (017)</p>
<p>Extended the piston theory to account for the large slope effect due to the cantilevered configuration. However, the boundary layer effect is not included. The plan is to correlate the theoretical results with experiments.</p>
<h2 id="computational-study-for-the-design-of-a-hypersonic-panel-flutter-experiment">Computational study for the design of a hypersonic panel flutter experiment</h2>
<p>By Maxim Freydin (138)</p>
<p>A theoretical analysis of clamped panel flutter response, including the geometrical nonlinearity, non-ideally clamped boundary stiffness, distributed static pressure differential across the panel, and a temperature differential between the panel and its support. Flutter and LCO predictions are done by a linear eigenvalue method and direct time-marching solution in modal coordinates. Experiments are panned in the University of Southern Queensland. The panel is extremely thin, around 0.1 mm, and the experiment will run for approximately 200 ms.</p>
<h1 id="aerospace-systems">Aerospace Systems</h1>
<h2 id="aeroelastic-role-in-the-road-to-a-fully-automated-refuelling-system">Aeroelastic role in the road to a fully automated refuelling system</h2>
<p>By J. Barrera Rodr&#xED;guez (048)</p>
<p>This is an interesting paper describing the development of a <em>real</em> Automated Air-to-Air Refuelling (A3R) system in the industry. The system consists of an extensible mast with a &#x201C;ruddervator&#x201D; connected to the aircraft with a roll/pitch joint. Modeling difficulties include the elastic response of the mast, variable mass and the boundary conditions (free or attached to another aircraft). The structural response of the mast is modelled using the finite element method and the aerodynamic force of the ruddervator is modelled using the doublet lattice method. The other unmodelled effects, which may be nonlinear, include gravity, drag of mast, etc. These effects are identified from the flight data and incorporated into the model via a convolutional nonlinear forcing term.</p>
<h2 id="flight-mechanical-analysis-and-test-of-unmanned-multi-body-aircraft">Flight mechanical analysis and test of unmanned multi-body aircraft</h2>
<p>By An Chao (083)</p>
<p>Learned about the concept of Multi-body Aircraft (MBA) as a alternative to the aircraft with ultra-high aspect ratio. The MBA configuration alleviates the wing loading and its modeling does not require the nonlinear aeroelastic analysis. However, the MBA has its own instability modes that need to be mitigated.</p>
]]></content>
      
        <categories>
            
            <category> digest </category>
            
        </categories>
        
        
        <tags>
            
            <tag> conference </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Trying Out RNN Regressor - Part I]]></title>
      <url>http://smanist.github.io/2019/07/01/Trying-out-RNN-regressor-part-1/</url>
      <content type="html"><![CDATA[<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css"><p>I am almost new to this field. Still learning.</p>
<a id="more"></a>
<h1 id="introduction">Introduction</h1>
<p>In the field of engineering, frequently we need to do <a href="https://en.wikipedia.org/wiki/System_identification" target="_blank" rel="noopener">system identification</a> (SI), i.e.&#xA0;to infer the mathematical model of a dynamical system based on a set of time series data. A classical problem is the SI of a linear system <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mo>&#x2D9;</mo></mover></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mrow><mrow><mi mathvariant="bold">A</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mo>+</mo><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mrow><mrow><mi mathvariant="bold">C</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mo>+</mo><mrow><mrow><mi mathvariant="bold">D</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
\dot{\mathbf{h}}&amp;= {\mathbf{A}}{\mathbf{h}}+ {\mathbf{B}}{\mathbf{x}}\\
{\mathbf{y}}&amp;= {\mathbf{C}}{\mathbf{h}}+ {\mathbf{D}}{\mathbf{x}}\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.4956500000000001em;"></span><span class="strut bottom" style="height:2.4913000000000007em;vertical-align:-0.9956500000000006em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.5643500000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">h</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#x2D9;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span style="top:0.6356500000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.5643500000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">A</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="mbin">+</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span><span style="top:0.6356500000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">C</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="mbin">+</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">D</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> Given input <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{x}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span></span> and output <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{y}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span></span></span>, how does one determine the system matrices <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">A</mi></mrow></mrow><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">C</mi></mrow></mrow><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">D</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{A}},{\mathbf{B}},{\mathbf{C}},{\mathbf{D}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">A</span></span></span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">C</span></span></span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">D</span></span></span></span></span></span>? Note that the system states <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{h}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span></span></span></span> are not directly observed in the time series data, i.e.&#xA0;they are hidden. Over the long history of SI, many successful methods and algorithms have been developed. Some model the hidden states explicitly and some do not. Some can handle nonlinear systems and some do not. I am not an expert in SI and not going to talk about these algorithms.</p>
<p>In the machine learning community, it appears that people tend to reorganize and reformulate some old concepts into some &#x201C;new ideas&#x201D;. No offense. Indeed this is sometimes useful. In <a href="http://www.cs.toronto.edu/~hinton/csc2535/notes/lec10new.pdf" target="_blank" rel="noopener">Hinton2013</a>, several modeling methods for sequential data are divided into two categories: memoryless models and memoryful models. The memoryless models have limited memory window and the hidden state cannot be used efficiently. One example is the autoregressive model, which predicts the next term in a sequence from a fixed number of previous terms. Another example is the feed-forward neural nets, which generalize autoregressive models by using one or more layers of non-linear hidden units. The memoryful models infer the hidden state distribution at the cost of higher computational burden. One example is the linear systems algorithms that can be viewed as generative models with real-valued hidden states that cannot be observed directly. Another example is the hidden Markov models (HMM), which have a discrete one-of-N hidden state. In HMM, transitions between states are stochastic and controlled by a transition matrix. The outputs produced by a state are stochastic.</p>
<p>The last example of the memoryful models is the recurrent neural network (RNN), the topic of this post. It updates the hidden state in a deterministic nonlinear way. Compared to the aformentioned models, the RNN has the following advantages:</p>
<ol style="list-style-type: decimal">
<li>Distributed hidden state allows the efficient storage of information about the past.</li>
<li>Non-linear dynamics allows the update of hidden state in complicated ways.</li>
<li>No need to infer hidden state, whose evolution is purely deterministic.</li>
<li>Parameters in the RNN, i.e.&#xA0;the weights, are shared, which makes the model compact.</li>
</ol>
<h1 id="mathematical-models-of-rnn">Mathematical Models of RNN</h1>
<h2 id="vanilla-rnn">Vanilla RNN</h2>
<p>This section is based on <a href="http://cs231n.stanford.edu/slides/2017/cs231n_2017_lecture10.pdf" target="_blank" rel="noopener">this</a>.</p>
<p>The RNN centers around the following equation that describes the evolution of the hidden state, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi></msub><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{h}}_t = {\mathbf{f}}_W({\mathbf{h}}_{t-1}, {\mathbf{x}}_t)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is an activation function with weights <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{W}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span>. The time steps <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.61508em;"></span><span class="strut bottom" style="height:0.61508em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">t</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit">t</span><span class="mbin">&#x2212;</span><span class="mord mathrm">1</span></span></span></span> makes the formula recurrent. The function <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{W}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span> may be shared between different layers/time steps.</p>
<p>A vanilla RNN is <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>tanh</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>h</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>x</mi><mi>h</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>y</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\mathbf{h}}_t &amp;= \tanh({\mathbf{W}}_{hh} {\mathbf{h}}_{t-1} + {\mathbf{W}}_{xh} {\mathbf{x}}_t) \\
{\mathbf{y}}_t &amp;= {\mathbf{W}}_{hy} {\mathbf{h}}_t
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.4000000000000004em;vertical-align:-0.9500000000000004em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mop">tanh</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">x</span><span class="mord mathit mtight">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> It looks very much like the linear system discussed above, except that it has a nonlinear state equation.</p>
<p>There are multiple types of RNNs: one-to-one, one-to-many, many-to-one, many-to-many, etc. In other words, the inputs <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{x}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and outputs <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{y}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are not necessarily nonzero. For example, an RNN is many-to-one when all of its inputs are assumed to be nonzero and only one output is expected (e.g.&#xA0;at the end) - this could be the case for a sequence classification problem.</p>
<h2 id="gradient-problem">Gradient Problem</h2>
<p>There is an infamous issue with RNN: the gradient problem, which prevented the effective training of RNNs for a period of time.</p>
<p>The training of an RNN requires a proper definition of the error, or the scalar loss function <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span></span></span></span>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>E</mi><mo>=</mo><msub><mo>&#x2211;</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo>&#x2026;</mo><mi>s</mi></mrow></msub><msub><mi>E</mi><mi>t</mi></msub><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>t</mi></msub><mo separator="true">,</mo><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mo>&#xAF;</mo></mover></mrow><mi>t</mi></msub><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
E = \sum_{t=1\ldots s} E_t({\mathbf{y}}_t, {\bar{\mathbf{y}}}_t)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.050005em;"></span><span class="strut bottom" style="height:2.3171180000000002em;vertical-align:-1.2671130000000002em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.05764em;">E</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-limits reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:1.167113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span><span class="minner mtight">&#x2026;</span><span class="mord mathit mtight">s</span></span></span></span><span style="top:-0.000004999999999921734em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span><span style="top:-0.013440000000000007em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span></span></span></span> time steps are assumed, and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mo>&#xAF;</mo></mover></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\bar{\mathbf{y}}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58122em;"></span><span class="strut bottom" style="height:0.82566em;vertical-align:-0.24444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span><span style="top:-0.013440000000000007em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> represent the ground truth.</p>
<p>The weights <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{W}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span> are computed by the gradient descent method, where the gradient is computed from the back propagation (BP) of the error. In other words, one needs to obtain the derivative of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span></span></span></span> w.r.t. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{W}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span> via the chain rule, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow></mfrac></mrow><mo>=</mo><msub><mo>&#x2211;</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x2026;</mo><mo separator="true">,</mo><mi>s</mi></mrow></msub><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mi>E</mi><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow></mfrac></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\frac{\partial E}{\partial {\mathbf{W}}}} = \sum_{t=1,\ldots,s} {\frac{\partial E_t}{\partial {\mathbf{W}}}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.774661em;vertical-align:-1.403221em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathit" style="margin-right:0.05764em;">E</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-limits reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:1.167113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span><span class="mpunct mtight">,</span><span class="minner mtight">&#x2026;</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">s</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></span> where <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mi>E</mi><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow></mfrac></mrow><mo>=</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mi>E</mi><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>t</mi></msub></mrow></mfrac></mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow></mfrac></mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow></mfrac></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\frac{\partial E_t}{\partial {\mathbf{W}}}} = {\frac{\partial E_t}{\partial {\mathbf{y}}_t}} {\frac{\partial {\mathbf{y}}_t}{\partial {\mathbf{h}}_t}} {\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{W}}}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.25188em;vertical-align:-0.8804400000000001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.6860000000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></span></p>
<p>Now, focus on the weights for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{h}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span></span></span></span>, i.e. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{W}}_{hh}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, which will be written as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{W}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span> for simplicity in the following. There is a &#x201C;double dependency&#x201D; in the gradient <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex">{\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{W}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8962079999999999em;"></span><span class="strut bottom" style="height:1.2412079999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">W</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.4100999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathbf mtight">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>: (1) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{h}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> itself depends on all the past states; (2) a past state depends on the states prior to that state, too. Mathematically, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow></mfrac></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mo>&#x2211;</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x2026;</mo><mo separator="true">,</mo><mi>t</mi></mrow></msub><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>k</mi></msub></mrow></mfrac></mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow></mfrac></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>k</mi></msub></mrow></mfrac></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mo>&#x220F;</mo><mrow><mi>i</mi><mo>=</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x2026;</mo><mo separator="true">,</mo><mi>t</mi></mrow></msub><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>i</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub></mrow></mfrac></mrow></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{W}}}} &amp;= \sum_{k=1,\ldots,t} {\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{h}}_k}} {\frac{\partial {\mathbf{h}}_k}{\partial {\mathbf{W}}}} \\
{\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{h}}_k}} &amp;= \prod_{i=k+1,\ldots,t} {\frac{\partial {\mathbf{h}}_i}{\partial {\mathbf{h}}_{i-1}}}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:3.059661em;"></span><span class="strut bottom" style="height:5.619322em;vertical-align:-2.559661em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.6882210000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><span style="top:1.1214400000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.6882210000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.202113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span><span class="mpunct mtight">,</span><span class="minner mtight">&#x2026;</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">t</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><span style="top:1.1214400000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.202113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mathrm mtight">1</span><span class="mpunct mtight">,</span><span class="minner mtight">&#x2026;</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">t</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x220F;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.6859999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>i</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub></mrow></mfrac></mrow><mo>=</mo><mi mathvariant="normal">&#x39B;</mi><mo>[</mo><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msubsup><mo>]</mo><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\frac{\partial {\mathbf{h}}_i}{\partial {\mathbf{h}}_{i-1}}} = \Lambda[{\mathbf{f}}_W&apos;]{\mathbf{W}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.265771em;vertical-align:-0.894331em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.6859999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x39B;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">]</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x39B;</mi></mrow><annotation encoding="application/x-tex">\Lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x39B;</span></span></span></span> makes the vector <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_W&apos;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.027223em;vertical-align:-0.275331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.275331em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> a diagonal matrix.</p>
<p>The gradient problem comes from the product in <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>k</mi></msub></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex">{\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{h}}_k}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8962079999999999em;"></span><span class="strut bottom" style="height:1.3470679999999997em;vertical-align:-0.4508599999999999em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.4100999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathbf mtight">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>. For each term of the product <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">&#x2225;</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>k</mi></msub></mrow></mfrac></mrow><mo fence="true">&#x2225;</mo></mrow><mo>&#x2264;</mo><mo>&#x2225;</mo><mi mathvariant="normal">&#x39B;</mi><mo>[</mo><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msubsup><mo>]</mo><mo>&#x2225;</mo><mo>&#x2225;</mo><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mo>&#x2225;</mo><mo>&#x2264;</mo><msub><mi>&#x3B3;</mi><mi>f</mi></msub><msub><mi>&#x3B3;</mi><mi>W</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\left\lVert {\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{h}}_k}} \right\rVert \le \lVert\Lambda[{\mathbf{f}}_W&apos;]\rVert \lVert {\mathbf{W}}\rVert \le \gamma_f \gamma_W
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.47398em;"></span><span class="strut bottom" style="height:2.424em;vertical-align:-0.9500199999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9500199999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:0.3440199999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.2619800000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.8679800000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9500199999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:0.3440199999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.2619800000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.8679800000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2264;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">&#x2225;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x39B;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">]</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">&#x2225;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">&#x2225;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">&#x2225;</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2264;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>&#x3B3;</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">\gamma_f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>&#x3B3;</mi><mi>W</mi></msub></mrow><annotation encoding="application/x-tex">\gamma_W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are the maximum singular values of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x39B;</mi><mo>[</mo><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msubsup><mo>]</mo></mrow><annotation encoding="application/x-tex">\Lambda[{\mathbf{f}}_W&apos;]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.027223em;vertical-align:-0.275331em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x39B;</span><span class="mopen">[</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.275331em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">]</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{W}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span>, respectively. For the product <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">&#x2225;</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>k</mi></msub></mrow></mfrac></mrow><mo fence="true">&#x2225;</mo></mrow><mo>&#x2264;</mo><mo>(</mo><msub><mi>&#x3B3;</mi><mi>f</mi></msub><msub><mi>&#x3B3;</mi><mi>W</mi></msub><msup><mo>)</mo><mrow><mi>t</mi><mo>&#x2212;</mo><mi>k</mi></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\left\lVert {\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{h}}_k}} \right\rVert \le (\gamma_f \gamma_W)^{t-k}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.47398em;"></span><span class="strut bottom" style="height:2.424em;vertical-align:-0.9500199999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9500199999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:0.3440199999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.2619800000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.8679800000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9500199999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:0.3440199999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.2619800000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.8679800000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2264;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></p>
<p>When <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is a function like <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>tanh</mi></mrow><annotation encoding="application/x-tex">\tanh</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mop">tanh</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>&#x3B3;</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">\gamma_f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> would be close to zero as the input moves away from zero. As for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{W}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>&#x3B3;</mi><mi>W</mi></msub></mrow><annotation encoding="application/x-tex">\gamma_W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is probably either <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">&lt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mrel">&lt;</span><span class="mord mathrm">1</span></span></span></span> or <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">&gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mrel">&gt;</span><span class="mord mathrm">1</span></span></span></span>. Therefore, a sufficiently large <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mo>&#x2212;</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">t-k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit">t</span><span class="mbin">&#x2212;</span><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span>, i.e.&#xA0;time span of dependency, can cause two issues for the BP,</p>
<ol style="list-style-type: decimal">
<li>Vanishing gradients: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">&#x2225;</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>k</mi></msub></mrow></mfrac></mrow><mo fence="true">&#x2225;</mo></mrow><mo>&#x2192;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\left\lVert {\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{h}}_k}} \right\rVert \rightarrow 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.167985em;"></span><span class="strut bottom" style="height:1.818em;vertical-align:-0.6500149999999999em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.6500149999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:0.044014999999999915em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.5619850000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.4100999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathbf mtight">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.6500149999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:0.044014999999999915em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.5619850000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mrel">&#x2192;</span><span class="mord mathrm">0</span></span></span></span>, making <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mi>E</mi><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow></mfrac></mrow><mo>&#x223C;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{\frac{\partial E_t}{\partial {\mathbf{W}}}}\sim 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8962079999999999em;"></span><span class="strut bottom" style="height:1.2412079999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">W</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.4100999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mrel">&#x223C;</span><span class="mord mathrm">0</span></span></span></span>. In other words, the past states cannot be practically involved in BP.</li>
<li>Exploding gradients: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">&#x2225;</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>k</mi></msub></mrow></mfrac></mrow><mo fence="true">&#x2225;</mo></mrow><mo>&#x226B;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\left\lVert {\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{h}}_k}} \right\rVert \gg 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.167985em;"></span><span class="strut bottom" style="height:1.818em;vertical-align:-0.6500149999999999em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.6500149999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:0.044014999999999915em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.5619850000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.4100999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathbf mtight">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.6500149999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:0.044014999999999915em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.5619850000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mrel">&#x226B;</span><span class="mord mathrm">1</span></span></span></span>, making <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mi>E</mi><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow></mfrac></mrow><mo>&#x226B;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{\frac{\partial E_t}{\partial {\mathbf{W}}}}\gg 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8962079999999999em;"></span><span class="strut bottom" style="height:1.2412079999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">W</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.4100999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mrel">&#x226B;</span><span class="mord mathrm">1</span></span></span></span>. In other words, the BP may experience a computational overflow.</li>
</ol>
<p>Another way to see the gradient problem in the vanilla RNN is via the propagation of the variation/error of the hidden state <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{h}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span></span></span></span>. This way is somewhat hand-waving but more concise. The error of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{h}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msubsup><mo>&#x2299;</mo><mo>(</mo><mi>&#x3B4;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\delta {\mathbf{h}}_t = {\mathbf{f}}_W&apos; \odot (\delta {\mathbf{W}}{\mathbf{h}}_{t-1} + {\mathbf{W}}\delta {\mathbf{h}}_{t-1})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8018919999999999em;"></span><span class="strut bottom" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2299;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#x2299;</mo></mrow><annotation encoding="application/x-tex">\odot</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">&#x2299;</span></span></span></span> is element-wise vector product and the variation associated with the input is ignored. The second term in the bracket represents the contribution of the error of the previous states to the error of the current state, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub><mo>&#x223C;</mo><mo>(</mo><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msubsup><mo>&#x2299;</mo><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><msup><mo>)</mo><mi>k</mi></msup><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mi>k</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\delta {\mathbf{h}}_t \sim ({\mathbf{f}}_W&apos;\odot {\mathbf{W}})^k \delta {\mathbf{h}}_{t-k}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8991079999999999em;"></span><span class="strut bottom" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x223C;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2299;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> For situations discussed in the previous paragraph, the factor <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msubsup><mo>&#x2299;</mo><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><msup><mo>)</mo><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">({\mathbf{f}}_W&apos;\odot {\mathbf{W}})^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:1.124439em;vertical-align:-0.275331em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.275331em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> can be (1) vanishing, so that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\delta{\mathbf{h}}_{t-k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> almost does not contribute to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\delta{\mathbf{h}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>; (2) exploding, so that the contribution of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\delta{\mathbf{h}}_{t-k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> overwhelms the contributions of the other states.</p>
<p>The issue of vanishing and exploding gradients does not mean the RNN model is impractical, but rather means that the gradient descent becomes increasingly inefficient when the temporal span of the dependencies increases.</p>
<p>There are some fixes to circumvent the gradient issue while retaining the vanilla RNN structure,</p>
<ol style="list-style-type: decimal">
<li>For vanishing gradients, one can perform a proper initialization of the weights, and incorporate a more well-behaved activation function, such as the rectified linear unit (ReLU): <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mi>max</mi><mo>(</mo><mn>0</mn><mo separator="true">,</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f(x)=\max(0,x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></li>
<li>For exploding gradient, one can do a clipping trick with a threshold <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span> for the gradient <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2207;</mi></mrow><annotation encoding="application/x-tex">\nabla</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x2207;</span></span></span></span>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msup><mi mathvariant="normal">&#x2207;</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>=</mo><mfrac><mrow><mi>T</mi></mrow><mrow><mo>&#x2225;</mo><mi mathvariant="normal">&#x2207;</mi><msup><mo>&#x2225;</mo><mn>2</mn></msup></mrow></mfrac><mi mathvariant="normal">&#x2207;</mi><mo separator="true">,</mo><mspace width="1em"></mspace><mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi></mrow><mspace width="1em"></mspace><mo>&#x2225;</mo><mi mathvariant="normal">&#x2207;</mi><msup><mo>&#x2225;</mo><mn>2</mn></msup><mo>&gt;</mo><mi>T</mi></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\nabla&apos; = \frac{T}{\lVert\nabla\rVert^2}\nabla,\quad \mathrm{if}\quad \lVert\nabla\rVert^2 &gt; T
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.36033em;"></span><span class="strut bottom" style="height:2.29633em;vertical-align:-0.936em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathrm">&#x2207;</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mopen">&#x2225;</span><span class="mord mathrm">&#x2207;</span><span class="mclose"><span class="mclose">&#x2225;</span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2207;</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathrm">i</span><span class="mord mathrm" style="margin-right:0.07778em;">f</span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mopen">&#x2225;</span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2207;</span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">&#x2225;</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&gt;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.13889em;">T</span></span></span></span></span></li>
</ol>
<h2 id="long-short-term-memory">Long Short Term Memory</h2>
<p>A more systematic solution to the vanishing gradient problem is the Long Short Term Memory (LSTM) model (<a href="https://www.bioinf.jku.at/publications/older/2604.pdf" target="_blank" rel="noopener">Hochreiter1997</a>) <a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a>. It introduces a &#x201C;memory cell&#x201D; that enables the storage and access of information over long periods of time. The state equation for LSTM is now significantly expanded from the vanilla RNN, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">i</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mo>=</mo><mi>&#x3C3;</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>i</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>x</mi><mi>i</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mi>i</mi></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mo>=</mo><mi>&#x3C3;</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>f</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>x</mi><mi>f</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mi>f</mi></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">o</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mo>=</mo><mi>&#x3C3;</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>o</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>x</mi><mi>o</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mi>o</mi></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mo>=</mo><mi>tanh</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>g</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>x</mi><mi>g</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mi>g</mi></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>t</mi></msub><mo>&#x2299;</mo><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">i</mi></mrow></mrow><mi>t</mi></msub><mo>&#x2299;</mo><msub><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">o</mi></mrow></mrow><mi>t</mi></msub><mo>&#x2299;</mo><mi>tanh</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub><mo>)</mo></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{array}{rl}
{\mathbf{i}}_t &amp;= \sigma({\mathbf{W}}_{hi} {\mathbf{h}}_{t-1} + {\mathbf{W}}_{xi} {\mathbf{x}}_t + {\mathbf{b}}_i) \\
{\mathbf{f}}_t &amp;= \sigma({\mathbf{W}}_{hf} {\mathbf{h}}_{t-1} + {\mathbf{W}}_{xf} {\mathbf{x}}_t + {\mathbf{b}}_f) \\
{\mathbf{o}}_t &amp;= \sigma({\mathbf{W}}_{ho} {\mathbf{h}}_{t-1} + {\mathbf{W}}_{xo} {\mathbf{x}}_t + {\mathbf{b}}_o) \\
{\mathbf{g}}_t &amp;= \tanh( {\mathbf{W}}_{hg} {\mathbf{h}}_{t-1} + {\mathbf{W}}_{xg} {\mathbf{x}}_t + {\mathbf{b}}_g) \\
{\mathbf{c}}_t &amp;= {\mathbf{f}}_t \odot {\mathbf{c}}_{t-1} + {\mathbf{i}}_t \odot {\mathbf{g}}_t \\
{\mathbf{h}}_t &amp;= {\mathbf{o}}_t \odot \tanh({\mathbf{c}}_t)
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:3.8500000000000005em;"></span><span class="strut bottom" style="height:7.200000000000001em;vertical-align:-3.35em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-r"><span class="vlist"><span style="top:-3.0100000000000007em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">i</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-1.8100000000000007em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.6100000000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">o</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5899999999999996em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:1.7899999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:2.99em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-3.0100000000000007em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">x</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:-1.8100000000000007em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">x</span><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:-0.6100000000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight">o</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">x</span><span class="mord mathit mtight">o</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">o</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:0.5899999999999996em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mop">tanh</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">x</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:1.7899999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">i</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:2.99em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">o</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mop">tanh</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3C3;</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span></span></span></span> is the sigmoid function acting as a switch and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">b</span></span></span></span></span></span> is a constant offset vector.</p>
<p>In the LSTM model, the current hidden state is no longer directly related to the current input and the previous hidden state. Rather, it is now an output from the memory cell <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{c}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. The memory cell is essentially a weighted sum of the past memory and the current information. In other words, it determines: (1) whether to activate the information from past steps, and (2) whether to overwrite the memory with the information from the current step. Specifically, three new gates are introduced,</p>
<ol style="list-style-type: decimal">
<li>Input gate: Scale input to cell (write)</li>
<li>Output gate: Scale output from cell (read)</li>
<li>Forget gate: Scale old cell values (reset)</li>
</ol>
<p>The effect of the gates is better seen via the variation approach w.r.t. the hidden states, the memory cells, and the weights <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{W}}_{hg}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. Note that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{W}}_{hg}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> corresponds to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{W}}_{hh}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> in the vanilla version and will again be written as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{W}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span> below for simplicity. Also note that, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>&#x3B4;</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2299;</mo><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mo>)</mo><mo>=</mo><mi>&#x3B4;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2299;</mo><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mo>+</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2299;</mo><mi>&#x3B4;</mi><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\delta ({\mathbf{x}}\odot {\mathbf{y}}) = \delta {\mathbf{x}}\odot {\mathbf{y}}+ {\mathbf{x}}\odot \delta {\mathbf{y}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03785em;">&#x3B4;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2299;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2299;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2299;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span></span></span></span></p>
<p>The variations of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{c}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{h}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>t</mi></msub><mo>&#x2299;</mo><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mo stretchy="true">&#x203E;</mo></mover></mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">i</mi></mrow></mrow><mi>t</mi></msub><mo>&#x2299;</mo><mi>&#x3B4;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">o</mi></mrow></mrow><mi>t</mi></msub><mo>&#x2299;</mo><mi>tanh</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub><mo>)</mo><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">o</mi></mrow></mrow><mi>t</mi></msub><mo>&#x2299;</mo><msup><mi>tanh</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>&#x2299;</mo><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
\delta {\mathbf{c}}_t &amp;= {\mathbf{f}}_t\odot\delta {\mathbf{c}}_{t-1} + {\overline{\mathbf{W}}}\delta {\mathbf{h}}_{t-1} + {\mathbf{i}}_t\odot\delta {\mathbf{W}}{\mathbf{h}}_{t-1} \\
\delta {\mathbf{h}}_t &amp;= \delta {\mathbf{o}}_t \odot \tanh({\mathbf{c}}_t) + {\mathbf{o}}_t \odot \tanh&apos; \odot \delta {\mathbf{c}}_t
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.473055em;"></span><span class="strut bottom" style="height:2.44611em;vertical-align:-0.973055em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.5869449999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6130549999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.5869449999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord displaystyle textstyle uncramped"><span class="mord overline"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span><span style="top:-0.80611em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped overline-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">i</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6130549999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">o</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mop">tanh</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">o</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mop"><span class="mop">tanh</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord">&#x2299;</span><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mo stretchy="true">&#x203E;</mo></mover></mrow></mrow><annotation encoding="application/x-tex">{\overline{\mathbf{W}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8861100000000001em;"></span><span class="strut bottom" style="height:0.8861100000000001em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord overline"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span><span style="top:-0.80611em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped overline-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is a condensed term containing several weights, including <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{W}}_{hg}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. Note that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{W}}_{hg}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> only appears in the errors in the memory cell. Now, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\delta {\mathbf{h}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> propagates into <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\delta {\mathbf{c}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> but <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\delta {\mathbf{c}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> does not necessarily propagate into <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{h}}_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. Instead, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\delta {\mathbf{c}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> may be directly passed to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\delta {\mathbf{c}}_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> without being affected by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{W}}_{hg}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, thus avoiding the products of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{W}}_{hg}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and the gradient problems.</p>
<h2 id="gated-recurrent-unit">Gated Recurrent Unit</h2>
<p>The gated recurrent unit (GRU) is another RNN variant <a href="https://arxiv.org/abs/1502.02367" target="_blank" rel="noopener">Chung2015</a>. It is similar to LSTM, but computationally more efficient, as there are less parameters and less complex structure.</p>
<p>Mathematically, GRU is represented as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">r</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>&#x3C3;</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>r</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>x</mi><mi>r</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mi>r</mi></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>&#x3C3;</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>z</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>x</mi><mi>z</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mi>z</mi></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>tanh</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>g</mi></mrow></msub><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">r</mi></mrow></mrow><mi>t</mi></msub><mo>&#x2299;</mo><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>)</mo><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>x</mi><mi>g</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mi>g</mi></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>t</mi></msub><mo>&#x2299;</mo><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mo>(</mo><mn>1</mn><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>t</mi></msub><mo>)</mo><mo>&#x2299;</mo><msub><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\mathbf{r}}_t &amp;= \sigma({\mathbf{W}}_{hr} {\mathbf{h}}_{t-1} + {\mathbf{W}}_{xr} {\mathbf{x}}_t + {\mathbf{b}}_r) \\
{\mathbf{u}}_t &amp;= \sigma({\mathbf{W}}_{hz} {\mathbf{h}}_{t-1} + {\mathbf{W}}_{xz} {\mathbf{x}}_t + {\mathbf{b}}_z) \\
{\mathbf{g}}_t &amp;= \tanh({\mathbf{W}}_{hg}({\mathbf{r}}_t\odot {\mathbf{h}}_{t-1}) + {\mathbf{W}}_{xg} {\mathbf{x}}_t + {\mathbf{b}}_g) \\
{\mathbf{h}}_t &amp;= {\mathbf{u}}_t \odot {\mathbf{h}}_{t-1} + (1-{\mathbf{u}}_t) \odot {\mathbf{g}}_t
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.6500000000000004em;"></span><span class="strut bottom" style="height:4.800000000000001em;vertical-align:-2.1500000000000004em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.8100000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">r</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.6100000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:1.7900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.8100000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">x</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:-0.6100000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">x</span><span class="mord mathit mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.04398em;">z</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:0.5900000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mop">tanh</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">r</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">x</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:1.7900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mbin">&#x2299;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span></p>
<p>The GRU merges the cell state and hidden state, and thus <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{h}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span></span></span></span> replaces <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{c}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span></span></span></span> and the output gate <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">o</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{o}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">o</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is no longer needed. Next, the GRU combines the forget and input gates into a single &#x201C;update gate&#x201D; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{u}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, which enables the inclusion of long-term behaviors in the RNN. Finally, a reset gate <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">r</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{r}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">r</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is added to control the contribution of the previous states to the current prediction.</p>
<p>While many alternative LSTM architectures have been proposed, in <a href="https://arxiv.org/abs/1503.04069" target="_blank" rel="noopener">Greff2016</a>, it was found that the original LSTM performs reasonably well on various datasets and none of the eight investigated modifications (including GRU) significantly improves performance. Furthermore, it was found that the forget gate and the output activation function as its most critical components.</p>
<h1 id="example">Example</h1>
<h2 id="pytorch-windows-with-anaconda">PyTorch: Windows with Anaconda</h2>
<p>Among the popular machine learning frameworks, I chose PyTorch for its mild learning curve. I planed to try RNN on my Windows laptop, but it turns out PyTorch does not support Python 2 on Windows/Anaconda. So I did the following to install a minimal working PyTorch.</p>
<p>A Python 3 <code>environment</code> has to be created first by <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda create -n py36 python=3.6 anaconda</div></pre></td></tr></table></figure></p>
<p>After a lengthy installation, the environment is then deployed by <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda activate py36</div></pre></td></tr></table></figure></p>
<p>The command for installing PyTorch is found <a href="https://pytorch.org/get-started/locally/" target="_blank" rel="noopener">here</a>. In my case where a GPU is not available, the PyTorch ecosystem is installed by, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install pytorch-cpu torchvision-cpu -c pytorch</div></pre></td></tr></table></figure></p>
<p>The Python 3 installation might alter the default browser for the Jupyter Notebook. To reset the browser, first fo the following in the command line, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">jupyter notebook --generate-config</div></pre></td></tr></table></figure></p>
<p>And next specify the path to the browser in the config file, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">c.NotebookApp.browser = u&apos;path_to_browser %s&apos;</div></pre></td></tr></table></figure></p>
<p>Note that <code>%s</code> has to be in the string.</p>
<h2 id="toy-problem">Toy Problem</h2>
<p>The dynamical system considered in this example is the forced Van der Pol (VdP) <a href="https://en.wikipedia.org/wiki/Van_der_Pol_oscillator#Forced_Van_der_Pol_oscillator" target="_blank" rel="noopener">oscillator</a>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mover accent="true"><mi>x</mi><mo>&#xA8;</mo></mover><mo>=</mo><mi>&#x3BC;</mi><mo>(</mo><mn>1</mn><mo>&#x2212;</mo><msup><mi>x</mi><mn>2</mn></msup><mo>)</mo><mover accent="true"><mi>x</mi><mo>&#x2D9;</mo></mover><mo>&#x2212;</mo><mi>x</mi><mo>+</mo><mi>A</mi><mi>sin</mi><mo>(</mo><mi>&#x3C9;</mi><mi>t</mi><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\ddot x = \mu (1-x^2) \dot x - x + A \sin(\omega t)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8641079999999999em;"></span><span class="strut bottom" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord accent reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord mathit">x</span></span><span style="top:0em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xA8;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3BC;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">1</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mord accent reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord mathit">x</span></span><span style="top:0em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#x2D9;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">x</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">A</span><span class="mop reset-textstyle displaystyle textstyle uncramped">sin</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03588em;">&#x3C9;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">t</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>x</mi><mo>&#x2D9;</mo></mover></mrow><annotation encoding="application/x-tex">\dot x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.66786em;"></span><span class="strut bottom" style="height:0.66786em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord mathit">x</span></span><span style="top:0em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#x2D9;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span> are considered the states of this second-order ODE. The first term on the RHS is a nonlinear damping term that introduced rich dynamical properties to the oscillator. The third term on the RHS is considered the input to the system. In this study, the following parameters are used, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>&#x3BC;</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>1</mn><mo separator="true">,</mo><mspace width="1em"></mspace><mi>A</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">.</mi><mn>2</mn><mo separator="true">,</mo><mspace width="1em"></mspace><mi>x</mi><mo>(</mo><mn>0</mn><mo>)</mo><mo>=</mo><mover accent="true"><mi>x</mi><mo>&#x2D9;</mo></mover><mo>(</mo><mn>0</mn><mo>)</mo><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mspace width="1em"></mspace><mi>t</mi><mo>&#x2208;</mo><mo>[</mo><mn>0</mn><mo separator="true">,</mo><mn>5</mn><mn>0</mn><mo>]</mo><mo separator="true">,</mo><mspace width="1em"></mspace><mi mathvariant="normal">&#x394;</mi><mi>t</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>2</mn><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\mu = 0.1,\quad A = 1.2,\quad x(0)=\dot x(0)=0,\quad t\in [0, 50],\quad \Delta t=0.25
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3BC;</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">0</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">.</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">1</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathit">A</span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">1</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">.</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">2</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathit">x</span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">0</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord accent reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord mathit">x</span></span><span style="top:0em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#x2D9;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">0</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">0</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathit">t</span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2208;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">0</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">5</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">0</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">]</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathrm">&#x394;</span></span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">t</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">0</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">.</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">2</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">5</span></span></span></span></span> Given the sinusoidal input associated with a certain value of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3C9;</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C9;</span></span></span></span>, one can numerically integrate the system to obtain the response of the VdP oscillator. The goal of this exercise is to fit an RNN based on the VdP responses for several <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3C9;</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C9;</span></span></span></span>&#x2019;s, such that the RNN can reproduce the VdP responses for some other <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3C9;</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C9;</span></span></span></span>&#x2019;s.</p>
<p>The code implementation is adapted from <a href="https://github.com/MorvanZhou/PyTorch-Tutorial/blob/master/tutorial-contents/403_RNN_regressor.py" target="_blank" rel="noopener">here</a>, and can be found from my github <a href="https://github.com/smanist/trying_out_rnn_regressor" target="_blank" rel="noopener">repo</a>. Four types of RNNs are examined,</p>
<ol style="list-style-type: decimal">
<li>Vanilla RNN with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>tanh</mi></mrow><annotation encoding="application/x-tex">\tanh</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mop">tanh</span></span></span></span> as activation function.</li>
<li>Vanilla RNN with ReLU as activation function.</li>
<li>LSTM RNN</li>
<li>GRU RNN</li>
</ol>
<p>All the RNNs have one hidden layer with 32 states and one linear output layer. The RNNs are trained via the MSE loss function using the Adam algorithm with a learning rate of 0.01 and 10000 epochs. The training data set includes the VdP responses for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3C9;</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>3</mn><mi>&#x3C0;</mi><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>4</mn><mi>&#x3C0;</mi><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mi>&#x3C0;</mi><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>6</mn><mi>&#x3C0;</mi></mrow><annotation encoding="application/x-tex">\omega=0.3\pi,0.4\pi,0.5\pi,0.6\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C9;</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">3</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">4</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">6</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span></span></span></span>. The testing data sets includes the VdP responses for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3C9;</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>3</mn><mn>5</mn><mi>&#x3C0;</mi><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>4</mn><mn>5</mn><mi>&#x3C0;</mi><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mn>5</mn><mi>&#x3C0;</mi></mrow><annotation encoding="application/x-tex">\omega=0.35\pi,0.45\pi,0.55\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C9;</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">3</span><span class="mord mathrm">5</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">4</span><span class="mord mathrm">5</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mord mathrm">5</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span></span></span></span>. In each training epoch, the data for gradient decent is a random segment (starts from beginning) of a VdP response randomly chosen from the training data set. A maximum of 120 time steps is used in the training. In other words, the last 80 time steps of the VdP response in the training data set are unseen by the RNN. Finally, the initial hidden states are set to be zero.</p>
<p>The results are shown in the figures below. The solid blue and red lines are the VdP responses found directly using numerical integration. The dashed lines are the RNN prediction. The vanilla RNNs do not do well in this problem. The failure probably can be explained the gradient vanishing problem that prevents the vanilla RNN to capture the long term periodic behavior. Both the LSTM and GRU do well. Note that the RNN predictions extrapolates well beyond the data used for training, as well as between the different values of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3C9;</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C9;</span></span></span></span>&#x2019;s.</p>
<p>There are apprarently many tweaks and tunable parameters in the RNNs that can improve the prediction or generalize the model. For example,</p>
<ol style="list-style-type: decimal">
<li>What are the optimal numbers of layers and hidden states for the RNN?</li>
<li>What is the best way to utilize the training data set?</li>
<li>How to take care of different initial conditions? Maybe via infering the proper initial hidden state in RNN?</li>
<li>How to efficiently train the RNN for a larger parameter space that includes, e.g. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BC;</mi><mo separator="true">,</mo><mi>A</mi><mo separator="true">,</mo><mi>&#x3C9;</mi></mrow><annotation encoding="application/x-tex">\mu, A, \omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BC;</span><span class="mpunct">,</span><span class="mord mathit">A</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C9;</span></span></span></span>?</li>
</ol>
<p>These might be done in a future post.</p>
<figure float="left">
<img src="m0_pred.png" width="700px">
<figcaption>
Vanilla RNN with tanh.
</figcaption>
</figure>
<figure float="left">
<img src="m1_pred.png" width="700px">
<figcaption>
Vanilla RNN with ReLU.
</figcaption>
</figure>
<figure float="left">
<img src="m2_pred.png" width="700px">
<figcaption>
LSTM RNN.
</figcaption>
</figure>
<figure float="left">
<img src="m3_pred.png" width="700px">
<figcaption>
GRU RNN.
</figcaption>
</figure>
<h1 id="more-references">More References</h1>
<ol style="list-style-type: decimal">
<li><a href="https://ieeexplore.ieee.org/document/279181" target="_blank" rel="noopener">Bengio et al, &#x201C;Learning long-term dependencies with gradient descent is difficult&#x201D;</a></li>
<li><a href="http://proceedings.mlr.press/v28/pascanu13.pdf" target="_blank" rel="noopener">Pascanu et al, &#x201C;On the difficulty of training recurrent neural networks&#x201D;</a></li>
<li><a href="https://www.cs.ox.ac.uk/people/nando.defreitas/machinelearning/lecture11.pdf" target="_blank" rel="noopener">Recurrent Nets and LSTM</a></li>
<li><a href="https://www.cs.toronto.edu/~tingwuwang/rnn_tutorial.pdf" target="_blank" rel="noopener">RNN Tutorial</a></li>
<li><a href="https://danijar.com/tips-for-training-recurrent-neural-networks/" target="_blank" rel="noopener">Tips for training RNNs</a></li>
<li><a href="https://r2rt.com/non-zero-initial-states-for-recurrent-neural-networks.html" target="_blank" rel="noopener">Initial states for RNN</a></li>
</ol>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Note that the notation is slightly different from the engineering convention, so as to conform with the notation in RNN.<a href="#fnref1">&#x21A9;</a></p></li>
<li id="fn2"><p>One can see that even LSTM is not a recent concept.<a href="#fnref2">&#x21A9;</a></p></li>
</ol>
</div>
]]></content>
      
        <categories>
            
            <category> digest </category>
            
        </categories>
        
        
        <tags>
            
            <tag> rnn </tag>
            
            <tag> time series </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Interesting Websites]]></title>
      <url>http://smanist.github.io/2019/02/15/Interesting-websites/</url>
      <content type="html"><![CDATA[<p>This is a gathering of websites that are interesting and useful.</p>
<p>The list is in alphabetical order and could be updated from time to time.</p>
<a id="more"></a>
<h2 id="amcharts"><a href="www.amcharts.com">amCharts</a></h2>
<p>The website provides a set of visualization tools, including an <a href="live.amcharts.com">online chart editor</a> and an <a href="pixelmap.amcharts.com">online map generator</a>. These applications are free and fully-functional. The free image has a website logo that can be removed by paying for a license.</p>
<p>But the most powerful tool from amCharts is its <a href="www.amcharts.com/download">libraries</a> for plugging interactive visualizations into a webpage. One can write a relatively simple JavaScript/JSON file (or TypeScript, which I am not familiar with) to generate a fancy complex image, such as chord diagrams, sankey diagrams, and annotated world maps.</p>
<p>The only inconvenient part is that the library is a little bit heavy if one only wants to make figures for a paper or presentation. The library does provide an export function, but requires some manual operations.</p>
<h2 id="coca-linggle-and-netspeak"><a href="corpus.byu.edu/coca/">COCA</a>, <a href="linggle.com">Linggle</a> and <a href="www.netspeak.org">Netspeak</a></h2>
<p>These are websites for improving English usage/writing by checking/finding the proper combination of words, i.e.&#xA0;phrases.</p>
<p>For example, on Linggle, one can find the best combination of words that looks native to English,</p>
<ol style="list-style-type: decimal">
<li><code>*</code> for filling in a blank of a phrase with multiple words.</li>
<li><code>_</code> for filling in a blank of a phrase with one word.</li>
<li><code>?word</code> for checking if <code>word</code> is needed in the phrase.</li>
<li><code>word1/word2</code> for choosing the best word from <code>word1</code> and <code>word2</code> for the phrase.</li>
<li><code>pos.</code> for finding a word of the specified part of speech for the phrase. <code>pos.</code> can be v., n., adj., prop., det., conj., pron.</li>
</ol>
<p>COCA and Netspeak are other two websites for the similar purpose, and its usage is self-explanatory from the website instruction.</p>
<h2 id="wordart"><a href="wordart.com">Wordart</a></h2>
<p>The website is for generating a cloud of words, e.g.&#xA0;keywords of a research project. The resulting image can be highly-customized. One has to pay for high resolution image. However, I think the resolution of the free version is high enough for regular usage.</p>
]]></content>
      
        <categories>
            
            <category> pieces </category>
            
        </categories>
        
        
        <tags>
            
            <tag> language, visualization </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Rays v.s. Skates]]></title>
      <url>http://smanist.github.io/2019/01/27/Rays_vs_Skates/</url>
      <content type="html"><![CDATA[<p>Flat fish flying in the water.</p>
<a id="more"></a>
<p>Recently I visited an aquarium and encountered with these &#x201C;flying&#x201D; fish, rays and skates. They looks the same to me: flat, kite-like fish.</p>
<p>In fact, rays and skates are dorsoventrally flattened fish that belong to the same superorder <a href="https://en.wikipedia.org/wiki/Batoidea" target="_blank" rel="noopener">Batoidea</a>, which contains four orders. Skates are in <a href="https://en.wikipedia.org/wiki/Rajiformes" target="_blank" rel="noopener">Rajiformes</a>, while rays are in <a href="https://en.wikipedia.org/wiki/Myliobatiformes" target="_blank" rel="noopener">Myliobatiformes</a>, <a href="https://en.wikipedia.org/wiki/Rhinopristiformes" target="_blank" rel="noopener">Rhinopristiformes</a>, <a href="https://en.wikipedia.org/wiki/Electric_ray" target="_blank" rel="noopener">Torpediniformes</a>. Historically, due to morphological reasons, some rays were classified as skates, and vice versa.</p>
<p>Furthermore, rays, skates, and their close relatives, sharks, are considered to be within a subclass of (primitive) fish called <a href="https://en.wikipedia.org/wiki/Elasmobranchii" target="_blank" rel="noopener">Elasmobranchii</a> in the class <a href="https://en.wikipedia.org/wiki/Chondrichthyes" target="_blank" rel="noopener">Chondrichthyes</a>. Chondrichthyes contains the cartilaginous fish. From wikipedia: They are jawed vertebrates with paired fins, paired nares, scales, a heart with its chambers in series, and skeletons made of cartilage rather than bone. In a word, these fish have soft skeletons <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. Furthermore, Elasmobranchs have five to seven pairs of gill clefts opening individually to the exterior, rigid dorsal fins and small placoid scales on the skin. The pelvic fins in males are modified to create claspers for the transfer of sperm. There is no swim bladder; instead, these fish maintain buoyancy with large livers rich in oil. Sometimes it is hard to differentiate rays and skates from sharks, as illustrated in this <a href="https://www.youtube.com/watch?v=iLwkfWuAMRo" target="_blank" rel="noopener">short video</a>. However, a rule of thumb is that, sharks have gill slits on the side, rays and skates have theirs on the bottom.</p>
<p>Now the diffeences between rays and skates. The major difference is in the reproductive strategies: Rays are viviparous while skates are oviparous. The skate eggs are a little peculiar, because they are released in hard rectangular cases nicknamed &#x201C;mermaid&#x2019;s purses&#x201D;. Morphologically, skates typically have a prominent dorsal fin while the dorsal fin is absent or greatly reduced in rays. Most rays are kite-shaped with whip-like tails having stinging spines (hence &#x201C;stingray&#x201D;) while skates have fleshier tails and lack spines <a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a>. While some rays have stings to protect them, the electric rays have kidney-shaped electric organs that are visible through the skin on the dorsal surface to generate and discharge a strong electric current to stun prey and for defense from potential predators. As for skates, they rely on thorny projections on their backs and tails to for protection. For more differences between rays and skates, see <a href="https://en.wikipedia.org/wiki/Skate_(fish)#Skates_versus_stingrays" target="_blank" rel="noopener">here</a>.</p>
<p>It is said that rays are generally much larger than skates. Nevertheless, the variance of the sizes of rays is huge. The largest ray (<a href="https://en.wikipedia.org/wiki/Giant_oceanic_manta_ray" target="_blank" rel="noopener">Manta birostris</a>) reaches up to 9 meters in width, while the smaller ray (<a href="https://en.wikipedia.org/wiki/Lesser_electric_ray" target="_blank" rel="noopener">Narcine bancroftii</a>) is only 20 cm. The sizes of skates are in between. The largest skate (<a href="https://en.wikipedia.org/wiki/Common_skate" target="_blank" rel="noopener">Dipturus batis</a>) reaches up to 2.5 meters in length, while the smaller skate (<a href="https://en.wikipedia.org/wiki/Raja_straeleni" target="_blank" rel="noopener">Raja straeleni</a>) reaches to a maximum total length of 68 cm.</p>
<p>The last interesting thing I would like to mention is the <a href="https://en.wikipedia.org/wiki/Osmoregulation" target="_blank" rel="noopener">osmoregulation</a> of cartilaginous fishes, i.e.&#xA0;the passive regulation of the osmotic pressure of an organism&#x2019;s body fluids for the water-salt balance. For adaptation to high-salinity marine environments, cartilaginous fishes adopt a unique urea-based osmoregulation strategy. Their kidneys reabsorb nearly all filtered urea from the primary urine, and this is an essential component of <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1469-185X.1936.tb00497.x" target="_blank" rel="noopener">urea retention</a> in their body fluid.</p>
<p>Due to urea retention, the meat of cartilaginous fishes is usually poisonous, due to the high content of urea and sometimes trimethylamine oxide. Nevertheless, human managed to process the meat, e.g.&#xA0;via fermentation, and eat without costing their lives. For example, <a href="https://en.wikipedia.org/wiki/Hongeo-hoe" target="_blank" rel="noopener">hongeo-hoe</a> from Korea is made from skate and emits a very strong ammonia-like odor. And <a href="https://en.wikipedia.org/wiki/H%C3%A1karl" target="_blank" rel="noopener">h&#xE1;karl</a> from Iceland is made from sharks and has a strong ammonia-rich smell and fishy taste. The ammonia produced during fermentation actually helps the preservation of the food. I personally have tried h&#xE1;karl, which tasted good if the ammonia smell is accepted. I like the texture.</p>
<p>References:</p>
<ol style="list-style-type: decimal">
<li><a href="https://www.floridamuseum.ufl.edu/discover-fish/skates-rays/biology/" target="_blank" rel="noopener">Florida Museum</a></li>
</ol>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>See more differences between cartilaginous and bony fishes <a href="https://en.wikipedia.org/wiki/Osteichthyes#Anchor:Bony/Cartilaginous" target="_blank" rel="noopener">here</a>.<a href="#fnref1">&#x21A9;</a></p></li>
<li id="fn2"><p>The spines of stingrays are often removed for safety reasons when displayed in aquariums.<a href="#fnref2">&#x21A9;</a></p></li>
</ol>
</div>
]]></content>
      
        <categories>
            
            <category> pieces </category>
            
        </categories>
        
        
        <tags>
            
            <tag> zoology </tag>
            
            <tag> food </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Notes on Julia]]></title>
      <url>http://smanist.github.io/2018/12/21/Notes-on-Julia/</url>
      <content type="html"><![CDATA[<p><a href="https://www.youtube.com/watch?v=8h8rQyEpiZA" target="_blank" rel="noopener">&#x201C;Looks like Python, feels like lisp, runs like C.&#x201D;</a></p>
<a id="more"></a>
<h1 id="introduction">Introduction</h1>
<p>As discussed in the <a href="https://smanist.github.io/2018/11/19/Julia-For-Mushin/">previous article</a>, I plan to explore the capability of Julia in scientific computing, esp. in applications like computational mechanics and optimization. I have gotten even more attracted to Julia when I heard that it has <a href="https://www.hpcwire.com/off-the-wire/julia-joins-petaflop-club/" target="_blank" rel="noopener">joined the Petaflop Club</a>: achieved peak performance exceeding one petaflop per second on supercomputers. Julia appears to be the only &#x201C;high-level&#x201D; language in the Petaflop club - the others are C, C++ and Fortran.</p>
<p>This article is a digest of the basics of Julia that I have learned recently. The syntax of Julia will not be discussed in detail, as it could be mastered by actaully writing the code - So there will not be many examples. Instead, in this article, I would focus more on the features and highlights of Julia. In addition, due to my background, I tend to highlight the similarities and differences between Julia and Python/C++.</p>
<h1 id="overview">Overview</h1>
<h2 id="two-language-problem">Two-Language Problem</h2>
<p>One of the goals of Julia is to solve the two-language problem: one can <a href="https://thebottomline.as.ucsb.edu/2018/10/julia-a-solution-to-the-two-language-programming-problem" target="_blank" rel="noopener">either have a programming language that&#x2019;s easy to use, or fast.</a></p>
<p>There are indeed some existing solutions, e.g.&#xA0;those from the Python ecosystem. In the standard <code>CPython</code> implementation, the Python code is <em>interpreted</em> as bytecodes that run on the virtual machine, which is of course slower than <em>compiled</em> machine code that runs on the actual machine. Three representative approaches to accelerate Python include <a href="https://pypy.org/" target="_blank" rel="noopener"><code>PyPy</code></a>, <a href="https://cython.org/" target="_blank" rel="noopener"><code>Cython</code></a>, and <a href="http://numba.pydata.org/" target="_blank" rel="noopener"><code>Numba</code></a>. PyPy is basically an implementation different from CPython using a <a href="https://en.wikipedia.org/wiki/Just-in-time_compilation" target="_blank" rel="noopener">just-in-time (JIT)</a> compiler. Cython generates C code from Python code - or wraps C libraries for Python <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. Numba compiles Python snippets in a JIT manner. I myself have mainly used Python with Cython-wrapped C++ library. So I am really using two languages to &#x201C;solve&#x201D; the two-language problem. The three approaches have been discussed and compared in <a href="https://www.quora.com/How-do-Cython-Numba-and-PyPy-compare-in-terms-of-performance-ease-of-use-and-restrictions" target="_blank" rel="noopener">this post</a>. These approaches are not perfect. To accelerate a given Python code, some extra work are involved, e.g.&#xA0;annotating the code using certain &#x201C;peculiar&#x201D; syntaxes.</p>
<p>The two-language problem had been even more challenging when the Julia project started in 2009, since the Python ecosystem has not matured enough to solve the problem. As one of the developers discussed in <a href="https://discourse.julialang.org/t/julia-motivation-why-werent-numpy-scipy-numba-good-enough/2236" target="_blank" rel="noopener">this post</a>: The initial version of <code>Cython</code> was released in 2007; The first working verion of <code>PyPy</code> was released in 2007; <code>Numpy</code> was yet not mature at the time; <code>Numba</code> would not be released until 2012. <a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></p>
<h2 id="solution-by-julia">Solution by Julia</h2>
<p>Julia is mainly written in Julia with some dependencies on C, Fortran, and assembly. However, in the core, there is a <a href="https://en.wikipedia.org/wiki/Scheme_(programming_language)" target="_blank" rel="noopener">Scheme</a> parser <code>FemtoLisp</code> and a <a href="https://en.wikipedia.org/wiki/LLVM" target="_blank" rel="noopener">LLVM</a> compiler in C++. They are responsible for gluing Julia and the underlying operating system together.</p>
<p>The Julia solution to the two-language problem is best described by the quote at the beginning of this article:</p>
<ol style="list-style-type: decimal">
<li>Writes like Python: The user writes Julia like a high-level dynamic language.</li>
<li>Feels like Lisp: The Julia code is parsed into <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree" target="_blank" rel="noopener">abstract syntax trees</a> (ASTs) using FemtoLisp (<code>lowered</code>, <code>typed</code>).</li>
<li>Runs like C: The LLVM generates the <a href="https://en.wikipedia.org/wiki/Intermediate_representation" target="_blank" rel="noopener">intermediate representation</a> (IR) of the ASTs, which would run on the virtual machine (<code>llvm</code>), and compiles the IR into the native code optimized for the local machine (<code>native</code>) <a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a>.</li>
</ol>
<p>The user essentially only needs to care about writing their applications. The compiler takes care of the rest. Of course, the code would be faster if it is written with care taken for the parsing and compiling stages.</p>
<h2 id="key-features">Key Features</h2>
<p>As I understand, Julia as a <a href="https://en.wikipedia.org/wiki/Dynamic_programming_language" target="_blank" rel="noopener">dynamic programming language</a> is made distinct from the others by its <a href="https://en.wikipedia.org/wiki/Type_system" target="_blank" rel="noopener">type system</a> combined with <a href="https://en.wikipedia.org/wiki/Multiple_dispatch" target="_blank" rel="noopener">multiple dispatch</a>. Well, I am not a computer scientist, I could be wrong in this assertion and some of the concepts discussed in this section.</p>
<p>Dynamic languages are usually considered &#x201C;typeless&#x201D;. However, more precisely speaking, types do exist, but what lacks is type declaration. The user cannot explicitly instruct the compiler to specify certain types for certain values. On the other hand, in static languages, type declaration is mandatory. And that is one reason why static languages are usually faster than dynamic languages, as some optimizations of the machine code can be done based on the types. Cython and Numba are like patches of partial type declaration for accelerating Python. Julia takes a step further, as it has the complete type system and the <em>type inference</em> mechanism. Like static language, all the values in Julia can be assigned a type by the user. Like dynamic language, not all values require a type - the most suitable type can be <em>inferred</em> by the compiler.</p>
<p>Based on the type system, the multiple dispatch mechanism is enabled with <a href="https://en.wikipedia.org/wiki/Parametric_polymorphism" target="_blank" rel="noopener">parametric polymorphism</a>. In <a href="https://en.wikipedia.org/wiki/Polymorphism_(computer_science)" target="_blank" rel="noopener">polymorphism</a>, a single interface, or method, is provided to values of different types <a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a>. Typically, the polymorphic methods are stored in a <a href="https://en.wikipedia.org/wiki/Virtual_method_table" target="_blank" rel="noopener">virtual method table</a>, a.k.a. vtable. In the <em>run-time</em>, the specific method is chosen from the vtable. In single dispatch, the vtable is stored with the classes. The calling of a method can be written as <code>object.action(args)</code>, because the choice of polymorphic method is solely determined by the type of the calling object. In multiple dispatch, the vtable is stored with the method itself. The calling of a method should be better written as <code>action(objects, args)</code>, as is done in Julia, the choice of polymorphic method is determined by the types of all the arguments.</p>
<p>Multiple dispatch has two advantages. First, it is the direct reason for the high performance of Julia. For each polymorphic method, specialized low-level code is generated with all possible optimizations under the host machine. In the run-time, the most suitable/optimized method is called from the vtable. Second, multiple dispatch provides greater flexibility and reusability, as a method is not bound to a type. For example, suppose there is an existing method for LU decomposition for matrices of <code>Float64</code>. To do LU decomposition of matrices of rationals, one only need to define the elementary arithmetic operations for rationals, and call the same LU method. However, in single dispatch languages, one will need to not only define the elementary arithmetic operations, but also <em>rewriting</em> the LU method using the new rational type.</p>
<p>Besides the type system and multiple dispatch, another important feature of Julia is its <a href="https://en.wikipedia.org/wiki/Metaprogramming" target="_blank" rel="noopener">metaprogramming</a> capability: a program can be designed to read, generate, analyse or transform other programs, and even modify itself while running. The roles of code and data are more or less interchangeable. In Julia, everything is an expression that returns a value and an expression can take values and/or <em>expressions</em> as input. The metaprogramming capability directly stems from the lisp core of Julia, that enables the manipulation of the ASTs generated from the Julia code, e.g.&#xA0;using macros <a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a> - functions that acts on expressions. The metaprogramming capability allows the users to minimize the efforts and computational time for their applications.</p>
<h2 id="learning-materials">Learning materials</h2>
<p>The best learning material for Julia is probably its <a href="https://docs.julialang.org" target="_blank" rel="noopener">documentation</a>, which is always (expected to be) update-to-date, and contains both introductory and advanced topics. The official website also provides a <a href="https://julialang.org/learning/" target="_blank" rel="noopener">large list</a> of learning materials, including videos (e.g. <a href="https://www.youtube.com/watch?v=8h8rQyEpiZA" target="_blank" rel="noopener">this</a> and <a href="http://online.kitp.ucsb.edu/online/transturb17/gibson/rm/jwvideo.html" target="_blank" rel="noopener">this</a>), online documents, and books. Among these are two books that I recommend: (1) <em>Getting Started with Julia</em> by Ivo Balbaert, indeed good for getting started; (2) &#x201C;Julia High Performance&#x201D; by Avik Sengupta, a little advanced but very useful for beginners aiming for performant programs. Another book, &#x201C;Mastering Julia&#x201D; by Malcolm Sherrington, might be good for people who need immediate hands-on experiences. However, a notable issue is that, with the advent of the more stable 1.0 version, some of the syntaxes and claims in the books are outdated. So make sure to practice and verify everything read from the books.</p>
<p>Another good source of learning materials are the Julia code itself. As one of the books has suggested, there are several interesting folders in Julia to look at:</p>
<ol style="list-style-type: decimal">
<li><code>base</code>: contains a great portion of the standard library and the coding style exemplary.</li>
<li><code>test</code>: has some code that illustrates how to write test scripts and use the Base.Test system.</li>
<li><code>examples</code>: gives Julia&#x2019;s take on some well-known old computing chestnuts.</li>
</ol>
<p>This article is mainly based on materials from <em>Getting Started with Julia</em> by Ivo Balbaert and the official documentation.</p>
<h1 id="more-on-features">More on Features</h1>
<h2 id="type-system">Type System</h2>
<h3 id="type-hierarchy">Type hierarchy</h3>
<p>Every value has a type and there are a lot of built-in types. These types are organized in tree, with the root, type <code>Any</code>. The types themselves are of type <code>DataType</code>. A type is either an abstract type or a concrete type. An abstract type can have a lot of children or subtypes but cannot be instantiated, while a concrete type is on the contrary. Essentially, an abstract type is only a name that groups multiple subtypes together, which works in a manner similar to <code>Union</code> that gives a type/alias to a user-specified group of types. Naturally, <code>Any</code> is the supertype of all types (including itself). The opposite of <code>Any</code> is a special type called <code>Union{}</code>, i.e.&#xA0;union of nothing. It is subtype of all other types (even the concrete ones). There is also a special type <code>Nothing</code>.</p>
<p>Here, it is stressed again: In the context of multiple dispatch, a subtype do not inherit any methods from its supertype. This is on the contrary to the object-oriented thinking.</p>
<h3 id="conversion-promotion-and-annotation">Conversion, promotion, and annotation</h3>
<p>Variables of different types can be converted to each other, if the corresponding <code>convert</code> method exists. There is also a built-in system called automatic type promotion to promote arguments of functions so as to match those of the existing functions. This is a key device that facilitates the multi-dispatch mechanism. Additionally, the combination of type promotion and <code>Union</code> could bring some convenience to the user. The user can define one function using data types from a user-defined union and save the effort of defining multiple similar functions for each data type from the union.</p>
<p>Variables can be associated to types using two operators for type annotation: <code>::</code> and <code>&lt;:</code>. Essentially, <code>var::T</code> asserts if the variable <code>var</code> is of type <code>T</code>. This is also used in the sense of a type declaration, but only in local scopes such as in functions. <code>var&lt;:T</code> asserts if the variable <code>var</code> is of the subtype of <code>T</code>. This can be used in, e.g.&#xA0;the restriction of types in composite types.</p>
<h3 id="composite-and-parametric-types">Composite and parametric types</h3>
<p>The composite types are the types composed of a set of named fields with an optional type annotation (by default <code>Any</code>). A composite type is similar to a struct in C. In fact, the keyword is <code>struct</code> too in Julia.</p>
<p>Composite types declared with struct are immutable; they cannot be modified after construction. This design has some advantages, including efficiency in storage and memory allocation, thread safety, and readability. Nevertheless, the contents of a mutable field in an immutable type can be changed, because only the reference is stored. It could be a good practice to define immutable types without mutable fields. When necessary, mutable composite types can be declared with the keywords <code>mutable struct</code>.</p>
<p>Composite types can be generalized via parametrization. A parametric type is conceptually similar to templates in C++ and creates a whole family of new possible concrete types. However, the new types are only compiled as needed at runtime. Finally, for better performance, always annotate the type of the fields in a composite type when possible.</p>
<p>As a side note, to see whether the two objects x and y are identical, they must be compared with the <code>is</code> function, The <code>is(x, y)</code> function can also be written with the triple-equal operator as <code>x === y</code>. The addresses in memory are compared to check whether they point to the same memory location</p>
<h3 id="constructors">Constructors</h3>
<p>Constructors creates and initializes an instance of a type. There is always a default (inner) constructor that comes with a type, if not otherwise specified. One can, of course, define a specific inner constructor in the type declaration, which <em>overrides</em> the default one. The inner constructors are the only constructors that has access to a special locally existent function called <code>new</code> that creates an object of the declared type. Once a type is declared, there is no way to add more inner constructor methods. Instead, one can only add outer constructors, that are defined just like regular methods (due to multiple dispatch). The outer constructors, ultimately, rely on calling one of the inner constructors to complete the instantiation.</p>
<p>Special inner constructors are needed in certain cases, e.g.&#xA0;when argument checking is necessary. A good practice is to combine outer constructors with a limited set of inner constructors.</p>
<h2 id="metaprogramming">Metaprogramming</h2>
<p>This is the part of Julia that feel like Lisp: &#x201C;code is data and data is code&#x201D;. Every piece of code is internally represented as an expression, <code>Expr</code>, which can be manipulated by other expressions. This characteristic of Julia, <a href="https://en.wikipedia.org/wiki/Homoiconicity" target="_blank" rel="noopener">homoiconicity</a>, enables the transformation and generation of the code. This is not unfamiliar, if one works with Lisp (e.g.&#xA0;in Emacs) and Mathematica.</p>
<p>The homoiconicity facilitates the <a href="https://en.wikipedia.org/wiki/Reflection_(computer_programming)" target="_blank" rel="noopener">reflection</a> capability of Julia. The structure of a program and its types can be explored programmatically just like any other data. This means that a running program can dynamically discover its own properties. Reflection is indispensable for tools that need to inspect the internals of the code objects programmatically, such as debugging and profiling.</p>
<h3 id="expressions">Expressions</h3>
<p>The Julia code is parsed by FemtoLisp as an AST, a tree representation of the abstract syntactic structure of the source code. The nodes of AST are all of type <code>Expr</code>. A formal definition of the <code>Expr</code> type is <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">type Expr</div><div class="line">    head::Symbol</div><div class="line">    args::Array{Any,1}</div><div class="line">end</div></pre></td></tr></table></figure></p>
<p>The <code>head</code> indicates the type of the expression, e.g. <code>:call</code> as a function call and <code>=</code> as assignment. The <code>args</code> is an array of <code>Symbol</code>s and (maybe) <code>Expr</code>s, which recursively represents the AST. One can get a formatted output of the AST of an expression using the <code>dump</code> function.</p>
<p>Expressions can be built directly using the constructor for <code>Expr</code>. However, to make life easier, one can create expressions using the quote operator <code>:</code> that treats its argument as data instead of code. It means &#x201C;prevented evaluation&#x201D; in a sense. The quote preceding a symbol makes a <code>Symbol</code>, e.g <code>:sym</code>. The quote preceding a bracketed expression makes an <code>Expr</code>, e.g <code>:(1+2)</code>.</p>
<p>A compound expression consists of multiple sub-expressions separated by <code>;</code>. The value of a compound expression is the value of the last sub-expression. For a larger compound expression, it is better to use the <code>quote-end</code> block instead of quote operator. Note that the evaluation of an expression is done in the global scope and the internal variables will be visible to the outside code.</p>
<p>Writing expressions is made even simpler with the interpolation operator <code>$</code>. The interpolation is evaluated once an expression is constructed at parse time. This is unlike the quotation itself, which is evaluated by <code>eval</code> at runtime.</p>
<h3 id="macros">Macros</h3>
<p>Macros are like functions, but instead of values, they take expressions, symbols or literals as input arguments. The evaluation of a macro means the expansion of the input expression. This expansion occurs at parse time when the AST is being built. This is different from a function, which takes the input values and returns the computed values at run-time.</p>
<p>A macro is hygenic, when it differentiates between the macro context and the calling context. The hygienity is important because the macros inject the code directly in the namespace in which they are called, which may clash with the existing methods in the same module. There are several rules for writing hygienic macros:</p>
<ol style="list-style-type: decimal">
<li>Declare the variables used in the macro as local, so as not to conflict with the outer variables.</li>
<li>Use the escape function <code>esc</code> to make sure that an interpolated expression is not expanded, but instead is used literally.</li>
<li>Don&#x2019;t call <code>eval</code> inside a macro.</li>
</ol>
<p>Note that escaping is similar to <code>Hold</code> in Mathematica. An expression wrapped in this manner is left alone by the macro expander and simply pasted into the output verbatim. Therefore it will be resolved when the macro is called, instead of when it is defined.</p>
<h1 id="notes-on-the-usage">Notes on the Usage</h1>
<p>This section highlights some basic functionalities of Julia.</p>
<h2 id="general-behaviors-and-conventions">General Behaviors and Conventions</h2>
<p>Julia behaves similarly to Python in many senses, e.g.&#xA0;all names are just aliases bound to values. However, there are differences. For example, in Julia, arrays are 1-indexed. Negative index is not supported and the last index is <code>end</code>. Refer to <a href="https://docs.julialang.org/en/v1/manual/noteworthy-differences/" target="_blank" rel="noopener">this</a> for more differences between Julia and other languages.</p>
<p>Entities in Julia must start with a letter or an underscore <code>_</code>. Conventionally variable names consist of lowercase letters with long names separated by underscores rather than using camel case. Numbers can be separated by underscores for readability. It is a good practice to write constant variables in uppercase letters. The package names are kept upper camel case. <code>!</code> indicates a mutating function that modifies its the first argument.</p>
<p>Julia does not have line-continuation operators. It will read until the expression is finished.</p>
<p>Julia supports unicode, so that functions and variables can be named using special characters, e.g. <code>&#x2297;</code> instead of <code>*</code> for outer product, and <code>&#x3B1;</code> instead of <code>alpha</code> for a Greek symbol.</p>
<h2 id="data-structures">Data structures</h2>
<p>Concepts like strings, arrays, dictionaries, tuples, and sets all behave in a manner that is more or less similar to those in Python. Note that except string, all the rest are parametric types.</p>
<h3 id="strings">Strings</h3>
<p>Julia differentiates between single characters and strings. Strings can contain any number of characters and are specified using double quotes <code>&quot;</code> or triple double quotes <code>&quot;&quot;&quot;</code>. The character literals are specified using single quotes <code>&apos;</code>. <code>&quot;&quot;&quot;</code> is used (esp.) when there are double quotes in the string itself.</p>
<p>The strings are <em>immutable</em>, which means that they cannot be altered once they have been defined</p>
<p>Julia has an elegant string interpolation mechanism for constructing strings using the <code>$</code> operator (again). <code>$var</code> inside a string is replaced by the value of <code>var</code>, and <code>$(expr)</code> is replaced by the computed value of expression <code>expr</code>. The <code>@printf</code> macro takes a format string and one or more variables to substitute into this string while being formatted. It works in a manner similar to <code>printf</code> in C. In string interpolation, another <code>@sprintf</code> from <code>Printf</code> package is used.</p>
<p>Strings are joined by <code>*</code>, unlike <code>+</code> in Python. As a result, <code>^</code> applied on a string indicates an implicit multiplication.</p>
<p>Unicode characters in a string contains multiple bytes. Therefore, there are two ways to define the length of a string: (1) Number of bytes in string, <code>endof(str)</code>; (2) Number of characters in string, <code>length()</code>.</p>
<p>There are several special types of string.</p>
<ol style="list-style-type: decimal">
<li><code>v&quot;&quot;</code> for version number, which can be compared.</li>
<li><code>r&quot;&quot;</code> for regular expressions, which can be used for pattern matching.</li>
<li><code>b&quot;&quot;</code> for byte array literal, which represents a string using <code>Uint8</code> values.</li>
</ol>
<h3 id="arrays">Arrays</h3>
<p>An array is of parametric type: <code>Array{Type,Dimension}</code>. For example, <code>Array{Int64,2}</code> means a 2-D array containing values of type <code>Int64</code>. Additionally, there are short-hands for vectors and matrices: <code>Array{Type,1} == Vector{Type}</code> and <code>Array{Type,2} == Matrix{Type}</code>.</p>
<p>The arrays are by default &#x201C;real&#x201D; arrays, meaning that the data is stored continuously in memory (<em>column-major</em>). This is in contrast to the list of lists in Python and vectors of vectors in C++. It is possible to create array of arrays in Julia, of course. However, the array would only contain the references to the underlying arrays.</p>
<p>There are multiple ways to create an array,</p>
<ol style="list-style-type: decimal">
<li>Direct specification, e.g. <code>a=[1,2,3]</code>.</li>
<li>Using some methods, e.g. <code>collect(range(...))</code></li>
<li>List comprehension, e.g. <code>[i for i in 1:3]</code>. Multiple <code>for</code>&#x2019;s result in multi-D arrays.</li>
</ol>
<p>Note that due to the column-major storage, 1-D array is logically column vectors. Logically row vectors are essentially 1-by-N matrices. To create row vectors, separate the values by space instead of comma, e.g. <code>a=[1 2 3]</code>. Furthermore, a semicolon <code>;</code> indicates a new row, leading to a matrix, e.g. <code>a=[1 2 3;4 5 6]</code>.</p>
<p>In the creation of an array, constraining the type is often helpful for the performance. Using typed comprehensions everywhere for explicitness and safety in production code is certainly a best practice. For example, use <code>a=Int64[1,2,3]</code> instead of <code>a=[1,2,3]</code>. When dealing with large arrays, it is better to indicate the final number of elements for pre-allocation using the <code>sizehint</code> method to improve the performance. The memory of a large array can be freed by setting the array to <code>nothing</code>.</p>
<h3 id="dictionaries-and-enumerations">Dictionaries and enumerations</h3>
<p>A dictionary is of parametric type: <code>Dict{Type_key,Type_value}</code>. It is created by by <code>Dict(key=&gt;val, ...)</code>, where <code>=&gt;</code> is a pair operator. All the keys must have the same type, and the same is true for the values. The types can be specified at creation. A good practice is to use immutable types for the key, e.g.&#xA0;a <code>Symbol</code> <a href="#fn6" class="footnoteRef" id="fnref6"><sup>6</sup></a>.</p>
<p>Dictionaries are mutable. New key-value pairs can be appended to a dictionary without calling method like <code>update</code> in Python. Also, one can directly loop over keys, values, or key-value pairs of a dict. In Python, one need to call <code>iteritems</code> to loops over key-value pairs.</p>
<p>Julia does not provide a standard enumeration type. However, there is a <code>@enum</code> macro that creates a type that behaves like a <code>Enum</code>, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@enum EnumName[::BaseType] key[=val] ...</div></pre></td></tr></table></figure></p>
<p>The data is stored as <code>Vector{Tuple{Symbol,Integer}}</code>.</p>
<h3 id="tuples">Tuples</h3>
<p>The type of a tuple is just a tuple of the types of the values it contains. Tuples are immutable, just like other languages. A tuple can be unpacked or deconstructed, e.g. <code>a, b = tuple1</code>. Notice that an error will not be raised if the left-hand side cannot take all the values of the tuple.</p>
<p>Finally, note that there is a type <code>NamedTuples</code>, which can be considered an ordered dictionary. Its underlying structure consists of a tuple of all the keys as <code>Symbol</code> and a tuple of all the values.</p>
<h2 id="control-flow">Control flow</h2>
<h3 id="basic-blocks">Basic Blocks</h3>
<p>One thing to be kept in mind is that, everything is an expression that returns a value. That means, structs like <code>if-else-end</code> and <code>try-except-end</code> all return a value, which can be assigned to a variable.</p>
<p>The familiar <code>if-elseif-else-end</code> syntax is used for conditionals. There are two short-hand versions: (1) Ternary operators: <code>a ? b : c</code>, and (2) Short-circuit evaluation <a href="#fn7" class="footnoteRef" id="fnref7"><sup>7</sup></a>,</p>
<ol style="list-style-type: decimal">
<li><code>cond &amp;&amp; expr</code>, if cond=true, do expr</li>
<li><code>cond || expr</code>, if cond=false, do expr</li>
</ol>
<p>Like Python, Julia has no switch/case statement, and the language provides no built-in pattern matching</p>
<p>The familiar <code>while-end</code> and <code>for-end</code> syntaxes are used for loops, which can be combined with <code>break</code> and <code>continue</code>. For the <code>for</code> loop, the iteration can be done on a range, a string, an array, or any other iterable collection, just like Python. Furthermore, <code>enumerate</code> also exists in Julia. One thing special, though, is that multiple <code>for</code> loops can be combined into one block - this is how multi-for list comprehension works. Note that <code>for</code> loops are typically <em>faster</em> than vectorization in languages like Python. That is because (1) in Python, the implementation of vectorization (e.g.&#xA0;by Numpy) is faster than naive loops generated by the interpreter; (2) in Julia, vectorization requires extra memory allocation and is thus slower than naive loops. Nevertheless, list comprehension can be far slower than the <code>for</code> loops and vectorizations.</p>
<p>The exceptions can be handled using the familiar <code>try-catch-finally-end</code> construct. However, the <code>try-catch</code> should not be used in performance bottlenecks. Whenever possible, all possible exceptions should be handled via conditionals. There are 24 predefined exceptions that Julia can generate, as of writing. These exceptions can be <code>throw</code>&#x2019;d to interrupt the execution. User-defined exceptions can be created by deriving from the base type, <code>Exception</code>. Finally, Exceptions with error/warning/info messages are handled by the <code>error</code>, <code>warn</code>, and <code>info</code> methods.</p>
<h3 id="scopes">Scopes</h3>
<p>The <code>for</code>, <code>while</code>, and <code>try</code> blocks (but not the <code>if</code> blocks) all introduce a new scope. There are several things to note.</p>
<p>To create a new local binding for a variable, one should use the <code>let</code> block. This is similar to the <code>cell-var-from-loop</code> in Python discussed in a previous <a href="https://smanist.github.io/2018/04/19/Python-Linting/">article</a>, where a local variable is used in the definition of a function that would be used outside the current block.</p>
<p>The <code>for</code> loops and comprehensions differ in the way they scope an iteration variable. When <code>i</code> is initialized before a <code>for</code> loop, after executing a <code>for</code> loop iterating on <code>i</code>, the variable <code>i</code> will be updated. However, this is <em>not true</em> for comprehension.</p>
<h3 id="taskscoroutines">Tasks/Coroutines</h3>
<p>Julia also supports the <code>yield</code> mechanism, like Python. This can done by the combination of <code>put!</code> and <code>take!</code> methods associated with the <code>Channel</code> type. There is also a more fundamental <code>Task</code> type to define the task to be executed by <code>put!</code> and <code>take!</code>. There is also a convenient <code>@task</code> macro for creating a task from a function. <a href="#fn8" class="footnoteRef" id="fnref8"><sup>8</sup></a></p>
<p>Finally, note that currently Julia tasks are not scheduled to run on separate CPU cores (yet?).</p>
<h2 id="functions">Functions</h2>
<p>There are several ways for creating a function:</p>
<ol style="list-style-type: decimal">
<li>Code block of <code>function-end</code></li>
<li>One-liner: function(variables) = expression</li>
<li>Anonymous function: function = variables -&gt; expression</li>
</ol>
<p>When the performance is important, try to use named functions instead of anonymous ones, because calling anonymous functions involves a huge overhead. Anonymous functions are mostly used when passing a function as an argument to another function, or as output of a function. That latter case is related to <a href="https://docs.julialang.org/en/v1.0/devdocs/functions/#Closures-1" target="_blank" rel="noopener">closures</a>.</p>
<p>The input and output of a function are essentially specified using tuples. There are three types of arguments: (1) Normal arguments; (2) Optional positional arguments; (3) Optional keyword arguments. A typical arglist would be <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">func(arg, pos_arg=val1; kw_arg=val2)</div></pre></td></tr></table></figure></p>
<p>Only the first two types of arguments, the positional ones, are considered in the multiple dispatch mechanism. The optional keyword arguments are mainly introduced for code clarity. The last positional argument can be &#x201C;spliced&#x201D;: <code>arg...</code>, meaning that it would take all the extra positional arguments into one tuple. Note that the splice operator <code>...</code>, or splat, can be also used to pass an array to a function as individual arguments rather than an array as a whole. This is similar to the <code>*</code> operator in Python.</p>
<p>It is important to realize that in Julia, all the arguments to functions (with the exception of plain data such as numbers and chars) are passed by reference. Their values are not copied when they are passed, which means they can be changed from inside the function, and the changes will be visible to the calling code.</p>
<p>Higher-order function in Julia just works like that in Python. There are methods like <code>map</code>, <code>filter</code>, and <code>broadcast</code>. Note that the short-hand for broadcast is the dot <code>.</code>. This is the underlying mechanism for <em>element-wise</em> operations in arrays, such as <code>.*</code>. Also, wise applications of the dot operator can avoid extra memory allocations in vectorized loops, or making a devectorized loop look like a vectorized one - See example #6 <a href="http://www.stochasticlifestyle.com/7-julia-gotchas-handle/" target="_blank" rel="noopener">here</a>.</p>
<p>Here are some general tips for writing performant functions/program:</p>
<ol start="0" style="list-style-type: decimal">
<li>Refrain from using global variables. If unavoidable, make them constant, or at least annotate the types.</li>
<li>Split the complete program in functions, <em>small</em> functions, that work on local variables.</li>
<li>Types should be stable: Avoid changing the types of variables during execution.</li>
<li>Types could be inferred: Always type-annotate the arguments using concrete types or type unions.</li>
<li>The return type should only depend on the types of the arguments.</li>
<li>Avoid using the splat operator for dynamic lists of keyword arguments.</li>
</ol>
<h1 id="advanced-topics">Advanced Topics</h1>
<p>Two advanced topics in Julia are briefly touched here and will be investigated more in the future.</p>
<h2 id="calling-other-languages-from-julia">Calling other languages from Julia</h2>
<h3 id="shell">Shell</h3>
<p>Julia offers an efficient shell integration through the <code>run</code> function, which creates an object of type <code>Cmd</code> that is defined by enclosing a command string in backticks <code>`</code>. Julia forks commands as child processes from the Julia process. The <code>Cmd</code> object is not executed immediately. It can be run, connected to other commands via pipes, and read or write to it. The pipe operator <code>|&gt;</code> can be used to redirect the output of a <code>Cmd</code> as the input to the following <code>Cmd</code>, just like that in shell environment <a href="#fn9" class="footnoteRef" id="fnref9"><sup>9</sup></a>.</p>
<h3 id="c-and-fortran">C and Fortran</h3>
<p>Julia&#x2019;s LLVM compiler generates native code, the C functions can be called directly by Julia without any glue code. Calling a C function from Julia has exactly the same overhead as calling the same function from C code itself. However, care should be taken when dealing with arguments. First, one needs to work with pointer types, i.e.&#xA0;a native pointer Ptr{T} representing the memory address for a variable of type T. Second, the data consists of bits, e.g.&#xA0;Int8, Uint8, Int32, Float64, Bool, and Char, are considered <code>bitstype</code>. These will be viewed as contiguous byte arrays from C. The calling basically takes the following form, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">result = ccall( (:function, &quot;library&quot;), return_type, (tuple_of_argument_types,), arguments)</div></pre></td></tr></table></figure></p>
<p>Arguments to C functions are, in general, automatically converted, and the returned values in C types are also converted to Julia types. Arrays of Booleans are handled differently in C and Julia and cannot be passed directly, so they must be manually converted. The <code>ccall</code> function will also automatically ensure that all of its arguments will be preserved from garbage collection until the call returns.</p>
<p>Calling Fortran functions is similar. Just note that all inputs must be passed by reference. The support for C++ is more complex, see packages like <a href="https://github.com/Keno/Cxx.jl" target="_blank" rel="noopener">Cxx</a> and <a href="https://github.com/JuliaInterop/CxxWrap.jl" target="_blank" rel="noopener">CxxWrap</a>.</p>
<h3 id="python">Python</h3>
<p>Calling Python from Julia is done easily using the <code>PyCall</code> package. With the <code>@pyimport</code> macro, one can easily import any Python library, whose functions are called with the familiar dot notation.</p>
<h2 id="parallel-computing">Parallel Computing</h2>
<p>Julia&#x2019;s model for building a large parallel application works by means of a global distributed address space. This means that you can hold a reference to an object that lives on another machine participating in a computation. These references are easily manipulated and passed around between machines, making it simple to keep track of what&#x2019;s being computed where. Also, machines can be added in mid computation when needed.</p>
<p>Besides manually receiving and sending messages between processes, or workers, Julia also provides some useful wrappers.</p>
<h3 id="parallel-macro">Parallel macro</h3>
<p>The <code>@parallel</code> macro acts on a <code>for</code> loop, splitting the range, and distributing it to each process. It optionally takes a &#x201C;reducer&#x201D; as its first argument. If a reducer is specified, the results from each remote procedure will be aggregated using the reducer.</p>
<p>If the computational task is to apply a function to all elements in some collection, the parallel map operation can be applied using the <code>pmap</code> function <code>pmap(f, coll)</code>. It applies a function on each element of a collection in parallel, while preserving the order of the collection in the result.</p>
<h3 id="distributed-array">Distributed array</h3>
<p>When computations have to be done on a very large array (or arrays), the array can be distributed, so that each process works in parallel on a different part of the array. In this way, we can make use of the memory resources of multiple machines, and allow the manipulation of arrays that would be too large to fit on one machine.</p>
<p>The specific data type used here is called a distributed array or <code>DArray</code>; most operations behave exactly as on the normal Array type, so the parallelism is invisible. With <code>DArray</code>, each process has local access to just a part of the data, and no two processes share the same data.</p>
<h1 id="more-topics-for-later">More Topics for Later</h1>
<p>There are yet many more topics to talk about in Julia, e.g.</p>
<ol style="list-style-type: decimal">
<li>Packages: Julia has a built-in package system with <code>git</code> capability.</li>
<li>Graphics: Plotting capability is typically enabled by interfacing to external packages, e.g.&#xA0;Matplotlib from Python.</li>
<li>Benchmark: There are some tools/packages for benchmarking, which are critical for developing real performant Julia code.</li>
<li>Performance notes: The whole book &#x201C;Julia High Performance&#x201D; by Avik Sengupta is devoted to this topic.</li>
</ol>
<p>These topics (and more) will probably be discussed in future posts.</p>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>It is also possbile to <a href="https://cython.readthedocs.io/en/latest/src/userguide/pypy.html" target="_blank" rel="noopener">combine Cython and PyPy</a> for more acceleration. Yet, that requires tweaking the original code even more.<a href="#fnref1">&#x21A9;</a></p></li>
<li id="fn2"><p>This initial environment also has an influence on the design of Julia - maybe that is why arrays are column-majored instead of row-majored as in <code>Numpy</code>.<a href="#fnref2">&#x21A9;</a></p></li>
<li id="fn3"><p>Julia provides <a href="https://docs.julialang.org/en/v1.0/devdocs/reflection/#Intermediate-and-compiled-representations-1" target="_blank" rel="noopener">several methods</a> for inspecting the code generated at each stage: <code>code_lowered</code>, <code>code_typed</code>, <code>code_warntype</code>, <code>code_llvm</code>, <code>code_native</code>.<a href="#fnref3">&#x21A9;</a></p></li>
<li id="fn4"><p>Note that there is a subtle difference between polymorphism and <a href="https://en.wikipedia.org/wiki/Function_overloading" target="_blank" rel="noopener">overloading</a>. Both polymorphic and overloaded methods seem to be &#x201C;methods of the same name that behave differently depending on the arguments and their types.&#x201D; The difference is that the choice of overloaded methods is done in the <em>compilation</em>, while the choice of polymorphic methods is done in the <em>run-time</em>. An example in C++: methods of the same name in the same class are overloaded; virtual functions inherited between classes are polymorphic. Nevertheless, in Julia documentation, it seems the two concepts are not strictly differentiated.<a href="#fnref4">&#x21A9;</a></p></li>
<li id="fn5"><p>An often-noted difference between macros in Julia and languages like C and C++ is that, macros in the latter are expanded before any actual parsing or interpretation occurs.<a href="#fnref5">&#x21A9;</a></p></li>
<li id="fn6"><p>Note that the syntax <code>[key=&gt;val, ...]</code> now produces an array of <code>Pairs</code> and the syntax <code>{key=&gt;val, ...}</code> is deprecated.<a href="#fnref6">&#x21A9;</a></p></li>
<li id="fn7"><p>For non-short-circuit Boolean evaluations, use operators <code>&amp;</code> and <code>|</code>.<a href="#fnref7">&#x21A9;</a></p></li>
<li id="fn8"><p>Note that there was a <code>produce</code>-<code>consume</code> method combination, but they are already deprecated.<a href="#fnref8">&#x21A9;</a></p></li>
<li id="fn9"><p>The pipe operators <code>|&gt;</code> works not only with <code>Cmd</code> objects, but also other functions. Essentially it means passing preceding object as the argument to the following function.<a href="#fnref9">&#x21A9;</a></p></li>
</ol>
</div>
]]></content>
      
        <categories>
            
            <category> coding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> julia </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Roast Beef]]></title>
      <url>http://smanist.github.io/2018/12/02/Roast-beef/</url>
      <content type="html"><![CDATA[<p>An (on-going) experiment of roast beef.</p>
<a id="more"></a>
<h1 id="the-recipe">The recipe</h1>
<p>This recipe is based on multiple sources: <a href="https://www.allrecipes.com/video/1032/all-american-roast-beef/" target="_blank" rel="noopener">1</a>, <a href="https://www.simplyrecipes.com/recipes/roast_beef/" target="_blank" rel="noopener">2</a>, <a href="https://www.williams-sonoma.com/recipe/pan-roasted-beef-tenderloin-with-rosemary-and-garlic.html" target="_blank" rel="noopener">3</a>, <a href="https://www.myrecipes.com/recipe/pan-fried-beef-tenderloin" target="_blank" rel="noopener">4</a>.</p>
<h2 id="ingredients">Ingredients</h2>
<ol style="list-style-type: decimal">
<li>Beef</li>
<li>Salt</li>
<li>Garlic</li>
<li>Pepper</li>
</ol>
<h2 id="steps">Steps</h2>
<h3 id="preparation">Preparation</h3>
<ol style="list-style-type: decimal">
<li>Make sure the beef is at room temperature.</li>
<li>Rub the surface with salt and smashed garlic, and cover the beef using food wrap for 15-30 min.</li>
</ol>
<h3 id="option-1-using-frying-pan-only">Option 1: Using frying pan only</h3>
<ol style="list-style-type: decimal">
<li>Recycle the garlic and fry at low heat.</li>
<li><em>Frying</em>: Fry the beef at high heat, 2 min for each side until brown.</li>
<li>Cover the pan with lid and turn off the heating, let the beef stand for 5 min.</li>
<li>Flip the meat and let stand for a few more minutes, at very low heat.</li>
<li>When the center temperature reaches 100 F, get the beef out.</li>
<li>Sprinkle pepper and wrap the beef with foil. Let stand for 30 min.</li>
</ol>
<h3 id="option-2-using-oven">Option 2: Using Oven</h3>
<ol style="list-style-type: decimal">
<li><em>Tieing</em>: Tie the beef with kitchen twine with a 2-3 inch separation.</li>
<li><em>Roasting</em>: Roast the beef at 375 F until the center temperature reaches 150 F. Typically takes 20 min/pound.</li>
<li>Let the beef stand for 20 min.</li>
</ol>
<h3 id="variations">Variations</h3>
<p>One purpose of browning the surface is to &#x201C;lock&#x201D; the juice in the beef. This is done by (1) the Frying step in Option 1, or (2) the Tieing and Roasting steps in Option 2. There are two variants of Option 2. First, in the Roasting step, instead of roasting constantly at 375 F, lower the temperature to 225 F once the beef is browned. Note that this woudl take longer to finish. The second variant is to replace the Tieing and Roasting steps with the Frying step from Option 1.</p>
<h2 id="notes">Notes</h2>
<ol style="list-style-type: decimal">
<li>In the rubbing step of preparation, one suggestion is to insert some garlic into the beef for better smell and taste.</li>
<li>In Option 1, the center temperature of 100 F results in rare to medium rare texture. Increase if necessary.</li>
</ol>
]]></content>
      
        <categories>
            
            <category> pieces </category>
            
        </categories>
        
        
        <tags>
            
            <tag> life </tag>
            
            <tag> food </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Julia for Mushin]]></title>
      <url>http://smanist.github.io/2018/11/19/Julia-For-Mushin/</url>
      <content type="html"><![CDATA[<p>A plan to try out the <a href="https://julialang.org/" target="_blank" rel="noopener">Julia language</a>.</p>
<a id="more"></a>
<p>Three months ago, Version 1.0 of Julia was <a href="https://julialang.org/blog/2018/08/one-point-zero" target="_blank" rel="noopener">released</a>, marking the more-or-less maturing of this language, especially for the field of scientific computation. For Internet applications, some people say everything that can be done using Javascript will eventually be done using Javascript. I wonder if the same thing is true about Julia: In scientific computation, will everything that can be done using Julia eventually be done using Julia?</p>
<p>I am not wondering without a solid basis. Julia appears to be fast, maybe close to C, according to the <a href="https://julialang.org/benchmarks/" target="_blank" rel="noopener">official benchmark</a>. In the meanwhile, Julia is a dynamic language that is probably much easier to use than static languages like C. As the developer <a href="https://docs.julialang.org/en/v1/" target="_blank" rel="noopener">indicated</a>, Julia is developed in the hope to &#x201C;eliminate the performance trade-off and provide a single environment productive enough for prototyping and efficient enough for deploying performance-intensive applications&#x201D;.</p>
<p>I am particularly interested in a few features of Julia claimed by its developers: (1) Designed for parallelism and distributed computation; (2) Powerful type system where user-defined types are as fast and compact as built-ins; (3) Call C functions directly, without wrappers or special APIs. Item 1 indicates a certain level of automation in parallelizing the code. Item 2 indicates the efficient implementation of some computational techniques, such as automatic differentiation (AD). If that is true, a lot of troubles and pains in AD&#x2019;ing codes in C/C++/Fortran can be avoid. Item 3 could be a huge plus for a Cython user like me - I have been glueing C/C++ libraries using Python all the time. Nevertheless, if Julia is fast enough, maybe there is even no need for the acceleration using C/C++.</p>
<p>To try out and assess Julia, my short-term plan is to rewrite and expand the Python library <a href="https://smanist.github.io/2018/06/23/Multibody-short-range-interaction/">Mushin</a> that I developed earlier. The rewriting will be divided into the following steps/modules,</p>
<ol style="list-style-type: decimal">
<li>Basics I: The computation of the element internal force vectors and stiffness matrices; the assembly of the element vectors and matrices; the solution of the nonlinear system of static mechanics.</li>
<li>Basics II: The inclusion of mass terms and the capability for solving dynamic problems.</li>
<li>Parallelization using MPI.</li>
<li>Optimization: Development of the adjoint of the problem using AD techniques.</li>
<li>Uncertainty quantification (UQ) of the time response.</li>
</ol>
<p>Modules 2, 3 and 4 depend on Module 1 and are parallel to each other. Module 5 depends on Modules 1 and 2. There are a few questions to consider in the implementation of these modules:</p>
<ol style="list-style-type: decimal">
<li>How to implement sparse and distributed vectors and matrices? Would <a href="https://docs.julialang.org/en/v1/stdlib/SparseArrays" target="_blank" rel="noopener">SparseArrays</a> work?</li>
<li>More fundamentally, how to do large-scale linear algebra operations in Julia? Is there something that is AD-able and is like the <a href="https://www.mcs.anl.gov/petsc/" target="_blank" rel="noopener">PETSc</a> library for C?</li>
<li>How to solve a large scale nonlinear system? Would <a href="https://github.com/JuliaOpt/NLopt.jl" target="_blank" rel="noopener">NLopt</a> work?</li>
<li>How to AD the code? How would <a href="http://www.juliadiff.org/" target="_blank" rel="noopener">JuliaDiff</a> work?</li>
<li>Is it better to implement time integration manually, or directly use <a href="http://docs.juliadiffeq.org/" target="_blank" rel="noopener">DifferentialEquations</a>? What impact would be on the UQ applications?</li>
</ol>
<p>The ultimate goal of the short-term plan is to check if Julia is suitable for a computational library: fast, easy parallelization, easy AD and UQ. If everything works out, the long-term plan would be to develop a pure Julia library for general finite element analysis that is parallelized with AD and UQ capabilities enabled.</p>
<p>Finally a few notes on the basic aspects in AD. Start with <a href="https://en.wikipedia.org/wiki/Automatic_differentiation" target="_blank" rel="noopener">wiki</a>. Mathematically, forward and backward modes of AD are conceptually based on the tangent and dual vectors, respectively. There are basically two strategies for implementation: source code transformation (SCT) and operator overloading (OO). The AD results are usually compared with the <a href="https://blogs.mathworks.com/cleve/2013/10/14/complex-step-differentiation/" target="_blank" rel="noopener">complex step method</a>. There are a lot of resources on GitHub, for both SCT and OO.</p>
<p>Some references:</p>
<ol style="list-style-type: decimal">
<li><a href="www.autodiff.org">Website</a>, a collection of libraries for AD.</li>
<li><a href="https://alexey.radul.name/ideas/2013/introduction-to-automatic-differentiation/" target="_blank" rel="noopener">Introduction to AD</a>.</li>
<li><a href="https://epubs.siam.org/doi/book/10.1137/1.9780898717761" target="_blank" rel="noopener">Evaluating Derivatives, Griewank2008</a>.</li>
<li><a href="https://www.springer.com/us/book/9780387303031" target="_blank" rel="noopener">Numerical Optimization, Nocedal2006</a>, a chapter is devoted to derivative evaluation, also including coloring scheme.</li>
<li><a href="https://ieeexplore.ieee.org/document/6426534/" target="_blank" rel="noopener">Andersson2012</a>, the library CasADi is presented and eight &#x201C;flavors&#x201D; of AD are discussed.</li>
<li><a href="https://arc.aiaa.org/doi/abs/10.2514/1.J052184" target="_blank" rel="noopener">Martins2013</a>.</li>
</ol>
]]></content>
      
        <categories>
            
            <category> plan </category>
            
        </categories>
        
        
        <tags>
            
            <tag> mechanics </tag>
            
            <tag> julia </tag>
            
            <tag> numerical </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Tips On Scientific Posters]]></title>
      <url>http://smanist.github.io/2018/11/19/Tips-On-Scientific-Posters/</url>
      <content type="html"><![CDATA[<p>Some feedback from my first poster presentation.</p>
<a id="more"></a>
<p>Recently I got a chance to present my research as a poster. It was fun to think about and make the poster, from which I have learned (what I think are) some basic guidelines. Thanks to <a href="http://www.principiae.be/pdfs/ERP-1.01.pdf" target="_blank" rel="noopener">Jean-luc Doumont</a>, specialists from a technical communication team, and my friends who criticized my poster.</p>
<h1 id="baseline-to-start-with">Baseline to Start With</h1>
<p>What summarizes the essentials of a poster, I think, is Doumont&#x2019;s Three laws of communication, originally from <a href="https://ieeexplore.ieee.org/abstract/document/1097811" target="_blank" rel="noopener">here</a>,</p>
<ol style="list-style-type: decimal">
<li>Adapt to audience - They will not adapt to you</li>
<li>Maximize signal/noise ratio: remove distracting elements on poster</li>
<li>Maintain effective redundancy: Using both verbal and nonverbal explanations to make the poster self-explained.</li>
</ol>
<p>My understanding is that, a poster is considered successful if the audience can learn the complete set of information that the poster is intended to convey. Therefore, the poster should be carefully tailored and not as stuffed/technical/detailed as possible, since the audience may not be able to digest. Also, a certain level of noise and redundancy is necessary to ensure the effectiveness of the information transmission. Note that the three laws of communication are apparently applicable to not only posters but also papers and presentations.</p>
<p>The central idea in structuring the poster is that a poster is multi-scale. On the top level are the titles and captions, which are the most visible and eye-catching. The lower levels are the texts and figures, which might be read if the audience got interested. On each level, the information should be stated and developed into <em>messages</em> using short full sentences. These messages answer the questions of the audience at different levels of details: What is presented and <em>so what</em>? What is the gap between what people have and want? And where does the authors come in and what are their contributions? In my opinion, the idea of multi-scale presentation is similar to the <a href="https://en.wikipedia.org/wiki/Inverted_pyramid_(journalism)" target="_blank" rel="noopener">inverted pyramid</a> structure in journalism. The only difference is the ordering of visibility. A news article is more linear: the most visible part is at the beginning and the visibility decreases towards the end.</p>
<h1 id="format-for-navigation">Format for Navigation</h1>
<p>The multi-scale nature of the poster determines its layout. Two aspects should be considered: How it looks like as a whole, and how are the items relatively positioned? The basic rules are summarized as: (1) Proximity for relation; (2) Similarity for similar contents; (3) Prominence for importance. Particularly, the items, e.g.&#xA0;text boxes and figures, should be placed with alignment to grid lines to achieve a global level of &#x201C;harmony&#x201D;.</p>
<p>For text boxes, make sure to use a fixed set of fontsizes. Furthermore, be cautious of using boldface: Whatever words in bold should make sense on its own. This is another example of how a poster is multi-scale. Next, some people (Like Doumont) suggest no justifications for the text, while I used justification in my poster. I think this is scenario dependent. Finally, it might be beneficial to maximize the contrast, e.g.&#xA0;using color background with white boxes.</p>
<h1 id="figures-and-visuals">Figures and Visuals</h1>
<p>The basic principle is that the visuals should be informative, instead of merely decorative. They should be designed with high proportion of data to ink while remain <em>self-explained</em> via necessary and meaningful captions, legends, narratives, etc.</p>
<p>For figures in particular, I do recommend Doumont&#x2019;s suggestions:</p>
<ol style="list-style-type: decimal">
<li>No need to use grids: Grids are for figures in the past era of printed materials.</li>
<li>Only label the significant numbers: Instead of using the conventional uniform axis ticks, which is a waste of ink and does no provide much information.</li>
<li>For posters, no need to include figure numbers: Waste of space and ink.</li>
</ol>
<h1 id="other-tips">Other Tips</h1>
<p>Think twice if the reference and acknowledgements should be put on the poster. They take some space but do not add much information to the poster. It might make more sense to carry the extra information via some external media. Doumont suggested something like a business card that can be distributed. People who are interested can look into the details themselves later. This time I tried to do things digitally and put a QR code on the poster that links to a temporary post on my website.</p>
<p>If PowerPoint is used for making the poster and producing the final PDF file, make sure the slides are <em>exported</em>, instead of <em>printed</em>, as PDF files. The figure resolution would be lost in printed PDF files. Also, whenever possible, use SVG format, instead of PNG format, for the figures. This reduces the file size of the slides while maintaining high resolution. However, note that in the exported PDF file, some features in the SVG figure might be rasterized.</p>
]]></content>
      
        <categories>
            
            <category> digest </category>
            
        </categories>
        
        
        <tags>
            
            <tag> career </tag>
            
            <tag> communication </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Professor Ni Naru III]]></title>
      <url>http://smanist.github.io/2018/10/14/Professor-Ni-Naru-III/</url>
      <content type="html"><![CDATA[<p>How to become a professor (in Engineering)? CV and cover letter for application.</p>
<a id="more"></a>
<p>These are notes from a workshop on writing CV and cover letters (CL).</p>
<p>First, think from institution&#x2019;s point of view: (1) They have spent great effort on creating the position, so the applicants are expected to customize the materials and show excitement for this particular institution. (2) Due to its large volume, the applications will be quickly skimmed and carefully read only when the applicant is seriously under consideration, so the materials are expected to be accessible to the general audience. In addition, the screening process will be in the order of CL, then CV, then research statement. So a certain level of redundancy is expected.</p>
<h1 id="cv">CV</h1>
<p>The CV should demonstrate one&#x2019;s strongest qualifications and the supporting details. Particularly, the following four aspects of the experiences shall be tailored based on the institution:</p>
<ol style="list-style-type: decimal">
<li>Research: Include short introduction and key results. The research interests should be explained using a short narrative of research and brief conclusion with future program of research, which align with the department.</li>
<li>Teaching: Typically teahcing assistant experience. It should be supported by statistical summary of evaluation and highlights of contributions to the course.</li>
<li>Grant</li>
<li>Professional</li>
</ol>
<p>In addition, care should be taken for the following items:</p>
<ol style="list-style-type: decimal">
<li>Include the dissertation title and advisor&#x2019;s name(s).</li>
<li>Awards: explain the abroad ones if necessary.</li>
<li>Publication: Differentiate between accepted, in press, submitted, under review, in progress.</li>
<li>Service and membership: List only those to whom contributed. Do not list those obtain by simply paying registration fees.</li>
<li>Reference info.: Include names, titles, institutions and contact info. for people who can provide info. on one&#x2019;s espertise, grant, collaboration.</li>
</ol>
<p>Some tips for writing the CV:</p>
<ol style="list-style-type: decimal">
<li>Clear and concise.</li>
<li>Learn from CV&#x2019;s of peers and people slightly ahead of you.</li>
<li>Balance the heading and the contents.</li>
<li>Always tailor for institutional fit.</li>
<li>Show instead of tell, i.e.&#xA0;provide supporting details.</li>
<li>Present oneself as a future colleague, not a student.</li>
</ol>
<h1 id="cover-letter">Cover letter</h1>
<p>Answer two questions: (1) What is one&#x2019;s strength as future faculty, particularly in productivity, fundability, leadership; (2) What is one&#x2019;s strength for the particular position: show the fit.</p>
<p>There are four essentials in CL:</p>
<ol style="list-style-type: decimal">
<li>Reputation: advisor, institution, contribution. This can be done in a short paragraph and serve as opening.</li>
<li>Fundability: research vision, past funding future ideas.</li>
<li>Productivity: funding, publication, patents.</li>
<li>Fit: research focus of the position, institutional culture, department colleagues. This serves as the closing.</li>
</ol>
<p>These essentials can be demonstrated in CL using the following structure:</p>
<ol style="list-style-type: decimal">
<li>Opening: What position, where you currently are, area of expertise, strength.</li>
<li>Body: Research vision, relevancy, fundability, accomplishments to date and highlighted contributions. Teaching and advising experience.</li>
<li>Closing: Enthusiasm for position, colleagues, department and institution.</li>
</ol>
<p>A good practice is to start writing a CL even if one is not applying for a position soon. This helps one to identify the areas and interest, articulated in daily networking, and be prepared for (unexpected) interviews.</p>
]]></content>
      
        <categories>
            
            <category> digest </category>
            
        </categories>
        
        
        <tags>
            
            <tag> faculty </tag>
            
            <tag> career </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Peking Duck]]></title>
      <url>http://smanist.github.io/2018/10/14/Peking-duck/</url>
      <content type="html"><![CDATA[<p>An (on-going) experiment of Peking-style scrispy skin duck.</p>
<a id="more"></a>
<h1 id="the-recipe">The recipe</h1>
<p>This recipe is mainly based on <a href="https://www.youtube.com/watch?v=gqXjCFNX6HQ" target="_blank" rel="noopener">The Ultimate Guide to Making Crispy, Amber-Hued Peking Duck at Home</a>.</p>
<p>I have tried the recipe twice, once for a duck and the other time for a chicken.</p>
<h2 id="ingredients">Ingredients</h2>
<ol style="list-style-type: decimal">
<li>Lean duck</li>
<li>Chinese five-spice powder (or <a href="https://www.geniuskitchen.com/recipe/five-spice-powder-66216" target="_blank" rel="noopener">DIY</a>)</li>
<li>Salt</li>
<li>Soy sauce</li>
<li>Maltose syrup</li>
<li>Applewood (optional)</li>
</ol>
<h2 id="steps">Steps</h2>
<h3 id="day-1">Day 1</h3>
<ol style="list-style-type: decimal">
<li>Clean the duck.</li>
<li>Coat the inside of the duck with five-spice powder (f.s.) and seal the body with a stick.</li>
<li>Separate the skin and the flesh of the duck.</li>
<li>Add salt, f.s., and soy sauce to water and boil for 5 min.</li>
<li>Poach the outside of the duck using the boiled water.</li>
<li>Mix soysauce with maltose syrup and coat the duck.</li>
<li>Now the duck has to be dried for a few days. It has to be somehow lift in the air, so that the extra sauce can drip down.</li>
</ol>
<h3 id="day-x">Day X</h3>
<ol style="list-style-type: decimal">
<li>Smoke the duck inside a sealed container using the applewood for 30 min. I skipped this step as I could not find applewood.</li>
<li>Roast the duck by the following steps: (1) Roast for 30 min at 350F and hang for 5 min to remove fat; (2) Roast again for 30 min until the core temperature reaches 130F.</li>
<li>Bath the duck with hot oil at 390F until it is golden.</li>
</ol>
<h2 id="notes">Notes</h2>
<ol style="list-style-type: decimal">
<li>In the video guide, a pump was used to blow the duck, which was very efficient. However, it is possible to manually separate the skin and the flesh - just be careful.</li>
<li>Make sure the wings and legs do not touch the body during the drying process.</li>
<li>In my experiment, the drying process was only one day. As a result, the skin of the final product was not so crispy.</li>
<li>The roast process depends on how fat the duck is. In the experiment, the duck was quite fat. As a result, the duck was hung at a higher frequency to remove the extra fat and oil.</li>
<li>To disassemble the duck, consider first remove the drum stick, then peel the skin off on the back, then cut through the legs, and finally cut out the breast.</li>
<li>The purpose of the maltose syrup is to provide a thick sauce base that can be applied onto the duck without dripping down too quickly. Moreover, the sugar in the syrup contributes significantly to the smell in the final product. When maltose syrup is not available, one can try to concentrate off-the-shelf pancake syrup: Boil the syrup for a few seconds and let it cool down slowly. Do not boil for too long time, otherwise the syrup would solidify.</li>
</ol>
]]></content>
      
        <categories>
            
            <category> pieces </category>
            
        </categories>
        
        
        <tags>
            
            <tag> life </tag>
            
            <tag> food </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Karaage]]></title>
      <url>http://smanist.github.io/2018/10/14/Karaage/</url>
      <content type="html"><![CDATA[<p>An (on-going?) experiment of Japanese-style fried chicken.</p>
<a id="more"></a>
<h1 id="the-recipe">The recipe</h1>
<h2 id="ingredients">Ingredients</h2>
<ol style="list-style-type: decimal">
<li>Chiken thigh (boneless): 2 lb</li>
<li>Ginger: half of palm</li>
<li>Garlic clove: 6</li>
<li>Salt: Dependents on mood</li>
<li>Pepper: Dependents on mood</li>
<li>Shichimi togarashi (optional): 1 bottle/18 g</li>
<li>Soy sauce: Dependents on mood</li>
<li>Cooking rice wine: Dependents on mood</li>
<li>Egg: 4</li>
<li>Starch: depends on working condition</li>
<li>Flour: depends on working condition</li>
<li>Oil: depends on working condition</li>
</ol>
<h2 id="steps">Steps</h2>
<ol style="list-style-type: decimal">
<li>Cut the chiken thigh to bite size.</li>
<li>Make the marinade sauce: Grind the garlic clove and ginger, and mix with salt, pepper, soy sauce, cooking rice wine. I also added shichimi togarashi (s.t.).</li>
<li>Marinate chicken in the sauce for 5 min.</li>
<li>Meanwhile, whisk the eggs.</li>
<li>Meanwhile, prepare the mixture of starch and flour with a ratio of 1:1.</li>
<li>Remove the marinade sauce on the chicken dice.</li>
<li>Roll the chicken dice in the powder mixture after dipping in the whisked egg.</li>
<li>Fry by repeating the following for 2-3 times: (1) Fry for 90 sec in 160-180C oil; (2) Stand for 60 sec while draining oil; (3) Break the crispy surface and fry again. At the last time, fry for 30 sec in 200C oil.</li>
</ol>
<h2 id="notes">Notes:</h2>
<ol style="list-style-type: decimal">
<li>Do not fry too many chicken dices in one batch, so as to avoid the sudden drop in oil temperature.</li>
<li>The time for frying depends on the size of chicken. In practice, what I did was to (1) fry one batch until the surface of the chicken dice just turns light yellow over a time period of 60-90 sec; (2) let the batch stand for some time until another batch is finished; (3) fry the first batch again until the color is deeper or becomes golden.</li>
<li>The key is to control the oil temperature. Do not let the surface color change too quickly - that means the temperature is too high.</li>
<li>Remove solid wastes in the oil between batches.</li>
</ol>
<h1 id="references">References:</h1>
<ol style="list-style-type: decimal">
<li><a href="https://norecipes.com/karaage-recipe/" target="_blank" rel="noopener">Recipe 1</a></li>
<li><a href="https://www.japanesecooking101.com/karaage-recipe/" target="_blank" rel="noopener">Recipe 2</a></li>
<li><a href="https://www.crunchyroll.com/todays-menu-for-the-emiya-family/episode-10-fried-chicken-yummy-even-when-its-cold-776019" target="_blank" rel="noopener">Recipe 3</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> pieces </category>
            
        </categories>
        
        
        <tags>
            
            <tag> life </tag>
            
            <tag> food </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Multi-Objective Optimization]]></title>
      <url>http://smanist.github.io/2018/08/30/Multi-objective-optimization/</url>
      <content type="html"><![CDATA[<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css"><p>An incomplete review.</p>
<a id="more"></a>
<h1 id="introduction">Introduction</h1>
<p>In a <a href="https://smanist.github.io/2018/06/12/Bayesian-optimization/">previous article</a>, we discussed Bayesian optimization for single objective problems. This article will discuss the multi-objective optimization (MO) and provide a partial review of the classical and the Bayesian MO algorithms.</p>
<h1 id="defining-a-multi-objective-optimization">Defining a multi-objective optimization</h1>
<p>Some of the mathematical contents follow this lecture <a href="https://cims.nyu.edu/~gn387/glp/lec1.pdf" target="_blank" rel="noopener">note</a>.</p>
<p>Formally, an MO is written as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mrow><msub><mo><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi><mspace width="0.16667em"></mspace><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></msub></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>=</mo><mo>[</mo><msub><mi>f</mi><mn>1</mn></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo separator="true">,</mo><mo>&#x22EF;</mo><mo separator="true">,</mo><msub><mi>f</mi><mi>n</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">.</mi></mrow></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>E</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>=</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>I</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>&#x2265;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>l</mi><mi>b</mi></mrow></msub><mo>&#x2264;</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2264;</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>u</mi><mi>b</mi></mrow></msub></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
    {\mathop{\mathrm{arg\,min}}\limits_{\mathbf{x}}} &amp;\quad {\mathbf{f}}({\mathbf{x}})=[f_1({\mathbf{x}}),\cdots,f_n({\mathbf{x}})] \\
    {\mathrm{s.t.}}&amp;\quad {\mathbf{c}}_E({\mathbf{x}}) = 0 \\
                 &amp;\quad {\mathbf{c}}_I({\mathbf{x}}) \ge 0 \\
                 &amp;\quad {\mathbf{x}}_{lb} \le {\mathbf{x}}\le {\mathbf{x}}_{ub}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.9172200000000004em;"></span><span class="strut bottom" style="height:5.334440000000001em;vertical-align:-2.41722em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-2.0772200000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mop op-limits"><span class="vlist"><span style="top:0.79444em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span style="top:5.551115123125783e-17em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm"><span class="mspace thinspace"></span><span class="mord mathrm">m</span></span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.3427800000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">s</span><span class="mord mathrm">.</span><span class="mord mathrm">t</span><span class="mord mathrm">.</span></span></span></span></span><span style="top:0.8572199999999996em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span style="top:2.05722em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-2.0772200000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mopen">[</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="minner">&#x22EF;</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span><span style="top:-0.3427800000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span><span style="top:0.8572199999999996em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mrel">&#x2265;</span><span class="mord mathrm">0</span></span></span><span style="top:2.05722em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.01968em;">l</span><span class="mord mathit mtight">b</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2264;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mrel">&#x2264;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">b</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> or simply writing the constraints as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2208;</mo><mrow><mrow><mi mathvariant="script">X</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{x}}\in{\mathcal{X}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mrel">&#x2208;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">X</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{X}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span></span></span></span> is the feasible design space.</p>
<p>Assume that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>f</mi><mi>i</mi><mo>&#x2217;</mo></msubsup></mrow><annotation encoding="application/x-tex">f_i^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.9414399999999999em;vertical-align:-0.247em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-left:-0.10764em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is the minimum attainable value of the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>th objective in the feasible design space, i.e. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>f</mi><mi>i</mi><mo>&#x2217;</mo></msubsup></mrow><annotation encoding="application/x-tex">f_i^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.9414399999999999em;vertical-align:-0.247em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-left:-0.10764em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is the solution to the single-objective optimization (SO) consisting of the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>th objective and all the constraints of the MO. The collection of all these solutions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>=</mo><mo>[</mo><msubsup><mi>f</mi><mn>1</mn><mo>&#x2217;</mo></msubsup><mo separator="true">,</mo><mo>&#x22EF;</mo><mo separator="true">,</mo><msubsup><mi>f</mi><mi>n</mi><mo>&#x2217;</mo></msubsup><mo>]</mo></mrow><annotation encoding="application/x-tex">{\mathbf{f}}^*=[f_1^*,\cdots,f_n^*]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mopen">[</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-left:-0.10764em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="minner">&#x22EF;</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-left:-0.10764em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">]</span></span></span></span> is defined as the ideal objective vector. In a typical MO problem, such a point is not attainable. That means no single solution exists that simultaneously optimizes each objective &#x2013; this is the fundamental problem in MO.</p>
<p>When <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">{\mathbf{f}}^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is unattainable, the objective functions are said to be conflicting and there exists a (possibly infinite) number of Pareto optimal solutions. A solution is called Pareto optimal if none of the objectives can be decreased without increasing some of the other objectives. Two Pareto optimal solutions are mutually nondominated. That means there exists some objectives in one solution that are smaller than those in the other solution.</p>
<p>The dominance is more precisely defined via the partial ordering, or the dominance relation between the design vectors <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{x}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span></span>. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{x}}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> dominates <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{x}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, denoted <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub><mo>&#x2AAF;</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{x}}_1\preceq{\mathbf{x}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.63597em;"></span><span class="strut bottom" style="height:0.7859700000000001em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2AAF;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, if (1) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub><mo>)</mo><mo>&#x2264;</mo><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">f_i({\mathbf{x}}_1)\leq f_i({\mathbf{x}}_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mrel">&#x2264;</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x22EF;</mo><mo separator="true">,</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">i=1,\cdots,n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="minner">&#x22EF;</span><span class="mpunct">,</span><span class="mord mathit">n</span></span></span></span> and (2) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2203;</mi><mi>j</mi><mo>&#x2208;</mo><mo>{</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x22EF;</mo><mo separator="true">,</mo><mi>n</mi><mo>}</mo></mrow><annotation encoding="application/x-tex">\exists j\in \{ 1,\cdots,n\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x2203;</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mrel">&#x2208;</span><span class="mopen">{</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="minner">&#x22EF;</span><span class="mpunct">,</span><span class="mord mathit">n</span><span class="mclose">}</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>j</mi></msub><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub><mo>)</mo><mo>&lt;</mo><msub><mi>f</mi><mi>j</mi></msub><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">f_j({\mathbf{x}}_1)&lt; f_j({\mathbf{x}}_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mrel">&lt;</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span>. The corresponding objective vectors are denoted <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mn>1</mn></msub><mo>&#x2AAF;</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_1\preceq{\mathbf{f}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2AAF;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. The dominance is strict, denoted <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub><mo>&#x227A;</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{x}}_1\prec{\mathbf{x}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5391em;"></span><span class="strut bottom" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x227A;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mn>1</mn></msub><mo>&#x227A;</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_1\prec{\mathbf{f}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x227A;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, if (2) is true for all <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span>&#x2019;s.</p>
<p>Using the dominance relation, a solution <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{x}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span></span> is (1) globally Pareto optimal if <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2AAF;</mo><msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow><annotation encoding="application/x-tex">{\mathbf{x}}\preceq{\mathbf{x}}&apos;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.887862em;vertical-align:-0.13597em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mrel">&#x2AAF;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2200;</mi><msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>&#x2208;</mo><mrow><mrow><mi mathvariant="script">X</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">\forall{\mathbf{x}}&apos;\in{\mathcal{X}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.790992em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x2200;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2208;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span></span></span></span>, (2) locally Pareto optimal if <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2203;</mi><mi>&#x3F5;</mi></mrow><annotation encoding="application/x-tex">\exists\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x2203;</span><span class="mord mathit">&#x3F5;</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2AAF;</mo><msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow><annotation encoding="application/x-tex">{\mathbf{x}}\preceq{\mathbf{x}}&apos;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.887862em;vertical-align:-0.13597em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mrel">&#x2AAF;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2200;</mi><msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo separator="true">,</mo><mo>&#x2225;</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2212;</mo><msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>&#x2225;</mo><mo>&lt;</mo><mi>&#x3F5;</mi></mrow><annotation encoding="application/x-tex">\forall{\mathbf{x}}&apos;,\lVert{\mathbf{x}}-{\mathbf{x}}&apos;\rVert&lt;\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x2200;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mopen">&#x2225;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">&#x2225;</span><span class="mrel">&lt;</span><span class="mord mathit">&#x3F5;</span></span></span></span>. All globally (locally) Pareto optimal solutions form the global (local) <em>Pareto set</em> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="script">X</mi></mrow></mrow><mi>p</mi></msup></mrow><annotation encoding="application/x-tex">{\mathcal{X}}^p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and its image in the objective space is the global (local) <em>Pareto front</em> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span>.</p>
<p>The ideal objective vector <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">{\mathbf{f}}^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is more formally defined by setting its <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>th entry to be <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2217;</mo></msup><msub><mo>]</mo><mi>i</mi></msub><mo>=</mo><msub><mi>inf</mi><mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2208;</mo><msup><mrow><mrow><mi mathvariant="script">X</mi></mrow></mrow><mi>p</mi></msup></mrow></msub><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo separator="true">,</mo><mspace width="1em"></mspace><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x22EF;</mo><mo separator="true">,</mo><mi>n</mi></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
[{\mathbf{f}}^*]_i = \inf_{ {\mathbf{x}}\in{\mathcal{X}}^p } f_i({\mathbf{x}}),\quad i=1,\cdots,n
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.521701em;vertical-align:-0.771701em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-limits reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:0.644331em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span><span class="mrel mtight">&#x2208;</span><span class="mord mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathcal mtight" style="margin-right:0.14643em;">X</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:2.7755575615628914e-17em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop">in<span style="margin-right:0.07778em;">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathit">i</span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">1</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="minner reset-textstyle displaystyle textstyle uncramped">&#x22EF;</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">n</span></span></span></span></span> Similarly, the nadir objective vector <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">{\mathbf{f}}^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is defined by setting its <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>th entry to be <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>n</mi></msup><msub><mo>]</mo><mi>i</mi></msub><mo>=</mo><msub><mi>sup</mi><mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2208;</mo><msup><mrow><mrow><mi mathvariant="script">X</mi></mrow></mrow><mi>p</mi></msup></mrow></msub><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo separator="true">,</mo><mspace width="1em"></mspace><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x22EF;</mo><mo separator="true">,</mo><mi>n</mi></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
[{\mathbf{f}}^n]_i = \sup_{ {\mathbf{x}}\in{\mathcal{X}}^p } f_i({\mathbf{x}}),\quad i=1,\cdots,n
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.716141em;vertical-align:-0.966141em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-limits reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:0.838771em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span><span class="mrel mtight">&#x2208;</span><span class="mord mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathcal mtight" style="margin-right:0.14643em;">X</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:8.326672684688674e-17em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop">sup</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathit">i</span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">1</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="minner reset-textstyle displaystyle textstyle uncramped">&#x22EF;</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">n</span></span></span></span></span> The ideal and nadir objective vectors define the lower and upper bounds of the Pareto front and thus can be used for normalization. The <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>th entry of the normalized objective vector is <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mo>[</mo><msup><mover accent="true"><mrow><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow></mrow><mo>&#xAF;</mo></mover><mi>p</mi></msup><msub><mo>]</mo><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>p</mi></msup><msub><mo>]</mo><mi>i</mi></msub><mo>&#x2212;</mo><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2217;</mo></msup><msub><mo>]</mo><mi>i</mi></msub></mrow><mrow><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>n</mi></msup><msub><mo>]</mo><mi>i</mi></msub><mo>&#x2212;</mo><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2217;</mo></msup><msub><mo>]</mo><mi>i</mi></msub></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
[\bar{ {\mathbf{f}}}^p]_i = \frac{ [{\mathbf{f}}^p]_i-[{\mathbf{f}}^*]_i }{ [{\mathbf{f}}^n]_i-[{\mathbf{f}}^*]_i }
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.427em;"></span><span class="strut bottom" style="height:2.363em;vertical-align:-0.936em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0.33334em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mopen">[</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mopen">[</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mopen">[</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mopen">[</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> The utopian objective vector is defined as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msup><mo>=</mo><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{f}}^u={\mathbf{f}}^*-{\mathbf{e}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">e</span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><msub><mo>]</mo><mi>i</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">[{\mathbf{e}}]_i&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">[</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&gt;</span><span class="mord mathrm">0</span></span></span></span> for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x22EF;</mo><mo separator="true">,</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">i=1,\cdots,n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="minner">&#x22EF;</span><span class="mpunct">,</span><span class="mord mathit">n</span></span></span></span>, which is useful in some MO algorithms. This vector is too good to attain and hence utopian.</p>
<p>Finally, the individual minimum (IM) objective vectors <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>k</mi><mrow><mi>i</mi><mi>m</mi></mrow></msubsup><msubsup><mo>}</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup></mrow><annotation encoding="application/x-tex">\{ {\mathbf{f}}_k^{im} \}_{k=1}^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.824664em;"></span><span class="strut bottom" style="height:1.1077719999999998em;vertical-align:-0.2831079999999999em;"></span><span class="base textstyle uncramped"><span class="mopen">{</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are introduced to further characterize the Pareto front. Geometrically, they are the &#x201C;corners&#x201D; of a Pareto front, which attains the minimum value of at least one of the objectives. The <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span>th <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mrow><mi>i</mi><mi>m</mi></mrow></msup></mrow><annotation encoding="application/x-tex">{\mathbf{f}}^{im}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.824664em;"></span><span class="strut bottom" style="height:0.824664em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is defined as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>k</mi><mrow><mi>i</mi><mi>m</mi></mrow></msubsup><mo>&#x2208;</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo separator="true">,</mo><mspace width="1em"></mspace><mo>[</mo><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>k</mi><mrow><mi>i</mi><mi>m</mi></mrow></msubsup><msub><mo>]</mo><mi>k</mi></msub><mo>=</mo><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2217;</mo></msup><msub><mo>]</mo><mi>k</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{f}}_k^{im}\in{\mathcal{F}},\quad [{\mathbf{f}}_k^{im}]_k = [{\mathbf{f}}^*]_k
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8746639999999999em;"></span><span class="strut bottom" style="height:1.1246639999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2208;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mopen reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mopen">[</span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> The IM objective vectors form the convex hull of individual minima (<em>CHIM</em>), which are used in some of the MO algorithms. In the 2-objective case, CHIM is a segment connecting the two IM objective vectors.</p>
<h1 id="classical-mo-algorithms">Classical MO algorithms</h1>
<p>Some of the discussion follows this lecture <a href="https://cims.nyu.edu/~gn387/glp/lec2.pdf" target="_blank" rel="noopener">note</a>.</p>
<p>Generating a point on the Pareto front typically requires solving an optimization problem and generating a set of Pareto points can be computationally expensive. Therefore, a common question to ask before solving an MO is: Is it necessary to solve the problem as an MO? If sufficient preference information on the objectives about the problem is available, the MO could be taken care of using <em>one</em> single-objective optimization (SO). This is the so-called <em>a priori</em> approach. The advantage is that the optimization only needs to be carried out once, but the disadvantages is that one needs to specify proper preferences over the objectives. The other type of method is the <em>a posteriori</em> approach, which works in a reversed manner. A representative set of Pareto front is generated first, typically via multiple runs of optimization, and the final design is identified within the solution sets. This approach is useful for problems having objectives with limited user knownledge.</p>
<p>Besides the a priori and a posteriori approaches, there are also non-preference and interactive methods. However, these will not be discussed in this article.</p>
<h2 id="a-priori-approach">A priori approach</h2>
<p>The a priori approach is closely related to the idea of <em>scalarization</em>, i.e.&#xA0;the aggregation of multiple objectives. Essentially, a utility function is required to quantify the preference over different solutions. A utility function satisfies (1) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub><mo>)</mo><mo>&lt;</mo><mi>u</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">u({\mathbf{x}}_1)&lt;u({\mathbf{x}}_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">u</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mrel">&lt;</span><span class="mord mathit">u</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> if <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub><mo>&#x227A;</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{x}}_1\prec{\mathbf{x}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5391em;"></span><span class="strut bottom" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x227A;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and (2) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub><mo>)</mo><mo>=</mo><mi>u</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">u({\mathbf{x}}_1)=u({\mathbf{x}}_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">u</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">u</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> if <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub><mo>&#x2280;</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{x}}_1\nprec{\mathbf{x}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.70576em;"></span><span class="strut bottom" style="height:0.9115200000000001em;vertical-align:-0.20576em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel amsrm">&#x2280;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub><mo>&#x2280;</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{x}}_2\nprec{\mathbf{x}}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.70576em;"></span><span class="strut bottom" style="height:0.9115200000000001em;vertical-align:-0.20576em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel amsrm">&#x2280;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>.</p>
<p>Two typical scalarization approaches are the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3F5;</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3F5;</span></span></span></span>-constraint method and the weighted metric method.</p>
<h3 id="&#x3B5;-constraint">&#x3B5;-constraint</h3>
<p>The <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3F5;</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3F5;</span></span></span></span>-constraint method is an effective approach for converting an MO into only one SO, if sufficient information is known about the optimization problem. Specifically, the idea is to optimize only one objective while making sure other objectives are not too large, i.e.&#xA0;below certain user-specified upper bounds. The utility function is simply <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>=</mo><msub><mi>f</mi><mi>j</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">u({\mathbf{x}})=f_j({\mathbf{x}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord mathit">u</span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi><mo>&#x2208;</mo><mo>{</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x22EF;</mo><mo separator="true">,</mo><mi>n</mi><mo>}</mo></mrow><annotation encoding="application/x-tex">j\in\{ 1,\cdots,n \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mrel">&#x2208;</span><span class="mopen">{</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="minner">&#x22EF;</span><span class="mpunct">,</span><span class="mord mathit">n</span><span class="mclose">}</span></span></span></span>. The method works by adding extra constraints to the SO, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mrow><msub><mo><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi><mspace width="0.16667em"></mspace><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></msub></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mi>u</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">.</mi></mrow></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2208;</mo><mrow><mrow><mi mathvariant="script">X</mi></mrow></mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>&#x2264;</mo><msub><mi>&#x3F5;</mi><mi>i</mi></msub><mo separator="true">,</mo><mspace width="1em"></mspace><mi>i</mi><mo>&#x2260;</mo><mi>j</mi><mo separator="true">,</mo><mi>i</mi><mo>&#x2208;</mo><mo>{</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x22EF;</mo><mo separator="true">,</mo><mi>n</mi><mo>}</mo></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
    {\mathop{\mathrm{arg\,min}}\limits_{\mathbf{x}}} &amp;\quad u({\mathbf{x}}) \\
    {\mathrm{s.t.}}&amp;\quad {\mathbf{x}}\in{\mathcal{X}}\\
                 &amp;\quad f_i({\mathbf{x}})\leq \epsilon_i,\quad i\neq j,i\in\{ 1,\cdots,n \}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.3172200000000003em;"></span><span class="strut bottom" style="height:4.134440000000001em;vertical-align:-1.8172200000000003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.4772200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mop op-limits"><span class="vlist"><span style="top:0.79444em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span style="top:5.551115123125783e-17em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm"><span class="mspace thinspace"></span><span class="mord mathrm">m</span></span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.25722000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">s</span><span class="mord mathrm">.</span><span class="mord mathrm">t</span><span class="mord mathrm">.</span></span></span></span></span><span style="top:1.4572200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.4772200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit">u</span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span></span></span><span style="top:0.25722000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mrel">&#x2208;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span></span></span><span style="top:1.4572200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mrel">&#x2264;</span><span class="mord"><span class="mord mathit">&#x3F5;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit">i</span></span><span class="mrel">&#x2260;</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mrel">&#x2208;</span><span class="mopen">{</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="minner">&#x22EF;</span><span class="mpunct">,</span><span class="mord mathit">n</span><span class="mclose">}</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> If the ranges of the objectives are known a priori, it is possible to obtain the complete Pareto front by excuting above procedure repeatedly with each run using a different set of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3F5;</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3F5;</span></span></span></span>&#x2019;s.</p>
<h3 id="weighted-metric">Weighted metric</h3>
<p>The weighted metric (WM) of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{f}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span></span> is defined as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>u</mi><mi>p</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>)</mo><mo>=</mo><msup><mrow><mo fence="true">(</mo><msubsup><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mi>f</mi><mi>i</mi></msub><mo>&#x2212;</mo><msubsup><mi>f</mi><mi>i</mi><mrow><mi>r</mi><mi>e</mi><mi>f</mi></mrow></msubsup><msup><mi mathvariant="normal">&#x2223;</mi><mi>p</mi></msup><mo fence="true">)</mo></mrow><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mi>p</mi></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
u_p({\mathbf{f}}) = \left(\sum_{i=1}^n w_i|f_i-f_i^{ref}|^p\right)^{1/p}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.8889999999999998em;"></span><span class="strut bottom" style="height:3.1666689999999997em;vertical-align:-1.277669em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner reset-textstyle displaystyle textstyle uncramped"><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.276864em;margin-left:-0.10764em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.4809079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathrm">&#x2223;</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-1.3639999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span><span class="mord mathrm mtight">/</span><span class="mord mathit mtight">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>&#x2208;</mo><mo>[</mo><mn>1</mn><mo separator="true">,</mo><mi mathvariant="normal">&#x221E;</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">p\in [1,\infty]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mrel">&#x2208;</span><span class="mopen">[</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">&#x221E;</span><span class="mclose">]</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">w_i&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&gt;</span><span class="mord mathrm">0</span></span></span></span> and typically <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_{i=1}^n w_i=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.0500099999999999em;vertical-align:-0.30001em;"></span><span class="base textstyle uncramped"><span class="mop"><span class="mop op-symbol small-op" style="top:-0.0000050000000000050004em;">&#x2211;</span><span class="msupsub"><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span>, and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mrow><mi>r</mi><mi>e</mi><mi>f</mi></mrow></msup></mrow><annotation encoding="application/x-tex">{\mathbf{f}}^{ref}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:0.849108em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is a reference point.</p>
<p>The figure illustrates two special cases. The first one is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span> (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi><msub><mi>M</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">WM_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10903em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> in the figure), in which case the method is equivalent to the weighted sum method. This approach guarantees to find the complete Pareto front if it is convex. However, such is not guaranteed for non-convex case. Moreover, a uniform distribtuion of weights typically does not result in a uniformly distributed Pareto set. The second case is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>=</mo><mi mathvariant="normal">&#x221E;</mi></mrow><annotation encoding="application/x-tex">p=\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mrel">=</span><span class="mord mathrm">&#x221E;</span></span></span></span> (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi><msub><mi>M</mi><mi mathvariant="normal">&#x221E;</mi></msub></mrow><annotation encoding="application/x-tex">WM_\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10903em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">&#x221E;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> in the figure), where the method becomes the Tchebycheff metric. This approach guarantees to find the complete Pareto front no matter whether it is convex or not. However, the reference point has to satisfy <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mrow><mi>r</mi><mi>e</mi><mi>f</mi></mrow></msup><mo>&#x2AAF;</mo><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">{\mathbf{f}}^{ref}\preceq{\mathbf{f}}^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:0.985078em;vertical-align:-0.13597em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2AAF;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>.</p>
<p>An extension of WM is the rotated WM, which will not be discussed in detail here.</p>
<figure float="left">
<img src="pareto.png" width="700px">
<figcaption>
Illustration of the concepts associated with Pareto front and several MO algorithms.
</figcaption>
</figure>
<h2 id="a-posteriori-approach">A posteriori approach</h2>
<p>The a posteriori approach is usually iterative and roughly fall into two categories. One is based on special formulations of mathematical programming, and can be considered an iterative a priori method that generates a Pareto point per iteration. The other, which is typically based on evolutionary algorithms (EAs), improves a set of (potential) Pareto points simultaneously per iteration.</p>
<h3 id="using-mathematical-programming">Using mathematical programming</h3>
<h4 id="two-objectives">Two objectives</h4>
<p>The two-objective problem has been studied extensively and is simpler than problems of more objectives. Two classical approaches are Normal Boundary Intersection (NBI) <a href="https://doi.org/10.1137/S1052623496307510" target="_blank" rel="noopener">Das1998</a> and (Normalized) Normal Constraint (NC) <a href="https://doi.org/10.1007/s00158-002-0276-1" target="_blank" rel="noopener">Messac2003</a>, as illustrated in the above figure. The NBI and NC can be considered the generalization of EC: Essentially, these methods convert the MO into an SO by introducing extra constraints and redefining the objective, so that the solution to the SO produces a point on the Pareto front. The extra constraints depends on a base point (or an anchor point) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">b</span></span></span></span></span></span> on the CHIM, or the utopia line in two-objective case. A discrete approximation of the Pareto front is constructed by choosing various <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">b</span></span></span></span></span></span> along the utopia line and solving the resulting SO&#x2019;s. As the reader might have noted, these approaches require the knowledge of the IM&#x2019;s, which has to be solved before the application of the MO algorithms.</p>
<p>In the NBI formulation, the objective vector is constrained to be on a line defined by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">b</span></span></span></span></span></span> and a direction vector <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">n</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">n</span></span></span></span></span></span> that is normal to the utopia line. The MO is converted to an SO for finding the intersection between the Pareto front and the line constraint, and hence the name NBI. <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mrow><msub><mo><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi><mspace width="0.16667em"></mspace><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></msub></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mi>t</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">.</mi></mrow></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2208;</mo><mrow><mrow><mi mathvariant="script">X</mi></mrow></mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>=</mo><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>+</mo><mi>t</mi><mrow><mrow><mi mathvariant="bold">n</mi></mrow></mrow></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
    {\mathop{\mathrm{arg\,min}}\limits_{\mathbf{x}}} &amp;\quad t({\mathbf{x}}) \\
    {\mathrm{s.t.}}&amp;\quad {\mathbf{x}}\in{\mathcal{X}}\\
                 &amp;\quad {\mathbf{f}}={\mathbf{b}}+t{\mathbf{n}}\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.3172200000000003em;"></span><span class="strut bottom" style="height:4.134440000000001em;vertical-align:-1.8172200000000003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.4772200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mop op-limits"><span class="vlist"><span style="top:0.79444em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span style="top:5.551115123125783e-17em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm"><span class="mspace thinspace"></span><span class="mord mathrm">m</span></span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.25722000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">s</span><span class="mord mathrm">.</span><span class="mord mathrm">t</span><span class="mord mathrm">.</span></span></span></span></span><span style="top:1.4572200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.4772200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit">t</span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span></span></span><span style="top:0.25722000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mrel">&#x2208;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span></span></span><span style="top:1.4572200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="mbin">+</span><span class="mord mathit">t</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">n</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span></p>
<p>In the NC formulation, the objective is constrained to be on a half-plane defined by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">b</span></span></span></span></span></span> and a direction vector <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">t</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{t}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.63492em;"></span><span class="strut bottom" style="height:0.63492em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">t</span></span></span></span></span></span> aligned with the utopia line. The MO is converted to an SO for finding the minimum of one of the objectives (the second objective in the illustrated case) given the extra constraint. <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mrow><msub><mo><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi><mspace width="0.16667em"></mspace><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></msub></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><msub><mi>f</mi><mn>1</mn></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">.</mi></mrow></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2208;</mo><mrow><mrow><mi mathvariant="script">X</mi></mrow></mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mo>(</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>)</mo><mo>&#x22C5;</mo><mrow><mrow><mi mathvariant="bold">t</mi></mrow></mrow><mo>&#x2265;</mo><mn>0</mn></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
    {\mathop{\mathrm{arg\,min}}\limits_{\mathbf{x}}} &amp;\quad f_1({\mathbf{x}}) \\
    {\mathrm{s.t.}}&amp;\quad {\mathbf{x}}\in{\mathcal{X}}\\
                 &amp;\quad ({\mathbf{f}}-{\mathbf{b}})\cdot{\mathbf{t}}\geq 0
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.3172200000000003em;"></span><span class="strut bottom" style="height:4.134440000000001em;vertical-align:-1.8172200000000003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.4772200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mop op-limits"><span class="vlist"><span style="top:0.79444em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span style="top:5.551115123125783e-17em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm"><span class="mspace thinspace"></span><span class="mord mathrm">m</span></span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.25722000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">s</span><span class="mord mathrm">.</span><span class="mord mathrm">t</span><span class="mord mathrm">.</span></span></span></span></span><span style="top:1.4572200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.4772200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span></span></span><span style="top:0.25722000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mrel">&#x2208;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span></span></span><span style="top:1.4572200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mopen"><span class="mspace quad"></span><span class="mopen">(</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mbin">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="mclose">)</span><span class="mbin">&#x22C5;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">t</span></span></span><span class="mrel">&#x2265;</span><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> In [Messac2003], a normalization step is applied before solving the SO, which slightly simplifies the normal constraint.</p>
<h4 id="three-or-more-objectives">Three or more objectives</h4>
<p>The ideas of NBI and NC are easily extended to the cases of more objectives, as have been done in [Das1998] and [Messac2003]. However, both methods may not be able to explore the complete Pareto front, resulting in some unobtainable regions. This is illustrated in the figure below: Assuming the objective space is a sphere centered at the origin, the Pareto front <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span> is an octant of the sphere (Green) and the CHIM is an equilateral triangle (Blue). However, the projection of the Pareto front on the CHIM plane, which is defined as CHIM+, is a region encompassed by three arcs (Red). That means, using a base point on the CHIM, one can only obtain solutions encompassed by the black dashed lines on the Pareto front.</p>
<p>As a remedy, <a href="https://doi.org/10.2514/1.8977" target="_blank" rel="noopener">Messac2004</a> proposed an improved NBI algorithm to explore the complete Pareto front by adding more base points outside the CHIM, i.e.&#xA0;on the CHIM+. Another approach, Directed Search Domain (DSD), is proposed in <a href="https://doi.org/10.1080/0305215X.2010.497185" target="_blank" rel="noopener">Erfani2011</a>. In DSD, the NBI constraint is replaced by cone constraints that is able to explore the complete Pareto front by expanding or rotating the cone. The Messac2004 and Erfani2011 algorithms are more like patches to the classical NBI and NC algorithms. These &#x201C;patched&#x201D; algorithms contain empirical parameters that have to be tuned and there is no guarantee of finding the complete Pareto front.</p>
<p>More systematic algorithms are proposed in <a href="https://doi.org/10.1137/080729013" target="_blank" rel="noopener">MG2009</a> as Successive Pareto Optimization (SPO) and in <a href="https://doi.org/10.1007/s00158-011-0729-5" target="_blank" rel="noopener">Motta2012</a> as Modified NBI and NC [Motta2012]. The two methods share a similar idea as recursive construction of the Pareto front. To solve an MO of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span> objectives, i.e.&#xA0;find the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span>-dimensional Pareto front <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span> problems of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>&#x2212;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span><span class="mbin">&#x2212;</span><span class="mord mathrm">1</span></span></span></span> objectives are solved to generate the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span> Pareto fronts <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">\partial{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span> of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>n</mi><mo>&#x2212;</mo><mn>1</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">(n-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">n</span><span class="mbin">&#x2212;</span><span class="mord mathrm">1</span><span class="mclose">)</span></span></span></span> dimensions, which are the boundaries of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span>. Subsequently, a set of base points are distributed uniformly between these boundaries, so as to cover the CHIM+ (almost) evenly and capture the <em>complete</em> Pareto front <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span>. Finally, at the recursion boundary, the SO&#x2019;s associated with the objectives are solved to determine the IM&#x2019;s.</p>
<p>Take a 3-objective problem for example, as shown in the figure below. First, the IM&#x2019;s are found. Next, the NBI procedure is applied to find <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mrow><mn>1</mn><mn>3</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\partial{\mathcal{F}}_{13}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span><span class="mord mathrm mtight">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> for the MO associated with objectives 1 and 3. Same procedures are done for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mrow><mn>1</mn><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\partial{\mathcal{F}}_{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mrow><mn>2</mn><mn>3</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\partial{\mathcal{F}}_{23}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span><span class="mord mathrm mtight">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. Finally, base points will be distributed over CHIM+, which is emcompassed by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mrow><mn>1</mn><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\partial{\mathcal{F}}_{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mrow><mn>1</mn><mn>3</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\partial{\mathcal{F}}_{13}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span><span class="mord mathrm mtight">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mrow><mn>2</mn><mn>3</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\partial{\mathcal{F}}_{23}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span><span class="mord mathrm mtight">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>, to identify the complete Pareto front by applying the NBI procedure again.</p>
<figure float="left">
<img src="obj3.gif" width="700px">
<figcaption>
Illustration of Pareto front of three objectives.
</figcaption>
</figure>
<h3 id="using-evolutionary-algorithm">Using evolutionary algorithm</h3>
<p>There are two out-standing EAs in this category, which are Non-dominated Sorting Genetic Algorithm-II (NSGA-II) in <a href="https://doi.org/10.1109/4235.996017" target="_blank" rel="noopener">Deb2002</a> and Strength Pareto Evolutionary Algorithm 2 (SPEA-2) in <a href="https://doi.org/10.3929/ethz-a-004284029" target="_blank" rel="noopener">Zitzler2001</a>. It appears they have become standard evolutionary algorithms for MO, against which new algorithms will be compared. However, I am not going to talk too much about EAs, which are not my favorite. Some introductory materials are found <a href="https://cims.nyu.edu/~gn387/glp/lec3.pdf" target="_blank" rel="noopener">here</a>. A comparison of evolutional algorithms for MO is found in, for example, <a href="https://doi.org/10.1162/106365600568202" target="_blank" rel="noopener">Zitzler2000</a> and <a href="https://doi.org/10.1162/EVCO_a_00009" target="_blank" rel="noopener">Bader2011</a>.</p>
<p>Nevertheless, one important thing to learn from the EAs is the construction of the fitness function of a Pareto solution - How much it is dominating others, or how much it is improving the Pareto front? This requires the proper definition of indicators describing the quality of the Pareto front. These indicators have a broader range of application in, for example, the assessment of convergence and the construction of acquisition functions in Bayesian MO algorithms. In <a href="https://doi.org/10.1109/TEVC.2003.810758" target="_blank" rel="noopener">Zitzler2003</a>, a number of criteria for the quality of the Pareto solution are gathered and compared. Three commonly used criteria include: The <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3F5;</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3F5;</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and hypervolume indicators.</p>
<p>The <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3F5;</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3F5;</span></span></span></span>-indicator characterizes the minimum separation between two Pareto solutions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{G}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span></span></span></span>. The additive form is, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>I</mi><mi>&#x3F5;</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo separator="true">,</mo><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow><mo>)</mo><mo>=</mo><msub><mi>inf</mi><mrow><mi>&#x3F5;</mi></mrow></msub><mo>{</mo><mi mathvariant="normal">&#x2200;</mi><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mo>&#x2208;</mo><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow><mi mathvariant="normal">&#x2203;</mi><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2208;</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo>:</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>+</mo><mi>&#x3F5;</mi><mo>&#x2AAF;</mo><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mo>}</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
I_\epsilon({\mathcal{F}}, {\mathcal{G}}) = \inf_{\epsilon}\{\forall{\mathbf{g}}\in{\mathcal{G}}\exists{\mathbf{f}}\in{\mathcal{F}}: {\mathbf{f}}+\epsilon\preceq {\mathbf{g}}\}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.45em;vertical-align:-0.7em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">&#x3F5;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-limits reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:0.6em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">&#x3F5;</span></span></span></span><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop">in<span style="margin-right:0.07778em;">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">{</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2200;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2208;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2203;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2208;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">:</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3F5;</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2AAF;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">}</span></span></span></span></span> The multiplicative form is defined in a similar manner.</p>
<p>The <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> indicator was initially developed in <a href="https://pdfs.semanticscholar.org/41e3/e93b35b4286a9d5310af0b898769e052ef93.pdf" target="_blank" rel="noopener">Hansen1998</a> for the case that the Pareto solutions are measured using a set of utility functions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">U</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{U}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">U</span></span></span></span></span></span>, e.g.&#xA0;the WM functions parameterized by the weight vectors <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">w</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{w}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">w</span></span></span></span></span></span>. The utility fuctions are assigned some weights, or &#x201C;probablities&#x201D; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi>u</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">u</span><span class="mclose">)</span></span></span></span>, representing the preference information. The indicator is defined as the weighted or expected improvement of the best value of utility functions, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>I</mi><mrow><msub><mi>R</mi><mn>2</mn></msub></mrow></msub><mo>(</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo separator="true">,</mo><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow><mo separator="true">;</mo><mrow><mrow><mi mathvariant="script">U</mi></mrow></mrow><mo>)</mo><mo>=</mo><msub><mo>&#x222B;</mo><mrow><mi>u</mi><mo>&#x2208;</mo><mrow><mrow><mi mathvariant="script">U</mi></mrow></mrow></mrow></msub><mo>[</mo><msup><mi>u</mi><mo>&#x2217;</mo></msup><mo>(</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo>)</mo><mo>&#x2212;</mo><msup><mi>u</mi><mo>&#x2217;</mo></msup><mo>(</mo><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow><mo>)</mo><mo>]</mo><mi>p</mi><mo>(</mo><mi>u</mi><mo>)</mo><mi>d</mi><mi>u</mi></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
I_{R_2}({\mathcal{F}}, {\mathcal{G}}; {\mathcal{U}}) = \int_{u\in{\mathcal{U}}}[u^*({\mathcal{F}})-u^*({\mathcal{G}})]p(u)du
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.36em;"></span><span class="strut bottom" style="height:2.29962em;vertical-align:-0.93962em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">U</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop reset-textstyle displaystyle textstyle uncramped"><span class="mop op-symbol large-op" style="margin-right:0.44445em;top:-0.0011249999999999316em;">&#x222B;</span><span class="msupsub"><span class="vlist"><span style="top:0.91225em;margin-right:0.05em;margin-left:-0.44445em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mrel mtight">&#x2208;</span><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathcal mtight" style="margin-right:0.09931em;">U</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">]</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">p</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">u</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">d</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">u</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>u</mi><mo>&#x2217;</mo></msup><mo>(</mo><mi mathvariant="normal">&#x25A1;</mi><mo>)</mo><mo>=</mo><mi>inf</mi><mo>{</mo><mi>u</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>)</mo><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2208;</mo><mi mathvariant="normal">&#x25A1;</mi><mo>}</mo></mrow><annotation encoding="application/x-tex">u^*(\Box)=\inf\{ u({\mathbf{f}}),{\mathbf{f}}\in\Box \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord mathrm">&#x25A1;</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop">in<span style="margin-right:0.07778em;">f</span></span><span class="mopen">{</span><span class="mord mathit">u</span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mrel">&#x2208;</span><span class="mord mathrm">&#x25A1;</span><span class="mclose">}</span></span></span></span>. When there is only one utility function, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>I</mi><mrow><msub><mi>R</mi><mn>2</mn></msub></mrow></msub><mo>(</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo separator="true">,</mo><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow><mo>)</mo><mo>=</mo><msup><mi>u</mi><mo>&#x2217;</mo></msup><mo>(</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo>)</mo><mo>&#x2212;</mo><msup><mi>u</mi><mo>&#x2217;</mo></msup><mo>(</mo><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">I_{R_2}({\mathcal{F}},{\mathcal{G}})=u^*({\mathcal{F}})-u^*({\mathcal{G}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mclose">)</span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span><span class="mclose">)</span></span></span></span>.</p>
<p>The (binary) hypervolume indicator is defined as the &#x201C;size&#x201D; of the margin between two Pareto solutions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{G}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span></span></span></span>, if one dominates the other. More formally, it is the measure <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x39B;</mi></mrow><annotation encoding="application/x-tex">\Lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x39B;</span></span></span></span> of the set containing points that are dominated by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span> but not by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{G}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span></span></span></span>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>I</mi><mi>H</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo separator="true">,</mo><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow><mo>)</mo><mo>=</mo><mi mathvariant="normal">&#x39B;</mi><mo>{</mo><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mo>&#x2AB0;</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo>&#x2227;</mo><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mo>&#x2AAF;</mo><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow><mo>}</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
I_H({\mathcal{F}}, {\mathcal{G}}) = \Lambda\{ {\mathbf{h}}|{\mathbf{h}}\succeq{\mathcal{F}}\wedge {\mathbf{h}}\preceq{\mathcal{G}}\}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.08125em;">H</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x39B;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">{</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2AB0;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2227;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2AAF;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">}</span></span></span></span></span></p>
<p>As mentioned above, there are two typical applications of these binary indicators. The first one is for convergence check. One can set one input to be the true Pareto solution (for benchmark problems), or a set consisting of the Utopian point (for real problems). The second application is to construct a <em>unary</em> indicator as the utility function of a potential solution <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{f}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span></span> by setting <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo>=</mo><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow><mo>&#x222A;</mo><mo>{</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>}</mo></mrow><annotation encoding="application/x-tex">{\mathcal{F}}={\mathcal{G}}\cup\{ {\mathbf{f}}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span><span class="mbin">&#x222A;</span><span class="mopen">{</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mclose">}</span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{G}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span></span></span></span> is a reference Pareto solution.</p>
<h1 id="bayesian-mo-algorithms">Bayesian MO algorithms</h1>
<p>The algorithms to be discussed in this section are considered Bayesian because the optimization process generates the solution based on the observed samples of the objective functions, instead of the objective functions themselves as in classical methods. This bares the same idea as in the Bayesian SO algorithms. A surrogate has to be constructed using the observed samples as a replacement of the objective functions, or their utility function. During the optimization, the exploitation and exploration strategy has to be incorporated so as to account for the uncertainty of the surrogate model, as was done in Bayesian SO algorithms.</p>
<p>The Bayesian MO algorithms have deep roots in the classical methods. Depending on how classical methods are utilized, the algorithms are classified into the indirect and the direct methods.</p>
<h2 id="indirect-methods">Indirect methods</h2>
<p>In the indirect methods, no special acquisition functions are developed for MO. Instead, the MO is converted to an SO as was done in the classical methods, such as WS and SPO. In a sense, the utility function in a classical method is directly used as an acqusition function. The resulting SO is solved using a BO algorithm, which is usually referred to as inner optimization.</p>
<p>One such example is the ParEGO algorithm in <a href="https://doi.org/10.1109/TEVC.2005.851274" target="_blank" rel="noopener">Knowles2006</a>. This is probably the first important Bayesian MO algorithm. The utility function is developed using the augmented Tchebycheff function, which is a combination of the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>u</mi><mi mathvariant="normal">&#x221E;</mi></msub></mrow><annotation encoding="application/x-tex">u_\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">&#x221E;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">u_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> functions, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>u</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>)</mo><mo>=</mo><msub><mi>max</mi><mi>i</mi></msub><msub><mi>w</mi><mi>i</mi></msub><msub><mi>f</mi><mi>i</mi></msub><mo>+</mo><mi>&#x3C1;</mi><msubsup><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>w</mi><mi>i</mi></msub><msub><mi>f</mi><mi>i</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
u({\mathbf{f}}) = \max_i w_i f_i + \rho \sum_{i=1}^n w_i f_i
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.6513970000000002em;"></span><span class="strut bottom" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">u</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-limits reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:0.6276640000000001em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:1.3877787807814457e-16em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop">max</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3C1;</span><span class="mop op-limits reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3C1;</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3C1;</span></span></span></span> is a small positive value typically set to 0.05. In each run, a random weight vector is generated and a point on the Pareto front is found. A noteworthy disadvantage of ParEGO is that the uniformity of the Pareto solution is not guaranteed. Using a similar idea, the algorithms of EC, NBI, NC are easily combined with Bayesian SO algorithms.</p>
<p>A major disadvantage of the indirect method is that, in the inner optimization, the BO algorithm would cost multiple evaluations of the black-box objective functions only to find one point on the Pareto front. A more efficient approach would be the direct method, which produces one point on the Pareto front <em>per</em> evaluation.</p>
<h2 id="direct-methods">Direct methods</h2>
<p>In the direct methods, the BO algorithm is executed with special MO acquisition functions.</p>
<h3 id="two-historical-methods">Two historical methods</h3>
<p>One precursor in this category is <a href="https://doi.org/10.1109/CEC.2005.1554959" target="_blank" rel="noopener">Jeong2005</a>. The MO is carried out using an evolutionary algorithm, where the fitness is defined as the expected improvements (EI) of the single objectives.</p>
<p>Another MO acquisition function is developed in <a href="https://doi.org/10.2514/1.16875" target="_blank" rel="noopener">Keane2006</a>. It is the first paper extending EI and probablity of improvement (PoI) of SO to MO. The EI was defined as the product of the PoI and an Euclidean distance-based improvement function. However, the formulation is limited to the 2-objective case.</p>
<h3 id="two-modern-methods">Two modern methods</h3>
<p>Later, the concept of hypervolume is introduced into the development of MO acquisition functions. It is mainly developed into two families.</p>
<p>One family is the SMS-EGO method proposed in <a href="https://doi.org/10.1007/978-3-540-87700-4_78" target="_blank" rel="noopener">Ponweiser2008</a>. It is an extension of the classical acqusition function of lower confidence bound (LCB), i.e.&#xA0;the improvement of HV due to LCB. In addition, a penalty is added to points that do not improve the Pareto front and an additive epsilon-dominance term is added to points close to Pareto front to smooth the distribution of the acquisition function. It was shown to outperform ParEGO and standard EAs like NSGA-II and SPEA-2. This method is easy to implement and has been widely used.</p>
<p>The other family is based on the S-metric expected improvement (SExI). It is the hypervolume version of EI for MO, originally proposed in <a href="https://core.ac.uk/download/pdf/46906138.pdf" target="_blank" rel="noopener">Emmerich2005</a>, as an extension of the classical EI for SO. The formulation is straight-forward by replacing the improvement function with the unary hypervolume indocator, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>E</mi><mi>I</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>=</mo><mo>&#x222B;</mo><mi>I</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>)</mo><mi>p</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo separator="true">;</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mi>d</mi><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
EI({\mathbf{x}}) = \int I({\mathbf{f}})p({\mathbf{f}};{\mathbf{x}})d{\mathbf{f}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.36em;"></span><span class="strut bottom" style="height:2.22225em;vertical-align:-0.86225em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.05764em;">E</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.07847em;">I</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-symbol large-op reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.44445em;top:-0.0011249999999999316em;">&#x222B;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.07847em;">I</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">p</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">d</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>)</mo><mo>=</mo><msub><mi>I</mi><mi>H</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo>&#x222A;</mo><mo>{</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>}</mo><mo separator="true">,</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">I({\mathbf{f}}) = I_H({\mathcal{F}}\cup\{ {\mathbf{f}}\}, {\mathcal{F}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.08125em;">H</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mbin">&#x222A;</span><span class="mopen">{</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mclose">}</span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mclose">)</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span> is the Pareto front of the current iteration.</p>
<p>In [Emmerich2005], the algorithm was called SMS-EMOA (i.e.&#xA0;solved using an evolutionary algorithm) and the integration of hypervolume was carried out using Monte Carlo method. In a later paper, <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.216.2154&amp;rep=rep1&amp;type=pdf" target="_blank" rel="noopener">Emmerich2008</a>, an exact integration method is proposed for SExI. However, the computational complexity of the exact ingration method grows exponentially with the problem dimension and number of Pareto points.</p>
<p>The algorithm complexity of SExI definitely limits the spread of its application. There are even survey papers that skipped this algorithm in the numerical comparison section due to complexity in the implementation. Nevertheless, the SExI algorithm is improved in <a href="https://doi.org/10.1007/978-3-319-15892-15" target="_blank" rel="noopener">Hupkens2015</a>, which claimed to be the fastest algorithm for the 2D and 3D cases. For the general case, however, the fastest algorithm is proposed in <a href="https://doi.org/10.1007/s10898-013-0118-2" target="_blank" rel="noopener">Couckuyt2014</a>, which is based on the <a href="http://www.wfg.csse.uwa.edu.au/hypervolume/" target="_blank" rel="noopener">WFG algorithm</a>. In [Couckuyt2014], the new algorithm is also applied to the MO version of PoI, which is easier to implement than SExI and appears to be equally effective.</p>
<h3 id="comparison">Comparison</h3>
<p>The aforementioned algorithms have been systematically compared in the literature. In <a href="https://doi.org/10.1007/978-3-642-15844-5_72" target="_blank" rel="noopener">Wagner2010</a>, the algorithms from [Jeong2005], [Knowles2006], [Keane2006], [Ponweiser2008], and [Emmerich2008] are compared. Three necessary conditions are proposed to detect conceptual problems in the formulations while four desirable properties are identified. It is concluded that [Keane2006] is <em>problematic</em>. [Ponweiser2008] satisfies the essential conditions for acquisition function, but has disadvantages like non-smooth distribution of acquisition function. [Emmerich2008] has the most desirable properties, but is hard to implement.</p>
<p>In <a href="https://doi.org/10.1007/978-3-642-37140-0_56" target="_blank" rel="noopener">Zaefferer2013</a>, four algorithms are compared: [Keane2006], [Emmerich2008], [Ponweiser2008], and an evolutional algorithm MSPOT (<em>which I do not care</em>), with SMS-EMOA as the baseline. [Keane2006] was found to be worse than the baseline, which agrees with the discussion in [Wagner2010]. The rest outperformed the baseline, but there was no decisive difference.</p>
<h3 id="further-development">Further development</h3>
<p>More algorithms and enhancements are developed in the literature since the proposal of SMS-EGO.</p>
<h4 id="multi-point-proposal">Multi-point proposal</h4>
<p>With the advent of parallel computing, the idea of multi-point proposal was proposed, e.g.&#xA0;in <a href="https://doi.org/10.1109/TEVC.2009.2033671" target="_blank" rel="noopener">Zhang2009</a>. The idea is to find multiple candidate design vectors that improves the Pareto front and evaluate the black-box function at these new points simultaneously, exploiting the parallelism of the modern computers.</p>
<p>In <a href="https://doi.org/10.1007/978-3-319-15934-8_5" target="_blank" rel="noopener">Horn2015</a>, algorithms like [Jeong2005], [Knowles2006] and [Ponweiser2008] are compared and extended with multi-point proposal. The major finding was that, for some algorithms, the multi-point variants did not significantly deteriorate the results. They even improved the approximation quality in some cases. Moreover, the change from the EI to the LCB could improve the results of the internal optimization within ParEGO.</p>
<h4 id="informatics-based-approaches">Informatics-based approaches</h4>
<p>This family of approaches are more recent and more &#x201C;Bayesian&#x201D; in the sense that a stronger statistical flavor is involved. Typical examples are stepwise uncertainty reduction (SUR) <a href="https://doi.org/10.1007/s11222-014-9477-x" target="_blank" rel="noopener">Picheny2015</a> and Predictive Entropy Search (PES) <a href="https://dl.acm.org/citation.cfm?id=3045548" target="_blank" rel="noopener">Hern&#xE1;ndez-Lobato2016</a>. The idea is to pick a new point at each iteration to maximize the &#x201C;information gain&#x201D; to the current Pareto front. The information gain is typically measured using the Shannon entropy. These methods claim themselves to be &#x201C;intuitive, statistically consistent and efficient&#x201D;, as an alternative to the classical &#x201C;sensible heuristic&#x201D; approaches, such as the hypervolume EI. For academic problems, these methods do seem to be comparable to methods like SMS-EGO. However, the computational cost appears to be higher and the implementation seems to be more complex than all the methods discussed above.</p>
<h1 id="computer-implementations">Computer implementations</h1>
<p>I have not found many implementations for Bayesian MO algorithms. Two working libraries I found are <a href="https://github.com/GPflow/GPflowOpt" target="_blank" rel="noopener">GPflowOpt</a> and <a href="http://sumo.intec.ugent.be/SUMO" target="_blank" rel="noopener">SUMO</a>. There are some libraries for evolutionary MO algorithms, such as <a href="http://esa.github.io/pygmo/" target="_blank" rel="noopener">PyGMO</a> and <a href="https://github.com/Project-Platypus/Platypus" target="_blank" rel="noopener">Platypus</a>, but without surrogate capabilities. Probably these libraries can be incorporated into some BO framework for MO purposes.</p>
<p>Finally, for the evaluation of these libraries, there are a few standard test cases to play with:</p>
<ol style="list-style-type: decimal">
<li>MOP: <a href="https://doi.org/10.1145/298151.298382" target="_blank" rel="noopener">VanVeldhuizen1999</a></li>
<li>ZDT: <a href="https://doi.org/10.1162/106365600568202" target="_blank" rel="noopener">Zitzler2000</a></li>
<li>DTLZ: <a href="https://doi.org/10.1007/1-84628-137-7_6" target="_blank" rel="noopener">Deb2005</a></li>
</ol>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>A precise description is that the base points are distributed on a surface encompassed by the boundaries. The specific definition of this surface is algorithm-dependent. The projection of this surface on the CHIM plane is identical to the CHIM+. Therefore, the projection of the base points are also expected to cover the CHIM+ (almost) evenly.<a href="#fnref1">&#x21A9;</a></p></li>
</ol>
</div>
]]></content>
      
        <categories>
            
            <category> digest </category>
            
        </categories>
        
        
        <tags>
            
            <tag> optimization </tag>
            
            <tag> numerical </tag>
            
            <tag> bayesian </tag>
            
            <tag> multi-objective </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Lewis Overthrust]]></title>
      <url>http://smanist.github.io/2018/07/29/Lewis-Overthrust/</url>
      <content type="html"><![CDATA[<p>Where to play with huge snowpatches in summer?</p>
<a id="more"></a>
<p>-In mountains of high altitude and/or high latitude. Maybe high enough that even glaciers exist. The Glacier National Park (GNP) is one such place to go.</p>
<h1 id="introduction">Introduction</h1>
<p>The glaciers are indeed an essential ingredient of the spectacular scenes in GNP. Yet, the scenes could be given an extra layer of &#x201C;awesomeness&#x201D; if the long geological history were taken into account. In a sense, the GNP is the result of the interactions between the terrain, the glacier, the climate, the fauna and flora, etc. over billions of years. And the most fascinating part is probably how the stage was &#x201C;prepared&#x201D; for these interactions by tectonic processes.</p>
<p>This stage is the Lewis Overthrust. And its formation is vividly explained in a booklet <strong>&#x201C;Rocks, Ice, and Water - The Geology of Waterton-Glacier Park&#x201D;</strong>, by David D. Alt and Donald W. Hyndman, 1973. I think it would be better to directly present the excerpt of this book (pp.&#xA0;21-24), instead of myself, a layman, trying to explain the geological mechanisms.</p>
<h1 id="the-lewis-overthrust-fault---the-beginning-of-mountains">The Lewis Overthrust Fault - The Beginning of Mountains</h1>
<p>Geologists normally expect to find sedimentary rocks stacked in the order they were deposited with the oldest layers at the bottom of the pile and the youngest on top. In Waterton-Glacier Park this expectable order of rock layers is dramatically reversed; Precambrian sedimentary rocks deposited more than one billion years ago are now on top of Cretaceous sedimentary rocks laid down only 70 million years ago! Apparently a slab of Precambrian sedimentary rock several thousand feet thick slid eastward some tens of miles over the much younger Cretaceous sedimentary rocks. The surface on which the sliding movement occurred is called the Lewis Overthrust Fault. Geologists have marvelled at this situation, and attempted to understand it, ever since they first recognized it in the years near the beginning of the twentieth century.</p>
<p>For many years geologists argued that a strong force from the west must have pushed the slab of Precambrian sedimentary rock eastward onto the plains. But this vision poses problems: pushing such a long, thin slab of rock from behind without crumpling it is an undertaking similar to pushing a large carpet across a floor without wrinkling it. The rocks, like the carpet, are not strong enough to withstand the necessary force without folding, and the friction in the sliding surface makes it difficult for movement to occur. The Precambrian slab in Waterton-Glacier Park is not crumpled, neither is there evidence in the area west of the Park of any geologic event that could have exerted a strong eastward push. So it is difficult to imagine how this enormous slab of rock was pushed into its present position.</p>
<p>Now most geologists are convinced that overthrust faults do not move in response to a push from behind but instead slide downhill under the pull of gravity. This eliminates the problem of understanding how the overthrust slab could withstand a force without crumpling because every particle of rock feels the tug of gravity individually.</p>
<p>The problem of overcoming friction in the sliding surface of the fault still remains. If water in the pores of the rock is under sufficient pressure, it will support the rocks above enabling them to move with very little friction. This might have happened in the Cretaceous rocks but would have been most unlikely in the much older Precambrian formations because they were probably much too dry by the time movement occurred on the Lewis Overthrust fault. Some geologists contend that the Precambrian rocks moved because certain layers were weak enough to flow like a viscous fluid carrying the rocks above. They imagine the rocks behaving somewhat like a layer cake filled with soft frosting.</p>
<p>Thousands of feet of sedimentary rocks had accumulated in the region of Waterton-Glacier Park by the end of Cretaceous time. Layer after layer of sandstone, mudstone and limestone deposited over a period of many hundreds of millions of years while the region was a level plain flooded at times by shallow seas. The quiet years ended about 70-90 million years ago, during Cretaceous time while giant dinosaurs still roamed the earth.</p>
<p>Processes operating deep within the earth slowly raised the continental crust of western North America, with its burden of sedimentary rocks, several thousand feet vertically upward forming a broad crustal arch that had its crest about 100 miles west of Waterton-Glacier Park. Thousands of feet of interlayered limestone, sandstone, and mudstone slowly slanted eastward as uplift proceeded. Tilting such a thick pile of sedimentary rocks, some layers strong and others weak, is somewhat like tilting a thick stack of heavily-buttered pancakes. In both cases the entire stack will eventually begin to slide downward on one or more of the weak layers. That is probably what happened about 50-60 million years ago all along the eastern front of the northern Rockies.</p>
<p>Somewhere deep within the pile of sedimentary rocks a weak layer yielded under the strain and the rocks above began to glide slowly eastward down the flank of the broad regional arch still rising in the earth&#x2019;s crust. The huge slab of Precambrian sedimentary rock that is now Waterton-Glacier Park slid an unknown distance eastward, probably more than 30 miles. It moved at least ten miles across the soft sands and muds deposited in the shallow Cretaceous sea that had receded only a few million years previously.</p>
<p>As the mass of Precambrian sedimentary rock slowly slid eastward, large gaps opened behind it. The same sort of thing happens when slabs of snow slide down a roof leaving gaps where the moving snow detached itself from the stationary mass that remained behind &#x2013; or the upper end of a glacier pulls away from the mountain at its head. The North Fork Valley, along the western margin of Waterton-Glacier Park, appears to be such a gap pulled open behind the Precambrian slab as it moved eastward on the Lewis Overthrust. It is approximately ten miles wide, probably not enough to account for all the displacement on the Lewis Overthrust fault. In order to find another gap to account for more displacement we must go farther west to the broad Flathead Valley and suggest that the Whitefish Range, west of the North Fork Valley, may also have slid eastward.</p>
<p>Early geologists interpreted the North Fork Valley quite differently, arguing that it is a downdropped block of the earth&#x2019;s crust. Rocks in the southern end of the valley, where the bedrock valley floor is exposed, do suggest that the valley floor has dropped vertically downward. But there are reasons to believe that the floor of a pull-apart valley might drop so the two explanations are not incompatible.</p>
<p>Mountain ranges north and south of Waterton-Glacier Park also consist of large slabs of rock that slid eastward as the earth&#x2019;s crust arched up to the west. But these ranges do not consist of a single large slab. Instead, they are made of many smaller slabs stacked on each other like a row of fallen dominoes. This kind of structure is also found in part of the eastern portion of Waterton Park.</p>
<p>More references:</p>
<ol style="list-style-type: decimal">
<li><a href="https://en.wikipedia.org/wiki/Lewis_Overthrust" target="_blank" rel="noopener">Wikipedia</a>, where a few illustrative figures are provided.</li>
<li><a href="https://www.nationalparkreservations.com/glacier-national-park-and-the-lewis-overthrust/" target="_blank" rel="noopener">Glacier National Park and the Lewis Overthrust</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> pieces </category>
            
        </categories>
        
        
        <tags>
            
            <tag> mechanics </tag>
            
            <tag> geology </tag>
            
            <tag> glacier </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Solving a Multibody Short-Range Interaction Problem]]></title>
      <url>http://smanist.github.io/2018/06/23/Multibody-short-range-interaction/</url>
      <content type="html"><![CDATA[<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css"><p>When multiple bodies interact with their neighbours according to a graph.</p>
<a id="more"></a>
<h1 id="introduction">Introduction</h1>
<p>Recently I wrote a code for solving a certain type of multibody problems - just for fun. One instance of such problem is the truss structure, which can be viewed as a set of points connected by bars that can only deform axially. A graph specifies the connectivity of the points - only the points that are connected interact with each other. Another instance of the problem is certain particle system that appear in material science. The particles only interact with their neighbours. Now the problem is essentially determining the equilibrium geometrical configuration of the multi-body system when it is subject to an external excitation. Such equilibrium can be determined via a certain energy principle, if there is any.</p>
<p>Mathematically, the problem is stated as follows. Suppose a multibody system is composed of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span> points <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>i</mi></msub><mo>}</mo></mrow><annotation encoding="application/x-tex">\{ {\mathbf{x}}_i\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">{</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">}</span></span></span></span> with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">M</span></span></span></span> point pairs <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><msub><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><mi>i</mi></msub><mo>=</mo><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>2</mn></mrow></msub><mo>)</mo><mo>}</mo></mrow><annotation encoding="application/x-tex">\{ {\mathbf{e}}_i=({\mathbf{x}}_{i1},{\mathbf{x}}_{i2})\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">{</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mclose">}</span></span></span></span>. The energy <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">U</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{U}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">U</span></span></span></span></span></span> of the multibody system is defined as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mi mathvariant="script">U</mi></mrow></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mo>)</mo><mo>=</mo><msubsup><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></msubsup><mi>U</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>2</mn></mrow></msub><mo>)</mo><mo>&#x2261;</mo><msubsup><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></msubsup><msub><mi>U</mi><mi>i</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathcal{U}}({\mathbf{u}}) = \sum_{i=1}^M U({\mathbf{x}}_{i1},{\mathbf{x}}_{i2}) \equiv \sum_{i=1}^M U_i
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.8283360000000002em;"></span><span class="strut bottom" style="height:3.106005em;vertical-align:-1.277669em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">U</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-limits reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.10903em;">U</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2261;</span><span class="mop op-limits reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10903em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>U</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">U_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10903em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is the energy of the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>th point pair and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{u}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span></span></span></span> is a vector containing all the states of the points. Next, assume the external excitation is conservative, i.e.&#xA0;there exists a scalar function <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">V</mi></mrow></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">{\mathcal{V}}({\mathbf{u}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="mclose">)</span></span></span></span> such that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#x2212;</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="script">V</mi></mrow></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex">-{\frac{\partial {\mathcal{V}}}{\partial {\mathbf{u}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8801079999999999em;"></span><span class="strut bottom" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord">&#x2212;</span><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">u</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathcal mtight" style="margin-right:0.08222em;">V</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> is the external force acting on the points. The system achieves equilibrium at its stationary point, i.e.&#xA0;when the gradient of total energy <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x3A0;</mi><mo>=</mo><mrow><mrow><mi mathvariant="script">U</mi></mrow></mrow><mo>+</mo><mrow><mrow><mi mathvariant="script">V</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">\Pi={\mathcal{U}}+{\mathcal{V}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x3A0;</span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">U</span></span></span><span class="mbin">+</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span></span></span></span></span> becomes zero, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo>=</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi mathvariant="normal">&#x3A0;</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow></mrow></mfrac></mrow><mo>=</mo><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{g}}({\mathbf{u}}^*) = {\frac{\partial \Pi}{\partial {\mathbf{u}}}} = 0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathrm">&#x3A0;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">0</span></span></span></span></span></p>
<h1 id="solution-schemes">Solution schemes</h1>
<h2 id="naive-newton-scheme">Naive Newton scheme</h2>
<p>In simple cases, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">{\mathbf{u}}^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.688696em;"></span><span class="strut bottom" style="height:0.688696em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is a minimum point near the initial state. One can employ any standard optimization algorithms to solve the problem, i.e.&#xA0;to minimize <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x3A0;</mi></mrow><annotation encoding="application/x-tex">\Pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x3A0;</span></span></span></span> w.r.t. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{u}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span></span></span></span>. Particularly, given the gradient <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{g}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span></span></span></span> and the Jacobian <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">J</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{J}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">J</span></span></span></span></span></span> of the energy, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mi mathvariant="bold">J</mi></mrow></mrow><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo>=</mo><mfrac><mrow><msup><mi mathvariant="normal">&#x2202;</mi><mn>2</mn></msup><mi mathvariant="normal">&#x3A0;</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mn>2</mn></msup></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{J}}({\mathbf{u}}^*) = \frac{\partial^2 \Pi}{\partial {\mathbf{u}}^2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.491108em;"></span><span class="strut bottom" style="height:2.177108em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">J</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x3A0;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> the minimum is found via the Newton-Raphson (NR) procedure, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">J</mi></mrow></mrow><mi>i</mi></msub><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>i</mi></msub><mo>+</mo><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\mathbf{J}}_i{\Delta\mathbf{u}}_i &amp;= -{\mathbf{g}}_i \\
{\mathbf{u}}_{i+1} &amp;= {\mathbf{u}}_i + {\Delta\mathbf{u}}_i
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.4000000000000004em;vertical-align:-0.9500000000000004em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">J</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{u}}_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is the initial guess of the solution.</p>
<p>By applying the NR procedure to a series of external forces, one obtains the equilibrium path of the system, or the displacement-load curve in structural analysis.</p>
<h2 id="nonlinear-schemes">Nonlinear schemes</h2>
<p>There are exceptions that cannot be solved using the naive Newton scheme. Such exceptions occur typically when (1) the initial state is far from the solution, or/and (2) the equilibrium path contains limit points. There are two types of limit points. At a load limit point, a nonzero displacement increment results in a zero load increment. Or put in a different way, increasing (or decreasing) the load would result in the increase/decrease of the displacement on the two sides of the limit point. The case of displacement limit point is the reverse.</p>
<p>People have developed various solution schemes to tackle these issues. A review of these schemes is provided in <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.654.2545&amp;rep=rep1&amp;type=pdf" target="_blank" rel="noopener">Leon2011</a>. (Also check its Figure 1 for an illustration of the displacement and load limit points.)</p>
<p>To introduce these schemes, in the following we consider only the case where the external excitation is linear, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mo>&#x2212;</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="script">V</mi></mrow></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow></mrow></mfrac></mrow><mo>=</mo><mi>&#x3BB;</mi><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
-{\frac{\partial {\mathcal{V}}}{\partial {\mathbf{u}}}} = \lambda{\mathbf{f}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3BB;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{f}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span></span> is a constant vector and the value of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BB;</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BB;</span></span></span></span> determines the magnitude of the external force. In such case, the total energy of the system is written as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">&#x3A0;</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mo separator="true">,</mo><mi>&#x3BB;</mi><mo>)</mo><mo>=</mo><mrow><mrow><mi mathvariant="script">U</mi></mrow></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mo>)</mo><mo>&#x2212;</mo><mi>&#x3BB;</mi><msup><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>T</mi></msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\Pi({\mathbf{u}},\lambda) = {\mathcal{U}}({\mathbf{u}}) - \lambda {\mathbf{u}}^T{\mathbf{f}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x3A0;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3BB;</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">U</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3BB;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span></span></span></p>
<h3 id="n1-dimensional-space-formulation">N+1 dimensional space formulation</h3>
<p>Assume that the NR iteration starts at the previous equilibrium point. Treating <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BB;</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BB;</span></span></span></span> as an unknown, in the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>th NR iteration, the linear system is augmented as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">J</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd><mtd><mrow><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>i</mi><mi>T</mi></msubsup></mrow></mtd><mtd><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mi>i</mi></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>H</mi><mi>i</mi></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{bmatrix}
{\mathbf{J}}_i &amp; -{\mathbf{f}}\\
{\mathbf{c}}_i^T &amp; b_i
\end{bmatrix}
\begin{bmatrix}
{\Delta\mathbf{u}}_i \\
{\Delta\lambda}_i
\end{bmatrix}
=
\begin{bmatrix}
-{\mathbf{g}}_i \\
H_i
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.4756655em;"></span><span class="strut bottom" style="height:2.4513310000000006em;vertical-align:-0.9756655000000005em;"></span><span class="base displaystyle textstyle uncramped"><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6356655em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">J</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6156655000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-0.6356655em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span><span style="top:0.6156655000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span> where the last row and the coefficients <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{c}}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">H_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are introduced to constrain <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BB;</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BB;</span></span></span></span> and close the linear system. Different choices of these coefficients give rise to different solution schemes.</p>
<p>The solution of the augmented system is expressed as, due to <a href="https://onlinelibrary.wiley.com/doi/full/10.1002/nme.1620140811" target="_blank" rel="noopener">Batoz1979</a>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mi>i</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><msub><mi>H</mi><mi>i</mi></msub><mo>&#x2212;</mo><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>i</mi><mi>T</mi></msubsup><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>g</mi><mi>i</mi></mrow></msub></mrow><mrow><mi>b</mi><mo>+</mo><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>i</mi><mi>T</mi></msubsup><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mi>i</mi></mrow></msub></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mi>i</mi></msub><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mi>i</mi></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>g</mi><mi>i</mi></mrow></msub></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\Delta\lambda}_i &amp;= \frac{H_i - {\mathbf{c}}_i^T{\Delta\mathbf{u}}_{gi}}{b + {\mathbf{c}}_i^T{\Delta\mathbf{u}}_{fi}} \\
{\Delta\mathbf{u}}_i &amp;= {\Delta\lambda}_i{\Delta\mathbf{u}}_{fi} + {\Delta\mathbf{u}}_{gi}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.108785em;"></span><span class="strut bottom" style="height:3.7175700000000003em;vertical-align:-1.6087850000000001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.5904540000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:1.248785em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.5904540000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.713131em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">b</span><span class="mbin">+</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.27686399999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.34480000000000005em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.258664em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span><span style="top:1.248785em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">J</mi></mrow></mrow><mi>i</mi></msub><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>g</mi><mi>i</mi></mrow></msub><mo>=</mo><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{J}}_i{\Delta\mathbf{u}}_{gi}=-{\mathbf{g}}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">J</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord">&#x2212;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">J</mi></mrow></mrow><mi>i</mi></msub><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mi>i</mi></mrow></msub><mo>=</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{J}}_i{\Delta\mathbf{u}}_{fi}={\mathbf{f}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">J</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span></span>.</p>
<h3 id="simple-incremental-schemes">Simple incremental schemes</h3>
<p>A naive choice of the constraint for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BB;</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BB;</span></span></span></span> is that <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>i</mi></msub><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mspace width="1em"></mspace><msub><mi>b</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mspace width="1em"></mspace><msub><mi>H</mi><mn>1</mn></msub><mo>=</mo><mrow><mover accent="true"><mi>&#x3BB;</mi><mo>&#xAF;</mo></mover></mrow></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>H</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mspace width="1em"></mspace><mi>i</mi><mo>&#x2265;</mo><mn>2</mn></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\mathbf{c}}_i=0,\quad b_i=1,\quad H_1={\bar\lambda}\\
H_i=0,\quad i\geq 2
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.4000000000000004em;vertical-align:-0.9500000000000004em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord"><span class="mspace quad"></span><span class="mord mathit">b</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord"><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord mathit">&#x3BB;</span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit">i</span></span><span class="mrel">&#x2265;</span><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> This corresponds to the <em>incremental loading</em> (IL) scheme, which prescribes the load increment <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mover accent="true"><mi>&#x3BB;</mi><mo>&#xAF;</mo></mover></mrow></mrow><annotation encoding="application/x-tex">{\bar\lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8312199999999998em;"></span><span class="strut bottom" style="height:0.8312199999999998em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord mathit">&#x3BB;</span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> at the first iteration. As a result, the load parameter is fixed for the rest of iterations. Near the load limit point, the IL scheme would either fail or result in the snap-through behavior - the solution &#x201C;jumps&#x201D; to an equilibrium point far away from the previous solution and results in a non-smooth equilibrium path. Such behavior cannot be avoided unless the direction of the load increment is reversed at the load limit point. Similarly there is <em>incremental displacement</em> scheme which prescribes the displacement increment and suffers from the displacement limit point.</p>
<h3 id="arc-length-schemes">Arc length schemes</h3>
<p>The family of <em>arc length</em> (AL) schemes are developed to overcome the limitations of the incremental schemes at limit points. These schemes have been widely used in engineering applications, esp. commercial computater-aided engineering software. The key idea is to introduce an <em>arc length</em> constraint that simultaneously controls the increments in the displacement and load, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>T</mi></msup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mo>+</mo><mi>&#x3BC;</mi><msup><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mn>2</mn></msup><mo>=</mo><msup><mrow><mi mathvariant="normal">&#x394;</mi><mi>s</mi></mrow><mn>2</mn></msup></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\Delta\mathbf{u}}^T{\Delta\mathbf{u}}+ \mu{\Delta\lambda}^2 = {\Delta s}^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.0857709999999998em;vertical-align:-0.19444em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3BC;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">s</span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> Different values of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BC;</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BC;</span></span></span></span> result in the variants of the schemes: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BC;</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\mu=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BC;</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span> for spherical AL method, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BC;</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mu=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BC;</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span> for cylindrical AL method, and the most general, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BC;</mi><mo>&gt;</mo><mn>0</mn><mo separator="true">,</mo><mi>&#x3BC;</mi><mo>&#x2260;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\mu&gt;0,\mu\neq 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.716em;"></span><span class="strut bottom" style="height:0.9309999999999999em;vertical-align:-0.215em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BC;</span><span class="mrel">&gt;</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathit">&#x3BC;</span><span class="mrel">&#x2260;</span><span class="mord mathrm">1</span></span></span></span> for elliptical AL method.</p>
<p>For the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">N+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span> formulation, the AL constraint is rewritten as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mn>1</mn><mi>T</mi></msubsup><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>i</mi></msub><mo>+</mo><mi>&#x3BC;</mi><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mn>1</mn></msub><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mi>i</mi></msub><mo>=</mo><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mi>s</mi></mrow><mi>i</mi><mn>2</mn></msubsup></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\Delta\mathbf{u}}_1^T{\Delta\mathbf{u}}_i + \mu{\Delta\lambda}_1{\Delta\lambda}_i = {\Delta s}_i^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.138331em;vertical-align:-0.247em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3BC;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">s</span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>s</mi></mrow><mn>1</mn></msub><mo>=</mo><mrow><mi mathvariant="normal">&#x394;</mi><mi>s</mi></mrow></mrow><annotation encoding="application/x-tex">{\Delta s}_1={\Delta s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">s</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">s</span></span></span></span></span> the prescribed AL and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>s</mi></mrow><mi>i</mi></msub><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mi>i</mi><mo>&#x2265;</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">{\Delta s}_i=0,i\geq 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">s</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mrel">&#x2265;</span><span class="mord mathrm">2</span></span></span></span>. The coefficients <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{c}}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">H_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are then determined accordingly. The final expression for load increments is the following, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mi>i</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mo>&#xB1;</mo><mfrac><mrow><mrow><mi mathvariant="normal">&#x394;</mi><mi>s</mi></mrow></mrow><mrow><msqrt><mrow><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow></msub><mo>+</mo><mi>&#x3BC;</mi></mrow></msqrt></mrow></mfrac><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mspace width="1em"></mspace><mi>i</mi><mo>=</mo><mn>1</mn></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x2212;</mo><mfrac><mrow><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>g</mi><mi>i</mi></mrow></msub></mrow><mrow><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mi>i</mi></mrow></msub><mo>+</mo><mi>&#x3BC;</mi><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mn>1</mn></msub></mrow></mfrac><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mspace width="1em"></mspace><mi>i</mi><mo>&#x2265;</mo><mn>2</mn></mrow></mtd></mtr></mtable></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\Delta\lambda}_i = \left\{
\begin{array}{ll}
\pm\frac{ {\Delta s}}{ \sqrt{ {\Delta\mathbf{u}}_{f1}^T{\Delta\mathbf{u}}_{f1}+\mu}}, &amp;\quad i=1 \\
-\frac{ {\Delta\mathbf{u}}_{f1}^T{\Delta\mathbf{u}}_{gi}}{ {\Delta\mathbf{u}}_{f1}^T{\Delta\mathbf{u}}_{fi}+\mu{\Delta\lambda}_1}, &amp;\quad i\geq 2
\end{array}
\right.
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:3.195722em;"></span><span class="strut bottom" style="height:5.891444em;vertical-align:-2.695722em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:1.5500099999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23A9;</span></span></span><span style="top:1.5500099999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:1.2500099999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:0.9500099999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:-0.000010000000000287557em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23A8;</span></span></span><span style="top:-1.1500100000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:-1.4500100000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:-1.7500100000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:-2.0500200000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23A7;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-1.835392em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">&#xB1;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:1.0678675000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord sqrt"><span class="sqrt-sign" style="top:0.01213249999999988em;"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size2">&#x221A;</span></span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.3013079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.3448em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord mathit">&#x3BC;</span></span></span><span style="top:-1.0978675em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">s</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mpunct">,</span></span></span><span style="top:1.545175em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.7131310000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.3013079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.3448em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord mathit">&#x3BC;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.8092159999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-1.835392em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit">i</span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span><span style="top:1.545175em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit">i</span></span><span class="mrel">&#x2265;</span><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p>
<p>A noteworthy issue of the above scheme is that the sign of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{\Delta\lambda}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is unspecified. One way to determine the sign is to pick the new increment that is &#x201C;closest to&#x201D; the previous solution, as discussed in <a href="https://scholar.harvard.edu/files/vasios/files/ArcLength.pdf" target="_blank" rel="noopener">this document</a>. Another way to overcome the issue of direction determination is the linearization of the AL scheme, which replaces the AL constraint with a normal plane constraint.</p>
<h3 id="generalized-displacement-control-scheme">Generalized displacement control scheme</h3>
<p>The <a href="https://arc.aiaa.org/doi/pdf/10.2514/3.10529" target="_blank" rel="noopener">Yang1990</a> scheme is another scheme that bears a similar geometrical interpretation like the linearized AL scheme. Yet, initially, its derivation was to ensure the numerical stability of the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">N+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span> dimensional space solution. A generalized stiffness parameter GSP is proposed, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>G</mi><mi>S</mi><mi>P</mi><mo>=</mo><mfrac><mrow><mo>(</mo><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>f</mi><mn>0</mn></msubsup><msup><mo>)</mo><mi>T</mi></msup><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>f</mi><mn>0</mn></msubsup></mrow><mrow><mo>(</mo><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow><mn>0</mn></msubsup><msup><mo>)</mo><mi>T</mi></msup><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow></msub></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
GSP = \frac{ ({\Delta\mathbf{u}}_f^0)^T{\Delta\mathbf{u}}_f^0}{ ({\Delta\mathbf{u}}_{f1}^0)^T{\Delta\mathbf{u}}_{f1}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.650547em;"></span><span class="strut bottom" style="height:2.773963em;vertical-align:-1.123416em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">G</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.05764em;">S</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.13889em;">P</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mopen">(</span><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.3013079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.3448em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.8092159999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>f</mi><mn>0</mn></msubsup></mrow><annotation encoding="application/x-tex">{\Delta\mathbf{u}}_f^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is the first iteration from the first increment and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow><mn>0</mn></msubsup></mrow><annotation encoding="application/x-tex">{\Delta\mathbf{u}}_{f1}^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is the first iteration from the previous increment. At the first increment, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>f</mi><mn>0</mn></msubsup><mo>=</mo><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow><mn>0</mn></msubsup></mrow><annotation encoding="application/x-tex">{\Delta\mathbf{u}}_f^0={\Delta\mathbf{u}}_{f1}^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. Initially <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mi>S</mi><mi>P</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">GSP=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span> and GSP increases/decreases as the structure stiffens/softens. A negative value of GSP means that the equilibrium path passed the load limit point and the load direction should be reversed. Refer to Figure 2 in [Yang1990] for a geometrical illustration of the effect of GSP.</p>
<p>The introduction of GSP leads to the following definition of the load increment, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mi>i</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mi>s</mi><mi>g</mi><mi>n</mi><mrow><mi mathvariant="normal">&#x394;</mi><mi>s</mi></mrow><msqrt><mrow><mi mathvariant="normal">&#x2223;</mi><mi>G</mi><mi>S</mi><mi>P</mi><mi mathvariant="normal">&#x2223;</mi></mrow></msqrt><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mspace width="1em"></mspace><mi>i</mi><mo>=</mo><mn>1</mn></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x2212;</mo><mfrac><mrow><mo>(</mo><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow><mn>0</mn></msubsup><msup><mo>)</mo><mi>T</mi></msup><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>g</mi><mi>i</mi></mrow></msub></mrow><mrow><mo>(</mo><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow><mn>0</mn></msubsup><msup><mo>)</mo><mi>T</mi></msup><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mi>i</mi></mrow></msub></mrow></mfrac><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mspace width="1em"></mspace><mi>i</mi><mo>&#x2265;</mo><mn>2</mn></mrow></mtd></mtr></mtable></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\Delta\lambda}_i = \left\{
\begin{array}{ll}
sgn{\Delta s}\sqrt{ |GSP|}, &amp;\quad i=1 \\
-\frac{ ({\Delta\mathbf{u}}_{f1}^0)^T{\Delta\mathbf{u}}_{gi}}{ ({\Delta\mathbf{u}}_{f1}^0)^T{\Delta\mathbf{u}}_{fi}}, &amp;\quad i\geq 2
\end{array}
\right.
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.35002em;"></span><span class="strut bottom" style="height:4.2000399999999996em;vertical-align:-1.8500199999999998em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9500099999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23A9;</span></span></span><span style="top:0.9500099999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:-0.000010000000000287557em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23A8;</span></span></span><span style="top:-1.1500100000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:-1.4500200000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23A7;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-1.3250414999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">n</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">s</span></span><span class="mord sqrt"><span class="sqrt-sign" style="top:-0.09388000000000007em;"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">&#x221A;</span></span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathrm">&#x2223;</span><span class="mord mathit">G</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathrm">&#x2223;</span></span></span><span style="top:-0.90388em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mpunct">,</span></span></span><span style="top:0.6855054999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mopen">(</span><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.3013079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.3448em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.8092159999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-1.3250414999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit">i</span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span><span style="top:0.6855054999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit">i</span></span><span class="mrel">&#x2265;</span><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>g</mi><mi>n</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">.</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">sgn=1.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">n</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span></span></span></span> and its sign changes whenever GSP becomes negative - and thus the load direction is automatically reversed at load limit point.</p>
<h1 id="application-to-geometrically-nonlinear-truss">Application to geometrically nonlinear truss</h1>
<h2 id="formulation">Formulation</h2>
<p>For the geometrically nonlinear truss, the energy between one pair of points is, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>E</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><mfrac><mrow><mi>k</mi></mrow><mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi></mrow></mfrac><mo>(</mo><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><msup><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><mo>&#x2212;</mo><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><msup><mo>)</mo><mn>2</mn></msup></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
E_i = \frac{1}{2} \frac{k}{||{\mathbf{l}}||} (||{\mathbf{l}}&apos;|| - ||{\mathbf{l}}||)^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.30744em;vertical-align:-0.936em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">l</span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">l</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">l</span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>2</mn></mrow></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{l}}={\mathbf{x}}_{i2}-{\mathbf{x}}_{i1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">l</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>2</mn></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msubsup><mo>&#x2212;</mo><msubsup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>1</mn></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">{\mathbf{l}}&apos;={\mathbf{x}}_{i2}&apos;-{\mathbf{x}}_{i1}&apos;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.010556em;vertical-align:-0.258664em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">l</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.258664em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">2</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.258664em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, and superscript &#x2019; means new states of the points. The gradient and the Jacobian of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>E</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">E_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> only depend on <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>i</mi><mi>T</mi></msubsup><mo>=</mo><mo>[</mo><msubsup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>1</mn></mrow><mi>T</mi></msubsup><mo separator="true">,</mo><msubsup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>2</mn></mrow><mi>T</mi></msubsup><mo>]</mo></mrow><annotation encoding="application/x-tex">{\mathbf{u}}_i^T=[{\mathbf{x}}_{i1}^T,{\mathbf{x}}_{i2}^T]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.0999949999999998em;vertical-align:-0.258664em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.258664em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mopen">[</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.258664em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.258664em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">2</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">]</span></span></span></span>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mi>E</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>i</mi></msub></mrow></mfrac></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mi>k</mi><mn>1</mn></msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><msup><mi mathvariant="normal">&#x2202;</mi><mn>2</mn></msup><msub><mi>E</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msubsup><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mi>k</mi><mn>1</mn></msub><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mi>I</mi></mrow></mtd><mtd><mrow><mo>&#x2212;</mo><mi>I</mi></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x2212;</mo><mi>I</mi></mrow></mtd><mtd><mrow><mi>I</mi></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>T</mi></msup></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\frac{\partial E_i}{\partial {\mathbf{u}}_i}} &amp;= k_1 {\mathbf{L}}\\
\frac{ \partial^2 E_i}{ \partial {\mathbf{u}}_i^2} &amp;= k_1
\begin{bmatrix}
I &amp; -I \\ -I &amp; I
\end{bmatrix}
+ k_2 {\mathbf{L}}{\mathbf{L}}^T
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.580706em;"></span><span class="strut bottom" style="height:4.661412em;vertical-align:-2.080706em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.2092660000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><span style="top:1.1178420000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.6859999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.27686399999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.34480000000000005em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.2092660000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span></span></span><span style="top:1.1178420000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">&#x2212;</span><span class="mord mathit" style="margin-right:0.07847em;">I</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">&#x2212;</span><span class="mord mathit" style="margin-right:0.07847em;">I</span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>T</mi></msup></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mo>[</mo><mo>&#x2212;</mo><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><msup><mo>)</mo><mi>T</mi></msup><mo separator="true">,</mo><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><msup><mo>)</mo><mi>T</mi></msup><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>k</mi><mn>1</mn></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi>k</mi></mrow><mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi></mrow></mfrac><mrow><mo fence="true">(</mo><mn>1</mn><mo>&#x2212;</mo><mfrac><mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi></mrow><mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><msup><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>k</mi><mn>2</mn></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi>k</mi></mrow><mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><msup><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mi mathvariant="normal">&#x2223;</mi><msup><mi mathvariant="normal">&#x2223;</mi><mn>3</mn></msup></mrow></mfrac></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\mathbf{L}}^T &amp;= [-({\mathbf{l}}&apos;)^T, ({\mathbf{l}}&apos;)^T] \\
k_1 &amp;= \frac{k}{||{\mathbf{l}}||} \left(1 - \frac{||{\mathbf{l}}||}{||{\mathbf{l}}&apos;||}\right) \\
k_2 &amp;= \frac{k}{||{\mathbf{l}}&apos;||^3}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:3.2294004999999997em;"></span><span class="strut bottom" style="height:5.958800999999999em;vertical-align:-2.7294004999999997em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-2.3380694999999996em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.5280695000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:1.7934004999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-2.3380694999999996em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mopen">[</span><span class="mord">&#x2212;</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">l</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">l</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">]</span></span></span><span style="top:-0.5280695000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">l</span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord mathrm">1</span><span class="mbin">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">l</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">l</span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:1.7934004999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">l</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord mathrm">&#x2223;</span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">3</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> The gradient and Jacobian of the whole system are assembled from those of the point pairs.</p>
<h2 id="case-study">Case study</h2>
<p>The star dome 24-bar truss is a typical problem that contains various nonlinear behaviors. The description of the problem can be found <a href="https://www.researchgate.net/figure/a-Star-Dome-Space-Truss-with-24-bars-and-b-Equilibrium-paths_fig5_324993551" target="_blank" rel="noopener">here</a>. The star dome is loaded at the center and experiences several load and displacement limit points during the loading process. The initial configuration (red dot-dashed line) and several typical deformation are shown in Figure 1. The displacement-load curve of the center node is presented in Figure 2.</p>
<figure float="left">
<img src="sd0.png" width="350px"> <img src="sd1.png" width="350px"> <img src="sd2.png" width="350px"> <img src="sd3.png" width="350px">
<figcaption>
Figure 1.
</figcaption>
</figure>
<figure float="left">
<img src="ld.png" width="500px">
<figcaption>
Figure 2. y-axis is the vertical force.
</figcaption>
</figure>
]]></content>
      
        <categories>
            
            <category> digest </category>
            
        </categories>
        
        
        <tags>
            
            <tag> optimization </tag>
            
            <tag> mechanics </tag>
            
            <tag> numerical </tag>
            
            <tag> solver </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Bayesian Optimization]]></title>
      <url>http://smanist.github.io/2018/06/12/Bayesian-optimization/</url>
      <content type="html"><![CDATA[<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css"><p>How to solve an optimization problem when the objective function and/or the constraints are expensive/impossible to compute?</p>
<a id="more"></a>
<h1 id="introduction">Introduction</h1>
<h2 id="the-problem">The problem</h2>
<p>The objective function is expensive to compute when it is, for example, the lift-to-drag ratio of an aircraft wing using a computational fluid dynamics (CFD) solver, or nonlinear deformation of composite structure using a finite element (FE) solver. The objective function is impossible to compute when it is, for example, data obtained from experiments.</p>
<p>The optimization problem is written formally as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi><mspace width="0.16667em"></mspace><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></msub></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mi>J</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo separator="true">;</mo><mrow><mrow><mi mathvariant="bold">U</mi></mrow></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">.</mi></mrow></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>E</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo separator="true">;</mo><mrow><mrow><mi mathvariant="bold">U</mi></mrow></mrow><mo>)</mo><mo>=</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>I</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo separator="true">;</mo><mrow><mrow><mi mathvariant="bold">U</mi></mrow></mrow><mo>)</mo><mo>&#x2265;</mo><mn>0</mn></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
    {\mathrm{arg\,min}}_{\mathbf{d}}&amp;\quad J({\mathbf{d}};{\mathbf{U}}) \\
    {\mathrm{s.t.}}&amp;\quad {\mathbf{c}}_E({\mathbf{d}};{\mathbf{U}}) = 0 \\
                &amp;\quad {\mathbf{c}}_I({\mathbf{d}};{\mathbf{U}}) \ge 0
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.05em;"></span><span class="strut bottom" style="height:3.6000000000000005em;vertical-align:-1.5500000000000007em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.2099999999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm"><span class="mspace thinspace"></span><span class="mord mathrm">m</span></span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">d</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.00999999999999951em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">s</span><span class="mord mathrm">.</span><span class="mord mathrm">t</span><span class="mord mathrm">.</span></span></span></span></span><span style="top:1.1900000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.2099999999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.09618em;">J</span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mpunct">;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">U</span></span></span><span class="mclose">)</span></span></span><span style="top:-0.00999999999999951em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mpunct">;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">U</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span><span style="top:1.1900000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mpunct">;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">U</span></span></span><span class="mclose">)</span><span class="mrel">&#x2265;</span><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{d}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span></span></span></span> is the vector of design variables, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>E</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{c}}_E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>I</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{c}}_I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are the aggregated equality and inequality constraint functions, respectively. The state variables <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">U</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{U}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">U</span></span></span></span></span></span> are those implicitly involved in the evaluation of the objective and constraint functions. Examples of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">U</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{U}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">U</span></span></span></span></span></span> are the flow variables in a CFD solver or the displacement field in the structural FE solver.</p>
<p>In above cases, in order to solve the optimization problem during a practical time period, the number of evaluation of the objective function has to be limited in the optimization algorithm. There are two limitations on the optimization algorithm: (1) The design space cannot be explored by carrying out numerous <em>direct</em> evaluation of the objective function; (2) The derivative of the objective function w.r.t. design variables cannot be computed using the finite difference approach. These limitations prevent the direct application of any gradient-free or gradient-based algorithms to the optimization problem.</p>
<h2 id="surrogate-based-optimization">Surrogate-based optimization</h2>
<p>To overcome the limitations, one approach is to use surrogate-based optimization (SBO). The SBO algorithms typically contain two key ingredients, a surrogate model and an acquisition function. The surrogate model is employed to approximate the expensive objective function. Since the surrogate is computationally efficient, it allows for fast evaluation of approximated objective function as well as its derivative w.r.t. the design variables. The acquisition function is a criterion for selecting the points in the design space that is potentially a solution to the optimization problem. The acquisition function is designed to take into account of both <em>exploration</em>, i.e.&#xA0;sampling from areas of high uncertainty, and <em>exploitation</em>, i.e.&#xA0;sampling from areas likely to contain the minimizer of the objective function.</p>
<p>The general procedure of SBO is as follows,</p>
<ol style="list-style-type: decimal">
<li>Step 1: Generate a sample data set <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">D</mi></mrow></mrow><mo>=</mo><mo>{</mo><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>J</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mrow><mi>E</mi><mi>i</mi></mrow></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mrow><mi>I</mi><mi>i</mi></mrow></msub><mo>)</mo><msubsup><mo>}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><msub><mi>N</mi><mi>s</mi></msub></mrow></msubsup></mrow><annotation encoding="application/x-tex">{\mathcal{D}}=\{({\mathbf{d}}_i, J_i, {\mathbf{c}}_{Ei}, {\mathbf{c}}_{Ii})\}_{i=1}^{N_s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9232309999999999em;"></span><span class="strut bottom" style="height:1.200095em;vertical-align:-0.276864em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.02778em;">D</span></span></span><span class="mrel">=</span><span class="mopen">{</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.09618em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist"><span style="top:0.276864em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.44489999999999996em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.10903em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> by evaluating the objective and constraint functions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>J</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mrow><mi>E</mi><mi>i</mi></mrow></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mrow><mi>I</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">J_i, {\mathbf{c}}_{Ei}, {\mathbf{c}}_{Ii}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.09618em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> at a few sample points <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{d}}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> in the design space.</li>
<li>Step 2: Generate surrogates <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>J</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msup><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">J^{sur}({\mathbf{d}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>E</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msubsup><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">{\mathbf{c}}_E^{sur}({\mathbf{d}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.025331em;vertical-align:-0.275331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.275331em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>I</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msubsup><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">{\mathbf{c}}_I^{sur}({\mathbf{d}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.025331em;vertical-align:-0.275331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.275331em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose">)</span></span></span></span> using the sample data set <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">D</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{D}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.02778em;">D</span></span></span></span></span></span>.</li>
<li>Step 3: Find the design point <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">{\mathbf{d}}^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> by solving an optimization problem that consists of the surrogates and acquisition function.</li>
<li>Step 4: Evaluate the objective and constraint functions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>J</mi><mo>&#x2217;</mo></msup><mo separator="true">,</mo><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>E</mi><mo>&#x2217;</mo></msubsup><mo separator="true">,</mo><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>I</mi><mo>&#x2217;</mo></msubsup></mrow><annotation encoding="application/x-tex">J^*, {\mathbf{c}}_E^*, {\mathbf{c}}_I^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.688696em;"></span><span class="strut bottom" style="height:0.939723em;vertical-align:-0.251027em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.251027em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.251027em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> at the new design point <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">{\mathbf{d}}^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>.</li>
<li>Step 5: Update the surrogate using the sample data set augmented with the new design point <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="script">D</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>=</mo><mrow><mrow><mi mathvariant="script">D</mi></mrow></mrow><mo>&#x222A;</mo><mo>{</mo><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo separator="true">,</mo><msup><mi>J</mi><mo>&#x2217;</mo></msup><mo separator="true">,</mo><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>E</mi><mo>&#x2217;</mo></msubsup><mo separator="true">,</mo><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>I</mi><mo>&#x2217;</mo></msubsup><mo>)</mo><mo>}</mo></mrow><annotation encoding="application/x-tex">{\mathcal{D}}^*={\mathcal{D}}\cup \{({\mathbf{d}}^*,J^*,{\mathbf{c}}_E^*,{\mathbf{c}}_I^*)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.0010270000000001em;vertical-align:-0.251027em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.02778em;">D</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.02778em;">D</span></span></span><span class="mbin">&#x222A;</span><span class="mopen">{</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.251027em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.251027em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mclose">}</span></span></span></span>.</li>
<li>Step 6: Repeat steps 3-5 until the convergence or stopping conditions are reached.</li>
</ol>
<p>One category of SBO is the one-shot approach, which only contains steps 1-4. In the one-shot approach, the acquisition function is the surrogate itself. The issue is that the initial sample set does not necessarily represent well the distribution of the objective function over the whole design space. As a result, the optimal solution found by the algorithm may be far off from the true value of objective function. The other category of SBO is the updating approach that, of course, contains all the six steps. This is the category where the Bayesian optimization lies.</p>
<h1 id="bayesian-optimization">Bayesian optimization</h1>
<h2 id="concepts">Concepts</h2>
<p>Bayesian optimization (BO) is essentially the six-step SBO procedure with a statistical interpretation. Adapted from <a href="https://en.wikipedia.org/wiki/Bayesian_optimization" target="_blank" rel="noopener">wikipedia</a>: The expensive function is treated as a random function with a prior distribution, which captures the beliefs about the behavior of the function. The prior distribution is updated using the data set to form the the posterior distribution over the objective function. The posterior distribution is used to construct an acquisition function that determines the next design point.</p>
<p>The two precursors of BO are <a href="http://fluidsengineering.asmedigitalcollection.asme.org/article.aspx?articleid=1431594" target="_blank" rel="noopener">Kushner1964</a> and <a href="https://link.springer.com/chapter/10.1007%2F978-3-662-38527-2_55" target="_blank" rel="noopener">Mockus1975</a>. A good review of BO is provided in <a href="https://arxiv.org/abs/1012.2599" target="_blank" rel="noopener">Brochu2010</a>. The Gaussian process regression (GPR) model is a popular choice for the surrogate model in BO. Some outstanding the GPR-based BO algorithms include, but not limited to,</p>
<ol style="list-style-type: decimal">
<li>BayesOpt: <a href="https://github.com/rmcantin/bayesopt" target="_blank" rel="noopener">code</a>, <a href="https://rmcantin.bitbucket.io/html/" target="_blank" rel="noopener">doc</a>, <a href="https://arxiv.org/abs/1405.7430" target="_blank" rel="noopener">paper</a>.</li>
<li>HIPS/spearmint: <a href="https://github.com/HIPS/Spearmint" target="_blank" rel="noopener">code</a>.</li>
<li>GPyOpt: <a href="https://github.com/SheffieldML/GPyOpt" target="_blank" rel="noopener">code</a>, <a href="http://sheffieldml.github.io/GPyOpt/" target="_blank" rel="noopener">doc</a></li>
<li>GPflowOpt: <a href="https://github.com/GPflow/GPflowOpt" target="_blank" rel="noopener">code</a>, <a href="https://gpflowopt.readthedocs.io/en/latest/" target="_blank" rel="noopener">doc</a>, <a href="https://arxiv.org/abs/1711.03845" target="_blank" rel="noopener">paper</a></li>
</ol>
<p>Besides GPR, there are BO algorithms using other surrogate models, such as those in SMAC (<a href="http://www.cs.ubc.ca/labs/beta/Projects/SMAC/" target="_blank" rel="noopener">code</a>, <a href="https://www.cs.ubc.ca/~hutter/papers/10-TR-SMAC.pdf" target="_blank" rel="noopener">paper</a>). A list of implementations of BO is provided <a href="https://rmcantin.bitbucket.io/html/relsoft.html" target="_blank" rel="noopener">here</a>. Finally, note that in the engineering community, the BO algorithm tends to appear by the name efficient global optimization (EGO) algorithm <a href="https://link.springer.com/article/10.1023/A:1008306431147" target="_blank" rel="noopener">Jones1998</a>, <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.2.4697&amp;rep=rep1&amp;type=pdf" target="_blank" rel="noopener">Sasena2002</a>.</p>
<p>Next, the key components of BO, the surrogate model and the acquisition function, as well as the treatment of constraints will be discussed.</p>
<h2 id="surrogate-model">Surrogate model</h2>
<p>In this and the following sections, the discussion will be based on the GPR model. The prediction of the GPR model at a new design point <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">{\mathbf{d}}^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> follows a Gaussian probability distribution, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msup><mi>J</mi><mo>&#x2217;</mo></msup><mo>=</mo><msup><mi>J</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msup><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo>&#x223C;</mo><mrow><mrow><mi mathvariant="script">N</mi></mrow></mrow><mo>(</mo><mi>&#x3BC;</mi><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo separator="true">,</mo><mrow><msup><mi>&#x3C3;</mi><mn>2</mn></msup></mrow><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo>)</mo><mo separator="true">,</mo><mspace width="1em"></mspace><mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi></mrow><mspace width="1em"></mspace><mi>P</mi><mo>(</mo><msup><mi>J</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msup><mo>=</mo><msup><mi>J</mi><mo>&#x2217;</mo></msup><mo>)</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><msqrt><mrow><mn>2</mn><mi>&#x3C0;</mi><mrow><msup><mi>&#x3C3;</mi><mn>2</mn></msup></mrow></mrow></msqrt></mrow></mfrac><mi>exp</mi><mrow><mo fence="true">(</mo><mo>&#x2212;</mo><mfrac><mrow><mo>(</mo><msup><mi>J</mi><mo>&#x2217;</mo></msup><mo>&#x2212;</mo><mi>&#x3BC;</mi><msup><mo>)</mo><mn>2</mn></msup></mrow><mrow><mn>2</mn><mrow><msup><mi>&#x3C3;</mi><mn>2</mn></msup></mrow></mrow></mfrac><mo fence="true">)</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
J^* = J^{sur}({\mathbf{d}}^*) \sim {\mathcal{N}}(\mu({\mathbf{d}}^*), {\sigma^2}({\mathbf{d}}^*)),\quad\mathrm{or}\quad P(J^{sur}=J^*)=\frac{1}{\sqrt{2\pi{\sigma^2}}}\exp\left(-\frac{(J^*-\mu)^2}{2{\sigma^2}}\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.491108em;"></span><span class="strut bottom" style="height:2.441138em;vertical-align:-0.95003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x223C;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3BC;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathrm">o</span><span class="mord mathrm">r</span></span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.13889em;">P</span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.8450540000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord sqrt"><span class="sqrt-sign" style="top:-0.11505399999999999em;"><span class="style-wrap reset-textstyle textstyle uncramped">&#x221A;</span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord mathrm">2</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.875054em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop reset-textstyle displaystyle textstyle uncramped">exp</span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord mathit">&#x3BC;</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BC;</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BC;</span></span></span></span> is the predicted value of objective function and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msup><mi>&#x3C3;</mi><mn>2</mn></msup></mrow></mrow><annotation encoding="application/x-tex">{\sigma^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> is the variance, i.e.&#xA0;the uncertainty of the prediction. The details of GPR models have been discussed in the previous articles and will be skipped.</p>
<h2 id="acquisition-function-for-unconstrained-optimization">Acquisition function for unconstrained optimization</h2>
<p>The BO is initially developed for unconstrained problems. Surveys of acquisition functions for such problems can be found in, for example, [Sasena2002] and <a href="https://dash.harvard.edu/handle/1/17467236" target="_blank" rel="noopener">Gelbart2015</a>. There are three basic acquisition functions: (1) Probability Improvement (PI) [Kushner1964], (2) Expected Improvement (EI) <a href="https://link.springer.com/article/10.1007/BF01099263" target="_blank" rel="noopener">Mockus1994</a>, <a href="http://www.csd.uwo.ca/~dlizotte/publications/lizotte_phd_thesis.pdf" target="_blank" rel="noopener">Lizotte2008</a>, (3) Lower Confidence Bound (LCB) <a href="https://ieeexplore.ieee.org/document/271617/" target="_blank" rel="noopener">Cox1992</a>. Besides the basic ones, there are acquisition functions based on Thompson Sampling and the information theory (entropy). In general, it appears that the acquisition functions are evolving towards (1) finding multiple candidate points in one iteration, (2) taking advantage of parallel computing via techniques like asynchronization. Nonetheless, this article will focus only on the three basic acquisition functions.</p>
<h3 id="pi">PI</h3>
<p>Defined as the probability of the new design point <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">{\mathbf{d}}^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> to offer a better value of the objective function <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>J</mi><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">J^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.688696em;"></span><span class="strut bottom" style="height:0.688696em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> than the minimum objective function in the sample data set <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>J</mi><mrow><mi>min</mi></mrow></msub><mo>=</mo><mi>min</mi><mo>{</mo><msub><mi>J</mi><mi>i</mi></msub><mo>}</mo></mrow><annotation encoding="application/x-tex">J_{\min}=\min\{J_i\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.09618em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mop mtight">min</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mop">min</span><span class="mopen">{</span><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.09618em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">}</span></span></span></span>. <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>C</mi><mrow><mi>P</mi><mi>I</mi></mrow></msub><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><msup><mi>J</mi><mo>&#x2217;</mo></msup><mo>&#x2264;</mo><msub><mi>J</mi><mrow><mi>min</mi></mrow></msub><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
C_{PI}({\mathbf{d}}^*) = P(J^*\le J_{\min})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">P</span><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.13889em;">P</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2264;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.09618em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mop mtight">min</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span></p>
<h3 id="ei">EI</h3>
<p>Defined as the expectation of the improvement in the objective function at the new design point. In the literature, EI has been generalized to include user-specified parameters that control the exploitation-exploration trade-off. The generalized EI is written as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>C</mi><mrow><mi>E</mi><mi>I</mi></mrow></msub><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo>=</mo><mrow><mrow><mi mathvariant="double-struck">E</mi></mrow></mrow><mo>[</mo><mi>I</mi><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo>]</mo><mo separator="true">,</mo><mspace width="1em"></mspace><mi>I</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo><mo>=</mo><mi>max</mi><mo>(</mo><mn>0</mn><mo separator="true">,</mo><mo>(</mo><msub><mi>J</mi><mrow><mi>min</mi></mrow></msub><mo>&#x2212;</mo><msup><mi>J</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msup><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo><mo>&#x2212;</mo><mi>&#x3B6;</mi><mi>&#x3C3;</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo><msup><mo>)</mo><mi>g</mi></msup><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
C_{EI}({\mathbf{d}}^*) = {\mathbb{E}}[I({\mathbf{d}}^*)],\quad I({\mathbf{d}}) = \max(0,(J_{\min}-J^{sur}({\mathbf{d}})-\zeta\sigma({\mathbf{d}}))^g)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbb">E</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.07847em;">I</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">]</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.07847em;">I</span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop reset-textstyle displaystyle textstyle uncramped">max</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">0</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.09618em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mop mtight">min</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.07378em;">&#x3B6;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03588em;">&#x3C3;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B6;</mi><mo>&#x2265;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\zeta\ge 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07378em;">&#x3B6;</span><span class="mrel">&#x2265;</span><span class="mord mathrm">0</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>&#x2265;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">g\ge 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mrel">&#x2265;</span><span class="mord mathrm">1</span></span></span></span> are the user-specified parameters. The classical form of EI is obtained with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B6;</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\zeta=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07378em;">&#x3B6;</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">g=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span>. A larger <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span></span> or <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B6;</mi></mrow><annotation encoding="application/x-tex">\zeta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07378em;">&#x3B6;</span></span></span></span> will put more weight on the exploration. Note that when <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B6;</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\zeta=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07378em;">&#x3B6;</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">g=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>, EI reduces to PI. For a GPR model, the closed-form expression is available for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>E</mi><mi>I</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{EI}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. For the case <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">g=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mi>C</mi><mrow><mi>E</mi><mi>I</mi></mrow></msub><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msubsup><mo>&#x222B;</mo><mn>0</mn><mi mathvariant="normal">&#x221E;</mi></msubsup><mi>I</mi><mi>P</mi><mo>(</mo><msup><mi>J</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msup><mo>=</mo><msub><mi>J</mi><mrow><mi>min</mi></mrow></msub><mo>&#x2212;</mo><mi>&#x3B6;</mi><mi>&#x3C3;</mi><mo>&#x2212;</mo><mi>I</mi><mo>)</mo><mi>d</mi><mi>I</mi></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mi>&#x3C3;</mi><mo>[</mo><mi>z</mi><mi mathvariant="normal">&#x3A6;</mi><mo>(</mo><mi>z</mi><mo>)</mo><mo>+</mo><mi>&#x3D5;</mi><mo>(</mo><mi>z</mi><mo>)</mo><mo>]</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mspace width="1em"></mspace><mi>&#x3C3;</mi><mo>&gt;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mspace width="1em"></mspace><mi>&#x3C3;</mi><mo>=</mo><mn>0</mn></mrow></mtd></mtr></mtable></mrow></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
  C_{EI}({\mathbf{d}}^*) &amp;= \int_0^\infty I P(J^{sur}=J_{\min}-\zeta\sigma-I) dI \\
                &amp;=
  \left\{
  \begin{array}{ll}
    \sigma [z\Phi(z) + \phi(z)],&amp;\quad \sigma &gt; 0 \\
    0,&amp;\quad \sigma = 0
  \end{array}
  \right.
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.58614em;"></span><span class="strut bottom" style="height:4.67228em;vertical-align:-2.08614em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.2261399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:1.13611em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.2261399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;top:-0.0011249999999999316em;">&#x222B;</span><span class="msupsub"><span class="vlist"><span style="top:0.91225em;margin-left:-0.44445em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">0</span></span></span><span style="top:-0.9739999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x221E;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.09618em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mop mtight">min</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord mathit" style="margin-right:0.07378em;">&#x3B6;</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="mbin">&#x2212;</span><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mclose">)</span><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.07847em;">I</span></span></span><span style="top:1.13611em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">{</span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="mopen">[</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mord mathrm">&#x3A6;</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit">&#x3D5;</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mclose">]</span><span class="mpunct">,</span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">0</span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span></span><span class="mrel">&gt;</span><span class="mord mathrm">0</span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span></span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi><mo>=</mo><mfrac><mrow><msub><mi>J</mi><mrow><mi>min</mi></mrow></msub><mo>&#x2212;</mo><mi>&#x3B6;</mi><mi>&#x3C3;</mi><mo>&#x2212;</mo><mi>&#x3BC;</mi></mrow><mrow><mi>&#x3C3;</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">z=\frac{J_{\min}-\zeta\sigma-\mu}{\sigma}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9322159999999999em;"></span><span class="strut bottom" style="height:1.277216em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">&#x3C3;</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.44610799999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.09618em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mop mtight">min</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.07378em;">&#x3B6;</span><span class="mord mathit mtight" style="margin-right:0.03588em;">&#x3C3;</span><span class="mbin mtight">&#x2212;</span><span class="mord mathit mtight">&#x3BC;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span>, and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x3A6;</mi></mrow><annotation encoding="application/x-tex">\Phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x3A6;</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3D5;</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3D5;</span></span></span></span> are the cummulative distribution and probability density functions, respectively. The gradient of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>E</mi><mi>I</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{EI}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> w.r.t. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{d}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span></span></span></span> for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3C3;</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sigma&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="mrel">&gt;</span><span class="mord mathrm">0</span></span></span></span> is, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mi>C</mi><mrow><mi>E</mi><mi>I</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow></mfrac></mrow><mo>=</mo><mo>&#x2212;</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>&#x3BC;</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow></mfrac></mrow><mi mathvariant="normal">&#x3A6;</mi><mo>(</mo><mi>z</mi><mo>)</mo><mo>+</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>&#x3C3;</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow></mfrac></mrow><mo>[</mo><mi>&#x3D5;</mi><mo>(</mo><mi>z</mi><mo>)</mo><mo>&#x2212;</mo><mi>&#x3B6;</mi><mi mathvariant="normal">&#x3A6;</mi><mo>(</mo><mi>z</mi><mo>)</mo><mo>]</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\frac{\partial C_{EI}}{\partial {\mathbf{d}}}} = - {\frac{\partial \mu}{\partial {\mathbf{d}}}}\Phi(z) + {\frac{\partial \sigma}{\partial {\mathbf{d}}}}[\phi(z)-\zeta\Phi(z)]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">d</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">d</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathit">&#x3BC;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x3A6;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.04398em;">z</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">d</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3D5;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.04398em;">z</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.07378em;">&#x3B6;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x3A6;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.04398em;">z</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">]</span></span></span></span></span> where the computation of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>&#x3BC;</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex">{\frac{\partial \mu}{\partial {\mathbf{d}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9322159999999999em;"></span><span class="strut bottom" style="height:1.277216em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">d</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.44610799999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathit mtight">&#x3BC;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>&#x3C3;</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex">{\frac{\partial \sigma}{\partial {\mathbf{d}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8801079999999999em;"></span><span class="strut bottom" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">d</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathit mtight" style="margin-right:0.03588em;">&#x3C3;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> has been discussed in a previous <a href="https://smanist.github.io/2018/06/08/Gaussian-process-regressor-addendum/">article</a>.</p>
<p>For the case <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B6;</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\zeta=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07378em;">&#x3B6;</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>, refer to P. 64 of [Sasena2002].</p>
<h3 id="lcb">LCB</h3>
<p>Defined using the LCB concept, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>C</mi><mrow><mi>L</mi><mi>C</mi><mi>B</mi></mrow></msub><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo>=</mo><mi>&#x3BC;</mi><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo>&#x2212;</mo><mi>&#x3B6;</mi><mi>&#x3C3;</mi><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
C_{LCB}({\mathbf{d}}^*) = \mu({\mathbf{d}}^*) - \zeta\sigma({\mathbf{d}}^*)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">L</span><span class="mord mathit mtight" style="margin-right:0.07153em;">C</span><span class="mord mathit mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3BC;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.07378em;">&#x3B6;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03588em;">&#x3C3;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> where the probability of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>J</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msup><mo>&lt;</mo><msub><mi>C</mi><mrow><mi>L</mi><mi>C</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">J^{sur}&lt;C_{LCB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&lt;</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">L</span><span class="mord mathit mtight" style="margin-right:0.07153em;">C</span><span class="mord mathit mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is a constant controlled by the user-specified parameter <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B6;</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\zeta&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07378em;">&#x3B6;</span><span class="mrel">&gt;</span><span class="mord mathrm">0</span></span></span></span>. A larger <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B6;</mi></mrow><annotation encoding="application/x-tex">\zeta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07378em;">&#x3B6;</span></span></span></span> will put more weight on the exploration. The gradient of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>L</mi><mi>C</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{LCB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">L</span><span class="mord mathit mtight" style="margin-right:0.07153em;">C</span><span class="mord mathit mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> w.r.t. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{d}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span></span></span></span> is straight-forward.</p>
<h3 id="discussion">Discussion</h3>
<p>The PI acquisition function is purely exploitation, which is undesirable for global optimization. The EI and LCB acquisition functions are high when <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>J</mi><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">J^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.688696em;"></span><span class="strut bottom" style="height:0.688696em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> approaches the optimum point, or the uncertainty of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>J</mi><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">J^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.688696em;"></span><span class="strut bottom" style="height:0.688696em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is high. Therefore, both <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>E</mi><mi>I</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{EI}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>L</mi><mi>C</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{LCB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">L</span><span class="mord mathit mtight" style="margin-right:0.07153em;">C</span><span class="mord mathit mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> achieve a balance between exploitation and exploration.</p>
<p>The exploitation-exploration trade-off of EI and LCB functions can be further tuned by the cooling scheme. In the cooling scheme, the optimization starts with a large user-specified parameter for more exploration and gradually decreases the parameter to focus on exploitation. However, the effect of this scheme is controversial [Sasena2002] and [Brochu2010].</p>
<h2 id="treatment-of-constraints">Treatment of constraints</h2>
<p>The acquisition functions discussed in the previous section work well with optimization problems without constraints or with box constraints only. For more complex constraints, there are two types of treatments. The first type is the direct approach. As suggested in [Sasena2002], the objective and constraint functions are replaced with the surrogates, and the following problem is solved, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi><mspace width="0.16667em"></mspace><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></msub></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mi>C</mi><mo>(</mo><msup><mi>J</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msup><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">.</mi></mrow></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>E</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msubsup><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo><mo>=</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>I</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msubsup><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo><mo>&#x2265;</mo><mn>0</mn></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
    {\mathrm{arg\,min}}_{\mathbf{d}}&amp;\quad C(J^{sur}, {\mathbf{d}}) \\
    {\mathrm{s.t.}}&amp;\quad {\mathbf{c}}_E^{sur}({\mathbf{d}}) = 0 \\
                &amp;\quad {\mathbf{c}}_I^{sur}({\mathbf{d}}) \ge 0
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.05em;"></span><span class="strut bottom" style="height:3.6000000000000005em;vertical-align:-1.5500000000000007em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.2099999999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm"><span class="mspace thinspace"></span><span class="mord mathrm">m</span></span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">d</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.00999999999999951em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">s</span><span class="mord mathrm">.</span><span class="mord mathrm">t</span><span class="mord mathrm">.</span></span></span></span></span><span style="top:1.1900000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.2099999999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.07153em;">C</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose">)</span></span></span><span style="top:-0.00999999999999951em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span><span style="top:1.1900000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose">)</span><span class="mrel">&#x2265;</span><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> Similar to [Sasena2002] is the expected violation (EV) method <a href="https://arc.aiaa.org/doi/pdf/10.2514/6.2000-4891" target="_blank" rel="noopener">Audet2000</a>: The optimization is carried out by filling the design space using latin hypercube sampling and filtering out infeasible candidate points using the so-called EV function, which takes the same form of EI. Essentially, the constraint surrogates <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msup></mrow><annotation encoding="application/x-tex">{\mathbf{c}}^{sur}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.664392em;"></span><span class="strut bottom" style="height:0.664392em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are replaced by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>E</mi><mi>V</mi></mrow></msub><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msup><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">C_{EV}({\mathbf{c}}^{sur}, {\mathbf{d}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="mord mathit mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose">)</span></span></span></span>.</p>
<p>The other type is the indirect approach, which is further divided into two categories, as discussed in [Gelbart2015]. In the first category, the constrained problem is converted to an unconstrained one using classical (non-BO) methods. Three representative approaches are,</p>
<ol style="list-style-type: decimal">
<li>Barrier methods: The iterates are <em>prevented</em> from leaving the feasible region by augmenting the objective function with a barrier function, which causes the objective to grow to infinity at the boundary of the feasible region.</li>
<li>Penalty methods: The objective function is augmented with a penalty term, which <em>still allows</em> the iterates to leave the feasible region but the iterates become feasible as the penalty increases to infinity in the process of optimization.</li>
<li>Augmented Lagrangian methods: The problem is solved via the Lagrangian form augmented with the extra term in penalty methods, while the Lagrangian multipliers are controlled by the penalty parameters.</li>
</ol>
<p>In the second category of indirect approach, the acquisition function is modified to incorporate the constraint surrogates. two representative approaches are,</p>
<ol style="list-style-type: decimal">
<li>Modified EI methods: An example is the EI with constraints (EIC) <a href="https://www.jstor.org/stable/4356058" target="_blank" rel="noopener">Schonlau1998</a>. The EI for the objective function is augmented to take account of the constraints. In EIC, the EI is multiplied by the probability that the constraints are satisfied, so that the improvement (almost) only occurs at feasible candidate points.</li>
<li>Marginalization integral (MI) methods: Examples are integrated expected conditional improvement <a href="https://www.researchgate.net/publication/45913547_Optimization_Under_Unknown_Constraints" target="_blank" rel="noopener">Gramacy2011</a> and expected volume minimization <a href="http://proceedings.mlr.press/v33/picheny14.pdf" target="_blank" rel="noopener">Picheny2014</a>. The acqusition function at <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{d}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span></span></span></span> is defined using an integral over the whole design space, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>C</mi><mrow><mi>M</mi><mi>I</mi></mrow></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo><mo>=</mo><mo>&#x222B;</mo><mi>F</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo separator="true">,</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>)</mo><mi>h</mi><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>)</mo><mi>d</mi><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
C_{MI}({\mathbf{d}}) = \int F({\mathbf{d}},{\mathbf{d}}&apos;)h({\mathbf{d}}&apos;)d{\mathbf{d}}&apos;
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.36em;"></span><span class="strut bottom" style="height:2.22225em;vertical-align:-0.86225em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-symbol large-op reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.44445em;top:-0.0011249999999999316em;">&#x222B;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.13889em;">F</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">h</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">d</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo separator="true">,</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">F({\mathbf{d}},{\mathbf{d}}&apos;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> is a measure of improvement at <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow><annotation encoding="application/x-tex">{\mathbf{d}}&apos;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> given observation at <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{d}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">h({\mathbf{d}}&apos;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> is the probability that the constraints are satisfied at <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow><annotation encoding="application/x-tex">{\mathbf{d}}&apos;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. The maximizer of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>M</mi><mi>I</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{MI}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> provides the best <em>overall</em> improvement in the design space. The inclusion of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">h({\mathbf{d}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose">)</span></span></span></span> encourages picking candidate points likely to be feasible, while <em>still permits</em> the picking of points in infeasible region that may provide improvement over the whole design space.</li>
</ol>
<p>In terms of programming, the direct approach is probably the easiest one to implement. Particularly, the non-BO indirect approaches may be applied to solve the subproblems derived from the the direct approach, if standard packages for numerical optimization are employed. The challenge in the MI methods is the integration over the design space, which could be intractable in higher dimensions.</p>
<h2 id="miscellaneous-topics">Miscellaneous topics</h2>
<h3 id="choice-of-optimization-algorithms">Choice of optimization algorithms</h3>
<p>No matter which algorithm is used, eventually the BO process boils down to a series of non-convex optimization subproblems. It is hard to find the global optimum of a non-convex function. One choice is to use the evolutionary algorithms, or some so-called global algorithms like the DIRECT, which are claimed to be able to find the global optimum given sufficiently many iterations. Another choice is to apply the algorithms for convex optimization, especially the gradient-based ones, with multiple restarts.</p>
<p>I personally prefer the latter. Both choices <em>do not</em> guarantee the convergence to global optimum. The convergence rate of the former is much slower than the latter, especially in high-dimensional space. In practice, multiple restarts usually result in a good global sub-optimal point that is sufficient for the engineering purposes. A merit of the former, though, is that some algorithms can handle disjoint feasible regions.</p>
<h3 id="relearn-rate-of-the-surrogate">Relearn rate of the surrogate</h3>
<p>The training of the surrogates could become expensive as the number of samples increases. Also, contrary to intuition, updating the hyperparameters of the surrogate at every iteration may be unnecessary or even counterproductive <a href="http://www.jmlr.org/papers/v12/bull11a.html" target="_blank" rel="noopener">Bull2011</a>. A better strategy is to introduce a <em>relearn rate</em>: Update the sample data set in the surrogate every iteration, but update the hyperparameters every <em>few</em> iterations.</p>
<p>In practice, the effectiveness of this strategy depends on the quality of the surrogate implementation. If the current hyperparameters are far off from the converged values, keeping the current hyperparameters would reduce the convergence rate of the whole BO algorithm. As for the GPR model, the update of sample data set has been discussed in a previous <a href="https://smanist.github.io/2018/06/08/Gaussian-process-regressor-addendum/">article</a>.</p>
<h1 id="final-note">Final note</h1>
<p>To be fair, it is worth mentioning the existence of adjoint-based optimization. This methodology applies to optimization problems constrained by partial differential equations (PDEs). One can incorporate the <em>adjoint</em> capability in their PDE solver and enable the direct gradient calculation of the expensive objective and constraint functions. This approach applies to optimization problems involving CFD and FE solvers. The adjoint method would be a different (but interesting) story that I will discuss in future.</p>
]]></content>
      
        <categories>
            
            <category> digest </category>
            
        </categories>
        
        
        <tags>
            
            <tag> optimization </tag>
            
            <tag> kriging </tag>
            
            <tag> surrogate model </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Gaussian Process Regressor - Addendum]]></title>
      <url>http://smanist.github.io/2018/06/08/Gaussian-process-regressor-addendum/</url>
      <content type="html"><![CDATA[<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css"><p>A collection of extra topics as a sequel to the GPR series.</p>
<a id="more"></a>
<h1 id="updating-scheme">Updating scheme</h1>
<p>Consider a scenario where a GP model is trained using a large sample data set (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span> points). Recall from the <a href="https://smanist.github.io/2017/09/22/Gaussian-process-regressor-part-1/">first</a> and the <a href="https://smanist.github.io/2017/09/26/Gaussian-process-regressor-part-2/">second</a> articles, the training process determines the hyperparameters and generates a number of coefficient matrices for the efficient computation of the predictive mean and variance. Now suppose a few new samples (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">M</span></span></span></span> points, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mo>&#x226A;</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">M\ll N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mrel">&#x226A;</span><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span>) are to be appended to the data set. The question is, does one simply retrain the GP model?</p>
<p>Not necessarily. The new samples can reduce the prediction error and the overall uncertainty but may have limited effect on the hyperparameters. Therefore, with a few new samples, one can update the GP model by keeping the old hyperparameters and recomputing the coefficient matrices, including <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{L}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">F</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{Q}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">Q</span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{R}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">R</span></span></span></span></span></span>.</p>
<p>Strictly speaking, the addition of new samples will result in the recomputation of everything, even though the hyperparameters remain the same: The std and mean of the samples are modified, so is the correlation matrix <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{K}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span></span></span></span>, and so are the follow-up matrix decompositions. However, now that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mo>&#x226A;</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">M\ll N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mrel">&#x226A;</span><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span>, one can assume that the std and mean of the new sample data set are the same as those of the old one. As a result, the portion of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{K}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span></span></span></span> associated with the old sample data set remains the same, and the new coefficient matrices can be computed via <em>partial</em> matrix decompositions, which could save considerable amount of time - dropping from <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><msup><mi>N</mi><mn>3</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(N^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">3</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><msup><mi>N</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(N^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span>.</p>
<p>The new covariance matrix is <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub></mrow></mtd><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>n</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>n</mi><mi>s</mi></mrow></msub></mrow></mtd><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>n</mi><mi>n</mi></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{K}}= 
\begin{bmatrix}
{\mathbf{K}}_{ss} &amp; {\mathbf{K}}_{sn} \\
{\mathbf{K}}_{ns} &amp; {\mathbf{K}}_{nn}
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{K}}_{ss}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is the matrix associated with the old data set, whose Cholesky factor <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{L}}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is known. Matrices <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>n</mi><mi>s</mi></mrow></msub><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>n</mi></mrow><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">{\mathbf{K}}_{ns}={\mathbf{K}}_{sn}^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.088331em;vertical-align:-0.247em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>n</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{K}}_{nn}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are due to the new samples. The Cholesky factor <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{L}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span></span></span></span> of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{K}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span></span></span></span> is obtained via the following procedure of partial Cholesky decomposition,</p>
<ol style="list-style-type: decimal">
<li>Cholesky decomposition: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>n</mi><mi>n</mi></mrow></msub><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>n</mi></msub><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>n</mi><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">{\mathbf{K}}_{nn}={\mathbf{L}}_n{\mathbf{L}}_n^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.088331em;vertical-align:-0.247em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>.</li>
<li>Linear solve: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mi>s</mi><mi>n</mi></mrow></msub><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>s</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{L}}_{sn} = {\mathbf{L}}_s^{-1}{\mathbf{K}}_{sn}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></li>
<li>Assemble the Cholesky factor, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>s</mi></msub></mrow></mtd><mtd><mrow><mrow><mrow><mi mathvariant="bold">O</mi></mrow></mrow></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mi>s</mi><mi>n</mi></mrow><mi>T</mi></msubsup></mrow></mtd><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>n</mi></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{L}}= 
\begin{bmatrix}
{\mathbf{L}}_s &amp; {\mathbf{O}}\\
{\mathbf{L}}_{sn}^T &amp; {\mathbf{L}}_n
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.4756655em;"></span><span class="strut bottom" style="height:2.4513310000000006em;vertical-align:-0.9756655000000005em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6356655em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6156655000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-0.6356655em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">O</span></span></span></span></span><span style="top:0.6156655000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></li>
</ol>
<p>Next, the new <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">F</span></span></span></span></span></span> matrix is <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow><mo>=</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mo>=</mo><msup><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>s</mi></msub></mrow></mtd><mtd><mrow><mrow><mrow><mi mathvariant="bold">O</mi></mrow></mrow></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mi>s</mi><mi>n</mi></mrow><mi>T</mi></msubsup></mrow></mtd><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>n</mi></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>s</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>n</mi></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow><mi>s</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>n</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>n</mi></msub><mo>&#x2212;</mo><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mi>s</mi><mi>n</mi></mrow><mi>T</mi></msubsup><msub><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow><mi>s</mi></msub><mo>)</mo></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{F}}= {\mathbf{L}}^{-1}{\mathbf{H}}=
\begin{bmatrix}
{\mathbf{L}}_s &amp; {\mathbf{O}}\\
{\mathbf{L}}_{sn}^T &amp; {\mathbf{L}}_n
\end{bmatrix}^{-1}
\begin{bmatrix}
{\mathbf{H}}_s \\
{\mathbf{H}}_n
\end{bmatrix} =
\begin{bmatrix}
{\mathbf{F}}_s \\
{\mathbf{L}}_n^{-1} ({\mathbf{H}}_n - {\mathbf{L}}_{sn}^T{\mathbf{F}}_s)
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.5407735000000002em;"></span><span class="strut bottom" style="height:2.516439000000001em;vertical-align:-0.9756655000000005em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">F</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner reset-textstyle displaystyle textstyle uncramped"><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6356655em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6156655000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-0.6356655em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">O</span></span></span></span></span><span style="top:0.6156655000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-1.0896655000000002em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6356655em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6156655000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span> where <a href="https://en.wikipedia.org/wiki/Block_matrix#Block_matrix_inversion" target="_blank" rel="noopener">block matrix inversion</a> is used and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow><mi>s</mi></msub><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>s</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><msub><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{F}}_s={\mathbf{L}}_s^{-1}{\mathbf{H}}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is known from the old model.</p>
<p>Finally, since <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow><mi>s</mi></msub><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mi>s</mi></msub><msub><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{F}}_s={\mathbf{Q}}_s{\mathbf{R}}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">R</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is known, one can utilize the <a href="http://www.ams.org/journals/mcom/1976-30-136/S0025-5718-1976-0431641-8/" target="_blank" rel="noopener">QR update algorithm</a> to obtain the QR decomposition of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">F</span></span></span></span></span></span>. Such algorithm has been implemented in standard packages for scientific computation, such as <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.qr_insert.html" target="_blank" rel="noopener">scipy.linalg.qr_insert</a>.</p>
<p>With the new coefficient matices <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{L}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">F</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{Q}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">Q</span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{R}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">R</span></span></span></span></span></span>, the GP model is updated with the new sample data set.</p>
<h1 id="gradients">Gradients</h1>
<p>In some scenarios where a GP model is involved, the gradients of the mean and the variance w.r.t. the input are required. One example is the surrogate-based optimization, where the GP model is used as the surrogate and the gradient-based algorithm is chosen to find the optima. It is necessary to compute the gradient analytically (or using automatic differentiation), instead of using finite difference. The latter could destabilize the iterations of gradient descent near some &#x201C;singularity&#x201D; points at which the GP model is ill-defined.</p>
<p>Note that, in the trivial treatment of the multiple output case, the process variances <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_f^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> of the output are determined independently. Therefore, it is sufficient to consider the single output case. From the first <a href="https://smanist.github.io/2017/09/22/Gaussian-process-regressor-part-1/">article</a> of the GPR series, the mean and variance at a single point are, respectively, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mi>m</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msup><mrow><mover accent="true"><mrow><mi mathvariant="bold">g</mi></mrow><mo>&#xAF;</mo></mover></mrow><mi>T</mi></msup><mrow><msub><mrow><mi mathvariant="bold">k</mi></mrow><mi>u</mi></msub></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>+</mo><msup><mrow><mover accent="true"><mrow><mi mathvariant="bold">b</mi></mrow><mo>&#xAF;</mo></mover></mrow><mi>T</mi></msup><mrow><msub><mrow><mi mathvariant="bold">h</mi></mrow><mi>u</mi></msub></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mrow><msup><mi>&#x3C3;</mi><mn>2</mn></msup></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow><mo>&#x2212;</mo><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><msub><mrow><mi mathvariant="bold">k</mi></mrow><mi>u</mi></msub></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><msup><mo>]</mo><mn>2</mn></msup><mo>+</mo><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mi>T</mi></mrow></msup><mo>[</mo><mrow><msub><mrow><mi mathvariant="bold">h</mi></mrow><mi>u</mi></msub></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>&#x2212;</mo><msup><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow><mi>T</mi></msup><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><msub><mrow><mi mathvariant="bold">k</mi></mrow><mi>u</mi></msub></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>]</mo><mo>]</mo><msup><mo>]</mo><mn>2</mn></msup></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>&#x2261;</mo><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow><mo>&#x2212;</mo><msubsup><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><mn>1</mn><mi>T</mi></msubsup><msub><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><mn>1</mn></msub><mo>+</mo><msubsup><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><mn>2</mn><mi>T</mi></msubsup><msub><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><mn>2</mn></msub></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
m({\mathbf{x}}) &amp;= {\bar\mathbf{g}}^T{\mathbf{k}_u}({\mathbf{x}}) + {\bar\mathbf{b}}^T{\mathbf{h}_u}({\mathbf{x}}) \\
{\sigma^2}({\mathbf{x}}) &amp;= {\sigma_f^2}- [{\mathbf{L}}^{-1}{\mathbf{k}_u}({\mathbf{x}})]^2 + [{\mathbf{R}}^{-T} [{\mathbf{h}_u}({\mathbf{x}}) - {\mathbf{F}}^T[{\mathbf{L}}^{-1}{\mathbf{k}_u}({\mathbf{x}})]]]^2 \\
         &amp;\equiv {\sigma_f^2}- {\mathbf{e}}_1^T{\mathbf{e}}_1 + {\mathbf{e}}_2^T{\mathbf{e}}_2
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.1662144999999997em;"></span><span class="strut bottom" style="height:3.8324289999999994em;vertical-align:-1.6662144999999997em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.2426635em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">m</span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span></span></span><span style="top:0.00866750000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span></span></span><span style="top:1.2831064999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.2426635em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span style="top:-0.013440000000000007em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.44521999999999984em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span></span></span><span style="top:0.00866750000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mbin">&#x2212;</span><span class="mopen">[</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mopen">[</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">R</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">[</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mclose">]</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:1.2831064999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">&#x2261;</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msub><mrow><mi mathvariant="bold">k</mi></mrow><mi>u</mi></msub></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{k}_u}={\mathbf{K}}_{su}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msub><mrow><mi mathvariant="bold">h</mi></mrow><mi>u</mi></msub></mrow><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>u</mi><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">{\mathbf{h}_u}={\mathbf{H}}_u^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.088331em;vertical-align:-0.247em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mrow><mover accent="true"><mrow><mi mathvariant="bold">b</mi></mrow><mo>&#xAF;</mo></mover></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msup><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mi>T</mi></msup><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>)</mo><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mover accent="true"><mrow><mi mathvariant="bold">g</mi></mrow><mo>&#xAF;</mo></mover></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mi>T</mi></mrow></msup><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mrow><mover accent="true"><mrow><mi mathvariant="bold">b</mi></mrow><mo>&#xAF;</mo></mover></mrow><mo>)</mo><mo>]</mo></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\bar\mathbf{b}}&amp;= {\mathbf{R}}^{-1} [{\mathbf{Q}}^T({\mathbf{L}}^{-1}{\mathbf{y}}_s)] \\
{\bar\mathbf{g}}&amp;= {\mathbf{L}}^{-T} [{\mathbf{L}}^{-1} ({\mathbf{y}}_s-{\mathbf{H}}{\bar\mathbf{b}})]
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.501331em;"></span><span class="strut bottom" style="height:2.502662em;vertical-align:-1.001331em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.6100000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6413309999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span style="top:-0.013440000000000007em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6100000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">R</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span><span style="top:0.6413309999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span></p>
<p>The gradient of the mean is computed in a straight-forward manner, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>m</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow><mo>=</mo><msup><mrow><mover accent="true"><mrow><mi mathvariant="bold">g</mi></mrow><mo>&#xAF;</mo></mover></mrow><mi>T</mi></msup><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msub><mrow><mi mathvariant="bold">k</mi></mrow><mi>u</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow><mo>+</mo><msup><mrow><mover accent="true"><mrow><mi mathvariant="bold">b</mi></mrow><mo>&#xAF;</mo></mover></mrow><mi>T</mi></msup><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msub><mrow><mi mathvariant="bold">h</mi></mrow><mi>u</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\frac{\partial m}{\partial {\mathbf{x}}}} = {\bar\mathbf{g}}^T{\frac{\partial {\mathbf{k}_u}}{\partial {\mathbf{x}}}} + {\bar\mathbf{b}}^T{\frac{\partial {\mathbf{h}_u}}{\partial {\mathbf{x}}}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathit">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span style="top:-0.013440000000000007em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.44521999999999984em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msub><mrow><mi mathvariant="bold">k</mi></mrow><mi>u</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex">{\frac{\partial {\mathbf{k}_u}}{\partial {\mathbf{x}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8962079999999999em;"></span><span class="strut bottom" style="height:1.2412079999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.4100999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathbf mtight">k</span></span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msub><mrow><mi mathvariant="bold">h</mi></mrow><mi>u</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex">{\frac{\partial {\mathbf{h}_u}}{\partial {\mathbf{x}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8962079999999999em;"></span><span class="strut bottom" style="height:1.2412079999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.4100999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathbf mtight">h</span></span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> are obtained from the regression and mean functions, respectively.</p>
<p>The computation of the gradient of the variance is a little bit more involved, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msup><mi>&#x3C3;</mi><mn>2</mn></msup></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mo>&#x2212;</mo><mn>2</mn><msubsup><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><mn>1</mn><mi>T</mi></msubsup><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msub><mrow><mi mathvariant="bold">k</mi></mrow><mi>u</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow><mo>+</mo><mn>2</mn><msubsup><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><mn>2</mn><mi>T</mi></msubsup><msup><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mi>T</mi></mrow></msup><mrow><mo fence="true">(</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msub><mrow><mi mathvariant="bold">h</mi></mrow><mi>u</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow><mo>&#x2212;</mo><msup><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow><mi>T</mi></msup><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msub><mrow><mi mathvariant="bold">k</mi></mrow><mi>u</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow><mo fence="true">)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mo>&#x2212;</mo><mn>2</mn><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mi>T</mi></mrow></msup><mo>(</mo><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">r</mi></mrow></mrow><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><mn>1</mn></msub><mo>)</mo><msup><mo>]</mo><mi>T</mi></msup><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msub><mrow><mi mathvariant="bold">k</mi></mrow><mi>u</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow><mo>+</mo><mn>2</mn><msup><mrow><mrow><mi mathvariant="bold">r</mi></mrow></mrow><mi>T</mi></msup><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msub><mrow><mi mathvariant="bold">h</mi></mrow><mi>u</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\frac{\partial {\sigma^2}}{\partial {\mathbf{x}}}} &amp;= - 2{\mathbf{e}}_1^T{\mathbf{L}}^{-1}{\frac{\partial {\mathbf{k}_u}}{\partial {\mathbf{x}}}} + 2{\mathbf{e}}_2^T{\mathbf{R}}^{-T}\left({\frac{\partial {\mathbf{h}_u}}{\partial {\mathbf{x}}}} - {\mathbf{F}}^T{\mathbf{L}}^{-1}{\frac{\partial {\mathbf{k}_u}}{\partial {\mathbf{x}}}}\right) \\
          &amp;= - 2[{\mathbf{L}}^{-T}({\mathbf{F}}{\mathbf{r}}+ {\mathbf{e}}_1)]^T {\frac{\partial {\mathbf{k}_u}}{\partial {\mathbf{x}}}} + 2{\mathbf{r}}^T{\frac{\partial {\mathbf{h}_u}}{\partial {\mathbf{x}}}}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.499289em;"></span><span class="strut bottom" style="height:4.498578em;vertical-align:-1.999289em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.008181em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><span style="top:1.3132890000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.008181em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord">&#x2212;</span><span class="mord mathrm">2</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mbin">+</span><span class="mord mathrm">2</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">R</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:1.3132890000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord">&#x2212;</span><span class="mord mathrm">2</span><span class="mopen">[</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">F</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">r</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mbin">+</span><span class="mord mathrm">2</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">r</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">r</mi></mrow></mrow><mo>=</mo><msup><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msub><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{r}}={\mathbf{R}}^{-1}{\mathbf{e}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.964108em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">r</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">R</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. The computation is organized so as to minimize the number of linear solves of the triangular matrices.</p>
]]></content>
      
        <categories>
            
            <category> digest </category>
            
        </categories>
        
        
        <tags>
            
            <tag> kriging </tag>
            
            <tag> surrogate model </tag>
            
            <tag> machine learning </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Professor Ni Naru II]]></title>
      <url>http://smanist.github.io/2018/05/27/Professor-Ni-Naru-II/</url>
      <content type="html"><![CDATA[<p>How to become a professor (in Engineering)? Cases and examples.</p>
<a id="more"></a>
<p>In short, there are more than one road to Rome. Yet, the general principles agree with those in the previous article.</p>
<h2 id="the-panelists">The panelists</h2>
<h3 id="prof.m">Prof.&#xA0;M</h3>
<p>(Tenured, female) Did undergrad in UIUC and worked in industry for 10 years before going to grad school. In the stage of PhD/PostDoc, she was thinking about back to industry afterwards. Yet, the Dean offered a chance in a newly-developed program in engineering education. That is how she ended up to be a faculty member.</p>
<h3 id="prof.j">Prof.&#xA0;J</h3>
<p>(Tenured, female) Directly became a tenure-track AP after PhD. What surprised her was that (1) she had to be hands off the direct research (such as coding) and focus on writing proposals, and (2) high level of interdisciplinary research (univ. dependent). Two mistakes she wished to have avoided in the AP period are that (1) continuing dissertation research (only) and (2) not knowing the field - resulting in, e.g.&#xA0;journal rejection. Her major tip is that an AP should <em>identify the field of impact and research vision</em>, so that he/she can focus on one core area due to the limited timeframe of the tenure process.</p>
<p>She was able to gave birth to a baby while striving for tenure. Having a baby is beneficial in the sense that it makes the life becomes more focused. Work has to be done when the baby is still in daycare.</p>
<h3 id="prof.c">Prof.&#xA0;C</h3>
<p>(Fresh AP, female) Worked as Postdoc in a NL before becoming an AP. That is probably how she developed a strong publication record.</p>
<h3 id="prof.k">Prof.&#xA0;K</h3>
<p>(Senior AP, female) She applied for a faculty position to over 30 institutions when she graduated and received around 10 interviews. Now what she thinks is that she should have applied to less places so that the time and energy are more focused. During the negotiation, she was able to convince the dept. to create two courses based on her research work, which are potentially beneficial for her later-on research. Two more tips she offered:</p>
<ol style="list-style-type: decimal">
<li>Do not be afraid to ask for resources.</li>
<li>It is natural and okay to have no experience in the beginning.</li>
</ol>
<h3 id="prof.l">Prof.&#xA0;L</h3>
<p>(Just tenured, male) He was hired through an interdisciplinary program between several depts. Now he is running a lab with around 10 grad students and some undergrads. Two things he found challenging: (1) dealing with a few superviors, (2) motivating the students. Concerning work-life balance, he suggested using the conferences as a means for family vacations.</p>
<h3 id="prof.s">Prof.&#xA0;S</h3>
<p>(Senior AP, male) He and his spouse were hired utilizing the dual-career program offered by the univ. He pointed out that the lab should be treated as a small business. The AP needs to be hands-off the &#x201C;field work&#x201D; and let the students do the labor. Also, one cannot always do what one wants.</p>
<h2 id="q-a">Q &amp; A</h2>
<h3 id="writing-research-statement">Writing research statement</h3>
<p>The key is to balance the old and new projects. The RS works as research proposals, presenting the new ideas and the start-up budget. This also indicates how one becomes independent from the advisor. The RS also shows the existing technical asset of one person, represented by the old projects. Anyways, make sure the RS receives feedback from the peers and mentors before application.</p>
<h3 id="start-up-package">Start-up package</h3>
<p>It is basically university dependent. Keep in mind that, during the negotiation, the dept. on the AP&#x2019;s side against the univ. in some aspects. A few suggestions: (1) Have a flexible requirement of the necessities. (2) Confirm what courses to teach. (3) Make sure any communication be recorded and all the requirements be written.</p>
<h3 id="getting-tenure">Getting tenure</h3>
<p>First of all, check the memos on tenure requirements and talk to senior faculty members for mentoring. Typically, a tier 1 research university focuses on research, but bad teaching would annihilate the tenure.</p>
<h3 id="as-a-mentor">As a mentor</h3>
<p>The role of a mentor is about not just academics, but also the overall well-being, such as the student&#x2019;s career development. Taking undergrads is usually the starting point of a new AP. Two suggestions: (1) utilize existing univ. program support, (2) avoid people aiming for recommendation letters - maybe give a one-year observation period.</p>
<p>Always note that the team chemistry is vital for the lab and the tenure.</p>
<h3 id="time-management">Time management</h3>
<p>The key is to prioritize the schedule and do not become deadline-driven. A typical work load of 50 hrs a week is decomposed as 60-70% for R, 20-30% for T, and the rest for S. 60% of time would be spent in course preparation.</p>
<h3 id="work-life-balance">Work-life balance</h3>
<p>First, &#x201C;balance&#x201D; itself should be well defined. It could mean a fixed time frame for life and work. Apparently, the understanding of the family and the partner is paramount. Especially the kids would force the AP to optimize the time management. There are univ. guidelines for faculty with family, which could be exploited.</p>
<h3 id="reasons-to-transit-from-nl-to-univ.">Reasons to transit from NL to univ.</h3>
<ol style="list-style-type: decimal">
<li>Family factor</li>
<li>Desire to interact with students and have more impact on people.</li>
</ol>
]]></content>
      
        <categories>
            
            <category> digest </category>
            
        </categories>
        
        
        <tags>
            
            <tag> faculty </tag>
            
            <tag> career </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Professor Ni Naru I]]></title>
      <url>http://smanist.github.io/2018/05/26/Professor-Ni-Naru-I/</url>
      <content type="html"><![CDATA[<p>How to become a professor (in Engineering)? General talk.</p>
<a id="more"></a>
<p>This is the digest of several seminars I attended recently. These are the info. provided by several professors from university, and filtered by my notes. I am not responsible for any biases.</p>
<p>Before any discussion in the details, one thing that I think should be kept in mind throughout the academic career is to form the research identity verbally</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&quot;I, Professor X, would like to be known for ...&quot;</div></pre></td></tr></table></figure>
<h2 id="how-does-faculty-search-happen">How does faculty search happen?</h2>
<p>Before diving into the applicants&#x2019; perspective, let&#x2019;s examine the perspective of the department. Bascially, the dept. would look for a candidate that fits into the departmental culture. The following are the typical steps:</p>
<ol style="list-style-type: decimal">
<li>Apply to the univ. for slots of new faculty positions. The slots may be prescribed special purposes, e.g.&#xA0;an AP in computer science specializing in machine learning.</li>
<li>Set up the search committee (which is common place for the AP to do service).</li>
<li>Solicit applications via advertisement, faculty network, and direct scouting.</li>
<li>Review applications.</li>
<li>Remote interview and evaluate (with rubrics).</li>
<li>On-site interview for finalists.</li>
<li>Discuss and decide on the final choice(s) and submit to college or univ. for approval.</li>
<li>Send out the offer and negotiate with the candidate.</li>
</ol>
<p>Next, from the applicants&#x2019; perspective, the faculty search happens as follows,</p>
<ol style="list-style-type: decimal">
<li>Step zero is to develop a good research record and reputation.</li>
<li>Prepare for application: CV, reference letters (RL), teaching and research statements (TS &amp; RS), cover letter (CL), set up the personal website for showcase. For TS and RS, it is important to have outsider review and emphasis on the <em>mutual</em> institutional fit.</li>
<li>Wait: from application deadline to interview.</li>
<li>Develop job talk and/or chalk talk. Two things to cover: &#x201C;What is done&#x201D; and &#x201C;What to be done&#x201D;. Make sure to balance the depth and breadth and maintain accessibility for people outside the field. When there is &#x201C;chalk talk&#x201D;, it may be also used to check the teaching capability of the candidate and how one would run a lab.</li>
<li>Interview: Several things to keep in mind: Explain to the diverse audience about the accomplishment and goals. Study the background of the people in department. Enjoy and learn - the interview is not necessarily the last one.</li>
<li>Wait: from interview to decision notification.</li>
<li>Negotiate if given an offer.</li>
</ol>
<p>Like the dept., it is advisable that the applicant check if departmental culture fits himself/herself. Or put in this way, the job of faculty is a long-term endeavor that involves the person and the dept. As a result, the faculty search is essentially a process of mutual fitting.</p>
<h2 id="before-faculty">Before faculty</h2>
<h3 id="a-rough-time-line">A rough time line</h3>
<p>Before getting a faculty position:</p>
<ol style="list-style-type: decimal">
<li>Explore - 2 years prior: Search job listing and conduct informal interviews.</li>
<li>Prepare - 1 year prior: Prepare the documents CV, RL, TS/RS, CL and have them reviewed, esp. if the univ. provides such resources.</li>
<li>Execute - 6 months prior: Prepare for the interview and review the offer with faculty and specialists from the univ.</li>
</ol>
<p>As for the background in PostDoc, the institutional reputation does matter. However, getting experience in mentoring and proposal writing (in a maybe lower level of univ.) is more important than joining in famous labs.</p>
<h3 id="national-labs">National labs</h3>
<p>Chances are that one goes for national labs (NL) before becoming a faculty member. There are pros and cons.</p>
<p>Pros:</p>
<ol style="list-style-type: decimal">
<li>NL provides funded postdocs and intership with generous benefits.</li>
<li>World-class equipments for experimentalist and computational scientists.</li>
<li>Work with reputed scientists, which forms the network beneficial for future research, funding, collaboration, and recognition.</li>
<li>Chances for publication.</li>
</ol>
<p>Cons:</p>
<ol style="list-style-type: decimal">
<li>Limitations in immigration status.</li>
<li>Publication could be delayed due to bureacratic process or clearance issues.</li>
<li>Lesser feeling of contribution as the research project is usually done collectively.</li>
<li>Limited freedom to select the research topic.</li>
<li>Limited chance for teaching, although possible if there are nearby univs.</li>
</ol>
<p>To initialize the connection with NL, networking is important. Less than 50% of NL positions are publicly advertised and more are filled by recommendation of univ. faculties, or through networking during conferences.</p>
<h2 id="during-tenure-track">During tenure-track</h2>
<h3 id="a-rough-time-line-1">A rough time line</h3>
<ol style="list-style-type: decimal">
<li>Year 1: R and T are the focus. S should be minimum. Especially extra time is needed to develop a course.</li>
<li>Year 2-3: R goes up and T goes down. Esp. R weighs in due to the mid-term review. S slightly increases and the AP becomes more experienced.</li>
<li>Year 4-6: R continues to increase for the final tenure review. S stays more or less the same level.</li>
</ol>
<h3 id="proposals">Proposals</h3>
<p>Writing proposals will be the major task of the new faculty. Practically, he/she needs to pay for students, lab expenses, faculty salary, and travel/logistic costs.</p>
<p>Before application, one needs to understand the mission of the funding agency. One basic way is to watch out for the solicitation of the agency, e.g.&#xA0;request for information (RFI), request for proposal (RFP), and broad agency anouncement (BAA). However, more importantly, talk to the manager directly. The manager is indeed the key person associated with the proposal. He/she creates the program, picks the proposal winners, and reports the progress to his/her boss. The general procedure/loop would be (1) present the idea to the manager, (2) let manager criticize or express his/her needs, (3) correct the proposal. One tip is to expect rejections but learn about the feedback.</p>
<p>Check out the <a href="https://en.wikipedia.org/wiki/George_H._Heilmeier" target="_blank" rel="noopener">Heilmeier Catechism</a> when working on the proposal.</p>
<ol style="list-style-type: decimal">
<li>What are you trying to do? Articulate your objectives using absolutely no jargon.</li>
<li>How is it done today, and what are the limits of current practice?</li>
<li>What&#x2019;s new in your approach and why do you think it will be successful?</li>
<li>Who cares? If you&#x2019;re successful, what difference will it make?</li>
<li>What are the risks and the payoffs?</li>
<li>How much will it cost?</li>
<li>How long will it take?</li>
<li>What are the midterm and final &#x201C;exams&#x201D; to check for success?</li>
</ol>
<p>The proposal requires some initial input data obtained based on the start-up funding. A suggested writing order is as follows: Summary of the ideas, deliverables and timeline, budget, background, introduction &amp; conlusion, abstract (most important and thus the last). Make sure to write about the broader impact.</p>
<p>A rule is suggested: Seek advice from people who are busy. They are busy because their advices are so valuable that people keep him/her occupied.</p>
<h3 id="service-responsibilities">Service responsibilities</h3>
<p>Service occurs in two aspects. First, within the campus, there are opportunities in the college/univ., dept., and outreach levels. Second, externally, the service includes professional committees, editorial work, proposal review, and journal review.</p>
<p>A few things to think about for the choice of service: High-visibility, networking opportunities, potential impact on R &amp; T. Some good examples are graduate student search committee and proposal review committee. The caveats in service include non-measurable time cost and distraction from R &amp; T, e.g.&#xA0;travelling for external services. Finally, it is better to <em>actively</em> seek and choose the service, instead of passively getting assigned the job.</p>
<h3 id="miscellaneous">Miscellaneous</h3>
<p>About growing research team: Be careful about the structure and size, hire the excellent ones and double-think about postdocs and undergrads. <em>Be aware of the common practices in the dept.</em></p>
<p>About whether to continue work of PhD/postdoc: A first question to ask is that whether the area is saturated? Continuted work provides potential early wins, but one eventually needs to branch to new areas.</p>
<p>About time management: A few things to consider - (1) When and how to collaborate. (2) Whether to outsource. (3) Respect other&#x2019;s time. (4) Identify the deadline and the key time nodes. (5) Try not to reinvent the wheels.</p>
<p>About branding of research: Note the Pygmalion effect, i.e.&#xA0;expectation enhances performance. Sustaining the brand gives positive feedback on publication, citation and impact, students, and sustainable funding.</p>
]]></content>
      
        <categories>
            
            <category> digest </category>
            
        </categories>
        
        
        <tags>
            
            <tag> faculty </tag>
            
            <tag> career </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Images in Hexo]]></title>
      <url>http://smanist.github.io/2018/04/22/Images-in-Hexo/</url>
      <content type="html"><![CDATA[<p>Displaying images in Hexo with Markdown.</p>
<a id="more"></a>
<h2 id="file-locations-of-the-images">File locations of the images</h2>
<p>This is straightforward and is discussed in the official <a href="https://hexo.io/docs/asset-folders.html" target="_blank" rel="noopener">documentation</a>. There are two ways. One is to put all images in the so-called <code>global asset folder</code>, <code>source/images</code>, and all posts will need to refer to the images using the path <code>/images/[FILENAME]</code>. The other way is to enable the <code>post asset folder</code> by setting the following flag in <code>_config.yml</code>, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">post_asset_folder: true</div></pre></td></tr></table></figure></p>
<p>In this case, the images will be stored separately in a folder of the same name as the post file name. In the post, the image is inserted using the path <code>[FILENAME]</code>. A similar discussion can be found <a href="https://yoheikoga.github.io/2016/04/05/How-to-put-pictures-and-change-sizes-on-your-Hexo-Blog/" target="_blank" rel="noopener">here</a>.</p>
<h2 id="displaying-the-images">Displaying the images</h2>
<h3 id="using-markdown">Using Markdown</h3>
<p>The image capabilities of Markdown depends on its implementation. The basic approach can be found <a href="https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet#images" target="_blank" rel="noopener">here</a> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">![](FILENAME [TEXT])</div></pre></td></tr></table></figure></p>
<p>Some implementations of Markdown support the sizing of the image as discussed <a href="https://stackoverflow.com/questions/14675913/changing-image-size-in-markdown" target="_blank" rel="noopener">here</a>. <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">![](FILENAME [TEXT] WIDTHx[HEIGHT])</div></pre></td></tr></table></figure></p>
<p>Unfortunately, it seems the current Markdown engine <code>pandoc</code> does not support the sizing.</p>
<p>An example is shown as follows,</p>
<div class="figure">
<img src="avatar.jpeg" title="An example image.">

</div>
<h3 id="using-html">Using HTML</h3>
<p>The HTML can be embedded into Markdown. So fancier image displaying can be achieved using HTML snippets. Note that there is also another approach that is based on CSS (<a href="https://stackoverflow.com/questions/255170/markdown-and-image-alignment#answer-5054055" target="_blank" rel="noopener">an example</a>). However, CSS more or less makes the file structure more complicated.</p>
<p>The basic format is, but not limited to, <figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;img src=FILENAME [width=WIDTH] [height=HEIGHT] [hspace=HSPACE] [align=&lt;&quot;right&quot;|&quot;left&quot;&gt;] [title=TITLETEXT] [style=STYLESTR]&gt;</div></pre></td></tr></table></figure></p>
<p>Note that one can use the <code>style</code> keyword to define the size and alignment, etc. For example, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">style=&quot;width:WIDTH; height:HEIGHT; float:&lt;right|left&gt;&quot;</div></pre></td></tr></table></figure></p>
<p>Finally, <code>&lt;img&gt;</code> can be combined with <code>&lt;p&gt;&lt;/p&gt;</code>, <code>&lt;figure&gt;&lt;/figure&gt;</code>, etc to achieve other formatting purposes.</p>
<p>The following are some examples. Hover the cursor on the image to see the title.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;img src=&quot;avatar.jpeg&quot; title=&quot;A regular image&quot; width=&quot;20px&quot; height=&quot;20px&quot;&gt;</div></pre></td></tr></table></figure>
<p><img src="avatar.jpeg" title="A regular image" width="20px" height="20px"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;img src=&quot;avatar.jpeg&quot; title=&quot;Image with right alignment&quot; width=&quot;20px&quot; align=&quot;right&quot;&gt;</div></pre></td></tr></table></figure>
<p><img src="avatar.jpeg" title="Image with right alignment" width="20px" align="right"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;img src=&quot;avatar.jpeg&quot; title=&quot;Right alignment using style&quot; style=&quot;float:right; width:20px;&quot;&gt;</div></pre></td></tr></table></figure>
<p><img src="avatar.jpeg" title="Right alignment using style" style="float:right; width:20px;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;img src=&quot;avatar.jpeg&quot; title=&quot;Multiple images on one line&quot; width=&quot;20px&quot; hspace=&quot;20px&quot;&gt;</div><div class="line">&lt;img src=&quot;avatar.jpeg&quot; width=&quot;20px&quot;&gt;</div></pre></td></tr></table></figure>
<p><img src="avatar.jpeg" title="Multiple images on one line" width="20px" hspace="20px"> <img src="avatar.jpeg" width="20px"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;p align=&quot;center&quot;&gt;</div><div class="line">  &lt;img src=&quot;avatar.jpeg&quot; title=&quot;Multiple images using p with center alignment&quot; width=&quot;20px&quot;&gt;</div><div class="line">  &lt;img src=&quot;avatar.jpeg&quot; width=&quot;20px&quot;&gt;</div><div class="line">&lt;/p&gt;</div></pre></td></tr></table></figure>
<p align="center">
<img src="avatar.jpeg" title="Multiple images using p with center alignment" width="20px"> <img src="avatar.jpeg" width="20px">
</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;figure float=&quot;left&quot;&gt;</div><div class="line">  &lt;img src=&quot;avatar.jpeg&quot; title=&quot;Image 1 with a caption&quot; width=&quot;20px&quot;&gt;</div><div class="line">  &lt;img src=&quot;avatar.jpeg&quot; title=&quot;Image 2 with a caption&quot; width=&quot;20px&quot;&gt;</div><div class="line">  &lt;figcaption&gt;An image with a caption.&lt;/figcaption&gt;</div><div class="line">&lt;/figure&gt;</div></pre></td></tr></table></figure>
<figure float="left">
<img src="avatar.jpeg" title="Image 1 with a caption" width="20px"> <img src="avatar.jpeg" title="Image 2 with a caption" width="20px">
<figcaption>
Images with a caption.
</figcaption>
</figure>
<p>More references:</p>
<ol style="list-style-type: decimal">
<li><a href="https://gist.github.com/DavidWells/7d2e0e1bc78f4ac59a123ddf8b74932d" target="_blank" rel="noopener">HTML alignment</a></li>
<li><a href="https://stackoverflow.com/questions/24319505/how-can-one-display-images-side-by-side-in-a-github-readme-md" target="_blank" rel="noopener">HTML multiple images on the same line</a></li>
<li><a href="https://www.w3schools.com/tags/tag_figcaption.asp" target="_blank" rel="noopener">HTML image with a caption</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> coding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Adding Fonts in WSL]]></title>
      <url>http://smanist.github.io/2018/04/20/Adding-Fonts-in-WSL/</url>
      <content type="html"><![CDATA[<p>Not using <code>Cygwin</code>.</p>
<a id="more"></a>
<h2 id="problem">Problem</h2>
<p>The default fonts that come with WSL/Ubuntu do not work well with emacs - not suitable for long-time editing (at least for me).</p>
<p>There are several particular issues. The first one is with the defects with the default font <code>DejaVu Sans Mono</code> (This is probably personal). The second is the scale of the fonts. Finally, the anti-aliasing of the fonts is missing.</p>
<p>It seems that anti-aliasing is not supported with Xming. So this article will focus on solving the first two issues.</p>
<h2 id="solving-the-scaling-issue">Solving the scaling issue</h2>
<p>This problem is relatively easy. One way is to set the fontsize particularly in emacs. Another way, which I went with, is to <a href="https://aufather.wordpress.com/2010/11/21/increasing-font-size-in-xming-server/" target="_blank" rel="noopener">set directly through Xming</a>. This is simple: just add one more argument to the shortcut to the Xming executable. <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Xming.exe [Other options] -dpi 120</div></pre></td></tr></table></figure></p>
<h2 id="solving-font-issue">Solving font issue</h2>
<p>The list of fonts that are available to emacs can be found by, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(print (font-family-list))</div></pre></td></tr></table></figure></p>
<p>The fonts can be tried out by, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(set-frame-font [FONTNAME])</div></pre></td></tr></table></figure></p>
<p>However, none of them works for me. The font that worked well for me is <code>ubuntu mono</code>, which can be downloaded from <a href="https://design.ubuntu.com/font/" target="_blank" rel="noopener">here</a>.</p>
<p>Next, installing fonts in Xming is pretty straightforward, as shown <a href="http://www.straightrunning.com/xmingnotes/fonts.php" target="_blank" rel="noopener">here</a>. It would require the <code>mkfontscale</code> tool, which is available in the <code>xfonts-utils</code> from <code>apt</code>. Note that mkfontscale is also available in Cygwin, but I do not think it is necessary to install a heavy system like Cygwin just for installing the font.</p>
<p>Finally, the new font in emacs is set by <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">(set-face-attribute &apos;default nil :height [HEIGHT])</div><div class="line">(set-face-attribute &apos;default nil :font [FONTNAME])</div></pre></td></tr></table></figure></p>
]]></content>
      
        <categories>
            
            <category> coding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> emacs </tag>
            
            <tag> fonts </tag>
            
            <tag> xming </tag>
            
            <tag> wsl </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Python Linting]]></title>
      <url>http://smanist.github.io/2018/04/19/Python-Linting/</url>
      <content type="html"><![CDATA[<p>Make Python clean again.</p>
<a id="more"></a>
<p><code>Pylint</code> is a nice tool for code analysis and it is well documented <a href="https://www.pylint.org/" target="_blank" rel="noopener">here</a>. The setup of pylint in Emacs has been discussed in a <a href="https://smanist.github.io/2018/01/17/Emacs-for-Python-Cpp/">previous article</a>. Pylint is highly-configurable via the <code>.pylintrc</code> file.</p>
<p>This article will focus on the tuning of the pylintrc file. The tuning is based on my actual needs.</p>
<h2 id="disabled-messages">Disabled messages</h2>
<p>The messages are categorized into four groups:</p>
<ol style="list-style-type: decimal">
<li>The &#x201C;too-many/few&#x201D; family: <code>too-many-arguments</code>, <code>too-many-branches</code>, <code>too-many-instance-attributes</code>, <code>too-many-locals</code>, <code>too-many-public-methods</code>, <code>too-many-statements</code>, <code>too-few-public-methods</code>. Having something &#x201C;too many&#x201D; typically indicates the code is not well designed. Yet, how many is &#x201C;too many&#x201D;? It really depends and a maximum number given in PEP or pylint may not be practical. Same thing for &#x201C;too few&#x201D;.</li>
<li>False-positive: <code>no-member</code>, <code>unbalanced-tuple-unpacking</code>. After all, pylint is not able to actually run the code and identify the variables that are created dynamically or in a context-dependent manner. In these cases, pylint raise distracting false-positive messages.</li>
<li>Code style: <code>bad-whitespace</code>, <code>invalid-name</code>. The PEP does have a <a href="https://www.python.org/dev/peps/pep-0008" target="_blank" rel="noopener">long style guide</a>. But it is hard and unnecessary to modify the code style of a large project with another set of self-consistent styles.</li>
<li>Code design: <code>broad-except</code>, <code>protected-access</code>. These, probably, should not be disabled. However, better solutions might just require large scale refactorization, which is undesirable.</li>
</ol>
<h2 id="messages-not-to-be-disabled">Messages not to be disabled</h2>
<p>Up until now, one item is found to be important and should <em>not</em> be disabled: <code>cell-var-from-loop</code>.</p>
<p>Consider this case, where <code>i</code> turns out to be the same in all three lambda functions. <figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">funcList = []</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</div><div class="line">    funcList.append(<span class="keyword">lambda</span> x: i*x)</div><div class="line">funcList[<span class="number">0</span>](<span class="number">3</span>) <span class="comment"># = 6, supposed to be 0</span></div></pre></td></tr></table></figure></p>
<p>This is where the cell-var-from-loop message will be raised. The correct way is to define the lambda function with a default argument, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">lambda x, arg=i: arg*x</div></pre></td></tr></table></figure></p>
<p><em>More to be updated in the future.</em></p>
<p>References:</p>
<ol style="list-style-type: decimal">
<li><a href="https://pylint.readthedocs.io/en/latest/technical_reference/features.html" target="_blank" rel="noopener">List of pylint messages</a></li>
<li><a href="http://pylint-messages.wikidot.com/" target="_blank" rel="noopener">Explanation of pylint messages</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> coding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> python </tag>
            
            <tag> lint </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Exploring CAS]]></title>
      <url>http://smanist.github.io/2018/04/15/Exploring-CAS/</url>
      <content type="html"><![CDATA[<p>CAS for Computer Algebra System.</p>
<a id="more"></a>
<h2 id="problem">Problem</h2>
<p>Recently I ran into a situation that I needed to do some symbolic math but did not have access to a decent CAS software. I have been a <code>Mathematica</code> user for quite long time, but it is apparently not available everywhere.</p>
<p>After struggling with my problem, this question is raised: What is a good substitue for Mathematica? What I like about Mathematica include:</p>
<ol style="list-style-type: decimal">
<li>Strong symbolic capabilities in simplification, polynomials, calculus, etc.</li>
<li>Support for multiple paradigms, including functional programming - and everything is a list.</li>
<li>Notebook-like GUI with various export options.</li>
</ol>
<p>For the substitute, I hope it is light-weight and easy to pick up.</p>
<h2 id="exploration">Exploration</h2>
<p>A long of list of major CAS software can be found <a href="https://en.wikipedia.org/wiki/List_of_computer_algebra_systems" target="_blank" rel="noopener">here</a>. Removing the specialized ones and picking the ones with as many capabilities as possible, some candidates are selected. These include: <a href="http://maxima.sourceforge.net/" target="_blank" rel="noopener">Maxima</a>, <a href="http://www.sympy.org/" target="_blank" rel="noopener">SymPy</a>, <a href="http://www.sagemath.org/" target="_blank" rel="noopener">SageMath</a>, <a href="http://www.axiom-developer.org/" target="_blank" rel="noopener">Axiom</a>, and <a href="http://fricas.sourceforge.net/" target="_blank" rel="noopener">FriCAS</a>.</p>
<p>For completeness of discussion, there is also <a href="http://www.apmaths.uwo.ca/~arich/" target="_blank" rel="noopener">Rubi</a> based on Mathematica, which focuses solely on integration.</p>
<h3 id="axiom-and-fricas">Axiom and FriCAS</h3>
<p>Axiom and FriCAS, as a fork of Axiom, used <code>HyperDoc</code> as its GUI, which is - sorry to use this word - ugly. FriCAS is said to be particularly good at integrations. However, its capability in simplification is very limited, as <a href="http://axiom-wiki.newsynthesis.org/SimplifyingExpressions" target="_blank" rel="noopener">documented by itself</a>. Candidates eliminated.</p>
<h3 id="sagemath">SageMath</h3>
<p>SageMath is somewhat more than a CAS software, as it tries to include many other capabilities like those in MATLAB. However, that is exactly my issue with SageMath. The capabilities depend on different other packages, include Maxima and SymPy as mentioned above. That makes the ecosystem way too heavy for the CAS purpose. Candidate eliminated.</p>
<h3 id="sympy">SymPy</h3>
<p>SymPy is nice in the sense that it is in the Python ecosystem and is expected to work well with the NumPy toolchain. So it is very easy to pick up (at least for a heavy Python user). Moreover, the Jupyter notebook provides a good solution for the GUI. Yet, its symbolic capability is limited.</p>
<h3 id="maxima">Maxima</h3>
<p>Maxima appears to be another CAS language that is easy to pick up. A GUI option is provided by <code>wxMaxima</code>, which looks like Mathematica and Jupyter. Its symbolic capability is fair. There is also an App <a href="https://github.com/YasuakiHonda/Maxima-on-Android-AS" target="_blank" rel="noopener">MaximaOnAndroid</a> on the smart phone.</p>
<h2 id="assessment">Assessment</h2>
<p>Two sets of tests are found for assessing the symbolic capabilities of CAS.</p>
<p>The first one is the <code>Charlwood&apos;s Integration Problems</code>, which are documented <a href="https://www.12000.org/my_notes/ten_hard_integrals/index.htm" target="_blank" rel="noopener">here</a> and <a href="http://luschny.de/math/quad/IntegralTestsSage.html" target="_blank" rel="noopener">here</a>. The integral problem, or the antiderivative problem, is considered difficult for a CAS system. The aforementioned integration problems are specially developed for testing CAS. In the so-called ten &#x201C;hardest&#x201D; integrals, the performance of Maxima is fair (8 out of 10), while SymPy only got 2 correct.</p>
<p>The second one is from the blog <a href="http://thingwy.blogspot.de/" target="_blank" rel="noopener">Maxima v.s. Mathematica</a>. A set of problems, including limit operation, integrals, simplification, algebraic equation solver, are discussed. In all problems, Maxima either provides a <em>wrong</em> answer, or fails to provide an answer. The blog is old (2015), but as of writing, I have tried all the problems except the simplification ones on (1) Maxima 5.40 using MaximaOnAndroid and (2) SymPy 1.1. For Maxima, no improvement is identified. SymPy fails in the integrals (again), but it did much better than Maxima in the algebraic solver. The test is unnecessarily fair, as there is always an aspect of a CAS software that is weaker than that of another.</p>
<p>Subsequently, wxMaxima is tried out on WSL. There is a Windows version for wxMaxima, but I prefer to have it in Linux-like environment. The installation is standard. However, the Maxima kernel somehow does not work. The kernel terminates upon start with an error message <code>personality failure 38</code>. This appears to be an issue with WSL support for Common LISP, as identified <a href="https://wpdev.uservoice.com/forums/266908-command-prompt-console-windows-subsystem-for-l/suggestions/17629492-maxima-and-common-lisp-should-work" target="_blank" rel="noopener">here</a> and <a href="https://stackoverflow.com/questions/47704787/maxima-personality-failure-38-on-windows-subsystem-for-linux-ubuntu" target="_blank" rel="noopener">here</a>.</p>
<p>So, finally, SymPy with the Jupyter environment is down-selected for the open-source substitute for Mathematica. Nevertheless, <em>there is probably no real open-source substitute for Mathematica after all</em>.</p>
]]></content>
      
        <categories>
            
            <category> digest </category>
            
        </categories>
        
        
        <tags>
            
            <tag> wsl </tag>
            
            <tag> cas </tag>
            
            <tag> maxima </tag>
            
            <tag> sympy </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Fun With WSL]]></title>
      <url>http://smanist.github.io/2018/03/23/Fun-with-WSL/</url>
      <content type="html"><![CDATA[<p>Now I hate Windows less.</p>
<a id="more"></a>
<p><a href="https://en.wikipedia.org/wiki/Windows_Subsystem_for_Linux" target="_blank" rel="noopener">Windows subsystem for Linux</a> (WSL) has come out for a while. It started from the insider preview version, migrated to Windows Store, and recently expanded its support to multiple Linux distributions, which caught my eyeball. As a user who ditched Windows for Linux, WSL is intriguing to me and I decided to try it out.</p>
<h2 id="installation-and-configuration">Installation and configuration</h2>
<p>I selected the Ubuntu distribution to install. The installation through Windows Store is <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10" target="_blank" rel="noopener">straightforward</a>. The only thing to note is that, for a first-time installation, the WSL feature has to be enabled through <code>PowerShell</code> with Administrator privilege, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux</div></pre></td></tr></table></figure></p>
<p>I had a problem during the installation though, that the process appeared to be frozen. However, when I restarted the computer (hallmark of Windows), it turns out the Ubuntu distribution is already installed in WSL. Due to this detour, I had to set up the user accounts manually in WSL, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># Create user with home folder</div><div class="line">useradd -m &lt;username&gt;</div><div class="line"># Set password</div><div class="line">passwd &lt;username&gt;</div><div class="line"># Add user to sudo group</div><div class="line">usermod -aG sudo &lt;username&gt;</div></pre></td></tr></table></figure></p>
<p>Afterwards, one also needs to set the default user for WSL, otherwise the start-up account would still be the root. In <code>PowerShell</code> do <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ubuntu config --default-user &lt;username&gt;</div></pre></td></tr></table></figure></p>
<p>Finally, upgrade the Ubuntu distribution, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo apt-get update</div><div class="line">sudo apt-get upgrade</div></pre></td></tr></table></figure></p>
<p>Unlike Windows itself, the WSL does not have a native graphical engine. So interacting with WSL would be like accessing a remote computer. Yet, it is possible to install a third-party X server, e.g.&#xA0;the <a href="https://sourceforge.net/projects/xming/" target="_blank" rel="noopener">Xming X server</a>. Make sure Xming is running in Windows, a GUI program in WSL can be invoked as, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">DISPLAY=:0 &lt;program&gt;</div></pre></td></tr></table></figure></p>
<h2 id="possible-application-editor-replacement">Possible application: Editor replacement</h2>
<p>In Windows, it is somehow difficult to find a good editor. Maybe that is because Windows has &#x201C;too&#x201D; good graphical support than Linux. What I looked for is something like Emacs (or Vim) - lightweight, higly-configurable, highly-extensible, support multiple languages. However, being lightweight appears to be contradict to the rest of the properties. Eventually NotePad++ is down-selected for its lightweightness. Yet, I would not use it to work on large projects. The recent rising star, VS code, is fancy and nice. I like it but it is too heavy for my machine.</p>
<p>I did not try the <a href="https://www.gnu.org/software/emacs/download.html" target="_blank" rel="noopener">Emacs for Windows</a>, thought that it is not very meaningful to use Emacs without its ecosystem on Linux. But now, with WSL, why not consider Emacs again?</p>
<p>The installation and the configuration could be done single-handedly in WSL. By configuration I mean copying the files from my config repo. By the way, to download auxiliary files from a code hosting website, the regular <code>wget</code> might not work, one has to use <code>curl</code>, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl --digest --user &lt;username&gt;:&lt;password&gt; &lt;url&gt; -o &lt;output&gt;</div></pre></td></tr></table></figure></p>
<p>First, the Emacs in terminal mode is tested. Working with terminal mode appears simpler as it does not require <code>Xming</code>. However, the problem is with the keyboard mapping. I struggled for some time and eventually gave up. The underlying issue is that the terminal interprets whatever the keyboard sends it into a sequence of characters, which are then sent to Emacs. Therefore, Emacs could not get whatever the terminal could not understand. This could result in behaviors like, mapping the arrow keys and <code>Home</code>/<code>End</code> keys to the letters ABCDHF. This particular one is easy to fix though, (with ergoemacs mode), by disabling a key binding in the configuration file, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(global-unset-key &quot;\M-O&quot;)</div></pre></td></tr></table></figure></p>
<p>However, there are worse issues. For example, the terminal could not understand the Windows key (i.e. <code>super</code> key) and differentiate upper and lower cases. There is no way to patch that in Emacs. Working with terminal Emacs is only possible if I gave up half of my customized key-bindings.</p>
<p>Next, I switched to the regular GUI Emacs. The memory usage is around 30 MB (plus 6 MB for Xming), about 2% of what VS code requires. This clears my last concern about the GUI mode - &#x201C;Emulating&#x201D; X-server-based GUI does not really take much memory like virtual machine would do. The operation in GUI Emacs is smooth and pretty much the same as that in Linux - except that one need to make sure to have Xming run with the <code>keyhook</code> option, otherwise the <a href="https://www.reddit.com/r/bashonubuntuonwindows/comments/52lwhz/x_server_that_captures_all_keys_and_mouse/" target="_blank" rel="noopener"><code>super</code> could not be picked up</a>. This can be done by modifying the shortcut to the Xming application.</p>
<p>Concerning the comparison between the terminal and GUI modes, there has been quite a few discussions (see references). Looks like people do favor GUI over terminal for Emacs.</p>
<p>For the GUI Emacs, the last issue is to figure out a way to run it easily. It would be tedious to start a bash and type in <code>emacs</code> before working every time. The solution is surprisingly simple via <a href="https://superuser.com/questions/1194581/make-a-shortcut-to-ubuntu-bash-exe-on-windows-10-that-doesnt-auto-close" target="_blank" rel="noopener">the short-cut mechanism</a>. Create a shortcut and define the command as <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">C:\Windows\System32\bash.exe -c &quot;DISPLAY=:0 emacs&quot;</div></pre></td></tr></table></figure></p>
<p>Set the <code>Run</code> mode to be &#x201C;Minimized&#x201D;, so that one do not need to worry about the companying bash window. A logo for the shortcut can be found <a href="https://github.com/tovbinm/emacs-24-mac/blob/master/nt/icons/emacs.ico" target="_blank" rel="noopener">here</a>.</p>
<p>One final thing to note, the files under Windows can be accessed in WSL by the path <code>\mnt\&lt;disk&gt;\Users\&lt;username&gt;</code>. To save some effort in typing, one can try the <code>bookmark-set</code>/<code>bookmark-jump</code> command in Emacs to record and jump to the location.</p>
<p>References:</p>
<ol style="list-style-type: decimal">
<li><a href="https://winaero.com/blog/set-default-user-wsl-windows-10/" target="_blank" rel="noopener">Set default user</a></li>
<li><a href="http://www.flycheck.org/en/latest/" target="_blank" rel="noopener">Xming manual</a></li>
<li><a href="https://www.emacswiki.org/emacs/PythonProgrammingInEmacs" target="_blank" rel="noopener">Emacs: GUI Emacs vs Terminal Emacs</a></li>
<li><a href="https://blog.aaronbieber.com/2016/12/29/don-t-use-terminal-emacs.html" target="_blank" rel="noopener">Don&#x2019;t Use Terminal Emacs</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> coding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> emacs </tag>
            
            <tag> xming </tag>
            
            <tag> wsl </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Emacs for Python and C/C++]]></title>
      <url>http://smanist.github.io/2018/01/17/Emacs-for-Python-Cpp/</url>
      <content type="html"><![CDATA[<p>New configuration for the new year.</p>
<a id="more"></a>
<p>This document covers the configuration of the syntax checking and code completion for Python and C/C++ in <code>Emacs</code>.</p>
<h2 id="emacs-version">Emacs version</h2>
<p>Emacs should be &gt;= 24.4, preferably &gt; 25.0. Mine was 24.3 before the upgrade and it does not work with some of the packages covered next. The upgrade can be done using the standard <code>apt-get</code> protocol following <a href="http://ubuntuhandbook.org/index.php/2017/04/install-emacs-25-ppa-ubuntu-16-04-14-04/" target="_blank" rel="noopener">this</a>, <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">add-apt-repository ppa:kelleyk/emacs</div><div class="line">apt-get update</div><div class="line">apt-get install emacs25</div></pre></td></tr></table></figure></p>
<p>Root privilege is needed. After installation, make sure the latest version is used, not the old one.</p>
<p>All the packages in emacs mentioned below can be installed via the <code>package</code> system via sources ELPA or MELPA. Details found <a href="https://www.emacswiki.org/emacs/InstallingPackages" target="_blank" rel="noopener">here</a>.</p>
<h2 id="common-modules">Common modules</h2>
<h3 id="code-completion">Code completion</h3>
<p>Let&#x2019;s start with two common modules for code completion: packages <code>yasnippets</code> and <code>auto-complete</code> (<code>AC</code> for short). The two modules would work with most of the languages, theoretically.</p>
<p>Yasnippets allows the insertion of code snippets by typing in a few letters. I configured it in the following way, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(require &apos;yasnippet)</div><div class="line">(yas-load-directory &quot;path-to-yasnippet/snippets&quot;)  ;; User provided snippets</div><div class="line">(define-key yas-minor-mode-map [(tab)] nil)</div><div class="line">(define-key yas-minor-mode-map [(backtab)] &apos;yas-expand)</div></pre></td></tr></table></figure></p>
<p>The best part is that the users can create their own snippets.</p>
<p>The function of auto-complete is self-explanatory. It tries to complete a few letters with a table of candidates. Following is a basic configuration, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">(require &apos;auto-complete)</div><div class="line">(require &apos;auto-complete-config)</div><div class="line">(ac-config-default)</div></pre></td></tr></table></figure></p>
<p>It could be annoying if AC tries to complete every letter one types in. I disabled the automatic completion, so that I auto-complete my input when I want to, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">(setq ac-auto-start nil)</div><div class="line">(define-key ac-mode-map (kbd &quot;your_kbd&quot;) &apos;auto-complete)</div></pre></td></tr></table></figure></p>
<p>The default AC table could be squeezed too much by candidates of very long names. One way to avoid that is to install and use the <code>pos-tip</code> package. <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(require &apos;pos-tip)</div></pre></td></tr></table></figure></p>
<h3 id="syntax-checking">Syntax checking</h3>
<p>Another necessary emacs package is <code>flycheck</code> as a general framework for checking the syntax. The setup is as follows, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(defun flycheck-kbd-map ()</div><div class="line">  (local-set-key (kbd &quot;your_kbd&quot;) &apos;flycheck-buffer)        ;; Check the buffer for errors</div><div class="line">  (local-set-key (kbd &quot;your_kbd&quot;) &apos;flycheck-clear)         ;; Clear the error labels</div><div class="line">  (local-set-key (kbd &quot;your_kbd&quot;) &apos;flycheck-list-errors))  ;; List the errors in a separate window</div><div class="line">(add-hook &apos;flycheck-mode-hook &apos;flycheck-kbd-map)</div></pre></td></tr></table></figure></p>
<p>If there were too many errors, flycheck might overflow and clear up all errors. To mitigate that, raise the threshold <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(setq flycheck-checker-error-threshold 10000)</div></pre></td></tr></table></figure></p>
<h2 id="python-mode">Python Mode</h2>
<p>Now getting to the Python-specific setups, which are based on this <a href="https://robots.thoughtbot.com/emacs-as-a-python-ide" target="_blank" rel="noopener">video</a>.</p>
<p>Two emacs packages are needed: <code>python-mode</code> and <code>jedi</code>. In the meanwhile, the packages <code>epc</code>, <code>jedi</code> and <code>pylint</code> have to be installed in the Python environment, as the backends to jedi and flycheck in emacs. On the Python side, the installation can be done with <code>pip</code>. <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip install [--upgrade] your_packages</div></pre></td></tr></table></figure></p>
<p>The <code>.emacs</code> setup looks like this, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">(require &apos;python-mode)</div><div class="line">(add-hook &apos;python-mode-hook &apos;yas-minor-mode)</div><div class="line">(add-hook &apos;python-mode-hook &apos;flycheck-mode)</div><div class="line">(autoload &apos;python-mode &quot;python-mode&quot; &quot;Python Mode.&quot; t)</div><div class="line"></div><div class="line">(require &apos;jedi)</div><div class="line">(add-to-list &apos;ac-sources &apos;ac-source-jedi-direct)</div><div class="line">(setq jedi:complete-on-dot t)</div><div class="line">(setq jedi:tooltip-method &apos;pos-tip)</div><div class="line">(defun jedi-config:setup-keys ()</div><div class="line">  (local-set-key (kbd &quot;your_kbd&quot;) &apos;jedi:goto-definition)</div><div class="line">  (local-set-key (kbd &quot;your_kbd&quot;) &apos;jedi:show-doc))</div><div class="line">(add-hook &apos;python-mode-hook &apos;jedi:setup)</div><div class="line">(add-hook &apos;python-mode-hook &apos;jedi-config:setup-keys)</div></pre></td></tr></table></figure></p>
<p>If Cython is needed as well, install packages <code>cython-mode</code> and <code>flycheck-cython</code> in emacs. And the setup, (require &#x2019;cython-mode) (require &#x2019;flycheck-cython) (add-hook &#x2019;cython-mode-hook &#x2019;yas-minor-mode) (add-hook &#x2019;cython-mode-hook &#x2019;flycheck-mode) (autoload &#x2019;cython-mode &#x201C;cython-mode&#x201D; &#x201C;Cython Mode.&#x201D; t)</p>
<p>With the Cython mode present, the association of file extensions could be tricky. One needs to disable the default settings in the Python mode, so as to enable correct activation of cython-mode. <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(setq auto-mode-alist (rassq-delete-all &apos;python-mode auto-mode-alist))</div><div class="line">(add-to-list &apos;auto-mode-alist &apos;(&quot;\\.py\\&apos;&quot; . python-mode))</div><div class="line">(setq auto-mode-alist (rassq-delete-all &apos;cython-mode auto-mode-alist))</div><div class="line">(add-to-list &apos;auto-mode-alist &apos;(&quot;\\.pyx\\&apos;&quot; . cython-mode))</div><div class="line">(add-to-list &apos;auto-mode-alist &apos;(&quot;\\.pxd\\&apos;&quot; . cython-mode))</div></pre></td></tr></table></figure></p>
<p>With the above setup, the python and cython modes are activated when and only when py files and pyx/pxd files are opened, respectively.</p>
<h2 id="cc-mode">C/C++ Mode</h2>
<p>The configuration to be presented is rather simple. However, the exploration of some possibilities took quite a while.</p>
<h3 id="the-tagging-system---trials">The tagging system - Trials</h3>
<p>The center issue is the parsing of the source code, i.e.&#xA0;the tagging system. C/C++ code requires compilation and linking and the parsing is not as simple as that of Python. I found three options: <code>rtags</code>, <code>ctags</code> and <code>gtags</code>. (Well, there is also <code>etags</code>, which was not tried out.)</p>
<p>Rtags, based on LLVM/Clang, appears to be popular. Moreover, there is a <a href="https://github.com/atilaneves/cmake-ide" target="_blank" rel="noopener"><code>cmake-ide</code></a> package that integrates well with rtags and the <code>CMake</code> ecosystem. The best part is that it can infer all compiler flags from the cmake files. And unlike the other two tools, no extra tagging file has to be generated. The compilation of the code is also straight-forward, since everything is defined by the CMake files. The rtags-based tools in emacs can be easily found using command <code>package-list-packages</code>.</p>
<p>One example setup of the cmake-ide mode can be found <a href="http://nilsdeppe.com/posts/emacs-c++-ide" target="_blank" rel="noopener">here</a>. I also tried a similar setup, which requires <code>cmake-ide</code> and its dependencies, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(require &apos;rtags)</div><div class="line">(require &apos;cmake-ide)</div><div class="line">(cmake-ide-setup)</div><div class="line">(setq cmake-ide-flags-c++ (append &apos;(&quot;-std=c++11&quot;)))</div></pre></td></tr></table></figure></p>
<p>However, one year later, the same author switched to another set of <a href="http://nilsdeppe.com/posts/emacs-c++-ide2" target="_blank" rel="noopener">tools</a> that is light-weight. I ditched the rtags approach too, after trying for half an hour. The installation of rtags is OK, only took 2.5 hours. The running of rtags is painful - it uses up all allowable resources. The author used a combination of <code>ctags</code> and <code>counsel-etags</code>. This combination had certain minor problems on my machine. So I continued to look for other solutions.</p>
<p>Then there comes the gtags-based <a href="https://tuhdo.github.io/c-ide.html" target="_blank" rel="noopener">approach</a>. Two configurations that are more or less equivalent are discussed. One is based on <code>helm-gtags</code>, the other <a href="https://github.com/leoliu/ggtags" target="_blank" rel="noopener"><code>ggtags</code></a>. I tried the setup with helm-gtags, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">(add-hook &apos;c-mode-hook &apos;helm-gtags-mode)</div><div class="line">(add-hook &apos;c++-mode-hook &apos;helm-gtags-mode)</div><div class="line">(eval-after-load &quot;helm-gtags&quot;</div><div class="line">  &apos;(progn</div><div class="line">     (define-key helm-gtags-mode-map (kbd &quot;your_kbd&quot;) &apos;helm-gtags-dwim)</div><div class="line">     (define-key helm-gtags-mode-map (kbd &quot;your_kbd&quot;) &apos;helm-gtags-pop-stack)</div><div class="line">     (define-key helm-gtags-mode-map (kbd &quot;your_kbd&quot;) &apos;helm-gtags-update-tags)))</div></pre></td></tr></table></figure></p>
<p>It works, but not so stable on my system. Sometimes the parse fails without a good reason.</p>
<p>Finally ggtags is down-selected.</p>
<h3 id="setting-up-gtags">Setting up gtags</h3>
<p>The command line tool <code>gtags</code> can be downloaded from <a href="https://www.gnu.org/software/global/" target="_blank" rel="noopener">here</a> and the installation procedure is standard. In emacs, the packages <code>company</code> and <code>ggtags</code> are required. Basically company calls ggtags via company-capf for code completion. AC is replaced by company, as the latter works with gtags better than AC. The setup is as follows, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">(defun company-kbd-map ()</div><div class="line">  (local-set-key (kbd &quot;your_kbd&quot;) &apos;company-complete))     ;; Just like auto-complete</div><div class="line">(add-hook &apos;company-mode-hook &apos;company-kbd-map)</div><div class="line">(defun ggtags-kbd-map ()</div><div class="line">  (local-set-key (kbd &quot;your_kbd&quot;) &apos;ggtags-find-tag-dwim)  ;; Jump to definition</div><div class="line">  (local-set-key (kbd &quot;your_kbd&quot;) &apos;ggtags-prev-mark)      ;; Return to the file before jumping</div><div class="line">  (local-set-key (kbd &quot;your_kbd&quot;) &apos;ggtags-update-tags))   ;; Refresh the tagging files</div><div class="line">(add-hook &apos;ggtags-mode-hook &apos;ggtags-kbd-map)</div></pre></td></tr></table></figure></p>
<p>Since company is used instead of AC, AC needs to be turned off explicitly in C/C++ modes. Yasnippets and flycheck are used as well. Particularly, flycheck for c++-mode is to set for the C++11 standard. <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">(add-hook &apos;c-mode-common-hook</div><div class="line">  (lambda ()</div><div class="line">    (when (derived-mode-p &apos;c-mode &apos;c++-mode)</div><div class="line">      (auto-complete-mode 0)</div><div class="line">      (yas-minor-mode 1)</div><div class="line">      (flycheck-mode 1)</div><div class="line">      (ggtags-mode 1)</div><div class="line">      (company-mode 1))))</div><div class="line">(add-hook &apos;c++-mode-hook</div><div class="line">  (lambda () (setq flycheck-gcc-language-standard &quot;c++11&quot;)))</div></pre></td></tr></table></figure></p>
<h2 id="others">Others</h2>
<p>I do recommend the <a href="https://github.com/sellout/emacs-color-theme-solarized" target="_blank" rel="noopener">solarized</a> color theme, which requires packages <code>color-theme</code> and <code>color-theme-solarized</code>. For emacs &gt;= 24, activate by <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(load-theme &apos;solarized t)</div></pre></td></tr></table></figure></p>
<p>Other references:</p>
<ol style="list-style-type: decimal">
<li><a href="https://github.com/auto-complete/auto-complete/blob/master/doc/manual.md" target="_blank" rel="noopener">auto-complete</a></li>
<li><a href="http://www.flycheck.org/en/latest/" target="_blank" rel="noopener">flycheck</a></li>
<li><a href="https://www.emacswiki.org/emacs/PythonProgrammingInEmacs" target="_blank" rel="noopener">emacswiki for Python</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> coding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> emacs </tag>
            
            <tag> python </tag>
            
            <tag> cpp </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Gaussian Process Regressor - Part III]]></title>
      <url>http://smanist.github.io/2017/09/28/Gaussian-process-regressor-part-3/</url>
      <content type="html"><![CDATA[<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css"><p>Finally, let&#x2019;s talk about some variants of GPR.</p>
<a id="more"></a>
<h1 id="limitations-of-gpr">Limitations of GPR</h1>
<p>In previous articles (<a href="https://smanist.github.io/2017/09/22/Gaussian-process-regressor-part-1/">here</a> and <a href="https://smanist.github.io/2017/09/26/Gaussian-process-regressor-part-2/">here</a>), the classical formulation of Gaussian process regression (GPR) is presented. Relevant software implementation is also discussed and compared. GPR is non-parametric, and thus very flexible - it can handle any data set. Moreover, it provides the error estimate of the prediction. However, a non-parametric model like GPR has its inherent disadvantages. The prediction depends on the data set. That is, the model does not actually extract any information from the data, and it is essentially brute-force curve-fitting. Furthermore, the model is dense. The prediction requires accessing all the training data, resulting in expensive dense matrix operations. In fact, given <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span> training data points, the trainging stage requires <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><msup><mi>N</mi><mn>3</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(N^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">3</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> cost due to dense matrix inversion, and the prediction stage requires <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><msup><mi>N</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(N^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> cost due to dense matrix multiplication.</p>
<h1 id="towards-large-dataset">Towards Large Dataset</h1>
<p>In an effort to cure the weaknesses of GPR, a lot of modern variants have been developed. The basic idea is to reduce the effective <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span> in the model. The classification of variants have been well discussed in Chap. 8 of <a href="http://www.gaussianprocess.org/gpml/chapters/RW.pdf" target="_blank" rel="noopener">GPML</a> and <a href="http://www.jmlr.org/papers/volume6/quinonero-candela05a/quinonero-candela05a.pdf" target="_blank" rel="noopener">Quin2005</a>.</p>
<p>The variants can be roughly classified into two types. In the first type, the covariance matrices are replaced by their low-rank approximations, so that the cost of matrix operations depends on the rank instead of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span>. The major criticism is that the GP becomes degenerate due to the approximation. A degenerate GP would predict low or zero variance in regions far away from the training data set, which is not desirable. In the second type, a partial set of data points is selected to represent the whole data set, thus directly reducing <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span>. The challenge is, how to select the point? Greedy method might work but is probably suboptimal. There is also the variational approach that sparsifies the PGR, but I am not familiar with this aspect yet.</p>
<p>One interesting approach is the <a href="http://www.miketipping.com/sparsebayes.htm" target="_blank" rel="noopener">relevance vector machine (RVM)</a>. It applies the idea of automatic relevance determination (ARD) and finds the training data point that is of the most &#x201C;relevance&#x201D; to the model. Subsequently, a kernel is constructed from these &#x201C;relevance vectors&#x201D; to form the final prediction model. Due to the construction of the kernel, RVM is a degenerate GP, which is criticized in <a href="http://quinonero.net/Publications/rasmussen05healing.pdf" target="_blank" rel="noopener">Rasm2005</a>. A fun fact of RVM is that its 2001 version algorithm is patented, and partially discouraged its integration into some mainstream packages. Note that its faster, 2003 version of algorithm is not patented, though. One good Python implementation of RVM can be found <a href="https://github.com/AmazaspShumik/sklearn-bayes" target="_blank" rel="noopener">here</a>.</p>
<p>Another approach of the second type is the GPR with pseudo-inputs <a href="https://pdfs.semanticscholar.org/ffe0/dc8492bf9dd1e433fefe60b0dcd9d27152df.pdf" target="_blank" rel="noopener">Snel2008</a>, or termed fully independent training conditional (FITC). This approach determines a set of points from the training data, not necessarily the points in the data set itself, and generates the GPR over these &#x201C;pseudo inputs&#x201D;. The GP is still non-degenerate, but <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span> can be significantly reduced, sometimes by two orders of magnitudes. Yet the prediction is not deteriorated by much.</p>
<h1 id="a-unifying-view">A Unifying View</h1>
<p>In Quin2005, a unified framework for sparse GPR (and GPR itself) is proposed, from which the variants discussed above can be derived.</p>
<h2 id="outline-of-framework">Outline of framework</h2>
<p>In the framework, one has to differentiate between two types of variables. One is the observed noisy output <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{y}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span></span></span>, the other the underlying noise-free <em>latent</em> output <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{f}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span></span>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mo>=</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>+</mo><mi>&#x3F5;</mi></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{y}}= {\mathbf{f}}+ \epsilon
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3F5;</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3F5;</mi><mo>&#x223C;</mo><mrow><mrow><mi mathvariant="script">N</mi></mrow></mrow><mo>(</mo><mn>0</mn><mo separator="true">,</mo><mrow><msubsup><mi>&#x3C3;</mi><mi>n</mi><mn>2</mn></msubsup></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">\epsilon\sim{\mathcal{N}}(0,{\sigma_n^2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3F5;</span><span class="mrel">&#x223C;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span></span><span class="mopen">(</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose">)</span></span></span></span> is the noise, assumed to be additive and independent. The conditional satisfies <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x223C;</mo><mrow><mrow><mi mathvariant="script">N</mi></mrow></mrow><mo>(</mo><mi>v</mi><mi>f</mi><mo separator="true">,</mo><mrow><msubsup><mi>&#x3C3;</mi><mi>n</mi><mn>2</mn></msubsup></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">{\mathbf{y}}|{\mathbf{f}}\sim {\mathcal{N}}(vf,{\sigma_n^2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mrel">&#x223C;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span></span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose">)</span></span></span></span>. The training data is considered noisy, i.e. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{y}}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is provided for training. However, the prediction is expected to be noise-free, i.e. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is desired. Using a Bayesian approach, the prediction can be formulated as follows, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mi>p</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>)</mo></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mo>&#x222B;</mo><mi>p</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>)</mo><mi>d</mi><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mo>&#x222B;</mo><mfrac><mrow><mi>p</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub><mo>)</mo><mi>p</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub><mo>)</mo></mrow><mrow><mi>p</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>)</mo></mrow></mfrac><mi>d</mi><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>p</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>)</mo></mrow></mfrac><mo>&#x222B;</mo><mi>p</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub><mo>)</mo><mi>p</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub><mo>)</mo><mi>d</mi><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
p({\mathbf{f}}_u|{\mathbf{y}}_s) &amp;= \int p({\mathbf{f}}_s,{\mathbf{f}}_u|{\mathbf{y}}_s) d{\mathbf{f}}_s \\
               &amp;= \int \frac{p({\mathbf{y}}_s|{\mathbf{f}}_s,{\mathbf{f}}_u)p({\mathbf{f}}_s,{\mathbf{f}}_u)}{p({\mathbf{y}}_s)} d{\mathbf{f}}_s \\
               &amp;= \frac{1}{p({\mathbf{y}}_s)} \int p({\mathbf{y}}_s|{\mathbf{f}}_s)p({\mathbf{f}}_s,{\mathbf{f}}_u) d{\mathbf{f}}_s \\
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:4.290625em;"></span><span class="strut bottom" style="height:8.08125em;vertical-align:-3.790625em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-2.930625em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:-0.641375000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span style="top:1.6546249999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span style="top:3.430625em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-2.930625em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mop op-symbol large-op" style="margin-right:0.44445em;top:-0.0011249999999999316em;">&#x222B;</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mord mathit">d</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.641375000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mop op-symbol large-op" style="margin-right:0.44445em;top:-0.0011249999999999316em;">&#x222B;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit">d</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:1.6546249999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop op-symbol large-op" style="margin-right:0.44445em;top:-0.0011249999999999316em;">&#x222B;</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mord mathit">d</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is going to be integrated out, or &#x201C;marginalized&#x201D;, as it is of no interest to the prediction. The preceeding term <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">p({\mathbf{y}}_s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> is essentially a normalizing factor and will not be computed explicitly. The remaining term <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">p({\mathbf{f}}_s,{\mathbf{f}}_u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> in the integration would satisfy the joint Gaussian distribution as in previous derivations. This is where the large dense covariance matrix is introduced. This is where the simplification comes in.</p>
<p>In the framework, a set of <em>inducing points</em> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is assumed to be sampled from the GP like <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. Therefore, the probability should satisfy, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>p</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub><mo>)</mo><mo>=</mo><mo>&#x222B;</mo><mi>p</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub><mo>)</mo><mi>d</mi><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub><mo>=</mo><mo>&#x222B;</mo><mi>p</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub><mo>)</mo><mi>p</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub><mo>)</mo><mi>d</mi><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
p({\mathbf{f}}_s,{\mathbf{f}}_u) = \int p({\mathbf{f}}_s,{\mathbf{f}}_u,{\mathbf{f}}_i) d{\mathbf{f}}_i = \int p({\mathbf{f}}_s,{\mathbf{f}}_u|{\mathbf{f}}_i)p({\mathbf{f}}_i) d{\mathbf{f}}_i
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.36em;"></span><span class="strut bottom" style="height:2.22225em;vertical-align:-0.86225em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">p</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-symbol large-op reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.44445em;top:-0.0011249999999999316em;">&#x222B;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">p</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">d</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-symbol large-op reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.44445em;top:-0.0011249999999999316em;">&#x222B;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">p</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">p</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">d</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub><mo>&#x223C;</mo><mrow><mrow><mi mathvariant="script">N</mi></mrow></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>i</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>i</mi><mi>i</mi></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_i\sim{\mathcal{N}}({\mathbf{m}}_i,{\mathbf{K}}_{ii})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x223C;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span>. The formulation up to here is still exact. The integration for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">p({\mathbf{f}}_u|{\mathbf{y}}_s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> would result in the regular GPR model.</p>
<p>Now here comes the key assumption in the framework, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are conditionally independent given <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>p</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub><mo>)</mo><mo>&#x2248;</mo><mi>q</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub><mo>)</mo><mo>=</mo><mo>&#x222B;</mo><mi>q</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub><mo>)</mo><mi>q</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub><mo>)</mo><mi>p</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub><mo>)</mo><mi>d</mi><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
p({\mathbf{f}}_s,{\mathbf{f}}_u) \approx q({\mathbf{f}}_s,{\mathbf{f}}_u) = \int q({\mathbf{f}}_s|{\mathbf{f}}_i) q({\mathbf{f}}_u|{\mathbf{f}}_i) p({\mathbf{f}}_i) d{\mathbf{f}}_i
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.36em;"></span><span class="strut bottom" style="height:2.22225em;vertical-align:-0.86225em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">p</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2248;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03588em;">q</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-symbol large-op reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.44445em;top:-0.0011249999999999316em;">&#x222B;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03588em;">q</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03588em;">q</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">p</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">d</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> This means the dependency of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> on <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is indirectly induced by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. As a reference, the exact forms of the conditionals and the covariance matrix are, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>&#x223C;</mo><mrow><mrow><mi mathvariant="script">N</mi></mrow></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>i</mi></mrow></msub><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>i</mi><mi>i</mi></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>i</mi></msub><mo>)</mo><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>&#x223C;</mo><mrow><mrow><mi mathvariant="script">N</mi></mrow></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>u</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>i</mi></mrow></msub><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>i</mi><mi>i</mi></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>i</mi></msub><mo>)</mo><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>u</mi></mrow></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>u</mi><mi>u</mi></mrow></msub><mo>)</mo></mrow></mtd></mtr></mtable></mrow><mspace width="1em"></mspace><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub></mrow></mtd><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>s</mi></mrow></msub></mrow></mtd><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>u</mi></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\left\{
\begin{aligned}
{\mathbf{f}}_s|{\mathbf{f}}_i &amp;\sim {\mathcal{N}}({\mathbf{m}}_s-{\mathbf{K}}_{si}{\mathbf{K}}_{ii}^{-1}({\mathbf{f}}_i-{\mathbf{m}}_i), {\mathbf{K}}_{ss}-{\mathbf{Q}}_{ss}) \\
{\mathbf{f}}_u|{\mathbf{f}}_i &amp;\sim {\mathcal{N}}({\mathbf{m}}_u-{\mathbf{K}}_{ui}{\mathbf{K}}_{ii}^{-1}({\mathbf{f}}_i-{\mathbf{m}}_i), {\mathbf{K}}_{uu}-{\mathbf{Q}}_{uu})
\end{aligned}
\right.
\quad{\mathbf{K}}=
\begin{bmatrix}
{\mathbf{K}}_{ss} &amp; {\mathbf{K}}_{su} \\
{\mathbf{K}}_{us} &amp; {\mathbf{K}}_{uu}
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.474108em;"></span><span class="strut bottom" style="height:2.4482160000000004em;vertical-align:-0.9741080000000004em;"></span><span class="base displaystyle textstyle uncramped"><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">{</span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.6100000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6141080000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6100000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">&#x223C;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.266995em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">i</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:0.6141080000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">&#x223C;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.266995em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">i</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>a</mi><mi>i</mi></mrow></msub><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>i</mi><mi>i</mi></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>i</mi><mi>b</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{Q}}_{ab}={\mathbf{K}}_{ai}{\mathbf{K}}_{ii}^{-1}{\mathbf{K}}_{ib}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.854239em;"></span><span class="strut bottom" style="height:1.131103em;vertical-align:-0.276864em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">a</span><span class="mord mathit mtight">b</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">a</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.276864em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">i</span></span></span></span><span style="top:-0.403131em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">b</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>.</p>
<h2 id="approximations">Approximations</h2>
<p>Under the above framework, all the approximations are actually simplifying or approximating the term <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mo>&#x2217;</mo><mo>&#x2217;</mo></mrow></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mo>&#x2217;</mo><mo>&#x2217;</mo></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{K}}_{**}-{\mathbf{Q}}_{**}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight">&#x2217;</span><span class="mord mtight">&#x2217;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight">&#x2217;</span><span class="mord mtight">&#x2217;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. For example, the low-rank approximation approach is effectively using, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>&#x223C;</mo><mrow><mrow><mi mathvariant="script">N</mi></mrow></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>i</mi></mrow></msub><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>i</mi><mi>i</mi></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>i</mi></msub><mo>)</mo><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">O</mi></mrow></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>&#x223C;</mo><mrow><mrow><mi mathvariant="script">N</mi></mrow></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>u</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>i</mi></mrow></msub><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>i</mi><mi>i</mi></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>i</mi></msub><mo>)</mo><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">O</mi></mrow></mrow><mo>)</mo></mrow></mtd></mtr></mtable></mrow><mspace width="1em"></mspace><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub></mrow></mtd><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>u</mi><mi>s</mi></mrow></msub></mrow></mtd><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>u</mi><mi>u</mi></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\left\{
\begin{aligned}
{\mathbf{f}}_s|{\mathbf{f}}_i &amp;\sim {\mathcal{N}}({\mathbf{m}}_s-{\mathbf{K}}_{si}{\mathbf{K}}_{ii}^{-1}({\mathbf{f}}_i-{\mathbf{m}}_i), {\mathbf{O}}) \\
{\mathbf{f}}_u|{\mathbf{f}}_i &amp;\sim {\mathcal{N}}({\mathbf{m}}_u-{\mathbf{K}}_{ui}{\mathbf{K}}_{ii}^{-1}({\mathbf{f}}_i-{\mathbf{m}}_i), {\mathbf{O}})
\end{aligned}
\right.
\quad{\mathbf{K}}=
\begin{bmatrix}
{\mathbf{Q}}_{ss} &amp; {\mathbf{Q}}_{su} \\
{\mathbf{Q}}_{us} &amp; {\mathbf{Q}}_{uu}
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.474108em;"></span><span class="strut bottom" style="height:2.4482160000000004em;vertical-align:-0.9741080000000004em;"></span><span class="base displaystyle textstyle uncramped"><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">{</span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.6100000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6141080000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6100000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">&#x223C;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.266995em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">i</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">O</span></span></span><span class="mclose">)</span></span></span><span style="top:0.6141080000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">&#x223C;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.266995em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">i</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">O</span></span></span><span class="mclose">)</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span> The covariance matrices are neglected and the &#x201C;distributions&#x201D; become deterministic, and hence the term Deterministic Inducing Conditional (DIC) in the framework. The zero covariance matrix is exactly the cause of the zero error estimation in this type of approach.</p>
<p>The approximation of interest in this article, the GPRFITC model, uses the following conditionals, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>&#x223C;</mo><mrow><mrow><mi mathvariant="script">N</mi></mrow></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>i</mi></mrow></msub><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>i</mi><mi>i</mi></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>i</mi></msub><mo>)</mo><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub><mo>+</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub><mo>)</mo><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>&#x223C;</mo><mi>E</mi><mi>x</mi><mi>a</mi><mi>c</mi><mi>t</mi></mrow></mtd></mtr></mtable></mrow><mspace width="1em"></mspace><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub><mo>+</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub><mo>)</mo></mrow></mtd><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>u</mi><mi>s</mi></mrow></msub></mrow></mtd><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>u</mi></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\left\{
\begin{aligned}
{\mathbf{f}}_s|{\mathbf{f}}_i &amp;\sim {\mathcal{N}}({\mathbf{m}}_s-{\mathbf{K}}_{si}{\mathbf{K}}_{ii}^{-1}({\mathbf{f}}_i-{\mathbf{m}}_i), {\mathbf{Q}}_{ss} + diag({\mathbf{K}}_{ss}-{\mathbf{Q}}_{ss})) \\
{\mathbf{f}}_u|{\mathbf{f}}_i &amp;\sim Exact
\end{aligned}
\right.
\quad{\mathbf{K}}=
\begin{bmatrix}
{\mathbf{Q}}_{ss} + diag({\mathbf{K}}_{ss}-{\mathbf{Q}}_{ss}) &amp; {\mathbf{Q}}_{su} \\
{\mathbf{Q}}_{us} &amp; {\mathbf{K}}_{uu}
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.462054em;"></span><span class="strut bottom" style="height:2.4241080000000004em;vertical-align:-0.9620540000000004em;"></span><span class="base displaystyle textstyle uncramped"><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">{</span></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.5979460000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6020540000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.5979460000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">&#x223C;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.266995em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">i</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord mathit">d</span><span class="mord mathit">i</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span><span style="top:0.6020540000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">&#x223C;</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mord mathit">x</span><span class="mord mathit">a</span><span class="mord mathit">c</span><span class="mord mathit">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord mathit">d</span><span class="mord mathit">i</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span> Note that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">q({\mathbf{f}}_u|{\mathbf{f}}_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> is exact only when one output is requested. Otherwise, the covariance matrix will be treated like <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>s</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>i</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">q({\mathbf{f}}_s|{\mathbf{f}}_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span>.</p>
<h1 id="more-on-gprfitc">More on GPRFITC</h1>
<p>In GPRFITC, the predictive mean becomes, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>p</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>u</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>u</mi><mi>s</mi></mrow></msub><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub><mo>+</mo><mrow><mrow><mi mathvariant="bold">V</mi></mrow></mrow><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>s</mi></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>u</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>i</mi></mrow></msub><msup><mrow><mrow><mi mathvariant="bold">M</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>i</mi><mi>s</mi></mrow></msub><msup><mrow><mrow><mi mathvariant="bold">V</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>s</mi></msub><mo>)</mo></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\mathbf{m}}_p &amp;= {\mathbf{m}}_u - {\mathbf{Q}}_{us}({\mathbf{Q}}_{ss}+{\mathbf{V}})^{-1}({\mathbf{y}}_s-{\mathbf{m}}_s) \\
      &amp;= {\mathbf{m}}_u - {\mathbf{K}}_{ui}{\mathbf{M}}^{-1}{\mathbf{K}}_{is}{\mathbf{V}}^{-1}({\mathbf{y}}_s-{\mathbf{m}}_s)
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.474108em;"></span><span class="strut bottom" style="height:2.4482160000000004em;vertical-align:-0.9741080000000004em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.61em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6141080000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.61em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:0.6141080000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">M</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">V</mi></mrow></mrow><mo>=</mo><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub><mo>)</mo><mo>+</mo><mrow><msubsup><mi>&#x3C3;</mi><mi>n</mi><mn>2</mn></msubsup></mrow><mrow><mrow><mi mathvariant="bold">I</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{V}}=diag({\mathbf{K}}_{ss}-{\mathbf{Q}}_{ss})+{\sigma_n^2}{\mathbf{I}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="mrel">=</span><span class="mord mathit">d</span><span class="mord mathit">i</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">I</span></span></span></span></span></span>, and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">M</mi></mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>i</mi><mi>i</mi></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>i</mi><mi>s</mi></mrow></msub><msup><mrow><mrow><mi mathvariant="bold">V</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{M}}={\mathbf{K}}_{ii}+{\mathbf{K}}_{is}{\mathbf{V}}^{-1}{\mathbf{K}}_{si}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.964108em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">M</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. The covariance is, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>p</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>u</mi></mrow></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>u</mi><mi>s</mi></mrow></msub><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub><mo>+</mo><mrow><mrow><mi mathvariant="bold">V</mi></mrow></mrow><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>u</mi></mrow></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>u</mi><mi>u</mi></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>i</mi></mrow></msub><msup><mrow><mrow><mi mathvariant="bold">M</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>i</mi><mi>u</mi></mrow></msub></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\mathbf{K}}_p &amp;= {\mathbf{K}}_{uu} - {\mathbf{Q}}_{us}({\mathbf{Q}}_{ss}+{\mathbf{V}})^{-1}{\mathbf{Q}}_{su} \\
      &amp;= {\mathbf{K}}_{uu} - {\mathbf{Q}}_{uu} + {\mathbf{K}}_{ui}{\mathbf{M}}^{-1}{\mathbf{K}}_{iu}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.474108em;"></span><span class="strut bottom" style="height:2.4482160000000004em;vertical-align:-0.9741080000000004em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.61em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6141080000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.61em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6141080000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">M</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> Note that for the computational cost, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span> is reduced to the number of inducing points.</p>
<p>There are three matrix inversions involved in the prediction. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">V</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{V}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span></span></span></span> is diagonal, and its inversion is trivial. Inversion inside <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{Q}}_{ss}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is done using Cholesky decomposition (again), <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>i</mi></mrow></msub><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>i</mi><mi>i</mi></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>i</mi><mi>s</mi></mrow></msub><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>i</mi></mrow></msub><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>i</mi></msub><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>i</mi><mi>T</mi></msubsup><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>i</mi><mi>s</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>&#x2261;</mo><msubsup><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>&#xAF;</mo></mover><mrow><mi>i</mi><mi>s</mi></mrow><mi>T</mi></msubsup><msub><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>&#xAF;</mo></mover><mrow><mi>i</mi><mi>s</mi></mrow></msub></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\mathbf{Q}}_{ss} &amp;= {\mathbf{K}}_{si}{\mathbf{K}}_{ii}^{-1}{\mathbf{K}}_{is} = {\mathbf{K}}_{si}({\mathbf{L}}_i{\mathbf{L}}_i^T)^{-1}{\mathbf{K}}_{is} \\
         &amp;\equiv \bar{\mathbf{K}}_{is}^T\bar{\mathbf{K}}_{is}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.5013309999999997em;"></span><span class="strut bottom" style="height:2.502662em;vertical-align:-1.0013310000000002em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6413310000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.266995em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">i</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6413310000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">&#x2261;</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.25511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">s</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.25511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>&#xAF;</mo></mover><mrow><mi>i</mi><mi>s</mi></mrow></msub><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>i</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>i</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\bar{\mathbf{K}}_{is}={\mathbf{L}}_i^{-1}{\mathbf{K}}_{is}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.854239em;"></span><span class="strut bottom" style="height:1.131103em;vertical-align:-0.276864em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.25511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.276864em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.403131em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. Subsequently, inversion of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">M</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{M}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">M</span></span></span></span></span></span> utilizes the decomposition of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>i</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{K}}_{ii}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msup><mrow><mrow><mi mathvariant="bold">M</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>i</mi><mi>i</mi></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>i</mi><mi>s</mi></mrow></msub><msup><mrow><mrow><mi mathvariant="bold">V</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>i</mi></mrow></msub><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>i</mi><mrow><mo>&#x2212;</mo><mi>T</mi></mrow></msubsup><mo>(</mo><mrow><mrow><mi mathvariant="bold">I</mi></mrow></mrow><mo>+</mo><msub><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>&#xAF;</mo></mover><mrow><mi>i</mi><mi>s</mi></mrow></msub><msup><mrow><mrow><mi mathvariant="bold">V</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msubsup><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>&#xAF;</mo></mover><mrow><mi>i</mi><mi>s</mi></mrow><mi>T</mi></msubsup><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>i</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>&#x2261;</mo><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>i</mi><mrow><mo>&#x2212;</mo><mi>T</mi></mrow></msubsup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>m</mi></msub><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>m</mi><mi>T</mi></msubsup><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>i</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>&#x2261;</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mi>T</mi></mrow></msup><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\mathbf{M}}^{-1} &amp;= ({\mathbf{K}}_{ii}+{\mathbf{K}}_{is}{\mathbf{V}}^{-1}{\mathbf{K}}_{si})^{-1} = {\mathbf{L}}_i^{-T} ({\mathbf{I}}+\bar{\mathbf{K}}_{is}{\mathbf{V}}^{-1}\bar{\mathbf{K}}_{is}^T)^{-1} {\mathbf{L}}_i^{-1} \\
         &amp;\equiv {\mathbf{L}}_i^{-T} ({\mathbf{L}}_m{\mathbf{L}}_m^T)^{-1} {\mathbf{L}}_i^{-1} \\
         &amp;\equiv {\mathbf{L}}^{-T}{\mathbf{L}}^{-1}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.1269964999999997em;"></span><span class="strut bottom" style="height:3.753993em;vertical-align:-1.6269965000000002em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.2356654999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">M</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.015665500000000165em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span style="top:1.2669965em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.2356654999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.266995em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">I</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.25511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.25511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">s</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.266995em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.015665500000000165em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">&#x2261;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.266995em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">m</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">m</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.266995em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:1.2669965em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">&#x2261;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where Cholesky decomposition is applied in the middle. The last two expressions are then used in the computation of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{m}}_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.730548em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{K}}_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>.</p>
<p>The hyperparameters of GPRFITC can be trained by maximizing the marginal likelihood. <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mo>&#x2212;</mo><mn>2</mn><mrow><mrow><mi mathvariant="script">L</mi></mrow></mrow><mo>=</mo><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>s</mi></msub><msup><mo>)</mo><mi>T</mi></msup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub><mo>+</mo><mrow><mrow><mi mathvariant="bold">V</mi></mrow></mrow><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>s</mi></msub><mo>)</mo><mo>+</mo><mi>log</mi><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub><mo>+</mo><mrow><mrow><mi mathvariant="bold">V</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mo>+</mo><mi>n</mi><mi>log</mi><mn>2</mn><mi>&#x3C0;</mi></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
-2{\mathcal{L}}= ({\mathbf{y}}_s-{\mathbf{m}}_s)^T ({\mathbf{Q}}_{ss} + {\mathbf{V}})^{-1} ({\mathbf{y}}_s-{\mathbf{m}}_s) + \log|{\mathbf{Q}}_{ss} + {\mathbf{V}}| + n\log 2\pi
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">2</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal">L</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mop reset-textstyle displaystyle textstyle uncramped">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">n</span><span class="mop reset-textstyle displaystyle textstyle uncramped">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">2</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03588em;">&#x3C0;</span></span></span></span></span> where the matrix inversion is handled as before. For the determinant, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mi>log</mi><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub><mo>+</mo><mrow><mrow><mi mathvariant="bold">V</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>log</mi><mi mathvariant="normal">&#x2223;</mi><mrow><mrow><mi mathvariant="bold">V</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><mrow><mrow><mi mathvariant="bold">I</mi></mrow></mrow><mo>+</mo><msub><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>&#xAF;</mo></mover><mrow><mi>i</mi><mi>s</mi></mrow></msub><msup><mrow><mrow><mi mathvariant="bold">V</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msubsup><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>&#xAF;</mo></mover><mrow><mi>i</mi><mi>s</mi></mrow><mi>T</mi></msubsup><mi mathvariant="normal">&#x2223;</mi></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>log</mi><mi mathvariant="normal">&#x2223;</mi><mrow><mrow><mi mathvariant="bold">V</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mo>+</mo><mn>2</mn><mi>log</mi><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>m</mi></msub><mi mathvariant="normal">&#x2223;</mi></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
\log|{\mathbf{Q}}_{ss} + {\mathbf{V}}| &amp;= \log|{\mathbf{V}}||{\mathbf{I}}+\bar{\mathbf{K}}_{is}{\mathbf{V}}^{-1}\bar{\mathbf{K}}_{is}^T| \\
&amp;= \log|{\mathbf{V}}| + 2\log|{\mathbf{L}}_m|
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.4756655em;"></span><span class="strut bottom" style="height:2.4513310000000006em;vertical-align:-0.9756655000000005em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.5843345000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="mord mathrm">&#x2223;</span></span></span><span style="top:0.6156655000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.5843345000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord mathrm">&#x2223;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">I</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.25511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.25511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">s</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span></span></span><span style="top:0.6156655000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord mathrm">&#x2223;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="mord mathrm">&#x2223;</span><span class="mbin">+</span><span class="mord mathrm">2</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">m</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> The hyperparameters in <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">L</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{L}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal">L</span></span></span></span></span></span> include those in regular GPR model: the length scales, process and noise variances, as well as the extra parameters: the location of the inducing points, the number of which is proportional to the input dimension and number of points. Due the large number of hyperparameters, the only viable training approach is the gradient-based method. The gradients of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">L</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{L}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal">L</span></span></span></span></span></span> can be found in Appendix C of Snel2008. Nevertheless, as mentioned before, the gradients are automatically handled in the TensorFlow-based GPflow code.</p>
<hr>
<p>This is the end of this series of articles on GPR, which covers its derivation, computational strategy, determination of hyperparameters, and extension to other variants.</p>
]]></content>
      
        <categories>
            
            <category> digest </category>
            
        </categories>
        
        
        <tags>
            
            <tag> kriging </tag>
            
            <tag> surrogate model </tag>
            
            <tag> machine learning </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Gaussian Process Regressor - Part II]]></title>
      <url>http://smanist.github.io/2017/09/26/Gaussian-process-regressor-part-2/</url>
      <content type="html"><![CDATA[<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css"><p>This time let&#x2019;s focus on the hyperparameters.</p>
<a id="more"></a>
<h1 id="introduction">Introduction</h1>
<p>In the <a href="https://smanist.github.io/2017/09/22/Gaussian-process-regressor-part-1/">last article</a>, the Gaussian process regression (GPR) model is discussed. Given the training data, it looks like all the coefficients, the predictive mean and the variances, can be determined from those formulations. Well, that is not the whole story. There are some extra coefficients in the covariance function of the Gaussian process that need to be determined, namely the hyperparameters.</p>
<p>The determination of the hyperparameters is a little more involved than the formulations in the last article, as this problem is non-convex.</p>
<h1 id="covariance-function">Covariance function</h1>
<p>A covariance function in the Gaussian process takes the form of, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>k</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>i</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>j</mi></msub><mo>)</mo><mo>=</mo><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow><mi>R</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>i</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>j</mi></msub><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
k({\mathbf{x}}_i,{\mathbf{x}}_j) = {\sigma_f^2}R({\mathbf{x}}_i,{\mathbf{x}}_j)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.864108em;"></span><span class="strut bottom" style="height:1.2472159999999999em;vertical-align:-0.383108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03148em;">k</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.00773em;">R</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_f^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> is the process variance, and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span></span></span></span> is typically stationary, i.e. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo separator="true">,</mo><msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>)</mo><mo>=</mo><mi>R</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2212;</mo><msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">R({\mathbf{x}},{\mathbf{x}}&apos;)=R({\mathbf{x}}-{\mathbf{x}}&apos;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span>, and monotonically decreasing. It is also assumed <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>(</mo><mn>0</mn><mo>)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">R(0)=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mopen">(</span><span class="mord mathrm">0</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span>, meaning that a point correlates with itself the most. When the observation is noisy, the covariance function is modified as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>k</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>i</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>j</mi></msub><mo>)</mo><mo>=</mo><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow><mi>R</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>i</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>j</mi></msub><mo>)</mo><mo>+</mo><mrow><msubsup><mi>&#x3C3;</mi><mi>n</mi><mn>2</mn></msubsup></mrow><msub><mi>&#x3B4;</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>&#x2261;</mo><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow><mo>[</mo><mi>R</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>i</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>j</mi></msub><mo>)</mo><mo>+</mo><mrow><msubsup><mover accent="true"><mrow><mi>&#x3C3;</mi></mrow><mo>~</mo></mover><mi>n</mi><mn>2</mn></msubsup></mrow><msub><mi>&#x3B4;</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>]</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
k({\mathbf{x}}_i,{\mathbf{x}}_j) = {\sigma_f^2}R({\mathbf{x}}_i,{\mathbf{x}}_j) + {\sigma_n^2}\delta_{ij} \equiv {\sigma_f^2}[R({\mathbf{x}}_i,{\mathbf{x}}_j) + {\tilde{\sigma}_n^2}\delta_{ij}]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.864108em;"></span><span class="strut bottom" style="height:1.2472159999999999em;vertical-align:-0.383108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03148em;">k</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.00773em;">R</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03785em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2261;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.00773em;">R</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span></span></span><span style="top:-0.35em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03785em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">]</span></span></span></span></span> A typical choice of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span></span></span></span> is the squared exponential function, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>R</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>i</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>j</mi></msub><mo>)</mo><mo>=</mo><mi>exp</mi><mo>[</mo><mo>&#x2212;</mo><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>i</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>j</mi></msub><msup><mo>)</mo><mi>T</mi></msup><mrow><mrow><mi mathvariant="bold">M</mi></mrow></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>i</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>j</mi></msub><mo>)</mo><mo>]</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
R({\mathbf{x}}_i,{\mathbf{x}}_j) = \exp[-({\mathbf{x}}_i-{\mathbf{x}}_j)^T{\mathbf{M}}({\mathbf{x}}_i-{\mathbf{x}}_j)]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.177439em;vertical-align:-0.286108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.00773em;">R</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop reset-textstyle displaystyle textstyle uncramped">exp</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">M</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">]</span></span></span></span></span> where in the isotropic case, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">M</mi></mrow></mrow><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn><msup><mi>l</mi><mn>2</mn></msup></mrow></mfrac><mrow><mrow><mi mathvariant="bold">I</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{M}}=\frac{1}{2l^2}{\mathbf{I}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.845108em;"></span><span class="strut bottom" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">M</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">I</span></span></span></span></span></span> meaning that the length scales in all dimensions are the same; while in the anisotropic case, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">M</mi></mrow></mrow><mo>=</mo><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac></mrow><mi>d</mi><mi>i</mi><mi>a</mi><mi>g</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">{\mathbf{M}}={\frac{1}{2}}diag({\mathbf{l}})^{-2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.845108em;"></span><span class="strut bottom" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">M</span></span></span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mord mathit">d</span><span class="mord mathit">i</span><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">l</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is a diagonal matrix with positive diagonal entries, representing the length scales in different dimensions. In both cases, the length scales have to be figured out from the training data. The latter case is sometimes also called <a href="https://www.slideshare.net/FlorianWilhelm2/explaining-the-idea-behind-automatic-relevance-determination-and-bayesian-interpolation-59498957" target="_blank" rel="noopener">automatic relevance determination</a> (ARD), meaning that the training process automatically determines if the particular dimension has a significant influence on the output. See the <a href="http://www2.imm.dtu.dk/pubdb/views/edoc_download.php/1050/ps/imm1050.ps" target="_blank" rel="noopener">DACE manual</a> for more discussion.</p>
<p>The length scales <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{l}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">l</span></span></span></span></span></span> and the variances <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_f^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>n</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_n^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> are the <em>hyperparameters</em> to be determined in the training process. In the general sense, the coefficients for the basis functions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover></mrow><annotation encoding="application/x-tex">\bar{\mathbf{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8312199999999998em;"></span><span class="strut bottom" style="height:0.8312199999999998em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span> are hyperparameters too.</p>
<h1 id="non-dimensionalization">Non-dimensionalization</h1>
<p>Before proceeding to the training process, it is beneficial to non-dimensionalize some quantities in the GPR model. First, the covariance matrices <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{K}}_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{K}}_{su}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> can be &#x201C;non-dimensionalized&#x201D; by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_f^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>y</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>&#x2261;</mo><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover></mrow><mi>y</mi></msub><mo>&#x2261;</mo><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow><mo>(</mo><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub><mo>+</mo><mrow><msubsup><mover accent="true"><mrow><mi>&#x3C3;</mi></mrow><mo>~</mo></mover><mi>n</mi><mn>2</mn></msubsup></mrow><mrow><mrow><mi mathvariant="bold">I</mi></mrow></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi></mrow></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>&#x2261;</mo><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover></mrow><mrow><mi>s</mi><mi>u</mi></mrow></msub></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\mathbf{K}}_y &amp;\equiv {\sigma_f^2}{\tilde{\mathbf{K}}}_y \equiv {\sigma_f^2}({\tilde{\mathbf{K}}}_{ss} + {\tilde{\sigma}_n^2}{\mathbf{I}}) \\
{\mathbf{K}}_{su} &amp;\equiv {\sigma_f^2}{\tilde{\mathbf{K}}}_{su}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.556078em;"></span><span class="strut bottom" style="height:2.612156em;vertical-align:-1.056078em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.633108em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6729700000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.633108em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">&#x2261;</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2261;</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span></span></span><span style="top:-0.35em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">I</span></span></span><span class="mclose">)</span></span></span><span style="top:0.6729700000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">&#x2261;</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span></p>
<p>Subsequently, examine the effect of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_f^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> on the predictive mean, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msubsup><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>p</mi><mo>&#x2217;</mo></msubsup><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi></mrow><mi>T</mi></msubsup><mover accent="true"><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mo>&#xAF;</mo></mover><mo>+</mo><msubsup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>u</mi><mi>T</mi></msubsup><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover><mo>=</mo><msubsup><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover></mrow><mrow><mi>s</mi><mi>u</mi></mrow><mi>T</mi></msubsup><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mo>~</mo></mover></mrow><mo>+</mo><msubsup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>u</mi><mi>T</mi></msubsup><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>~</mo></mover></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{m}}_p^* = {\mathbf{K}}_{su}^T\bar{\mathbf{g}}+ {\mathbf{H}}_u^T\bar{\mathbf{b}}= {\tilde{\mathbf{K}}}_{su}^T{\tilde{\mathbf{g}}}+ {\mathbf{H}}_u^T{\tilde{\mathbf{b}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.015301em;"></span><span class="strut bottom" style="height:1.398409em;vertical-align:-0.383108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord accent reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span></span><span style="top:-0.013440000000000007em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord accent reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span style="top:-0.5369700000000001em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span></span><span style="top:-0.36344em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.61344em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> where, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>=</mo><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2261;</mo><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>~</mo></mover></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mo>&#xAF;</mo></mover></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover><mo>)</mo><mo>=</mo><msubsup><mi>&#x3C3;</mi><mi>f</mi><mrow><mo>&#x2212;</mo><mn>2</mn></mrow></msubsup><mrow><msubsup><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>~</mo></mover></mrow><mo>)</mo></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
\bar{\mathbf{b}}&amp;= ({\mathbf{H}}^T{\mathbf{K}_y^{-1}}{\mathbf{H}})^{-1}{\mathbf{H}}^T{\mathbf{K}_y^{-1}}{\mathbf{y}}_s = ({\mathbf{H}}^T{\tilde{\mathbf{K}}_y^{-1}}{\mathbf{H}})^{-1}{\mathbf{H}}^T{\tilde{\mathbf{K}}_y^{-1}}{\mathbf{y}}_s \equiv {\tilde{\mathbf{b}}}\\
\bar{\mathbf{g}}&amp;= {\mathbf{K}_y^{-1}}({\mathbf{y}}_s-{\mathbf{H}}\bar{\mathbf{b}}) = \sigma_f^{-2} {\tilde{\mathbf{K}}_y^{-1}}({\mathbf{y}}_s-{\mathbf{H}}{\tilde{\mathbf{b}}})
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.5866275em;"></span><span class="strut bottom" style="height:2.673255em;vertical-align:-1.0866275em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.6553275000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span style="top:0.6590805000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span></span><span style="top:-0.013440000000000007em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6553275000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2261;</span><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.61344em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6590805000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2914389999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.61344em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> And the covariance, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>p</mi><mo>&#x2217;</mo></msubsup></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>u</mi></mrow></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>s</mi></mrow></msub><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi></mrow></msub><mo>+</mo><msup><mrow><mrow><mi mathvariant="bold">D</mi></mrow></mrow><mi>T</mi></msup><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mrow><mi mathvariant="bold">D</mi></mrow></mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow><mo>[</mo><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover></mrow><mrow><mi>u</mi><mi>u</mi></mrow></msub><mo>&#x2212;</mo><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover></mrow><mrow><mi>u</mi><mi>s</mi></mrow></msub><mrow><msubsup><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover></mrow><mrow><mi>s</mi><mi>u</mi></mrow></msub><mo>+</mo><msup><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">D</mi></mrow></mrow><mo>~</mo></mover></mrow><mi>T</mi></msup><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">D</mi></mrow></mrow><mo>~</mo></mover></mrow><mo>]</mo></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\mathbf{K}}_p^* &amp;= {\mathbf{K}}_{uu} - {\mathbf{K}}_{us}{\mathbf{K}}_y^{-1}{\mathbf{K}}_{su} + {\mathbf{D}}^T ({\mathbf{H}}^T{\mathbf{K}_y^{-1}}{\mathbf{H}})^{-1} {\mathbf{D}}\\
        &amp;= {\sigma_f^2}[{\tilde{\mathbf{K}}}_{uu} - {\tilde{\mathbf{K}}}_{us}{\tilde{\mathbf{K}}_y^{-1}}{\tilde{\mathbf{K}}}_{su} + {\tilde{\mathbf{D}}}^T ({\mathbf{H}}^T{\tilde{\mathbf{K}}_y^{-1}}{\mathbf{H}})^{-1} {\tilde{\mathbf{D}}}]
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.586424em;"></span><span class="strut bottom" style="height:2.672848em;vertical-align:-1.086424em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.6950930000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.703316em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6950930000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">D</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">D</span></span></span></span></span><span style="top:0.703316em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">D</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.5369700000000001em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">D</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">]</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mi mathvariant="bold">D</mi></mrow></mrow><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>u</mi><mi>T</mi></msubsup><mo>&#x2212;</mo><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi></mrow></msub><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>u</mi><mi>T</mi></msubsup><mo>&#x2212;</mo><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover></mrow><mrow><mi>s</mi><mi>u</mi></mrow></msub><mo>&#x2261;</mo><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">D</mi></mrow></mrow><mo>~</mo></mover></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{D}}= {\mathbf{H}}_u^T-{\mathbf{H}}^T {\mathbf{K}_y^{-1}}{\mathbf{K}}_{su} = {\mathbf{H}}_u^T-{\mathbf{H}}^T {\tilde{\mathbf{K}}_y^{-1}}{\tilde{\mathbf{K}}}_{su} \equiv {\tilde{\mathbf{D}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9229700000000001em;"></span><span class="strut bottom" style="height:1.306078em;vertical-align:-0.383108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">D</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2261;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">D</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> In sum, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_f^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> has no direct effect on the mean, but the covariance is proportional to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_f^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span>, once the hyperparameters are given. The question is, how to obtain the hyperparameters?</p>
<h1 id="learning-the-hyperparameters">Learning the hyperparameters</h1>
<h2 id="log-likelihood">Log-likelihood</h2>
<p>The hyperparameters are determined using the maximum likelihood estimation (MLE). With the joint Gaussian distribution, the log marginal likelihood of the training data is, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mrow><mrow><mi mathvariant="script">L</mi></mrow></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>log</mi><mi>p</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">X</mi></mrow></mrow><mi>s</mi></msub><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mo>&#x2212;</mo><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><msup><mo>)</mo><mi>T</mi></msup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>y</mi></msub><mo>+</mo><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>)</mo><mo>&#x2212;</mo><mrow><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac></mrow><mi>log</mi><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>y</mi></msub><mo>+</mo><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mo>&#x2212;</mo><mfrac><mrow><mi>n</mi></mrow><mrow><mn>2</mn></mrow></mfrac><mi>log</mi><mn>2</mn><mi>&#x3C0;</mi></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\mathcal{L}}&amp;= \log p({\mathbf{y}}_s|{\mathbf{X}}_s,{\mathbf{b}},{\mathbf{B}}) \\
    &amp;= - {\frac{1}{2}}({\mathbf{y}}_s-{\mathbf{H}}{\mathbf{b}})^T ({\mathbf{K}}_y+{\mathbf{H}}^T{\mathbf{B}}{\mathbf{H}})^{-1} ({\mathbf{y}}_s-{\mathbf{H}}{\mathbf{b}}) - {\frac{1}{2}}\log |{\mathbf{K}}_y+{\mathbf{H}}^T{\mathbf{B}}{\mathbf{H}}| - \frac{n}{2}\log 2\pi
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.85372em;"></span><span class="strut bottom" style="height:3.20744em;vertical-align:-1.35372em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.01372em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal">L</span></span></span></span></span><span style="top:0.66772em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.01372em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">X</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="mpunct">,</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="mclose">)</span></span></span><span style="top:0.66772em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="mclose">)</span><span class="mbin">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord mathrm">&#x2223;</span><span class="mbin">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord mathrm">2</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span> is number of training data points. Utilizing the determinant counterpart of matrix inversion lemma, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">&#x2223;</mi><mrow><mrow><mi mathvariant="bold">A</mi></mrow></mrow><mo>+</mo><mrow><mrow><mi mathvariant="bold">U</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">C</mi></mrow></mrow><msup><mrow><mrow><mi mathvariant="bold">V</mi></mrow></mrow><mi>T</mi></msup><mi mathvariant="normal">&#x2223;</mi><mo>=</mo><mi mathvariant="normal">&#x2223;</mi><mrow><mrow><mi mathvariant="bold">A</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><mrow><mrow><mi mathvariant="bold">C</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><msup><mrow><mrow><mi mathvariant="bold">C</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>+</mo><msup><mrow><mrow><mi mathvariant="bold">V</mi></mrow></mrow><mi>T</mi></msup><msup><mrow><mrow><mi mathvariant="bold">A</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mrow><mi mathvariant="bold">U</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
|{\mathbf{A}}+{\mathbf{U}}{\mathbf{C}}{\mathbf{V}}^T| = |{\mathbf{A}}| |{\mathbf{C}}| |{\mathbf{C}}^{-1} + {\mathbf{V}}^T{\mathbf{A}}^{-1}{\mathbf{U}}|
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">A</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">U</span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">C</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">A</span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">C</span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">C</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">A</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">U</span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span></span></span></span></span> and let <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{\mathbf{b}}=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>&#x2192;</mo><mrow><mrow><mi mathvariant="bold">O</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{B}}^{-1}\rightarrow{\mathbf{O}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2192;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">O</span></span></span></span></span></span> as was done last time, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mo>&#x2212;</mo><mn>2</mn><mrow><mrow><mi mathvariant="script">L</mi></mrow></mrow><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi><mi>T</mi></msubsup><mo>[</mo><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mo>&#x2212;</mo><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mo>]</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>+</mo><mi>log</mi><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>y</mi></msub><mi mathvariant="normal">&#x2223;</mi><mo>+</mo><mi>log</mi><mi mathvariant="normal">&#x2223;</mi><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mo>+</mo><mo>(</mo><mi>n</mi><mo>&#x2212;</mo><mi>m</mi><mo>)</mo><mi>log</mi><mn>2</mn><mi>&#x3C0;</mi></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
-2{\mathcal{L}}= {\mathbf{y}}_s^T [{\mathbf{K}_y^{-1}}- {\mathbf{K}_y^{-1}}{\mathbf{H}}({\mathbf{H}}^T{\mathbf{K}_y^{-1}}{\mathbf{H}})^{-1} {\mathbf{H}}^T {\mathbf{K}_y^{-1}}] {\mathbf{y}}_s + \log|{\mathbf{K}}_y| + \log|{\mathbf{H}}^T{\mathbf{K}_y^{-1}}{\mathbf{H}}| + (n-m)\log 2\pi
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.2744389999999999em;vertical-align:-0.383108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">2</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal">L</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">]</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mop reset-textstyle displaystyle textstyle uncramped">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mop reset-textstyle displaystyle textstyle uncramped">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">n</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">m</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mop reset-textstyle displaystyle textstyle uncramped">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">2</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03588em;">&#x3C0;</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">m</span></span></span></span> is number of basis functions, and was introduced due to the singularity caused by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2223;</mi><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi></mrow><annotation encoding="application/x-tex">|{\mathbf{B}}|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x2223;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="mord mathrm">&#x2223;</span></span></span></span>. An interesting simplification can be done to the first term in the above expression, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mi>I</mi><mn>1</mn></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi><mi>T</mi></msubsup><mo>[</mo><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mo>&#x2212;</mo><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mo>]</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi><mi>T</mi></msubsup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover><mo>)</mo><mo>&#x2261;</mo><msub><mi>I</mi><mn>2</mn></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>I</mi><mn>1</mn></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover><msup><mo>)</mo><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2261;</mo><msub><mi>I</mi><mn>3</mn></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>I</mi><mn>1</mn></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi><mi>T</mi></msubsup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><msup><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover><mi>T</mi></msup><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover><mo>&#x2261;</mo><msub><mi>I</mi><mn>4</mn></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>I</mi><mn>1</mn></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mi>I</mi><mn>2</mn></msub><mo>+</mo><msub><mi>I</mi><mn>3</mn></msub><mo>&#x2212;</mo><msub><mi>I</mi><mn>4</mn></msub><mo>=</mo><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover><msup><mo>)</mo><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover><mo>)</mo></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
I_1 &amp;= {\mathbf{y}}_s^T [{\mathbf{K}_y^{-1}}- {\mathbf{K}_y^{-1}}{\mathbf{H}}({\mathbf{H}}^T{\mathbf{K}_y^{-1}}{\mathbf{H}})^{-1} {\mathbf{H}}^T {\mathbf{K}_y^{-1}}] {\mathbf{y}}_s \\
    &amp;= {\mathbf{y}}_s^T {\mathbf{K}_y^{-1}}({\mathbf{y}}_s - {\mathbf{H}}\bar{\mathbf{b}}) \equiv I_2 \\
I_1 &amp;= ({\mathbf{y}}_s - {\mathbf{H}}\bar{\mathbf{b}})^T {\mathbf{K}_y^{-1}}{\mathbf{y}}_s \equiv I_3 \\
I_1 &amp;= {\mathbf{y}}_s^T {\mathbf{K}_y^{-1}}{\mathbf{y}}_s - \bar{\mathbf{b}}^T{\mathbf{H}}^T {\mathbf{K}_y^{-1}}{\mathbf{H}}\bar{\mathbf{b}}\equiv I_4 \\
I_1 &amp;= I_2+I_3-I_4 = ({\mathbf{y}}_s - {\mathbf{H}}\bar{\mathbf{b}})^T {\mathbf{K}_y^{-1}}({\mathbf{y}}_s - {\mathbf{H}}\bar{\mathbf{b}})
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:3.4360975em;"></span><span class="strut bottom" style="height:6.372195em;vertical-align:-2.9360974999999994em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-2.5447664999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-1.2703275000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span style="top:0.004111499999998713em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:1.278550499999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:2.5529894999999994em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-2.5447664999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">[</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mbin">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose">]</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-1.2703275000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose">)</span><span class="mrel">&#x2261;</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.004111499999998713em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2261;</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">3</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:1.278550499999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mrel">&#x2261;</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">4</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:2.5529894999999994em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">3</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">4</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose">)</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> Indicating that the term <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>I</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">I_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> behaves as if it is centered at <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover></mrow><annotation encoding="application/x-tex">{\mathbf{H}}\bar{\mathbf{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8312199999999998em;"></span><span class="strut bottom" style="height:0.8312199999999998em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span>, with a covariance matrix <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{K}}_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. Furthermore, factor <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">L</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{L}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal">L</span></span></span></span></span></span> with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_f^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mo>&#x2212;</mo><mn>2</mn><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="script">L</mi></mrow></mrow><mo>~</mo></mover></mrow><mn>1</mn></msub><mo>=</mo><msubsup><mi>&#x3C3;</mi><mi>f</mi><mrow><mo>&#x2212;</mo><mn>2</mn></mrow></msubsup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>~</mo></mover></mrow><msup><mo>)</mo><mi>T</mi></msup><mrow><msubsup><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>~</mo></mover></mrow><mo>)</mo><mo>+</mo><mi>log</mi><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover></mrow><mi>y</mi></msub><mi mathvariant="normal">&#x2223;</mi><mo>+</mo><mi>log</mi><mi mathvariant="normal">&#x2223;</mi><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mo>+</mo><mo>(</mo><mi>n</mi><mo>&#x2212;</mo><mi>m</mi><mo>)</mo><mi>log</mi><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
-2{\tilde{\mathcal{L}}}_1 = \sigma_f^{-2} ({\mathbf{y}}_s - {\mathbf{H}}{\tilde{\mathbf{b}}})^T {\tilde{\mathbf{K}}_y^{-1}}({\mathbf{y}}_s - {\mathbf{H}}{\tilde{\mathbf{b}}}) + \log|{\tilde{\mathbf{K}}}_y| + \log|{\mathbf{H}}^T{\tilde{\mathbf{K}}_y^{-1}}{\mathbf{H}}| + (n-m)\log{\sigma_f^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9313em;"></span><span class="strut bottom" style="height:1.358847em;vertical-align:-0.4275469999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">2</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathcal">L</span></span></span></span><span style="top:-0.60233em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2914389999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.61344em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.61344em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mop reset-textstyle displaystyle textstyle uncramped">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mop reset-textstyle displaystyle textstyle uncramped">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">n</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">m</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mop reset-textstyle displaystyle textstyle uncramped">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where the constant term is neglected.</p>
<p>If the prior on the coefficients of the basis functions is ignored, the log-likelihood would be simplified to, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mo>&#x2212;</mo><mn>2</mn><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="script">L</mi></mrow></mrow><mo>~</mo></mover></mrow><mn>2</mn></msub><mo>=</mo><msubsup><mi>&#x3C3;</mi><mi>f</mi><mrow><mo>&#x2212;</mo><mn>2</mn></mrow></msubsup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>~</mo></mover></mrow><msup><mo>)</mo><mi>T</mi></msup><mrow><msubsup><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>~</mo></mover></mrow><mo>)</mo><mo>+</mo><mi>log</mi><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover></mrow><mi>y</mi></msub><mi mathvariant="normal">&#x2223;</mi><mo>+</mo><mi>n</mi><mi>log</mi><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
-2{\tilde{\mathcal{L}}}_2 = \sigma_f^{-2} ({\mathbf{y}}_s - {\mathbf{H}}{\tilde{\mathbf{b}}})^T {\tilde{\mathbf{K}}_y^{-1}}({\mathbf{y}}_s - {\mathbf{H}}{\tilde{\mathbf{b}}}) + \log|{\tilde{\mathbf{K}}}_y| + n\log{\sigma_f^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9313em;"></span><span class="strut bottom" style="height:1.358847em;vertical-align:-0.4275469999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">2</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathcal">L</span></span></span></span><span style="top:-0.60233em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2914389999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.61344em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.61344em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mop reset-textstyle displaystyle textstyle uncramped">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">n</span><span class="mop reset-textstyle displaystyle textstyle uncramped">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span></p>
<h2 id="process-variances">Process variances</h2>
<p>A natural step next would be finding <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_f^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> by setting <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2202;</mi><mo>(</mo><mo>&#x2212;</mo><mn>2</mn><mrow><mover accent="true"><mrow><mrow><mi mathvariant="script">L</mi></mrow></mrow><mo>~</mo></mover></mrow><mo>)</mo><mi mathvariant="normal">/</mi><mi mathvariant="normal">&#x2202;</mi><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\partial(-2{\tilde{\mathcal{L}}})/\partial{\sigma_f^2}=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9201900000000001em;"></span><span class="strut bottom" style="height:1.3394059999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mopen">(</span><span class="mord">&#x2212;</span><span class="mord mathrm">2</span><span class="mord textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathcal">L</span></span></span></span><span style="top:-0.60233em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mord mathrm">/</span><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span> and solving for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_f^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>N</mi></mrow></mfrac><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>~</mo></mover></mrow><msup><mo>)</mo><mi>T</mi></msup><mrow><msubsup><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>~</mo></mover></mrow><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\sigma_f^2}= \frac{1}{N}({\mathbf{y}}_s - {\mathbf{H}}{\tilde{\mathbf{b}}})^T {\tilde{\mathbf{K}}_y^{-1}}({\mathbf{y}}_s - {\mathbf{H}}{\tilde{\mathbf{b}}})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.32144em;"></span><span class="strut bottom" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.61344em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.61344em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>=</mo><mi>n</mi><mo>&#x2212;</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">N=n-m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mrel">=</span><span class="mord mathit">n</span><span class="mbin">&#x2212;</span><span class="mord mathit">m</span></span></span></span> for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="script">L</mi></mrow></mrow><mo>~</mo></mover></mrow><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{\tilde{\mathcal{L}}}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9201900000000001em;"></span><span class="strut bottom" style="height:1.07019em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathcal">L</span></span></span></span><span style="top:-0.60233em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>=</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">N=n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mrel">=</span><span class="mord mathit">n</span></span></span></span> for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="script">L</mi></mrow></mrow><mo>~</mo></mover></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\tilde{\mathcal{L}}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9201900000000001em;"></span><span class="strut bottom" style="height:1.07019em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathcal">L</span></span></span></span><span style="top:-0.60233em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. The former case is the center estimate of the variance, while the latter the MLE. When there are <em>multiple</em> outputs, the output variables are usually assumed to be independent, and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_f^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> can be computed separately for each output.</p>
<p>Plug the value back to the likelihood, and remove the constant terms [<a href="http://www.tandfonline.com/doi/abs/10.1080/00401706.1992.10485229" target="_blank" rel="noopener">Welch1992</a>], one obtains reduced log likelihood, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mn>1</mn></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>log</mi><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover></mrow><mi>y</mi></msub><mi mathvariant="normal">&#x2223;</mi><mo>+</mo><mi>log</mi><mi mathvariant="normal">&#x2223;</mi><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mo>+</mo><mo>(</mo><mi>n</mi><mo>&#x2212;</mo><mi>m</mi><mo>)</mo><mi>log</mi><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mn>2</mn></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>log</mi><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>~</mo></mover></mrow><mi>y</mi></msub><mi mathvariant="normal">&#x2223;</mi><mo>+</mo><mi>n</mi><mi>log</mi><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
-{\mathcal{F}}_1 &amp;= \log|{\tilde{\mathbf{K}}}_y| + \log|{\mathbf{H}}^T{\tilde{\mathbf{K}}_y^{-1}}{\mathbf{H}}| + (n-m)\log{\sigma_f^2}\\
-{\mathcal{F}}_2 &amp;= \log|{\tilde{\mathbf{K}}}_y| + n\log{\sigma_f^2}\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.556078em;"></span><span class="strut bottom" style="height:2.612156em;vertical-align:-1.056078em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.633108em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6729700000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.633108em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mbin">+</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord mathrm">&#x2223;</span><span class="mbin">+</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mbin">&#x2212;</span><span class="mord mathit">m</span><span class="mclose">)</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:0.6729700000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">K</span></span></span></span><span style="top:-0.60511em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mbin">+</span><span class="mord mathit">n</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where the only remaining unknown hyperparameters are the length scales <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{l}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">l</span></span></span></span></span></span>. Note that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathcal{F}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> should be used if a general mean function, without priors on its coefficients, is employed.</p>
<h2 id="finding-the-hyperparameters">Finding the hyperparameters</h2>
<p>There appears to be two strategies for determining the hyperparameters, the two-step and the one-step methods.</p>
<p>The two-step method utilizes the reduced log likelihood. This is the method used in the DACE toolbox and its Python translation in <a href="https://github.com/scikit-learn/scikit-learn/blob/51a765a/sklearn/gaussian_process/gaussian_process.py#L59" target="_blank" rel="noopener">sklearn</a>. The hyperparameters are divided into two groups: (1) length scales <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{l}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">l</span></span></span></span></span></span>, (2) variances <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_f^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>n</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_n^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span>. The primary unknown is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{l}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">l</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_f^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> is a function of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{l}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">l</span></span></span></span></span></span>, and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>n</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_n^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> is externally set, mainly as a device for numerical stability (namely the &#x201C;nugget&#x201D;). The objective function is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathcal{F}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. In the multi-output case, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span> for each output is computed using the same set of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{l}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">l</span></span></span></span></span></span>, and summed up as the final objective function.</p>
<p>The one-step method tries to determine all hyperparameters, even including <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover></mrow><annotation encoding="application/x-tex">\bar{\mathbf{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8312199999999998em;"></span><span class="strut bottom" style="height:0.8312199999999998em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span>, using gradient-based method. The difficulties are the efficiency of gradient-based method for the many variables and the implementation of the gradients. The first item is not a major issue with the developments in modern computational science. The second item could be indeed troublesome. But that is where the elegance of GPflow is revealed. It is based on TensorFlow, and TF handles the gradients efficiently with the computation graph model. In GPflow, one can focus on the objective functions. In its <a href="http://gpflow.readthedocs.io/en/latest/_modules/GPflow/gpr.html" target="_blank" rel="noopener">GPR implementation</a>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="script">L</mi></mrow></mrow><mo>~</mo></mover></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\tilde{\mathcal{L}}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9201900000000001em;"></span><span class="strut bottom" style="height:1.07019em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathcal">L</span></span></span></span><span style="top:-0.60233em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>~</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is employed. A limitation is that, in the multi-output case, all the outputs have to use the same <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_f^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span>. A remedy is to add a wrapper to its GPR class, and compute the MLE&#x2019;s of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_f^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> for each output.</p>
<p>In the newer version of GPR in <a href="https://github.com/scikit-learn/scikit-learn/blob/ef5cb84a/sklearn/gaussian_process/gpr.py#L21" target="_blank" rel="noopener">sklearn</a>, the gradient of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathcal{F}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> w.r.t. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{l}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">l</span></span></span></span></span></span> is introduced, and gradient-based optimization methods like <a href="https://en.wikipedia.org/wiki/Limited-memory_BFGS#L-BFGS-B" target="_blank" rel="noopener">L-BFGS-B</a> are employed. However, in the new implementation, the mean function is hardcoded to be zero, meaning that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mn>1</mn></msub><mo>=</mo><msub><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathcal{F}}_1={\mathcal{F}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. Furthermore, the variance <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_f^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> is fixed to be one, probably for easier computation of the gradients. This version essentially rules out the second group of the hyperparameters and determines the first group using gradient-based method. Therefore, the approach in this version is closer to the one-step method.</p>
<p>The GPy implementation will not be discussed here, as I am not familiar with it.</p>
]]></content>
      
        <categories>
            
            <category> digest </category>
            
        </categories>
        
        
        <tags>
            
            <tag> kriging </tag>
            
            <tag> surrogate model </tag>
            
            <tag> machine learning </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Gaussian Process Regressor - Part I]]></title>
      <url>http://smanist.github.io/2017/09/22/Gaussian-process-regressor-part-1/</url>
      <content type="html"><![CDATA[<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css"><p>This time let&#x2019;s talk about a non-parametric model.</p>
<a id="more"></a>
<h1 id="introduction">Introduction</h1>
<p>A non-parametric model uses all the training data to do predictions. In contrast, a parametric model obtains its &#x201C;parameters&#x201D; from the training data before prediction, and only uses those parameters for prediction.</p>
<p>The non-parametric model based on Gaussian process (GPR) has been around for quite a while. It has deep connections to methods such as radial basis function network (<a href="https://en.wikipedia.org/wiki/Radial_basis_function_network" target="_blank" rel="noopener">RBFN</a>). In geostatistics, and later in the field of engineering, the method is called <a href="https://en.wikipedia.org/wiki/Kriging" target="_blank" rel="noopener">kriging</a>. The GPR with explicit mean function is also called generalized least squares (<a href="https://en.wikipedia.org/wiki/Generalized_least_squares" target="_blank" rel="noopener">GLS</a>). There are two good properties of GPR. First, GPR can handle the noise in the sample data. Second, the model not only provides the interpolated value, but also the uncertainty of the prediction. These properties can be particularly useful in engineering applications - if there is time, this matter will be explained.</p>
<p>The idea of GPR is simple. It assumes that all data points are sampled from a Gaussian process, and therefore these points subject to a joint Gaussian distribution. The new data point should subject to a Gaussian distribution as well, determined by the training data. In that Gaussian distribution, the mean becomes the prediction, and the variance becomes the error estimation. In this article, the derivation of GPR will be presented, with some discussion in computational aspects. Most of the materials are based on the <a href="http://www.gaussianprocess.org/gpml/chapters/RW.pdf" target="_blank" rel="noopener">GPML</a> book (for derivation) and the manual of the <a href="http://www2.imm.dtu.dk/projects/dace/dace.pdf" target="_blank" rel="noopener">DACE</a> toolbox (for computation). The DACE manual also provides the derivation from the pointview of GLS.</p>
<h1 id="derivation">Derivation</h1>
<h2 id="the-basic-form">The basic form</h2>
<p>Assume the unknown function subjects to a GP, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>f</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>&#x223C;</mo><mrow><mrow><mi mathvariant="script">G</mi><mi mathvariant="script">P</mi></mrow></mrow><mo>(</mo><mi>m</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo separator="true">,</mo><mi>k</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo separator="true">,</mo><msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>)</mo><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
f({\mathbf{x}}) \sim {\mathcal{GP}}(m({\mathbf{x}}),k({\mathbf{x}},{\mathbf{x}}&apos;))
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.801892em;"></span><span class="strut bottom" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.10764em;">f</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x223C;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span><span class="mord mathcal" style="margin-right:0.08222em;">P</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">m</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03148em;">k</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">m({\mathbf{x}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">m</span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span></span></span></span> is the mean function and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo separator="true">,</mo><msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">k({\mathbf{x}},{\mathbf{x}}&apos;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> is the covariance function. By definition, they satisfies, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mi>m</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mrow><mi mathvariant="normal">E</mi></mrow><mo>[</mo><mi>f</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mrow><mi>k</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo separator="true">,</mo><msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>)</mo></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mrow><mi mathvariant="normal">E</mi></mrow><mo>[</mo><mo>(</mo><mi>f</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>&#x2212;</mo><mi>m</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>)</mo><mo>(</mo><mi>f</mi><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>)</mo><mo>&#x2212;</mo><mi>m</mi><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>)</mo><mo>)</mo><mo>]</mo></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
m({\mathbf{x}}) &amp;= \mathrm{E}[f({\mathbf{x}})] \\
k({\mathbf{x}},{\mathbf{x}}&apos;) &amp;= \mathrm{E}[(f({\mathbf{x}})-m({\mathbf{x}}))(f({\mathbf{x}}&apos;)-m({\mathbf{x}}&apos;))]
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.4000000000000004em;vertical-align:-0.9500000000000004em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">m</span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">E</span></span><span class="mopen">[</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">E</span></span><span class="mopen">[</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mbin">&#x2212;</span><span class="mord mathit">m</span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mbin">&#x2212;</span><span class="mord mathit">m</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">]</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> The probabilistic distribution of a set of points <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">D</mi></mrow></mrow><mo>=</mo><mo>{</mo><mrow><mrow><mi mathvariant="bold">X</mi></mrow></mrow><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mo>}</mo></mrow><annotation encoding="application/x-tex">{\mathcal{D}}=\{ {\mathbf{X}},{\mathbf{y}}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.02778em;">D</span></span></span><span class="mrel">=</span><span class="mopen">{</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">X</span></span></span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="mclose">}</span></span></span></span> sampled from GP is Gaussian, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mo>&#x223C;</mo><mrow><mrow><mi mathvariant="script">N</mi></mrow></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{y}}\sim{\mathcal{N}}({\mathbf{m}},{\mathbf{K}})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x223C;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><msub><mo>]</mo><mi>i</mi></msub><mo>=</mo><mi>m</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">X</mi></mrow></mrow><mi>i</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">[{\mathbf{m}}]_i=m({\mathbf{X}}_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">[</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathit">m</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">X</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><msub><mo>]</mo><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>k</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">X</mi></mrow></mrow><mi>i</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">X</mi></mrow></mrow><mi>j</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">[{\mathbf{K}}]_{ij}=k({\mathbf{X}}_i,{\mathbf{X}}_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mopen">[</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">X</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">X</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span>. Here the input variable <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">X</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{X}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">X</span></span></span></span></span></span> can be a matrix with each row being one sample, but only scalar output is considered for now. Now slipt the points into two sets: the training set <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">X</mi></mrow></mrow><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{X}}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">X</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> with known output <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{y}}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, and the target set <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">X</mi></mrow></mrow><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{X}}_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">X</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> with unknown output <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{y}}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. The joint distribution is still Gaussian, with the following mean, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msup><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>T</mi></msup><mo>=</mo><mo>[</mo><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">X</mi></mrow></mrow><mi>s</mi></msub><msup><mo>)</mo><mi>T</mi></msup><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">X</mi></mrow></mrow><mi>u</mi></msub><msup><mo>)</mo><mi>T</mi></msup><mo>]</mo><mo>&#x2261;</mo><mo>[</mo><msubsup><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>s</mi><mi>T</mi></msubsup><mo separator="true">,</mo><msubsup><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>u</mi><mi>T</mi></msubsup><mo>]</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{m}}^T = [{\mathbf{m}}({\mathbf{X}}_s)^T, {\mathbf{m}}({\mathbf{X}}_u)^T] \equiv [{\mathbf{m}}_s^T, {\mathbf{m}}_u^T]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">X</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">X</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">]</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2261;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">]</span></span></span></span></span> and the block covariance matrix, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub></mrow></mtd><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>s</mi></mrow></msub></mrow></mtd><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>u</mi></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{K}}= 
\begin{bmatrix}
{\mathbf{K}}_{ss} &amp; {\mathbf{K}}_{su} \\
{\mathbf{K}}_{us} &amp; {\mathbf{K}}_{uu}
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span> where the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i,j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span>th element of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{K}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span></span></span></span> is associated with the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>th and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span>th rows of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">X</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{X}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">X</span></span></span></span></span></span>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mo>[</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>a</mi><mi>b</mi></mrow></msub><msub><mo>]</mo><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>k</mi><mo>(</mo><mo>[</mo><msub><mrow><mrow><mi mathvariant="bold">X</mi></mrow></mrow><mi>a</mi></msub><msub><mo>]</mo><mi>i</mi></msub><mo separator="true">,</mo><mo>[</mo><msub><mrow><mrow><mi mathvariant="bold">X</mi></mrow></mrow><mi>b</mi></msub><msub><mo>]</mo><mi>j</mi></msub><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
[{\mathbf{K}}_{ab}]_{ij} = k([{\mathbf{X}}_a]_i, [{\mathbf{X}}_b]_j)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">a</span><span class="mord mathit mtight">b</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03148em;">k</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">X</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">a</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">X</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">b</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> In the case that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{y}}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is noisy, a white noise term with variance <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>&#x3C3;</mi><mi>n</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\sigma_n^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is added to the Gaussian distribution, adding a diagonal matrix to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{K}}_{ss}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>y</mi></msub><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub><mo>+</mo><msubsup><mi>&#x3C3;</mi><mi>n</mi><mn>2</mn></msubsup><msub><mrow><mrow><mi mathvariant="bold">I</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{K}}_y = {\mathbf{K}}_{ss} + \sigma_n^2 {\mathbf{I}}_{ss}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8641079999999999em;"></span><span class="strut bottom" style="height:1.150216em;vertical-align:-0.286108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">I</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></p>
<p>The distribution of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{y}}_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> given <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{y}}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is found by conditional probability, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>u</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x223C;</mo><mrow><mrow><mi mathvariant="script">N</mi></mrow></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>p</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>p</mi></msub><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{y}}_u|{\mathbf{y}}_s \sim {\mathcal{N}}({\mathbf{m}}_p, {\mathbf{K}}_p)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x223C;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> where the predictive mean is, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>p</mi></msub><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>u</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>s</mi></mrow></msub><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>s</mi></msub><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{m}}_p = {\mathbf{m}}_u - {\mathbf{K}}_{us}{\mathbf{K}}_y^{-1}({\mathbf{y}}_s-{\mathbf{m}}_s)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.864108em;"></span><span class="strut bottom" style="height:1.2472159999999999em;vertical-align:-0.383108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> and the covariance is, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>p</mi></msub><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>u</mi></mrow></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>s</mi></mrow></msub><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{K}}_p = {\mathbf{K}}_{uu} - {\mathbf{K}}_{us}{\mathbf{K}}_y^{-1}{\mathbf{K}}_{su}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.864108em;"></span><span class="strut bottom" style="height:1.2472159999999999em;vertical-align:-0.383108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></p>
<h2 id="using-basis-functions-for-the-mean-function">Using basis functions for the mean function</h2>
<p>The form of mean function is usually unknown beforehand, so it is more common to use a set of basis functions, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>m</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>=</mo><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><msup><mo>)</mo><mi>T</mi></msup><mrow><mrow><mi>b</mi></mrow></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
m({\mathbf{x}}) = {\mathbf{h}}({\mathbf{x}})^T{\mathcal{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">m</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">b</span></span></span></span></span></span></span> The coefficients <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi>b</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">b</span></span></span></span></span></span> have to be fitted from the sample data. Under a Bayesian framework, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi>b</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">b</span></span></span></span></span></span> is assumed to subject to, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mi>b</mi></mrow></mrow><mo>&#x223C;</mo><mrow><mrow><mi mathvariant="script">N</mi></mrow></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathcal{b}}\sim {\mathcal{N}}({\mathbf{b}}, {\mathbf{B}})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">b</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x223C;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> Taking <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi>b</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">b</span></span></span></span></span></span> into account, the GP from previous section is modified as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>f</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>&#x223C;</mo><mrow><mrow><mi mathvariant="script">G</mi><mi mathvariant="script">P</mi></mrow></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><msup><mo>)</mo><mi>T</mi></msup><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo separator="true">,</mo><mi>k</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo separator="true">,</mo><msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>)</mo><mo>+</mo><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><msup><mo>)</mo><mi>T</mi></msup><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
f({\mathbf{x}}) \sim {\mathcal{GP}}({\mathbf{h}}({\mathbf{x}})^T{\mathbf{b}},k({\mathbf{x}},{\mathbf{x}}&apos;)+{\mathbf{h}}({\mathbf{x}})^T{\mathbf{B}}{\mathbf{h}}({\mathbf{x}}))
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.10764em;">f</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x223C;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span><span class="mord mathcal" style="margin-right:0.08222em;">P</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03148em;">k</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> Extra terms due to the basis functions shall be added to the covariance matrix, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>=</mo><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">X</mi></mrow></mrow><mi>a</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">X</mi></mrow></mrow><mi>b</mi></msub><mo>)</mo><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>a</mi></msub><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><msubsup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>b</mi><mi>T</mi></msubsup><mo separator="true">,</mo><mspace width="1em"></mspace><mo>[</mo><msub><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mo>&#x2217;</mo></msub><msub><mo>]</mo><mi>i</mi></msub><mo>=</mo><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mo>(</mo><mo>[</mo><msub><mrow><mrow><mi mathvariant="bold">X</mi></mrow></mrow><mo>&#x2217;</mo></msub><msub><mo>]</mo><mi>i</mi></msub><msup><mo>)</mo><mi>T</mi></msup></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{K}}_{ab} = {\mathbf{K}}({\mathbf{X}}_a, {\mathbf{X}}_b) + {\mathbf{H}}_a {\mathbf{B}}{\mathbf{H}}_b^T,\quad [{\mathbf{H}}_*]_i={\mathbf{h}}([{\mathbf{X}}_*]_i)^T
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">a</span><span class="mord mathit mtight">b</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">X</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">a</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">X</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">b</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">a</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">b</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mopen reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mopen">[</span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">X</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></p>
<p>The extra terms make the predictive mean and covariance from the previous section extremely cumbersome to compute. Simplifications are needed and enabled by invoking the <a href="https://en.wikipedia.org/wiki/Woodbury_matrix_identity" target="_blank" rel="noopener">matrix inversion lemma</a>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mo>(</mo><mrow><mrow><mi mathvariant="bold">A</mi></mrow></mrow><mo>+</mo><mrow><mrow><mi mathvariant="bold">U</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">C</mi></mrow></mrow><msup><mrow><mrow><mi mathvariant="bold">V</mi></mrow></mrow><mi>T</mi></msup><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mrow><mrow><mi mathvariant="bold">A</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>&#x2212;</mo><msup><mrow><mrow><mi mathvariant="bold">A</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mrow><mi mathvariant="bold">U</mi></mrow></mrow><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">C</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>+</mo><msup><mrow><mrow><mi mathvariant="bold">V</mi></mrow></mrow><mi>T</mi></msup><msup><mrow><mrow><mi mathvariant="bold">A</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mrow><mi mathvariant="bold">U</mi></mrow></mrow><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msup><mrow><mrow><mi mathvariant="bold">V</mi></mrow></mrow><mi>T</mi></msup><msup><mrow><mrow><mi mathvariant="bold">A</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
({\mathbf{A}}+{\mathbf{U}}{\mathbf{C}}{\mathbf{V}}^T)^{-1} = {\mathbf{A}}^{-1} - {\mathbf{A}}^{-1}{\mathbf{U}}({\mathbf{C}}^{-1}+{\mathbf{V}}^T{\mathbf{A}}^{-1}{\mathbf{U}})^{-1} {\mathbf{V}}^T{\mathbf{A}}^{-1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">A</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">U</span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">C</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">A</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">A</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">U</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">C</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">A</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">U</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">V</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">A</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> In current case, the lemma is applied as follows, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>y</mi></msub><mo>+</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>=</mo><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mo>&#x2212;</mo><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><msup><mrow><mrow><mi mathvariant="bold">C</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mo>&#x2261;</mo><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">A</mi></mrow></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
({\mathbf{K}}_y + {\mathbf{H}}{\mathbf{B}}{\mathbf{H}}^T)^{-1} = {\mathbf{K}_y^{-1}}-{\mathbf{K}_y^{-1}}{\mathbf{H}}{\mathbf{C}}^{-1} {\mathbf{H}}^T {\mathbf{K}_y^{-1}}\equiv {\mathbf{K}_y^{-1}}-{\mathbf{A}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.2744389999999999em;vertical-align:-0.383108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">C</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2261;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">A</span></span></span></span></span></span></span></p>
<p>where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">C</mi></mrow></mrow><mo>=</mo><msup><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>+</mo><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{C}}={\mathbf{B}}^{-1} + {\mathbf{H}}^T {\mathbf{K}_y^{-1}}{\mathbf{H}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.2244389999999998em;vertical-align:-0.383108em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">C</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">H</span></span></span></span></span></span> and the subscript <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span></span></span></span> is dropped in <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{H}}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. Furthermore, the following identities can be derived, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mo>(</mo><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">A</mi></mrow></mrow><mo>)</mo></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msup><mrow><mrow><mi mathvariant="bold">C</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mo>(</mo><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">A</mi></mrow></mrow><mo>)</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><msup><mrow><mrow><mi mathvariant="bold">C</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\mathbf{B}}{\mathbf{H}}^T({\mathbf{K}_y^{-1}}-{\mathbf{A}}) &amp;= {\mathbf{C}}^{-1}{\mathbf{H}}^T{\mathbf{K}_y^{-1}}\\
({\mathbf{K}_y^{-1}}-{\mathbf{A}}){\mathbf{H}}{\mathbf{B}}&amp;= {\mathbf{K}_y^{-1}}{\mathbf{H}}{\mathbf{C}}^{-1}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.5108275em;"></span><span class="strut bottom" style="height:2.521655em;vertical-align:-1.0108275em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.6194965000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mbin">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">A</span></span></span><span class="mclose">)</span></span></span><span style="top:0.6277195em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mbin">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">A</span></span></span><span class="mclose">)</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">B</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6194965000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">C</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:0.6277195em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">C</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> The simplification procedure is bascally to cancel out matrices by combining the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{H}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">H</span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">A</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">({\mathbf{K}_y^{-1}}-{\mathbf{A}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.197216em;vertical-align:-0.383108em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mbin">&#x2212;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">A</span></span></span><span class="mclose">)</span></span></span></span> terms.</p>
<p>The predictive mean is simplified to, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msubsup><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>p</mi><mo>&#x2217;</mo></msubsup></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>u</mi></msub><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>+</mo><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>s</mi></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>u</mi></msub><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mo>)</mo><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>y</mi></msub><mo>+</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>s</mi></mrow></msub><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>+</mo><msup><mrow><mrow><mi mathvariant="bold">D</mi></mrow></mrow><mi>T</mi></msup><msup><mrow><mrow><mi mathvariant="bold">C</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>+</mo><msup><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>)</mo></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\mathbf{m}}_p^* &amp;= {\mathbf{H}}_u{\mathbf{b}}+ ({\mathbf{K}}_{us} + {\mathbf{H}}_u{\mathbf{B}}{\mathbf{H}}^T)({\mathbf{K}}_y + {\mathbf{H}}{\mathbf{B}}{\mathbf{H}}^T)^{-1}({\mathbf{y}}_s-{\mathbf{H}}{\mathbf{b}}) \\
        &amp;= {\mathbf{K}}_{us}{\mathbf{K}_y^{-1}}{\mathbf{y}}_s + {\mathbf{D}}^T {\mathbf{C}}^{-1} ({\mathbf{H}}^T {\mathbf{K}_y^{-1}}{\mathbf{y}}_s + {\mathbf{B}}^{-1}{\mathbf{b}})
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.5244389999999999em;"></span><span class="strut bottom" style="height:2.5488779999999998em;vertical-align:-1.0244389999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.633108em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6413309999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.633108em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="mbin">+</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="mclose">)</span></span></span><span style="top:0.6413309999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">D</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">C</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="mclose">)</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">D</mi></mrow></mrow><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>u</mi><mi>T</mi></msubsup><mo>&#x2212;</mo><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{D}}={\mathbf{H}}_u^T-{\mathbf{H}}^T {\mathbf{K}_y^{-1}}{\mathbf{K}}_{su}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.2244389999999998em;vertical-align:-0.383108em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">D</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. The covariance matrix is simplied to, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>p</mi><mo>&#x2217;</mo></msubsup></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>u</mi></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>u</mi></msub><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><msubsup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>u</mi><mi>T</mi></msubsup><mo>&#x2212;</mo><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>s</mi></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>u</mi></msub><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mo>)</mo><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>y</mi></msub><mo>+</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi></mrow></msub><mo>+</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><msubsup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>u</mi><mi>T</mi></msubsup><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>p</mi></msub><mo>+</mo><msup><mrow><mrow><mi mathvariant="bold">D</mi></mrow></mrow><mi>T</mi></msup><msup><mrow><mrow><mi mathvariant="bold">C</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mrow><mi mathvariant="bold">D</mi></mrow></mrow></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\mathbf{K}}_p^* &amp;= {\mathbf{K}}_{uu} + {\mathbf{H}}_u{\mathbf{B}}{\mathbf{H}}_u^T - ({\mathbf{K}}_{us}+{\mathbf{H}}_u{\mathbf{B}}{\mathbf{H}}^T) ({\mathbf{K}}_y + {\mathbf{H}}{\mathbf{B}}{\mathbf{H}}^T)^{-1} ({\mathbf{K}}_{su}+{\mathbf{H}}{\mathbf{B}}{\mathbf{H}}_u^T) \\
        &amp;= {\mathbf{K}}_p + {\mathbf{D}}^T {\mathbf{C}}^{-1} {\mathbf{D}}\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.5128849999999998em;"></span><span class="strut bottom" style="height:2.5257699999999996em;vertical-align:-1.0128849999999998em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.6215539999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6528849999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6215539999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:0.6528849999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">D</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">C</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">D</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span></p>
<p>Finally, consider the case that the coefficients are distributed uniformly, instead of Gaussian. That means <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#x2192;</mo><mrow><mn mathvariant="normal">0</mn></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{b}}\rightarrow\mathrm{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="mrel">&#x2192;</span><span class="mord textstyle uncramped"><span class="mord mathrm">0</span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>&#x2192;</mo><mrow><mrow><mi mathvariant="bold">O</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{B}}^{-1}\rightarrow {\mathbf{O}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2192;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">O</span></span></span></span></span></span>. With that, we arrive at the commonly used form of GPR, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msubsup><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>p</mi><mo>&#x2217;</mo></msubsup></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>s</mi></mrow></msub><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>+</mo><msup><mrow><mrow><mi mathvariant="bold">D</mi></mrow></mrow><mi>T</mi></msup><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>s</mi></mrow></msub><mover accent="true"><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mo>&#xAF;</mo></mover><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>u</mi></msub><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>p</mi><mo>&#x2217;</mo></msubsup></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>p</mi></msub><mo>+</mo><msup><mrow><mrow><mi mathvariant="bold">D</mi></mrow></mrow><mi>T</mi></msup><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mrow><mi mathvariant="bold">D</mi></mrow></mrow></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
{\mathbf{m}}_p^* &amp;= {\mathbf{K}}_{us}{\mathbf{K}_y^{-1}}{\mathbf{y}}_s + {\mathbf{D}}^T ({\mathbf{H}}^T{\mathbf{K}_y^{-1}}{\mathbf{H}})^{-1} {\mathbf{H}}{\mathbf{K}_y^{-1}}{\mathbf{y}}_s \\
        &amp;= {\mathbf{K}}_{us}\bar{\mathbf{g}}+ {\mathbf{H}}_u\bar{\mathbf{b}}\\
{\mathbf{K}}_p^* &amp;= {\mathbf{K}}_p + {\mathbf{D}}^T ({\mathbf{H}}^T{\mathbf{K}_y^{-1}}{\mathbf{H}})^{-1} {\mathbf{D}}\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.1244389999999997em;"></span><span class="strut bottom" style="height:3.7488779999999995em;vertical-align:-1.6244389999999997em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.2331079999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.00999999999999951em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span style="top:1.2413309999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.2331079999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">D</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.00999999999999951em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span></span><span style="top:-0.013440000000000007em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span style="top:1.2413309999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">D</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">D</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover><mo>=</mo><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">\bar{\mathbf{b}}=({\mathbf{H}}^T{\mathbf{K}_y^{-1}}{\mathbf{H}})^{-1}{\mathbf{H}}^T{\mathbf{K}_y^{-1}}{\mathbf{y}}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.2244389999999998em;vertical-align:-0.383108em;"></span><span class="base textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mo>&#xAF;</mo></mover><mo>=</mo><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover><mo>)</mo></mrow><annotation encoding="application/x-tex">\bar{\mathbf{g}}={\mathbf{K}_y^{-1}}({\mathbf{y}}_s-{\mathbf{H}}\bar{\mathbf{b}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8312199999999998em;"></span><span class="strut bottom" style="height:1.2143279999999999em;vertical-align:-0.383108em;"></span><span class="base textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span></span><span style="top:-0.013440000000000007em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose">)</span></span></span></span>. The term <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover></mrow><annotation encoding="application/x-tex">\bar{\mathbf{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8312199999999998em;"></span><span class="strut bottom" style="height:0.8312199999999998em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span> is essentially the coefficients of the mean function fitted from the sample data. Also, note that some people argue that the last term in <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>p</mi><mo>&#x2217;</mo></msubsup></mrow><annotation encoding="application/x-tex">{\mathbf{K}}_p^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.688696em;"></span><span class="strut bottom" style="height:1.071804em;vertical-align:-0.383108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> can neglected for simplicity [<a href="https://deepblue.lib.umich.edu/handle/2027.42/132844" target="_blank" rel="noopener">Sasena2002</a>].</p>
<h2 id="computational-aspects">Computational aspects</h2>
<p>The computation of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>p</mi><mo>&#x2217;</mo></msubsup></mrow><annotation encoding="application/x-tex">{\mathbf{m}}_p^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.688696em;"></span><span class="strut bottom" style="height:1.071804em;vertical-align:-0.383108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>p</mi><mo>&#x2217;</mo></msubsup></mrow><annotation encoding="application/x-tex">{\mathbf{K}}_p^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.688696em;"></span><span class="strut bottom" style="height:1.071804em;vertical-align:-0.383108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> can be tricky due to the ill-conditioned matrix inversion. The strategy is to combine <a href="https://en.wikipedia.org/wiki/Cholesky_decomposition" target="_blank" rel="noopener">cholesky decomposition</a> and <a href="https://en.wikipedia.org/wiki/QR_decomposition" target="_blank" rel="noopener">QR decomposition</a> to stabilize the inversions, i.e. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">{\mathbf{K}}_y^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.197216em;vertical-align:-0.383108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">({\mathbf{H}}^T{\mathbf{K}_y^{-1}}{\mathbf{H}})^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.2244389999999998em;vertical-align:-0.383108em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. For inversion of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{K}}_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>=</mo><mo>(</mo><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>T</mi></msup><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>=</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mi>T</mi></mrow></msup><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{K}_y^{-1}}{\mathbf{x}}= ({\mathbf{L}}{\mathbf{L}}^T)^{-1}{\mathbf{x}}= {\mathbf{L}}^{-T} ({\mathbf{L}}^{-1}{\mathbf{x}})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.891331em;"></span><span class="strut bottom" style="height:1.274439em;vertical-align:-0.383108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{L}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span></span></span></span> is a lower triangular matrix, and the matrix inversion is converted to two consecutive triangular solves. To inverse <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{H}}^T{\mathbf{K}_y^{-1}}{\mathbf{H}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.2244389999999998em;vertical-align:-0.383108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">H</span></span></span></span></span></span>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mo>=</mo><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><msup><mo>)</mo><mi>T</mi></msup><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mo>)</mo><mo>&#x2261;</mo><msup><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow><mi>T</mi></msup><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow><mo>=</mo><msup><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow><mi>T</mi></msup><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{H}}^T{\mathbf{K}_y^{-1}}{\mathbf{H}}= ({\mathbf{L}}^{-1}{\mathbf{H}})^T ({\mathbf{L}}^{-1}{\mathbf{H}}) \equiv {\mathbf{F}}^T{\mathbf{F}}= {\mathbf{R}}^T{\mathbf{R}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.2744389999999999em;vertical-align:-0.383108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2261;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">F</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">R</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">R</span></span></span></span></span></span></span> where QR decomposition is used <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow><mo>=</mo><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{Q}}{\mathbf{R}}={\mathbf{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">R</span></span></span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">F</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{Q}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">Q</span></span></span></span></span></span> is an orthogonal matrix, and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{R}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">R</span></span></span></span></span></span> is an upper triangular matrix. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{Q}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">Q</span></span></span></span></span></span> is tall and slim, because the number of rows equals to the number of samples, while the number of columns equals to the number of basis functions. With the stabilized matrix inversion introduced above, the quantities <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover></mrow><annotation encoding="application/x-tex">\bar{\mathbf{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8312199999999998em;"></span><span class="strut bottom" style="height:0.8312199999999998em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mo>&#xAF;</mo></mover></mrow><annotation encoding="application/x-tex">\bar{\mathbf{g}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58122em;"></span><span class="strut bottom" style="height:0.77566em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span></span><span style="top:-0.013440000000000007em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span> in <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mrow><mi mathvariant="bold">m</mi></mrow></mrow><mi>p</mi><mo>&#x2217;</mo></msubsup></mrow><annotation encoding="application/x-tex">{\mathbf{m}}_p^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.688696em;"></span><span class="strut bottom" style="height:1.071804em;vertical-align:-0.383108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">m</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are computed as follows, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><msup><mo>)</mo><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>T</mi></msup><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>=</mo><msup><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mi>T</mi></msup><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>)</mo><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mo>&#xAF;</mo></mover></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mrow><msubsup><mrow><mi mathvariant="bold">K</mi></mrow><mi>y</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup></mrow><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover><mo>)</mo><mo>=</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mi>T</mi></mrow></msup><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>&#xAF;</mo></mover><mo>)</mo><mo>]</mo></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
\begin{aligned}
\bar{\mathbf{b}}&amp;= ({\mathbf{H}}^T{\mathbf{K}_y^{-1}}{\mathbf{H}})^{-1}{\mathbf{H}}^T{\mathbf{K}_y^{-1}}{\mathbf{y}}_s = {\mathbf{R}}^{-1} [{\mathbf{Q}}^T({\mathbf{L}}^{-1}{\mathbf{y}}_s)] \\
\bar{\mathbf{g}}&amp;= {\mathbf{K}_y^{-1}}({\mathbf{y}}_s-{\mathbf{H}}\bar{\mathbf{b}}) = {\mathbf{L}}^{-T} [{\mathbf{L}}^{-1} ({\mathbf{y}}_s-{\mathbf{H}}\bar{\mathbf{b}})]
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.5244389999999999em;"></span><span class="strut bottom" style="height:2.5488779999999998em;vertical-align:-1.0244389999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.633108em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span style="top:0.6413309999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span></span><span style="top:-0.013440000000000007em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.633108em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">R</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span><span style="top:0.6413309999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> The covariance matrix is computed as follows, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mi>p</mi><mo>&#x2217;</mo></msubsup><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>u</mi><mi>u</mi></mrow></msub><mo>&#x2212;</mo><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi></mrow></msub><msup><mo>)</mo><mn>2</mn></msup><mo>+</mo><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mi>T</mi></mrow></msup><mo>[</mo><msubsup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>u</mi><mi>T</mi></msubsup><mo>&#x2212;</mo><msup><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow><mi>T</mi></msup><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi></mrow></msub><mo>)</mo><mo>]</mo><msup><mo>)</mo><mn>2</mn></msup></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle 
{\mathbf{K}}_p^* = {\mathbf{K}}_{uu} - ({\mathbf{L}}^{-1}{\mathbf{K}}_{su})^2 + ({\mathbf{R}}^{-T} [{\mathbf{H}}_u^T - {\mathbf{F}}^T({\mathbf{L}}^{-1}{\mathbf{K}}_{su})])^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.891331em;"></span><span class="strut bottom" style="height:1.274439em;vertical-align:-0.383108em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">R</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">]</span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi mathvariant="normal">&#x25A1;</mi><msup><mo>)</mo><mn>2</mn></msup><mo>=</mo><msup><mi mathvariant="normal">&#x25A1;</mi><mi>T</mi></msup><mi mathvariant="normal">&#x25A1;</mi></mrow><annotation encoding="application/x-tex">(\Box)^2=\Box^T\Box</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">&#x25A1;</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathrm">&#x25A1;</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x25A1;</span></span></span></span>.</p>
<h1 id="implementations-for-gpr">Implementations for GPR</h1>
<p>There are a lot of libraries that implements GPR. <a href="http://www.gaussianprocess.org/#code" target="_blank" rel="noopener">Here</a> provides a big list, which is last updated in 2011. Besides those in the list, there are four noteworthy libraries. The first one is the <a href="http://www2.imm.dtu.dk/projects/dace/" target="_blank" rel="noopener">DACE</a> MATLAB toolbox, which has some GLS flavor. It appears to be very popular in the engineering fields, especially those that relies on the MATLAB ecosystem heavily. The second one is the <a href="http://scikit-learn.org/" target="_blank" rel="noopener">sklearn</a> Python package. Up to version 0.17, the GPR is implemented in the gaussian_process.<a href="http://scikit-learn.org/0.17/modules/gaussian_process.html" target="_blank" rel="noopener">GaussianProcess</a> class, as a translation of the DACE toolbox. Afterwards, the GPR is re-implemented in the gaussian_process.<a href="http://scikit-learn.org/stable/modules/generated/sklearn.gaussian_process.GaussianProcessRegressor.html" target="_blank" rel="noopener">GaussianProcessRegressor</a> class using the formulation in GPML. Unfortunately, the new implementation only supports zero mean function. The third library is <a href="https://github.com/SheffieldML/GPy" target="_blank" rel="noopener">GPy</a>, which is a large, comprehensive repository of GP-related models. Finally, the fourth library is the <a href="http://gpflow.readthedocs.io/en/latest/" target="_blank" rel="noopener">GPflow</a>, which is an elegant implementation under the TensorFlow framework with roots from GPy. Modern variants of GPR are also included, some of which will be discussed in the follow-up articles.</p>
]]></content>
      
        <categories>
            
            <category> digest </category>
            
        </categories>
        
        
        <tags>
            
            <tag> kriging </tag>
            
            <tag> surrogate model </tag>
            
            <tag> machine learning </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Working on the Same hg Repository]]></title>
      <url>http://smanist.github.io/2017/09/18/Working-on-the-same-hg-repository/</url>
      <content type="html"><![CDATA[<p>What do we do when two users need to work on the <code>same</code> hg repository?</p>
<a id="more"></a>
<h1 id="problem">Problem</h1>
<p>By &#x201C;same&#x201D;, I mean the same folder in the filesystem. In the case that I encountered, I need to modify the repository on another user&#x2019;s account, directly, and do the regular commits, pulls, and pushes as if I were working on my own repository.</p>
<h1 id="discussion">Discussion</h1>
<p>Usually this scenario should not happen. Whenever there are two users, each user usually has his/her own repository. Modifications contributed by the <em>two</em> users are merged using standard version control methods. Furthermore, the ecosystem that the repository relies on should be in a shared state, e.g.&#xA0;in the <code>/opt</code> folder, so that the users only need to take care of the repository itself.</p>
<p>Now, what happened is that, only the first user will be the main contributor to the repository. Moreover, the repository relies on a heavy ecosystem, which is cumbersome to setup in a new account. Yes, historically, the ecosystem is setup under the second user&#x2019;s account, and not shared by the first user.</p>
<h1 id="workaround">Workaround</h1>
<p>One can always do something like following to enforce the manipulation of the repository, <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo hg -u USER OPERATION</div></pre></td></tr></table></figure></p>
<p>To avoid invoking the super user privilege, add writing permissions to the files in the <code>.hg</code> folder of the repository. <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo find .hg -type d -exec chmod 757 {} \;</div><div class="line">sudo find .hg -type f -exec chmod 646 {} \;</div></pre></td></tr></table></figure></p>
<p>When the user commits any changes to the repository, the writing permission is required to modify the .hg files.</p>
<p>Then add following information to the <code>hgrc</code> file in the repository <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[paths]</div><div class="line">dev = PATH_TO_REPO</div><div class="line">[ui]</div><div class="line">username = USER &lt;USER_EMAIL&gt;</div></pre></td></tr></table></figure></p>
<p>Then when doing <code>push</code> and <code>pull</code>, make sure to interact with the <code>dev</code> repository defined in the <code>hgrc</code> file. <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hg push dev</div><div class="line">hg pull dev</div></pre></td></tr></table></figure></p>
<p>In this manner, the commits are directed to the <code>dev</code> path under the specified user.</p>
<p>Finally, in <code>.hgrc</code> file, add <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[trusted]</div><div class="line">users = trokita</div></pre></td></tr></table></figure></p>
<p>to avoid some annoying outputs from the commandline.</p>
]]></content>
      
        <categories>
            
            <category> coding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> hg </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Getting Browser History in Chrome]]></title>
      <url>http://smanist.github.io/2017/09/18/Getting-browser-history-in-chrome/</url>
      <content type="html"><![CDATA[<p>I mean, through command line.</p>
<a id="more"></a>
<p>It is surprisingly simple, at least in Linux.</p>
<p>First find the location of the user profile of the Chrome browser. There is a file <code>History</code> that is a <code>sqlite3</code> database containing all the browsing history of this user.</p>
<p>Then, if there is no available <code>sqlite</code> client, install <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apt-get install sqlite3</div></pre></td></tr></table></figure></p>
<p>Just make sure to use <code>sqlite3</code> instead of <code>sqlite2</code>. The latter has been deprecated for a while.</p>
<p>Finally, do <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sqlite3 History <span class="string">&quot;select datetime(last_visit_time/1000000-11644473600,&apos;unixepoch&apos;),url from  urls order by last_visit_time desc&quot;</span> &gt; history_export.txt</div></pre></td></tr></table></figure></p>
<p>References:</p>
<ol style="list-style-type: decimal">
<li><a href="https://askubuntu.com/questions/631631/getting-internet-browsing-history-from-shell" target="_blank" rel="noopener">one source</a></li>
<li><a href="https://productforums.google.com/forum/#!topic/chrome/WiBZ3e_sEAM" target="_blank" rel="noopener">an older source</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> coding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> chrome </tag>
            
            <tag> shell </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[SSH to a host]]></title>
      <url>http://smanist.github.io/2017/09/11/SSH-to-a-host/</url>
      <content type="html"><![CDATA[<p>Some notes for setting up SSH connection to a remote computer.</p>
<a id="more"></a>
<p>The most straightforward way is apparently <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh user@host</div></pre></td></tr></table></figure></p>
<p>For frequent access, it would be nice to create an alias in the <code>.bashrc</code> file, <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">alias</span> myssh=<span class="string">&apos;ssh user@host&apos;</span></div></pre></td></tr></table></figure></p>
<p>Naive connection to host would require the password of <code>username</code>. So a better way is to setup the <a href="https://www.ssh.com/ssh/public-key-authentication" target="_blank" rel="noopener">public key authentication</a>, i.e.&#xA0;a security key pair on the local and the remote computers.</p>
<p>The <a href="https://www.ssh.com/ssh/keygen/" target="_blank" rel="noopener">steps</a> are simple. First, run <code>ssh-keygen</code> to generate the private and the public keys using the specified algorithm, which by default is the RSA. Then, the public key needs to be copied to the host and installed in the <code>authorized_keys</code> file. One can either do it manually, or using a handy tool, <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh-copy-id -i path_to_key user@host</div></pre></td></tr></table></figure></p>
<p>Finally, <code>scp</code> can be used to transfer files to and from the host. The usage is just like the <code>cp</code> command, <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">scp user@host:path_to_file_to_copy path_to_copied_file</div><div class="line">scp path_to_file_to_copy user@host:path_to_copied_file</div></pre></td></tr></table></figure></p>
<p>Again, for frequent access to a particular host, it would be nice to avoid <code>user@host</code> in the <code>scp</code> command. Something like below is expected, <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">myscp <span class="_">-d</span> path_to_file_to_copy path_to_copied_file</div><div class="line">myscp -u path_to_file_to_copy path_to_copied_file</div></pre></td></tr></table></figure></p>
<p>The <code>myscp</code> command can be implemented as follows, <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">function</span> <span class="function"><span class="title">myscp</span></span>() {</div><div class="line">  user=<span class="string">&quot;user@host:&quot;</span></div><div class="line">  scpwrapper <span class="variable">$user</span> <span class="string">&quot;<span class="variable">$@</span>&quot;</span></div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>And the <code>scpwrapper</code> function is defined as, <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">function</span> <span class="function"><span class="title">scpwrapper</span></span>() {</div><div class="line">  user=<span class="variable">$1</span></div><div class="line">  <span class="comment"># Default: file from local to server</span></div><div class="line">  opt=<span class="string">&quot;&quot;</span></div><div class="line">  u1=<span class="string">&quot;&quot;</span></div><div class="line">  u2=<span class="variable">$user</span></div><div class="line"></div><div class="line">  <span class="keyword">if</span> [ <span class="variable">$#</span> -le 5 ]; <span class="keyword">then</span></div><div class="line">    <span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$1</span>&quot;</span> == <span class="string">&quot;-h&quot;</span> ]; <span class="keyword">then</span></div><div class="line">        <span class="built_in">echo</span> <span class="string">&quot;Wrapper for scp to a given server&quot;</span></div><div class="line">        <span class="built_in">echo</span> <span class="string">&quot;    -u Upload to server&quot;</span></div><div class="line">        <span class="built_in">echo</span> <span class="string">&quot;    -d Download from server&quot;</span></div><div class="line">        <span class="built_in">echo</span> <span class="string">&quot;    -* Options for scp&quot;</span></div><div class="line">        <span class="built_in">return</span> 0</div><div class="line">    <span class="keyword">fi</span></div><div class="line">    <span class="keyword">while</span> [[ <span class="variable">$#</span> &gt; 3 ]]</div><div class="line">    <span class="keyword">do</span></div><div class="line">      key=<span class="string">&quot;<span class="variable">$2</span>&quot;</span></div><div class="line">      <span class="keyword">case</span> <span class="variable">$key</span> <span class="keyword">in</span></div><div class="line">        -u)</div><div class="line">        u1=<span class="string">&quot;&quot;</span></div><div class="line">        u2=<span class="variable">$user</span></div><div class="line">        <span class="built_in">shift</span></div><div class="line">        ;;</div><div class="line">        <span class="_">-d</span>)</div><div class="line">        u1=<span class="variable">$user</span></div><div class="line">        u2=<span class="string">&quot;&quot;</span></div><div class="line">        <span class="built_in">shift</span></div><div class="line">        ;;</div><div class="line">        *)</div><div class="line">        opt=<span class="variable">$key</span></div><div class="line">        <span class="built_in">shift</span></div><div class="line">        ;;</div><div class="line">      <span class="keyword">esac</span></div><div class="line">    <span class="keyword">done</span></div><div class="line">  <span class="keyword">else</span></div><div class="line">    <span class="built_in">echo</span> <span class="string">&quot;Too many arguments&quot;</span></div><div class="line">    <span class="built_in">echo</span> <span class="string">&quot;Exiting&quot;</span></div><div class="line">    <span class="built_in">return</span> 1</div><div class="line">  <span class="keyword">fi</span></div><div class="line"></div><div class="line">  f1=<span class="variable">$2</span></div><div class="line">  f2=<span class="variable">$3</span></div><div class="line">  <span class="built_in">echo</span> <span class="string">&quot;Executing: scp <span class="variable">$opt</span> <span class="variable">$u1</span><span class="variable">$f1</span> <span class="variable">$u2</span><span class="variable">$f2</span>&quot;</span></div><div class="line">  scp <span class="variable">$opt</span> <span class="variable">$u1</span><span class="variable">$f1</span> <span class="variable">$u2</span><span class="variable">$f2</span></div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>References:</p>
<ol style="list-style-type: decimal">
<li><a href="https://www.ssh.com/ssh/keygen/" target="_blank" rel="noopener">ssh-keygen</a></li>
<li><a href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" target="_blank" rel="noopener">RSA</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> coding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> shell </tag>
            
            <tag> ssh </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Mosasaurus]]></title>
      <url>http://smanist.github.io/2017/08/16/Mosasaurus/</url>
      <content type="html"><![CDATA[<p>The lizard from the Meuse river.</p>
<a id="more"></a>
<p>There is a huge marine reptile mounted in the Havard Natural History Museum. But not to be confused with another marine reptile appeared in a recent movie.</p>
<p>The one in the movie is <a href="https://en.wikipedia.org/wiki/Mosasaurus" target="_blank" rel="noopener">Mosasaurus</a>, which is from one of the 38 genera of Mosasaurs. Mosasaurs literally means Meuse reptile, or <em>lizards</em>. The Meuse river is where their first fossil remains were discovered. Recent research indicated that Mosasaurs swam like sharks and were endothermic and viviparous.</p>
<p>The one in the museum is <a href="https://en.wikipedia.org/wiki/Kronosaurus" target="_blank" rel="noopener">Kronosaurus</a>, one genus from Pliosauroidae. The pliosaurs were short-necked plesiosaurs, as indicated by the plio prefix, and were distant cousins of modern <em>turtles</em>. The pliosaurs had large heads and massive toothed jaws and swum like a turtle. Interestingly, the specimen in Havard is probably reconstructed with too many vertebrae.</p>
<p>Mosasaurus and Kronosaurus do have common relatives in the evolutionary tree. To start with, they both belong to class <a href="https://en.wikipedia.org/wiki/Sauropsida" target="_blank" rel="noopener">Sauropsida</a>, &#x201C;lizard faces&#x201D;, including all existing birds and reptiles and their extinct relatives. Note that there is a class Reptilia for reptiles, semi-deprecated due to the advent of phylogenetic nomenclature. Then clade <a href="https://en.wikipedia.org/wiki/Eureptilia" target="_blank" rel="noopener">Eureptilia</a>, &#x201C;true reptiles&#x201D;, characterized by two disconnected groups of bones in the skull. Then clade <a href="https://en.wikipedia.org/wiki/Diapsida" target="_blank" rel="noopener">Diapsida</a>, &#x201C;two arches&#x201D;, the only clade that survives through the Permian period, characterized by two holes in the skull. Then clade <a href="https://en.wikipedia.org/wiki/Neodiapsida" target="_blank" rel="noopener">Neodiapsida</a>, &#x201C;new two arches&#x201D;, including all the diapsids since the early Permian period. Finally, the clade <a href="https://en.wikipedia.org/wiki/Sauria" target="_blank" rel="noopener">Sauria</a>, a crowned-group of all modern reptiles including birds (and their extinct relatives of course).</p>
<p>Sauria divides into two clades. One is <a href="https://en.wikipedia.org/wiki/Lepidosauromorpha" target="_blank" rel="noopener">Lepidosauromorpha</a>, &#x201C;scaled lizard forms&#x201D;, including all diapsids closer to lizards than to crocodiles and birds. The other is <a href="https://en.wikipedia.org/wiki/Archosauromorpha" target="_blank" rel="noopener">Archosauromorpha</a>, &#x201C;ruling lizard forms&#x201D;, including the rest diapsids in Sauria. Mosasaurus belongs to the order <a href="https://en.wikipedia.org/wiki/Squamata" target="_blank" rel="noopener">Squamata</a>, containing scaled reptiles comprising all lizards and snakes. Squamata belongs to the clade <a href="https://en.wikipedia.org/wiki/Lepidosauria" target="_blank" rel="noopener">Lepidosauria</a> under Lepidosauromorpha, &#x201C;scaled lizards&#x201D;, i.e.&#xA0;reptiles with overlapping scales. Kronosaurus under Plesiosauria belongs to clade <a href="https://en.wikipedia.org/wiki/Sauropterygia" target="_blank" rel="noopener">Sauropterygia</a>, &#x201C;lizard flippers&#x201D;, aquatic reptiles swimming with flippers. Sauropterygia belongs to the clade <a href="https://en.wikipedia.org/wiki/Pantestudines" target="_blank" rel="noopener">Pantestudines</a> under Archosauromorpha, containing tetrapods more closely related to turtles.</p>
<p>During the late Cretaceous period, with the extinction of the ichthyosaurs and pliosaurs, mosasaurs became the dominant marine predators. So it is a little wired that a Cretaceous creature appeared in a movie themed Jurassic period.</p>
<p>References:</p>
<ol style="list-style-type: decimal">
<li><a href="http://islanublar.jurassicworld.com/dinosaurs/mosasaurus/" target="_blank" rel="noopener">A movie</a></li>
<li><a href="https://www.geol.umd.edu/~jmerck/geol431/lectures/17sauropsida.html" target="_blank" rel="noopener">Skull of Eureptilia</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> pieces </category>
            
        </categories>
        
        
        <tags>
            
            <tag> zoology </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[The Barnstar]]></title>
      <url>http://smanist.github.io/2017/06/26/Barnstar/</url>
      <content type="html"><![CDATA[<p>The five-pointed star as a popular decoration for barns and households.</p>
<a id="more"></a>
<p>The star is usually called a &#x201C;Amish star&#x201D; or a &#x201C;Pennsylvania star&#x201D;, but maybe more officially the barnstar. It does originate from Pennsylvania, but it is not from the Amish culture.</p>
<p>The story begins in the eighteenth century, in <a href="https://en.wikipedia.org/wiki/Electoral_Palatinate" target="_blank" rel="noopener">Palatinate of the Rhine</a>, when groups of people were religiously presecuted. These people are Anabaptists, who are Christians who believe that &#x201C;baptism is only valid when the candidate confesses his or her faith in Christ and wants to be baptized&#x201D;. The Anabaptists refused to take oaths and participate in military actions or civil government because of their belief, which resulted in the presecution. The group of Anabaptists who followed <a href="https://en.wikipedia.org/wiki/Jakob_Ammann" target="_blank" rel="noopener">Jakob Ammann</a> is called Amish.</p>
<p>In 1775, the german-speaking anabaptists, including the Amish and the non-Amish, immigrated to Pennsylvania to seek religious freedom. These people were referred to first using the word &#x201C;Deutsch&#x201D; by the English Colonists, and later a more collective term &#x201C;<a href="https://en.wikipedia.org/wiki/Pennsylvania_Dutch" target="_blank" rel="noopener">Pennsylvania Dutch</a>&#x201D;. However, the Amish (and also the <a href="https://en.wikipedia.org/wiki/Mennonite" target="_blank" rel="noopener">Mennonite</a>) people, called the &#x201C;plain people&#x201D;, are quite different from the rest of the Pennsylvania Dutch people, called the &#x201C;fancy people&#x201D;. The plain people adhere to strict religious beliefs and austere dress. Some of the communities only use four colors in their life, which are considered natural, white (cloud), blue (sky), brown (dirt), and green (plants). The <em>fancy</em> people introduced their form of folk art style to the local culture, including the barnstar.</p>
<p>Originally, the barnstars were meant to represent the mark of the builder. Later the symbol becames more frequently used for decoration and considered a good sign for the farmers. The star-in-circle form evolves into what is nowadays called &#x201C;<a href="https://en.wikipedia.org/wiki/Hex_sign" target="_blank" rel="noopener">hex sign</a>&#x201D;. The misconception between the Amish and the barnstar/hex sign is driven by <a href="http://peopleof.oureverydaylife.com/meaning-amish-star-8581.html" target="_blank" rel="noopener">commercial purposes to a degree</a>. Again, the Amish <a href="http://www.amishnews.com/featurearticles/Storyofhexsigns.htm" target="_blank" rel="noopener">do not</a> use the hex signs.</p>
<p>References:</p>
<ol style="list-style-type: decimal">
<li><a href="https://en.wikipedia.org/wiki/Barnstar" target="_blank" rel="noopener">Wikipedia</a></li>
<li><a href="https://web.archive.org/web/20061126014408/http://www.the-artistic-garden.com/barn-star.html" target="_blank" rel="noopener">Meanings of barnstar</a></li>
<li><a href="http://pioneerthinking.com/short-history-of-the-amish-barn-star" target="_blank" rel="noopener">More on &#x201C;Amish&#x201D; star</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> pieces </category>
            
        </categories>
        
        
        <tags>
            
            <tag> history </tag>
            
            <tag> symbols </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Math for Hexo]]></title>
      <url>http://smanist.github.io/2017/06/08/Math-for-Hexo/</url>
      <content type="html"><![CDATA[<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css"><p>The issue of type-setting Math formulae in Hexo-based GitHub site. This is more twisted than I expected.</p>
<a id="more"></a>
<h2 id="trial-1-kramed-mathjax">Trial 1: kramed + MathJax</h2>
<p>First, the <code>mathjax</code> support is needed. If not supported by the theme, <code>mathjax</code> can be installed by, <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install hexo-renderer-mathjax --save</div></pre></td></tr></table></figure></p>
<p>Then, the renderers for <code>markdown</code> and <code>mathjax</code> have <a href="http://2wildkids.com/2016/10/06/%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86Hexo%E5%92%8CMathJax%E7%9A%84%E5%85%BC%E5%AE%B9%E9%97%AE%E9%A2%98/" target="_blank" rel="noopener">known</a> conflict. To resolve the issue, an alternative renderer for <code>markdown</code> is needed, <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm uninstall hexo-renderer-marked --save</div><div class="line">npm install hexo-renderer-kramed --save</div></pre></td></tr></table></figure></p>
<p>This solution works fine locally. However, it does not work on GitHub when it is deployed. The reason is probably that the renderer for MathJax requires the calling of external <code>js</code> scripts, which is banned by the GitHub for safety issues.</p>
<p>Similar thing happened before, when this site was started. There was an external javascript that randomly generates some quotes to be displayed on the main webpage. It did not work on GitHub. Eventually, I replaced it with my own local version.</p>
<h2 id="trial-2-pandoc-mathjax">Trial 2: pandoc + MathJax</h2>
<p>After some googling, I encountered with another <a href="https://blog.yuanbin.me/posts/2014/05/play-mathjax-with-pandoc.html" target="_blank" rel="noopener">solution</a> based on <a href="http://pandoc.org/" target="_blank" rel="noopener"><code>pandoc</code></a>. This is essentially using an alternative renderer for Markdown, with the hope that the Math formulae can be generated &#x201C;statically&#x201D;. <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install hexo-renderer-pandoc --save</div></pre></td></tr></table></figure></p>
<p>Some files have to be added to the theme, as indicated by the webpage above.</p>
<p>Yet, this solution does not work for me for the same reason as the first solution.</p>
<h2 id="trial-3-pandoc-katex">Trial 3: pandoc + KaTeX</h2>
<p>So looks like the problem is with MathJax. What about a different processor for Math formulae, like <a href="https://www.npmjs.com/package/hexo-katex" target="_blank" rel="noopener"><code>KaTeX</code></a>?</p>
<p>The support for KaTeX is straight forward, <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install hexo-katex --save</div></pre></td></tr></table></figure></p>
<p>Then add the following to <code>_config.yml</code> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">pandoc:</div><div class="line">  mathEngine: katex</div></pre></td></tr></table></figure></p>
<p>And it works! It seems the Math is directly injected into the <code>html</code> file, so the calling of external javascript can be avoided.</p>
<p><code>pandoc</code> has a slightly different way in rendering <code>Markdown</code>, which introduces more flavors. For example, the <code>newcommand</code> in LaTeX can be enabled by adding extensions in the preamble area of the markdown file, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">variant: markdown+latex_macros</div></pre></td></tr></table></figure></p>
<h2 id="testing">Testing</h2>
<p>Inline math: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>=</mo><mi>y</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x=y+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span></p>
<p>Between line: <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mfrac><mrow><mi>x</mi></mrow><mrow><mi>y</mi></mrow></mfrac><mo>=</mo><mi>f</mi></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \frac{x}{y}=f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.10756em;"></span><span class="strut bottom" style="height:1.9880000000000002em;vertical-align:-0.8804400000000001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.6860000000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit" style="margin-right:0.03588em;">y</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">x</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.10764em;">f</span></span></span></span></span> Another line</p>
<p>Verify if the conflict is resolved: <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msubsup><mo>&#x222B;</mo><mi>a</mi><mi>b</mi></msubsup><msub><mi>f</mi><mn>1</mn></msub><mi>d</mi><mi>x</mi></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \int_a^bf_1dx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.460108em;"></span><span class="strut bottom" style="height:2.372358em;vertical-align:-0.91225em;"></span><span class="base displaystyle textstyle uncramped"><span class="mop reset-textstyle displaystyle textstyle uncramped"><span class="mop op-symbol large-op" style="margin-right:0.44445em;top:-0.0011249999999999316em;">&#x222B;</span><span class="msupsub"><span class="vlist"><span style="top:0.91225em;margin-left:-0.44445em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">a</span></span></span><span style="top:-0.9740000000000001em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">b</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">d</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">x</span></span></span></span></span></p>
<p>Katex supports the <code>newcommand</code> directives. However, using a user-defined command inside newcommand will <em>result in an error</em>.</p>
<p>Additional references:</p>
<ol>
<li><a href="https://fsh0524.github.io/2016/03/03/LaTeX-in-Hexo/" target="_blank" rel="noopener">Trial 1</a></li>
<li><a href="http://liuhongjiang.github.io/hexotech/2015/08/12/mathjax-in-hexo/" target="_blank" rel="noopener">Trial 2</a></li>
<li><a href="https://github.com/wzpan/hexo-renderer-pandoc" target="_blank" rel="noopener">Trial 3</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> coding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> hexo </tag>
            
            <tag> latex </tag>
            
            <tag> mathjax </tag>
            
            <tag> katex </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Roadworkers to Aviators]]></title>
      <url>http://smanist.github.io/2017/05/27/Roadworkers_to_Pilots/</url>
      <content type="html"><![CDATA[<p>A <a href="http://www.engin.umich.edu/college/about/news/stories/2016/may/chen-pdf/chen-61-mse" target="_blank" rel="noopener">story</a> of Chinese-Americans in the early years of American aviation.</p>
<a id="more"></a>
<p>A study on the lives of <a href="https://en.wikipedia.org/wiki/First_Transcontinental_Railroad" target="_blank" rel="noopener">Chinese railroad workers</a> and their descendents revealed a serendipity finding that, three of the familifies are connected by the <a href="https://en.wikipedia.org/wiki/Flying_Tigers" target="_blank" rel="noopener">Flying Tigers</a>.</p>
<p>The name &#x201C;Flying Tigers&#x201D; refers to three successive organizations: The American Volunteer Group (1941-1942), The China Air Task Force (1942-1943), and The 14th Air Force (1943-). The commander is <a href="https://en.wikipedia.org/wiki/Claire_Lee_Chennault" target="_blank" rel="noopener">Claire Chennault</a>. There is an exhibition on the Flying Tigers in the <a href="http://sandiegoairandspace.org/collection/item/american-volunteer-group-flying-tigers-collection" target="_blank" rel="noopener">San Diego Air and Space Museum</a>.</p>
<p>In the article, the lives of six people are described. Three of them, Chin Lin Sou, Jim King, and Chan Fong, are first-generation immigrants from China. They share some characteristics. First, they are all from Guangdong, a province in southern China. This is not uncommon. A lot of Cantonese in that era took the harsh voyage to America for gold rush, or/and escape from warfares in their homeland. Then, the three are educated, which distinguishes them from the other workers. Most Chinese workers could not speak fluent English, and are led by white foremans. After the road construction, Chin became one of the pioneers of Colorado, and King ended up being a tenent farmer in California. The life of Chan were a little more twisted. He had a business in Mississipi first, but had to move to Ohio due to then hostility towards Chinese. Chan and his wife passed away in their early ages, leaving behind ten children. That is another characteristic of the three people: They have a lot of children. Not sure if that was common in that era, or was that also due to some Chinese beliefs.</p>
<p>The other three, W. C. Chin, Bill King, and Moon Chen are the descendents. They are all graduated from college or specialized school. In particular, Chen had to earn his own tuitions due to the loss of his parents. In the Flying Tigers, Chin worked as communication officers, King was a fighter pilot. Chen was the personal representative of Chennault and flew the <a href="https://en.wikipedia.org/wiki/The_Hump" target="_blank" rel="noopener">Hump routes</a>. After war, Chin and King returned to their hometowns and started their local businesses. Chen stepped further. He continued to work with Chennault for airlines supporting the post-war rehabilitation of China. Later he worked with Northrop on the <a href="https://en.wikipedia.org/wiki/Northrop_F-5" target="_blank" rel="noopener">F-5E</a> jet fighter program.</p>
<p>Reference:</p>
<ol style="list-style-type: decimal">
<li>See the links above</li>
</ol>
]]></content>
      
        <categories>
            
            <category> digest </category>
            
        </categories>
        
        
        <tags>
            
            <tag> history </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[The Second Jaw of the Eels]]></title>
      <url>http://smanist.github.io/2017/05/27/Eel/</url>
      <content type="html"><![CDATA[<p>Some eels possess two sets of movable jaws, so are Xenomorphs.</p>
<a id="more"></a>
<p>The first set of jaw is regular one, namely <code>oral jaw</code>. The second set of jaw is called <code>pharyngeal jaw</code>. The usage of the jaw is best illustrated by this <a href="https://www.wired.com/2014/04/absurd-creature-of-the-week-this-eel-fires-extra-alien-jaws-out-of-its-throat/" target="_blank" rel="noopener">gif</a>.</p>
<p>Not all eels have pharyngeal jaws. The eels with this feature belong to <code>Muraenidae</code>, i.e.&#xA0;Moray eels. And not only eels have pharyngeal jaws. <a href="https://en.wikipedia.org/wiki/Cichlid" target="_blank" rel="noopener">Cichlids</a> have that too. In fact, the pharyngeal jaw structure has made cichlids one of the most diverge species of fish.</p>
<p>As for moray eels, the pharyngeal jaw helps the eating process. Most bony fish eat by suction. However, the moray eels do not have strong muscles to create the low pressure inside their body to suck in their prey. Instead, they bite and swallow with the help of the second jaw. Maybe this is the result of evolution. The moray eels are concealed inside crevices and alcoves, which are narrow - No space for the large muscles needed for suction. The restriction of the environment induced the gill arches of the moray eels to develop into movable jaws.</p>
<p>The function of the pharyngeal jaws in moray eels are not (re)discovered until 2007, by the <a href="http://www.nature.com/nature/journal/v449/n7158/abs/nature06062.html" target="_blank" rel="noopener">work</a> conducted people from UC Davis. The researchers found that in 1960s, <a href="http://scholarspace.manoa.hawaii.edu/bitstream/10125/7408/1/v21n3-348-363.pdf" target="_blank" rel="noopener">similar studies</a> have been published (but did not got popular). Another example of <a href="https://en.wikipedia.org/wiki/Stigler%27s_law_of_eponymy" target="_blank" rel="noopener">Stigler&#x2019;s law of eponymy</a>.</p>
<p>Func facts: 1. Moray eels sometimes cooperate with groupers for hunting, which is probably the only known example interspecies cooperative hunting in fish. 2. Eel swims by generating a travelling waving along its body. This enables swimming in the reversed direction. It would be fun to observe the vortex-shedding from the eel body. 3. H. R. Giger <a href="http://www.nytimes.com/2007/09/11/science/11eel.html" target="_blank" rel="noopener">indicated</a> that he has not studied any animals when creating the Aliens in 1979. He and the director just wanted to make it frightening.</p>
<p><a href="http://www.dictionary.com/browse/weel" target="_blank" rel="noopener">Weel</a>, the nature always acts ahead.</p>
<p>Reference:</p>
<ol style="list-style-type: decimal">
<li><a href="https://en.wikipedia.org/wiki/Pharyngeal_jaw" target="_blank" rel="noopener">Pharyngeal jaw</a></li>
<li><a href="https://en.wikipedia.org/wiki/Moray_eel" target="_blank" rel="noopener">Moray eel</a></li>
<li>And the linkes included in the article.</li>
</ol>
]]></content>
      
        <categories>
            
            <category> pieces </category>
            
        </categories>
        
        
        <tags>
            
            <tag> zoology </tag>
            
            <tag> alien </tag>
            
            <tag> mechanics </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Google Drive on Linux, A Command-line Tool]]></title>
      <url>http://smanist.github.io/2017/05/26/Google_drive_on_linux/</url>
      <content type="html"><![CDATA[<p>This works on Ubuntu 12.04.</p>
<a id="more"></a>
<p>As of 05/26/2017, Google has not provided a tool for Google Drive on Linux. Third party softwares have been developed to fill this gap. Some are GUI-based, such as the support added in the <a href="http://www.omgubuntu.co.uk/2015/09/gnome-3-18-google-drive-nautilus-support" target="_blank" rel="noopener">GNOME project</a> and some are command-line, such as <a href="https://github.com/astrada/google-drive-ocamlfuse" target="_blank" rel="noopener">google-drive-ocamlfuse</a>.</p>
<p>Yet, I have no plan to upgrade to higher version of GNOME, nor spend money on the GUI tools (Some are commercial). The PPA source of <code>google-drive-ocamlfuse</code> seems to be non-exist.</p>
<p>However, later I encountered with this commline-line tool <code>drive</code>. The tool caught my eyes immediately, because it is based on the <code>go</code> language. It looks neat to me to resolve an issue with a Google service using a Google product.</p>
<p>The steps are simple:</p>
<ol style="list-style-type: decimal">
<li>Install the <code>go</code> language from <a href="https://golang.org/doc/install" target="_blank" rel="noopener">here</a></li>
<li>Make sure to add <code>PATH</code> and <code>GOPATH</code> to the shell environment</li>
<li>Follow the <a href="https://github.com/odeke-em/drive" target="_blank" rel="noopener">steps</a> to install <code>drive</code></li>
<li><p>In particular, one needs to do, <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">drive init &lt;folder_to_mount_google_drive&gt;</div><div class="line"><span class="built_in">cd</span> &lt;folder_to_mount_google_drive&gt;</div><div class="line">drive pull</div></pre></td></tr></table></figure></p></li>
<li><p>One can also add a <code>.driveignore</code> file to ignore some files for syncronizing. Just like <code>git</code> or <code>hg</code>.</p></li>
</ol>
]]></content>
      
        <categories>
            
            <category> coding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> shell </tag>
            
            <tag> google </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Interesting/Useful Shell Commands/Tools]]></title>
      <url>http://smanist.github.io/2017/05/12/Interesting-shell-commands/</url>
      <content type="html"><![CDATA[<p>This is a gathering of shell commands or tools that look interesting - some are amazing.</p>
<p>The list is in alphabetical order.</p>
<a id="more"></a>
<h2 id="ag">ag</h2>
<p><code>ag</code>, <a href="https://github.com/ggreer/the_silver_searcher" target="_blank" rel="noopener">the silver searcher</a>, is a tool similar to <code>ack</code>. Well, I have been using <code>grep</code> only all the time.</p>
<p>But indeed, <code>ag</code> is fast, and by default it does recursive search, returns line numbers too, and have highlighting. So I probably would migrate from <code>grep</code> to <code>ag</code>. One thing to note, since it&#x2019;s recursive, it&#x2019;s necessary to specify the scope of search. One can use <code>-G [regexpr]</code> for files to include, and <code>--ignore [regexpr]</code> to exclude some files.</p>
<p>There is a good <a href="http://conqueringthecommandline.com/book/ack_ag" target="_blank" rel="noopener">guide</a> for this tool.</p>
<h2 id="cloc">cloc</h2>
<p><code>cloc</code> stands for &#x201C;Count Lines of Code&#x201D;. Basically it analyzes given file(s)/folder, counts the lines, returns the number of lines of code, comment, and blank. Its <a href="http://cloc.sourceforge.net" target="_blank" rel="noopener">website</a> provides a good introduction to this tool. There are a lot of similar tools available, as listed <a href="http://www.locmetrics.com/alternatives.html" target="_blank" rel="noopener">here</a>. <code>cloc</code> supports more languages than most of other ones.</p>
<p>I used to use <code>wc</code> to count the sizes of my projects, which typically look like the following, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">find . -regex &quot;.*\.\(cc\|h\|py\|pyx\|pxd\|txt\)&quot; ! -regex &quot;blah&quot; ! -path &quot;blah&quot; | xargs wc -l | tail -1</div></pre></td></tr></table></figure></p>
<p>I have to use <code>find</code> to identify the files I want to take into account, then send to <code>wc</code> to count lines of each file, and finally output the last line, which is the sum of all lines.</p>
<p>With <code>cloc</code>, I can simply do, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cloc . [--exclude-ext=blah]</div></pre></td></tr></table></figure></p>
<p>It identifies all code-related files - so I don&#x2019;t need to manually exclude files related to documentation. I use <code>doxygen</code> and it generates numerous html files. And it provides a summary of the code files categorized by language - provides more info than my home-made shell command.</p>
<p><code>cloc</code> can also diff codes. I have not seen this type of needs. When I need to compare different versions of my projects, version-control software is sufficient for me.</p>
<h2 id="fasd">fasd</h2>
<p><code>fasd</code> is tool for faster access to files and directories, as described in its <a href="https://github.com/clvv/fasd" target="_blank" rel="noopener">webpage</a>. It is inspired by <code>autojump</code>, <code>z</code> and <code>v</code>. In fact, initially I wanted to write about <code>autojump</code>, which is a Python-based tool. Then I came across <code>fasd</code>, purely Shell. I prefer to use shell-based tool in shell. <code>fasd</code> records the places one have visited, and ranks those by &#x201C;frecency&#x201D; i.e. &#x201C;frequency+recency&#x201D;, just like webpages. Later on, it would be able to guess which place to visit when the user types in only a few letters.</p>
<p><code>fasd</code> comes with a list of aliases. Some of them are, <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">alias</span> a=<span class="string">&apos;fasd -a&apos;</span>        <span class="comment"># List all files and directories in the database</span></div><div class="line"><span class="built_in">alias</span> d=<span class="string">&apos;fasd -d&apos;</span>        <span class="comment"># List only the directories in the database</span></div><div class="line"><span class="built_in">alias</span> f=<span class="string">&apos;fasd -f&apos;</span>        <span class="comment"># List only the files in the database</span></div><div class="line"><span class="built_in">alias</span> z=<span class="string">&apos;fasd_cd -d&apos;</span>     <span class="comment"># cd, same functionality as j in autojump</span></div></pre></td></tr></table></figure></p>
<p>My favorite is <code>z</code>. Suppose I have visited a place called <code>foo/bar</code> very frequently and recently, then wherever I am, I can do something like <code>z fo</code> to jump to <code>foo/bar</code>. <code>fasd</code> just estimates where I want to go most likely. For the other three, <code>a</code>, <code>d</code>, and <code>f</code> can be used to check the current frecency of the entries in the database.</p>
<h2 id="htop">htop</h2>
<p>An enhanced version of <code>top</code>. It visualizes the usage of the CPU, memory, and swap. More importantly, it is interactive! One can click on the entries to sort the processes. For a lazy guy like me, it saves the trouble of memorizing the short-cuts. Its functionalities are detailed in its help. Its <a href="http://hisham.hm/htop/" target="_blank" rel="noopener">website</a> is pretty cool as well.</p>
<h2 id="thefuck">thefuck</h2>
<p>This tool corrects the previous mis-typed console command. Its awesomeness is explained by this <a href="https://github.com/nvbn/thefuck" target="_blank" rel="noopener">video</a>. I think no more explanation is needed here.</p>
<h2 id="tmux">tmux</h2>
<p><code>tmux</code> is termed &#x201C;terminal multiplexer&#x201D;. According to its <a href="https://tmux.github.io/" target="_blank" rel="noopener">website</a>, it lets you switch easily between several programs in one terminal, detach them and reattach them to a different terminal. However, I personally use <code>terminator</code>, mainly for splitting the terminal into several panes for multiple tasks. It is easy to use and can record/modify the configuration just like <code>tmux</code>.</p>
<p>There is a <a href="http://lukaszwrobel.pl/blog/tmux-tutorial-split-terminal-windows-easily" target="_blank" rel="noopener">guy</a> switched from <code>terminator</code> to <code>tmux</code>. Following advantages of <code>tmux</code> are pointed out,</p>
<ol style="list-style-type: decimal">
<li>Portability - tmux works on all systems able to handle plain, old terminal.</li>
<li>Scriptability - tmux can be scripted, so that setting up windows and panes takes nothing more than one or two keystrokes.</li>
<li>Server-client architecture - tmux can be used to share sessions between users.</li>
<li>Tweaks and options - both tmux and Terminator are easy to get with, but it&#x2019;s tmux that allows to go further and offers wide range of configuration hacks.</li>
</ol>
<p>Well, the best tool is determined by the working environment, right?</p>
<h2 id="yapf">yapf</h2>
<p><code>yapf</code> stands for <a href="https://pypi.python.org/pypi/yapf" target="_blank" rel="noopener">&#x201C;Yet Another Python Formatter&#x201D;</a>. As the name indicates, there are already some Python formatter out there. These formatters try to conform the Python code with the PEP8 standard. It looks like <code>yapf</code> uses some smarter algorithms for this purpose.</p>
<p>Well, somehow I prefer my formatting, esp. the dictionaries and argument lists. <code>yapf</code> provides the identifier to avoid formatting some regions of the code, <figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># yapf: disable</span></div><div class="line">Your code</div><div class="line"><span class="comment"># yapf: enable</span></div></pre></td></tr></table></figure></p>
<p>This is not convenient enough. I would just continue to use <a href="https://www.pylint.org" target="_blank" rel="noopener"><code>pylint</code></a>.</p>
<h2 id="you-get">you-get</h2>
<p><code>you-get</code> behaves like <code>wget</code>. As described by its <a href="https://pypi.python.org/pypi/you-get" target="_blank" rel="noopener">webpage</a>, it is a &#x201C;Dumb downloader that scrapes the web&#x201D;.</p>
<p>I have not used this one yet though. No such need yet.</p>
<h2 id="asciinema"><a href="https://asciinema.org/" target="_blank" rel="noopener">asciinema</a></h2>
<p>I ran into this when I collect materials for this post.</p>
]]></content>
      
        <categories>
            
            <category> coding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> shell </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[The Raccoon]]></title>
      <url>http://smanist.github.io/2017/04/24/Raccoon/</url>
      <content type="html"><![CDATA[<p>The names of the animal <code>raccoon</code> in different languages turn out to be describing the same characteristic behavior of a raccoon.</p>
<a id="more"></a>
<p>That is <code>washing</code>. It tends to wash its food, whatever food, before eating it.</p>
<p>Raccoon&#x2019;s scientific name is <em>Procyon lotor</em>, where &#x201C;Procyon&#x201D; is the genus for raccoons (meaning dog-like), and &#x201C;lotor&#x201D; is literally &#x201C;washer&#x201D;.</p>
<p>Following is an incomplete list of languages that describe raccoons as &#x201C;washing bear&#x201D;</p>
<ol style="list-style-type: decimal">
<li>German: waschbar, wash::bear</li>
<li>Italian: orsetto lavatore, bear cub::washer</li>
<li>Hungarian: mos&#xF3;medve, wash::bear</li>
<li>Chinese: &#x6D63;&#x718A;, wash::bear</li>
<li>Japanese: &#x30A2;&#x30E9;&#x30A4;&#x30B0;&#x30DE;, wash::bear</li>
<li>French: raton laveur, rat::washer (well, rat&#x2026;)</li>
<li>Portuguese: rat&#xE3;o-lavadeiro, rat::washer</li>
</ol>
<p>Even the English name, &#x201C;raccoon&#x201D;, is somewhat related to washing too. It is believed that the word is adopted from the Powhatan language in the Virginia Colony. The Powhatan word for raccoon is &#x201C;ahrah-koon-em&#x201D;, which means &#x201C;[the] one who rubs, scrubs and scratches with its hands&#x201D;.</p>
<p>So why on earth raccoons &#x201C;wash&#x201D; their food? It is due to its senses. Raccoons do not have great vision, in fact, they are thought to be color blind. On the contrary, Raccoons&#x2019; paws have excellent sense of touch. So they need to &#x201C;rub&#x201D; an object to gain more information on it, e.g.&#xA0;is it edible? Furthermore, the sensors on their paws becomes more sensitive when wet, so raccoons tend to &#x201C;wash&#x201D; their paws before sensing their food. So they looks like washing their food.</p>
<p>References:</p>
<ol style="list-style-type: decimal">
<li><a href="https://en.wikipedia.org/wiki/Raccoon" target="_blank" rel="noopener">Wikipedia</a></li>
<li>Google translation</li>
</ol>
]]></content>
      
        <categories>
            
            <category> pieces </category>
            
        </categories>
        
        
        <tags>
            
            <tag> zoology </tag>
            
            <tag> etymology </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[The Rosetta Project]]></title>
      <url>http://smanist.github.io/2017/04/19/The-rosetta-project/</url>
      <content type="html"><![CDATA[<p>As the name implies, the Rosetta project is for linguistic acquisition by inferring, and hopefully mastering, the underlying structure of unfamiliar languages from translation.</p>
<a id="more"></a>
<p>Posts under this project:</p>
<ol style="list-style-type: decimal">
<li><a href="https://smanist.github.io/2017/04/14/A-vision-seen-after-a-rain/">A Vision Seen After A Rain</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> plan </category>
            
        </categories>
        
        
        <tags>
            
            <tag> rosetta </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[A Vision Seen After A Rain]]></title>
      <url>http://smanist.github.io/2017/04/14/A-vision-seen-after-a-rain/</url>
      <content type="html"><![CDATA[<p>A translation of &#x2018;&#x96E8;&#x4E0A;&#x304C;&#x308A;&#x306B;&#x898B;&#x305F;&#x5E7B;&#x2019; by <code>The Pillows</code>.</p>
<a id="more"></a>
<p>The Japanese version is from <a href="http://j-lyric.net/artist/a0006c3/l01b07f.html" target="_blank" rel="noopener">here</a>. The English translation is based on <a href="http://www.nautiljon.com/paroles/the+pillows/ameagari+ni+mita+maboroshi.html" target="_blank" rel="noopener">this</a>. Title translation is from <a href="https://en.wikipedia.org/wiki/Ameagari_ni_mita_Maboroshi" target="_blank" rel="noopener">wiki</a>. Modified according to this <a href="https://www.youtube.com/watch?v=UoN7qINNAX0" target="_blank" rel="noopener">video</a>.</p>
<h2 id="lyric">Lyric</h2>
<h3 id="section-1">Section 1</h3>
<p>&#x30B8;&#x30E7;&#x30FC;&#x30AF;&#x306F;&#x7B11;(&#x308F;&#x3089;)&#x3046;&#x306E;&#x304C;&#x793C;&#x5100;(&#x308C;&#x3044;&#x304E;)&#x3055;<br>
To laugh at a joke is good manners</p>
<p>&#x5446;(&#x3042;&#x304D;)&#x308C;&#x308B;&#x306A;&#x3088; &#x7B11;(&#x308F;&#x3089;)&#x3063;&#x3066;&#x3088;<br>
Don&#x2019;t be surprised, laugh</p>
<p>&#x805E;(&#x304D;)&#x304D;&#x98FD;(&#x3042;)&#x304D;&#x3066;&#x308B;&#x3068;&#x3057;&#x3066;&#x3082;<br>
Even if you&#x2019;re sick of hearing it.</p>
<p>&#x601D;(&#x304A;&#x3082;)&#x3063;&#x305F;&#x3088;&#x308A;&#x9060;(&#x3068;&#x304A;)&#x304F;&#x307E;&#x3067;&#x6765;(&#x304D;)&#x305F;<br>
I made it farther than I thought I would</p>
<p>&#x524D;(&#x307E;&#x3048;)&#x3070;&#x304B;&#x308A;&#x3092;&#x898B;(&#x307F;)&#x3066;&#x305F;&#x304B;&#x3089;<br>
Just because I was only looking back</p>
<p>&#x30AD;&#x30DF;&#x306E;&#x9854;(&#x304B;&#x304A;)&#x5FD8;(&#x308F;&#x3059;)&#x308C;&#x305F;&#x3051;&#x3069;<br>
I forgot your face but&#x2026;</p>
<h3 id="section-2">Section 2</h3>
<p>&#x8DB3;&#x8DE1;(&#x3042;&#x3057;&#x3042;&#x3068;)&#x306E;&#x7121;(&#x306A;)&#x3044;&#x9053;(&#x307F;&#x3061;)&#x3092;&#x9078;(&#x3048;&#x3089;)&#x3093;&#x3067;<br>
We chose a road without footprints</p>
<p>&#x305A;&#x3044;&#x3076;&#x3093;&#x6B69;(&#x3042;&#x308B;)&#x3044;&#x305F;&#x306A;<br>
And we walk it well.</p>
<p>&#x5E7C;(&#x304A;&#x3055;&#x306A;)&#x3044;&#x5922;(&#x3086;&#x3081;)&#x50B7;(&#x304D;&#x305A;)&#x3064;&#x3044;&#x3066;&#x3082;<br>
Even if I realized the dream was childish</p>
<p>&#x4ECA;(&#x3044;&#x307E;)&#x3082;&#x773A;(&#x306A;&#x304C;)&#x3081;&#x3066;&#x308B;<br>
I&#x2019;m still gazing at it</p>
<p>&#x305D;&#x3046; &#x4F55;&#x5EA6;(&#x306A;&#x3093;&#x3069;)&#x3082; &#x305D;&#x3046; &#x4F55;&#x5EA6;(&#x306A;&#x3093;&#x3069;)&#x3082; &#x4F55;&#x5EA6;(&#x306A;&#x3093;&#x3069;)&#x3082;<br>
Over and over; over and over; again and again</p>
<p>&#x30AD;&#x30DF;&#x3068;&#x3068;&#x3082;&#x306B;<br>
With you.</p>
<h3 id="section-3">Section 3</h3>
<p>&#x5168;(&#x3059;&#x3079;)&#x3066;&#x304C;&#x5909;(&#x304B;)&#x308F;&#x308B;&#x304B;&#x3082;&#x3057;&#x308C;&#x306A;&#x3044;<br>
It might be that everything will change</p>
<p>&#x8718;&#x86DB;(&#x304F;&#x3082;)&#x306E;&#x7CF8;(&#x3044;&#x3068;)&#x3092;&#x3088;&#x3058;&#x767B;(&#x306E;&#x307C;)&#x3063;&#x3066;<br>
We climb the spider&#x2019;s thread</p>
<p>&#x8A8D;(&#x307F;&#x3068;)&#x3081;&#x5408;(&#x3042;)&#x3063;&#x305F;&#x50D5;(&#x307C;&#x304F;)&#x3089;&#x306F;<br>
We agreed that this</p>
<p>&#x6642;&#x4EE3;(&#x3058;&#x3060;&#x3044;)&#x3082;&#x80CC;&#x666F;(&#x306F;&#x3044;&#x3051;&#x3044;)&#x3082;&#x305D;&#x3050;&#x308F;&#x306A;&#x3044;<br>
Age and setting didn&#x2019;t match up.</p>
<p>&#x907A;&#x7269;(&#x3044;&#x3076;&#x3064;)&#x306A;&#x3093;&#x3060;&#x3068;&#x601D;(&#x304A;&#x3082;)&#x3044;&#x77E5;(&#x3057;)&#x3063;&#x305F;<br>
We realized our memento was</p>
<p>&#x629C;(&#x306C;)&#x3051;&#x51FA;(&#x3060;)&#x3057;&#x305F;&#x58C1;&#x753B;(&#x3078;&#x304D;&#x304C;)&#x306E;&#x5922;(&#x3086;&#x3081;)<br>
A mural dream that slipped away.</p>
<h3 id="section-4">Section 4</h3>
<p>&#x5343;&#x5E74;(&#x305B;&#x3093;&#x3048;&#x3093;)&#x5F8C;(&#x3054;)&#x306E;&#x96E8;(&#x3042;&#x3081;)&#x306B;&#x306A;&#x3063;&#x3066;<br>
After being rain for one thousand years</p>
<p>&#x50D5;(&#x307C;&#x304F;)&#x3089;&#x306F;&#x964D;(&#x3075;)&#x308B;&#x3060;&#x308D;&#x3046;<br>
We will fall.</p>
<p>&#x592A;&#x967D;(&#x305F;&#x3044;&#x3088;&#x3046;)&#x3068;&#x3082;&#x89E3;(&#x308F;&#x304B;)&#x308A;&#x5408;(&#x3042;)&#x3063;&#x3066;<br>
I wonder if the rainbow that comes</p>
<p>&#x8679;(&#x306B;&#x3058;)&#x3092;&#x51FA;(&#x3060;)&#x305B;&#x308B;&#x304B;&#x306A;<br>
To understand the sun will come out.</p>
<p>&#x53F6;(&#x304B;&#x306A;)&#x3063;&#x305F;&#x3089; &#x53F6;(&#x304B;&#x306A;)&#x3063;&#x305F;&#x3089; &#x53F6;(&#x304B;&#x306A;)&#x3063;&#x305F;&#x3089;<br>
If it comes true, if it comes true, if it comes true</p>
<p>&#x7DBA;&#x9E97;(&#x304D;&#x308C;&#x3044;)&#x3060;&#x308D;&#x3046;&#x306A;<br>
Wouldn&#x2019;t it be beautiful</p>
<h3 id="section-5">Section 5</h3>
<p>&#x8E0F;(&#x3075;)&#x307F;&#x5916;(&#x306F;&#x305A;)&#x3057;&#x305F;&#x5D16;&#x3063;&#x6DF5;(&#x304C;&#x3051;&#x3063;&#x3077;&#x3061;)&#x3067;&#x3082;<br>
Even if I lose my footing at the cliff&#x2019;s edge</p>
<p>&#x624B;(&#x3066;)&#x3092;&#x63B4;(&#x3064;&#x304B;)&#x3093;&#x3067;&#x304F;&#x308C;&#x305F;<br>
You would catch my hand.</p>
<p>&#x96E8;(&#x3042;&#x3081;)&#x4E0A;(&#x3042;)&#x304C;&#x308A;&#x306B;&#x898B;(&#x307F;)&#x305F;&#x5E7B;(&#x307E;&#x307C;&#x308D;&#x3057;)&#x3092;<br>
I still remember the vision</p>
<p>&#x4ECA;(&#x3044;&#x307E;)&#x3082;&#x899A;(&#x304A;&#x307C;)&#x3048;&#x3066;&#x308B;<br>
Seen after the rain.</p>
<h3 id="section-6">Section 6</h3>
<p>&#x8DB3;&#x8DE1;(&#x3042;&#x3057;&#x3042;&#x3068;)&#x306E;&#x7121;(&#x306A;)&#x3044;&#x9053;(&#x307F;&#x3061;)&#x3092;&#x9078;(&#x3048;&#x3089;)&#x3093;&#x3067;<br>
We chose a road without footprints</p>
<p>&#x305A;&#x3044;&#x3076;&#x3093;&#x6B69;(&#x3042;&#x308B;)&#x3044;&#x305F;&#x306A;<br>
And we walk it well.</p>
<p>&#x8352;&#x91CE;(&#x3053;&#x3046;&#x3084;)&#x306E;&#x679C;(&#x306F;)&#x3066; &#x4F55;&#x51E6;(&#x3069;&#x3053;)&#x304B;&#x306B;&#x304D;&#x3063;&#x3068;<br>
To the ends of the wastelands and beyond</p>
<p>&#x8DB3;&#x8DE1;(&#x3042;&#x3057;&#x3042;&#x3068;)&#x6B8B;(&#x306E;&#x3053;)&#x3063;&#x3066;&#x308B;<br>
Our footprints will surely be left behind.</p>
<p>&#x305D;&#x308C;&#x3060;&#x3051;&#x304C; &#x305D;&#x308C;&#x3060;&#x3051;&#x304C; &#x305D;&#x308C;&#x3060;&#x3051;&#x304C;<br>
And that&#x2019;s just, and that&#x2019;s just, and that&#x2019;s just</p>
<p>&#x751F;(&#x3044;)&#x304D;&#x305F;&#x8A3C;(&#x3042;&#x304B;&#x3057;)<br>
Proof that we lived</p>
<p>&#x305D;&#x308C;&#x3060;&#x3051;&#x304C; &#x305D;&#x308C;&#x3060;&#x3051;&#x304C; &#x305D;&#x308C;&#x3060;&#x3051;&#x304C;<br>
And that&#x2019;s just, and that&#x2019;s just, and that&#x2019;s just</p>
<p>&#x50D5;(&#x307C;&#x304F;)&#x3089;&#x306E;&#x8A87;(&#x307B;&#x3053;)&#x308A;<br>
Our pride.</p>
<h2 id="discussion">Discussion</h2>
<h3 id="particles">Particles</h3>
<p>Let&#x2019;s start with particles.</p>
<h4 id="particles-&#x306F;-and-&#x304C;">Particles &#x306F; and &#x304C;</h4>
<p>The first line is a good example of distinction between &#x306F; and &#x304C;.<br>
&gt; &#x30B8;&#x30E7;&#x30FC;&#x30AF;&#x306F;&#x7B11;&#x3046;&#x306E;&#x304C;&#x793C;&#x5100;&#x3055;</p>
<p>In general, &#x306F; marks the topic of the context, which is more like &#x201C;Speaking of &#x2026;&#x201D;. &#x304C; marks the subject of the context. In particular, it introduces the subject that is new to the context, which is like the <code>new</code> operator in C++. Often, &#x304C; is also used for emphasis. In the case of the lyric, &#x306F; and &#x304C; form a subordinate clause. &#x306F; labels the subject of the subordinate, and &#x304C; the main clause.</p>
<p>For more discussion, see <a href="https://www.thoughtco.com/japanese-particles-wa-vs-ga-4091105" target="_blank" rel="noopener">this post</a></p>
<h3 id="verb">Verb</h3>
<p>Again the fisrt line. Noticing the verb &#x7B11;&#x3046; in the subordinate.<br>
&gt; &#x30B8;&#x30E7;&#x30FC;&#x30AF;&#x306F;&#x7B11;&#x3046;&#x306E;&#x304C;&#x793C;&#x5100;&#x3055;</p>
<h4 id="&#x4E00;&#x6BB5;&#x3044;&#x3061;&#x3060;&#x3093;-and-&#x4E94;&#x6BB5;&#x3054;&#x3060;&#x3093;-verbs">&#x4E00;&#x6BB5;(&#x3044;&#x3061;&#x3060;&#x3093;) and &#x4E94;&#x6BB5;(&#x3054;&#x3060;&#x3093;) verbs</h4>
<p>The verbs are categorized into &#x4E00;&#x6BB5; (ru-verbs) and &#x4E94;&#x6BB5; (u-verbs) verbs based on suffixes/conjugation. They are roughly categorized as follows, <figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> <span class="keyword">not</span> <span class="string">&apos;end with -&#x308B;&apos;</span>:</div><div class="line">    &#x4E94;&#x6BB5; verb</div><div class="line"><span class="keyword">else</span>:</div><div class="line">    <span class="keyword">if</span> <span class="string">&apos;end with &#x3059;&#x308B; and &#x304F;&#x308B;&apos;</span>:</div><div class="line">        Irregular</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        might be &#x4E00;&#x6BB5; verb</div></pre></td></tr></table></figure></p>
<p>The states of the verbs are indicated by the conjugations. There are 5 forms, which are associated with the vowels.</p>
<ol style="list-style-type: decimal">
<li><p>&#x3046; form: dictionary This is the most basic form, which would appear on dictionary, and hence the name. The other conjugations are based on this form. The transformation is done by changing the ending from &#x3046;-stage to the corresponding character in other stages, and then add more suffixes if necessary.</p></li>
<li><p>&#x3044; form: infinitive, &#x201C;to do&#x201D;</p></li>
<li><p>&#x3042; form: negative With an &#x3042;-stage ending and an extra suffix, such as &#x306A;&#x3044;, the verb becomes its negative form.</p></li>
<li><p>&#x3048; form: imperative/conditional With an &#x3048;-stage ending, the verb becomes imperative. Further, adding a suffix &#x3070; makes it conditional.</p></li>
<li><p>&#x304A; form: volitional, &#x201C;Let&#x2019;s do&#x201D;</p></li>
</ol>
<h4 id="summary">Summary</h4>
<table>
<thead>
<tr class="header">
<th>Form</th>
<th>State</th>
<th>Casual</th>
<th>Polite</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&#x4E94;&#x6BB5;</td>
<td>Positive</td>
<td>-u</td>
<td>-i&#x307E;&#x3059;</td>
</tr>
<tr class="even">
<td>&#x4E94;&#x6BB5;</td>
<td>Negative</td>
<td>-a&#x306A;&#x3044;</td>
<td>-i&#x307E;&#x305B;&#x3093;</td>
</tr>
<tr class="odd">
<td>&#x4E00;&#x6BB5;</td>
<td>Positive</td>
<td>-&#x308B;</td>
<td>-&#x307E;&#x3059;</td>
</tr>
<tr class="even">
<td>&#x4E00;&#x6BB5;</td>
<td>Negative</td>
<td>-&#x306A;&#x3044;</td>
<td>-&#x307E;&#x305B;&#x3093;</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th>Form</th>
<th>Imperative</th>
<th>Conditional</th>
<th>Volitional</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&#x4E94;&#x6BB5;</td>
<td>-e</td>
<td>-e&#x3070;</td>
<td>-o(&#x3046;)</td>
</tr>
<tr class="even">
<td>&#x4E00;&#x6BB5;</td>
<td>-&#x308D;</td>
<td>-&#x308C;&#x3070;</td>
<td>-&#x3088;&#x3046;</td>
</tr>
</tbody>
</table>
<h4 id="exceptions">Exceptions:</h4>
<h5 id="&#x4E94;&#x6BB5;-verbs-ending-with--&#x3046;">&#x4E94;&#x6BB5; verbs ending with -&#x3046;</h5>
<table>
<thead>
<tr class="header">
<th>Form</th>
<th>State</th>
<th>Casual</th>
<th>Polite</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&#x4E94;&#x6BB5;</td>
<td>Positive</td>
<td>-&#x3046;</td>
<td>-&#x3044;&#x307E;&#x3059;</td>
</tr>
<tr class="even">
<td>&#x4E94;&#x6BB5;</td>
<td>Negative</td>
<td>-&#x308F;&#x306A;&#x3044;</td>
<td>-&#x3044;&#x307E;&#x305B;&#x3093;</td>
</tr>
</tbody>
</table>
<h5 id="do">&#x201C;do&#x201D;</h5>
<table>
<thead>
<tr class="header">
<th>State</th>
<th>Casual</th>
<th>Polite</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Positive</td>
<td>&#x3059;&#x308B;</td>
<td>&#x3057;&#x307E;&#x3059;</td>
</tr>
<tr class="even">
<td>Negative</td>
<td>&#x3057;&#x306A;&#x3044;</td>
<td>&#x3057;&#x307E;&#x305B;&#x3093;</td>
</tr>
</tbody>
</table>
<p>&#x3059;&#x308B; is very useful because it can be attached to a noun and making it a verb. The conjugation of the compound verb behaves like &#x3059;&#x308B;.</p>
<h5 id="come">&#x201C;Come&#x201D;</h5>
<table>
<thead>
<tr class="header">
<th>State</th>
<th>Casual</th>
<th>Polite</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Positive</td>
<td>&#x6765;(&#x304F;)&#x308B;</td>
<td>&#x6765;(&#x304D;)&#x307E;&#x3059;</td>
</tr>
<tr class="even">
<td>Negative</td>
<td>&#x6765;(&#x3053;)&#x306A;&#x3044;</td>
<td>&#x6765;(&#x304D;)&#x307E;&#x305B;&#x3093;</td>
</tr>
</tbody>
</table>
<h5 id="exist">&#x201C;Exist&#x201D;</h5>
<table>
<thead>
<tr class="header">
<th>State</th>
<th>Casual</th>
<th>Polite</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Positive</td>
<td>&#x3042;&#x308B;</td>
<td>&#x3042;&#x308A;&#x307E;&#x3059;</td>
</tr>
<tr class="even">
<td>Negative</td>
<td>&#x306A;&#x3044;</td>
<td>&#x3042;&#x308A;&#x307E;&#x305B;&#x3093;</td>
</tr>
</tbody>
</table>
<p>For more discussion, see <a href="https://en.wikiversity.org/wiki/Japanese_Verb_Conjugation_-_Godan_Verbs" target="_blank" rel="noopener">this</a> and <a href="https://www.wasabi-jpn.com/japanese-grammar/japanese-verbs-u-verbs-and-ru-verbs-and-conjugation/" target="_blank" rel="noopener">this</a></p>
<p>Updated on 04/30/17. To be continued.</p>
]]></content>
      
        <categories>
            
            <category> music </category>
            
        </categories>
        
        
        <tags>
            
            <tag> the pillows </tag>
            
            <tag> rosetta </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Configuring a Hexo-based blog]]></title>
      <url>http://smanist.github.io/2017/03/25/Configuring-a-Hexo-based-blog/</url>
      <content type="html"><![CDATA[<p>Now let&#x2019;s customize the blog.</p>
<a id="more"></a>
<h2 id="picking-a-theme">Picking a theme</h2>
<p>A lot of themes are available from <a href="https://hexo.io/themes/" target="_blank" rel="noopener">here</a>. The theme currently used in this blog is <a href="https://github.com/stkevintan/hexo-theme-material-flow" target="_blank" rel="noopener">MaterialFlow</a> by <a href="https://github.com/stkevintan/" target="_blank" rel="noopener">kevintan</a>. The installation and basic configuration of <code>MaterialFlow</code> is straight forward, as described in its GitHub page.</p>
<h2 id="adding-a-widget">Adding a widget</h2>
<p>A widget can be a container of tags, categories, friendly links, etc. This <a href="http://ammonsonline.com/creating-a-hexo-widget/" target="_blank" rel="noopener">reference</a> provides a good discussion on adding widgets to the blog.</p>
<p>The widgets are stored in <code>&lt;blog&gt;/theme/&lt;your theme&gt;/layout/_widget</code>. To enable a widget, add several lines to the <code>_config.yml</code> in the <em>theme folder</em>, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">widgets:</div><div class="line">- &lt;your widget&gt;</div></pre></td></tr></table></figure></p>
<p>In <code>MaterialFlow</code>, this specification of widgets is modularized, and described in a seperate file <code>widgets.yml</code></p>
<h2 id="adding-a-page">Adding a page</h2>
<p>A page is an important building block of a Hexo-based blog. For example, to enable the &#x201C;Category&#x201D; widget, one needs to generate a page, <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo new page categories</div></pre></td></tr></table></figure></p>
<p>which generates a folder <code>source\categories</code> and a file <code>index.md</code> under that folder. Further, modify this file <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">title: Categories</div><div class="line">date: &lt;date time&gt;</div><div class="line">type: &quot;categories&quot;</div></pre></td></tr></table></figure></p>
<p>Same procedure for generating a page for &#x201C;Tagcloud&#x201D;, &#x201C;About&#x201D;, etc.</p>
<h2 id="enable-comments-using-disqus">Enable comments using Disqus</h2>
<p>The procedure is well described in this <a href="http://www.codeblocq.com/2015/12/Add-Disqus-comments-in-Hexo/" target="_blank" rel="noopener">article</a>. All one needs to do is to get a disqus account, and generate a shortname for the blog, then in the main <code>_config.yml</code> file, add <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">disqus_shortname: &lt;your short name&gt;</div></pre></td></tr></table></figure></p>
<h2 id="tips-for-markdown">Tips for Markdown</h2>
<ol style="list-style-type: decimal">
<li><p>To add categories and tags, in the title section, add, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">categories: &lt;your category&gt;</div><div class="line">tags: &lt;your tags&gt;</div></pre></td></tr></table></figure></p></li>
<li><p>To make a partial display of the article content, i.e. &#x201C;Read more&#x201D;, on the main site, add <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;!-- more --&gt;</div></pre></td></tr></table></figure></p></li>
</ol>
<p>before the contents to be hidden from the main site in the Markdown file.</p>
<ol start="3" style="list-style-type: decimal">
<li>To disable comments, in the title section, add, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">comments: false</div></pre></td></tr></table></figure></li>
</ol>
<p>Additional reference:</p>
<ol style="list-style-type: decimal">
<li><a href="http://darren90.github.io/2015/08/01/Hexo%E5%8D%9A%E5%AE%A2%E7%9A%84%E6%90%AD%E5%BB%BA/" target="_blank" rel="noopener">Configuring Hexo</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> coding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Setting up a blog using Hexo]]></title>
      <url>http://smanist.github.io/2017/03/22/Setting-up-a-blog-using-Hexo/</url>
      <content type="html"><![CDATA[<p>This applies to Windows 10 and Ubuntu 12.04.</p>
<a id="more"></a>
<h2 id="step-1-a-github-repository-for-the-website">Step 1: A GitHub repository for the website</h2>
<p>On GitHub, create a repository <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;yourname&gt;.github.io</div></pre></td></tr></table></figure></p>
<p>Make sure the <code>.gitignore</code> type is <code>Node</code>.</p>
<h2 id="step-2-setup-the-node.js-environment">Step 2: Setup the Node.js environment</h2>
<p>Install <a href="https://nodejs.org/en/" target="_blank" rel="noopener">Node.js</a>. Then install necessary component: <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g hexo-cli</div></pre></td></tr></table></figure></p>
<h2 id="step-3-setup-the-website">Step 3: Setup the website</h2>
<h3 id="initialize-local-folder">Initialize local folder</h3>
<p>Then, in a given folder, initialize the website <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo init [folder]</div></pre></td></tr></table></figure></p>
<p>In this folder, install a module for commiting to GitHub. Be sure to add <code>--save</code> so that the module is installed <em>inside</em> this folder and can be used by the server. <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install hexo-deployer-git --save</div></pre></td></tr></table></figure></p>
<h3 id="basic-configurations-for-the-website">Basic configurations for the website</h3>
<p>Modify the configuration file</p>
<ol style="list-style-type: decimal">
<li>The site section</li>
<li>The deployment section, e.g. <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">deploy:</div><div class="line">  type: git</div><div class="line">  repo: https://github.com/&lt;yourname&gt;/&lt;yourname&gt;.github.io.git</div><div class="line">  branch: master</div></pre></td></tr></table></figure></li>
</ol>
<p>An alternative for <code>repo</code> is <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">repo: git@github.com:&lt;yourname&gt;/&lt;yourname&gt;.github.io.git</div></pre></td></tr></table></figure></p>
<p>In my case, the <code>https</code> works for Win10, while the <code>git</code> version works for Ubuntu.</p>
<h3 id="editing-the-website-locally">Editing the website locally</h3>
<p>To generate and check the website locally <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">hexo clean</div><div class="line">hexo generate</div><div class="line">hexo server</div></pre></td></tr></table></figure></p>
<p>And the website is hosted on <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">https://localhost:4000</div></pre></td></tr></table></figure></p>
<p>More info:</p>
<ol style="list-style-type: decimal">
<li><a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></li>
<li><a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></li>
</ol>
<p>To add a new article <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo new [title]</div></pre></td></tr></table></figure></p>
<p>Then modify the corresponding <code>.md</code> file in <code>source/_posts</code>. More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h2 id="step-4-deployment-on-github">Step 4: Deployment on GitHub</h2>
<p>To deploy <figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo deploy</div></pre></td></tr></table></figure></p>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>
<h2 id="step-5-version-control-optional">Step 5: Version control (Optional)</h2>
<p>Deployment only pushes the generated contents (the <code>public</code> folder) to GitHub, not the source files. To work on multiple machines, it is beneficial to create an online repository. In this repository, some folders do not have to be tracked:</p>
<ol style="list-style-type: decimal">
<li><code>public</code> and <code>db.json</code>: Generated automatically every time before deployment.</li>
<li><code>node_modules</code>: Quite large, and not all are necessary. One can repeat Step 3 to create these modules.</li>
<li><code>.deploy_git</code>: Not essential. It can be generated every time <code>hexo</code> deploys the website. An issue might be the slowness due to a large website.</li>
</ol>
<h2 id="other-useful-links">Other useful links:</h2>
<ol style="list-style-type: decimal">
<li><a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a></li>
<li><a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a></li>
<li><a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> and <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a></li>
</ol>
<h2 id="references">References</h2>
<ol style="list-style-type: decimal">
<li><a href="https://zhangslob.github.io/2017/02/28/%E6%95%99%E4%BD%A0%E5%85%8D%E8%B4%B9%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%8CHexo-Github/" target="_blank" rel="noopener">zhangslob.github</a></li>
</ol>
]]></content>
      
        <categories>
            
            <category> coding </category>
            
        </categories>
        
        
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
