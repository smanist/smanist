<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Orpheus</title>
  
  <subtitle>Not necessarily coding</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://smanist.github.io/"/>
  <updated>2019-05-22T17:06:40.094Z</updated>
  <id>http://smanist.github.io/</id>
  
  <author>
    <name>Smanist</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Writing plan</title>
    <link href="http://smanist.github.io/2242/01/01/Writing-Plan/"/>
    <id>http://smanist.github.io/2242/01/01/Writing-Plan/</id>
    <published>2242-01-01T05:00:00.000Z</published>
    <updated>2019-05-22T17:06:40.094Z</updated>
    
    <content type="html"><![CDATA[<p>Some topics I plan to write about (or never).</p><a id="more"></a><h1 id="interesting-topics">Interesting Topics</h1><h2 id="development-of-modern-university.">Development of modern university.</h2><p>The precursor appears to be cathedral school with faculty of arts. Maybe start with examining the early universities and colleges in the US, such as UPenn. Another start could be the Humboldt University of Berlin, which appears to have the first modern university system. A third start is the Bologna University, which is among the earliest universities.</p><h2 id="parkinsons-law-and-peters-principle">Parkinson&#x2019;s law and Peter&#x2019;s principle</h2><h2 id="kakeya-set">Kakeya set</h2><p>A Kakeya set, or Besicovitch set, is a set of points in Euclidean space which contains a unit line segment in every direction. Besicovitch found a surprising result that the minimum area, or measure, of the set is <em>zero</em>.</p><p>A Kakeya needle set is a set in the plane with a stronger property, that a unit line segment can be rotated continuously. A yet surprising result is that the measure of such set can be arbitrarily small.</p><p><a href="https://en.wikipedia.org/wiki/Kakeya_set" target="_blank" rel="noopener">Ref1</a>, <a href="https://terrytao.wordpress.com/tag/kakeya-conjecture/" target="_blank" rel="noopener">Ref2</a></p><h2 id="miura-ori-and-theorema-egregium">Miura-ori and Theorema Egregium</h2><p>How to fold an A4 paper to reduce its area by an order of magnitude, while still easy to unfold? Miura folding is one answer. An introductory article is found <a href="https://wewanttolearn.wordpress.com/2014/11/11/miura-ori-based-curved-surface-origami-structures/" target="_blank" rel="noopener">here</a>. More interesting applications are found <a href="http://www.tsg.ne.jp/TT/index.html" target="_blank" rel="noopener">here</a>, where a scholar developed some computational origami software.</p><p>Concerning computational origami, there is another guy that must be mentioned: <a href="https://en.wikipedia.org/wiki/Robert_J._Lang" target="_blank" rel="noopener">Robert Lang</a>. He was a NASA physicist, but later became an <a href="http://www.langorigami.com/" target="_blank" rel="noopener">origami artist</a>. Now he is recognized as one of the leading theorists of the mathematics of origami and has developed ways to algorithmetize the design process for origami.</p><p>Another seemingly vague connection to origami is the shell structure. This starts with <a href="https://en.wikipedia.org/wiki/Theorema_Egregium" target="_blank" rel="noopener">Theorema Egregium</a>, or Remarkable Theorem. It is stated by Carl Friedrich Gauss that <em>If a curved surface is developed upon any other surface whatever, the measure of curvature in each point remains unchanged.</em> Essentially, the so-called Gaussian curvature is an intrinsic invariant of a surface. The curvature does not change if the surface deforms by bending only and not stretching. The implication of this result in engineering is the application of shell structure - thin and light, but strong. A flat paper can be folded into complex curved surfaces using generalized Miura-ori. Such folded structure is orders of magnitude stronger than the flat paper.</p><h2 id="sprite">SPRITE</h2><p>SPRITE for Sample Parameter Reconstruction via Iterative TEchniques. It is an awesome tool (<a href="https://peerj.com/preprints/26968v1/" target="_blank" rel="noopener">pre-print</a>) that enables the examination of statistical results in research papers that do not include the raw data - are they made up or fudged? One case found by the authors of SPRITE is related to the <a href="https://hackernoon.com/introducing-sprite-and-the-case-of-the-carthorse-child-58683c2bfeb" target="_blank" rel="noopener">carrots</a>.</p><h2 id="game-of-life-on-manifold">Game of life on manifold</h2><p>Conway&#x2019;s <a href="https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life" target="_blank" rel="noopener">Game of Life</a> is initially defined on a 2D flat discrete grid. However, nothing prevents it from generalization to grids of higher dimensions, or continous Euclidean spaces, or any proper metric spaces. A good example is found <a href="https://0fps.net/2012/11/19/conways-game-of-life-for-curved-surfaces-part-1/" target="_blank" rel="noopener">here</a> and <a href="https://0fps.net/2012/11/28/conways-game-of-life-for-curved-surfaces-part-2/" target="_blank" rel="noopener">here</a>.</p><h2 id="nsf-survey-of-science-engineering-doctorates">NSF Survey of Science &amp; Engineering Doctorates</h2><p>It turns out NSF has been surveying the doctorates earned each year in the US. It would be fun to dig into the <a href="https://ncses.nsf.gov/pubs/nsf19301" target="_blank" rel="noopener">data</a> and explore.</p><h2 id="optimal-control-for-frying-steaks">Optimal control for frying steaks</h2><p>A tasty steak is made by precisely controlling the temperature distribution of the steak on the frying pan. The evolution of the temperature in the steak is governed by the heat conduction equation. The control variables are the duration and magnitude of the heat flux from the frying pan. The question is, is it possible to achieve the given temperature response in the steak using an optimal control approach?</p><h1 id="more-serious-topics">More Serious Topics</h1><h2 id="dmd-and-higher-order-dmd">DMD and Higher-Order DMD</h2><p><a href="https://hal-polytechnique.archives-ouvertes.fr/hal-01020654/file/DMS0022112010001217a.pdf" target="_blank" rel="noopener">Dynamic Mode Decomposition</a> is a useful tool for post-processing spatiotemporal data (resulting from generally nonlinear dynamics) as an expansion of spatial modes times exponentials in the time variable, which exhibit generally nonzero growth rates. It has extentions like <a href="http://oa.upm.es/50185/1/INVE_MEM_2017_271038.pdf" target="_blank" rel="noopener">Higher Order Dynamic Mode Decomposition</a>.</p><h2 id="polynomial-rational-interpolation-and-isindy">Polynomial rational interpolation and iSINDy</h2><p>Polynomial curve fitting is one of the simplest tools for data modeling. However, it suffers from various issues, such as discussed <a href="https://en.wikipedia.org/wiki/Polynomial_and_rational_function_modeling" target="_blank" rel="noopener">here</a>. A better model would be polynomial rationals. But its mathematical properties are not as clear as polynomials - some materials are found <a href="https://link.springer.com/chapter/10.1007/978-1-4614-8453-0_2" target="_blank" rel="noopener">here</a>. Also, practical algorithms are developed only <a href="http://www.alglib.net/interpolation/rational.php" target="_blank" rel="noopener">recently</a>, i.e.&#xA0;the <a href="https://docs.scipy.org/doc/scipy-1.3.0/reference/generated/scipy.interpolate.BarycentricInterpolator.html" target="_blank" rel="noopener">Barycentric interpolation</a>.</p><p>The iSINDy method is the <a href="https://ieeexplore.ieee.org/abstract/document/7809160" target="_blank" rel="noopener">implicit</a> version of the <a href="https://www.pnas.org/content/113/15/3932.short" target="_blank" rel="noopener">SINDy</a> (Sparse Identification of Nonlinear Dynamics) method. As their names imply, the methods are used to infer the analytical form of a nonlinear dynamical system from the samples of its response. The sparsity ensures that the analytical form is as simple as possible. In SINDy, the system equation is represented by a linear combination of nonlinear features, e.g.&#xA0;polynomials, that are constructed from the state variables. In iSINDy, the system equation is represented by a rational fraction, similar to Barycentric interpolation. However, the difference is that in iSINDy the number of terms in the rational fraction is minimized, while in the latter all the possible terms might be involved.</p><h2 id="multi-fidelity-surrogate">Multi-fidelity surrogate</h2><p>Some surrogate models take in data from both high- and low-fidelity models. Usually such a &#x201C;multi-fidelity&#x201D; model is hierarchical, e.g.&#xA0;a fusion of multiple separate surrogates. <a href="http://papers.nips.cc/paper/7016-multi-information-source-optimization.pdf" target="_blank" rel="noopener">This paper</a> proposed a unified formulation for multi-fidelity surrogate, which seems to have some values in applications like surrogate-based optimization.</p><h2 id="gaussian-process-regression-with-discrete-variables">Gaussian process regression with discrete variables</h2><p>There is an <a href="https://arxiv.org/ftp/arxiv/papers/1806/1806.07504.pdf" target="_blank" rel="noopener">approach</a> based on latent variables that makes the discrete variables smooth. An application of this approach found <a href="https://arc.aiaa.org/doi/pdf/10.2514/6.2019-1971" target="_blank" rel="noopener">here</a> shows that it is better than some conventional approaches.</p><h2 id="non-intrusive-polynomial-chaos-expansion">Non-Intrusive Polynomial Chaos Expansion</h2><p>Polynomial chaos expansion (PCE) is one approach for uncertainty quantification. However, PCE is intrusive as it requires the modification of the deterministic version of the analysis code. One way to mitigate this problem is the non-intrusive version of PCE, as discussed in <a href="http://www.sci.utah.edu/publications/xiu05/Xiu_SIAM_JSC2005.pdf" target="_blank" rel="noopener">this paper</a>. One example of application is found <a href="https://arc.aiaa.org/doi/pdf/10.2514/6.2019-2216" target="_blank" rel="noopener">here</a>.</p><h2 id="methodology-for-uncertainty-quantification">Methodology for uncertainty quantification</h2><p>Nowadays people expect not only high-fidelity results from CFD-based simulation, but also its uncertainty, which may be quantified through rigorous verification, validation and uncertainty quantification (VVUQ) procedures. One such procedural framework is proposed by <a href="http://ftp.demec.ufpr.br/disciplinas/TM798/Artigos_seminarios/roy_oberkampf_2011-verification.pdf" target="_blank" rel="noopener">Roy and Oberkampf</a>.</p><p>In general, a solution for UQ is provided by the <a href="https://dakota.sandia.gov/" target="_blank" rel="noopener">DAKOTA software</a> from the Sandia National Lab. One application of Dakota is found <a href="https://arc.aiaa.org/doi/pdf/10.2514/6.2019-2278" target="_blank" rel="noopener">here</a>.</p><h2 id="sobol-sampling-v.s.-latin-hypercube-sampling">Sobol sampling v.s. Latin hypercube sampling</h2><p>Two sampling methods for Gaussian process regression. Also Halton sampling.</p><h2 id="non-intrusive-least-squares-shadowing">Non-Intrusive Least Squares Shadowing</h2><p>Optimization of a chaotic system can be challenging, because the gradients w.r.t. to the design variables computed naively could be &#x201C;noisy&#x201D;. This can be mitigated by the shadowing approach, which generates smooth gradients suitable for optimization. A non-intrusive version of the shadowing approach has been developed in <a href="https://www.sciencedirect.com/science/article/pii/S0021999117304783" target="_blank" rel="noopener">this paper</a>.</p><h2 id="openmdao">OpenMDAO</h2><p>The <a href="http://openmdao.org/" target="_blank" rel="noopener">OpenMDAO</a> package has evolved in the recent years into a quite comprehensive framework for large-scale multi-disciplinary optimization problems. Besides conventional aerostructural optimization, it has encompassed some interesting capabilities, e.g. <a href="https://github.com/OpenMDAO/dymos" target="_blank" rel="noopener">optimal control</a> and <a href="https://arc.aiaa.org/doi/pdf/10.2514/6.2019-1470" target="_blank" rel="noopener">topology optimization</a>. It seems Bayesian optimization is <a href="http://openmdao.org/pubs/Heath_Gray-_2012_-OpenMDAO_Frameork_for_Flexible_Multidisciplinary_Design_Analysis_and_Optimization_Methods.pdf" target="_blank" rel="noopener">supported</a> too, at least in some of the versions and some <a href="https://github.com/Kenneth-T-Moore/AMIEGO-AMD-OpenMDAO" target="_blank" rel="noopener">branches</a>.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Some topics I plan to write about (or never).&lt;/p&gt;
    
    </summary>
    
      <category term="plan" scheme="http://smanist.github.io/categories/plan/"/>
    
    
  </entry>
  
  <entry>
    <title>IFASD 2019 Digest</title>
    <link href="http://smanist.github.io/2019/07/02/IFASD_2019_digest/"/>
    <id>http://smanist.github.io/2019/07/02/IFASD_2019_digest/</id>
    <published>2019-07-02T21:30:00.000Z</published>
    <updated>2019-07-02T22:09:37.862Z</updated>
    
    <content type="html"><![CDATA[<p>What I found interesting.</p><a id="more"></a><p>IFASD stands for <a href="http://ifasd2019.utcdayton.com/" target="_blank" rel="noopener">The International Forum on Aeroelasticity and Structural Dynamics</a>. It was held during June 10-13 in Savannah, Georgia. The bracketed number is the paper number (if applicable).</p><h1 id="aeroelastic-design-and-optimization">Aeroelastic Design and Optimization</h1><h2 id="passive-aeroelastic-tailoring-of-high-aspect-ratio-wings">Passive aeroelastic tailoring of high aspect ratio wings</h2><p>By Karen Taminger.</p><p>Three approaches were highlighted that optimize the stiffness distribution of a wing to improve its aeroelastic performance:</p><ol style="list-style-type: decimal"><li>Curvilinear Spars and Ribs (SpaRibs), e.g. <a href="https://doi.org/10.2514/1.C031336" target="_blank" rel="noopener">Locatelli2011</a>, <a href="https://doi.org/10.2514/1.J057892" target="_blank" rel="noopener">Zhao2019</a></li><li><a href="http://gkennedy.gatech.edu/research-project/large-scale-topo/" target="_blank" rel="noopener">Structural topology optimization</a></li><li><a href="https://www.sciencedirect.com/science/article/pii/S0889974618306340" target="_blank" rel="noopener">Tow-steered composite wings</a></li></ol><h2 id="sizing-and-topology-design-of-an-aeroelastic-wingbox-under-uncertainty">Sizing and topology design of an aeroelastic wingbox under uncertainty</h2><p>By Bret K. Stanford (058)</p><p>A neat work on optimization under uncertainty. A two-level approach is employed. On the higher level, a non-gradient approach is employed to explore different wingbox topologies. The sizing of the wingbox topology is done by a gradient approach on the lower level. Uncertainties are introduced to the safety factors for the stress and buckling constraints, and modelled using the non-intrusive polynomial chaos expansion method. The sobol indices are used to explain the results.</p><h2 id="aeroelastic-prediction-workshop-no.-3">Aeroelastic prediction workshop, No. 3</h2><p>This will be discussed separately.</p><h1 id="reduced-order-modeling">Reduced Order Modeling</h1><h2 id="self-adaptive-pod-based-rom-3d-aeroelastic-simulations">Self adaptive POD based ROM 3D aeroelastic simulations</h2><p>By Ruben Moreno-Ramos (024)</p><p>Switch between CFD and ROM solvers during the aeroelastic simulation based on an error estimation. The CFD stage is used to generate data that updates POD modes in the projection-based ROM.</p><h2 id="model-order-reduction-for-coupled-nonlinear-aeroelastic-flight-mechanics-of-very-flexible-aircraft">Model order reduction for coupled nonlinear aeroelastic-flight mechanics of very flexible aircraft</h2><p>By Carlos E.S. Cesnik (095)</p><p>The goal is to reduce the coupled system of flight dynamics and aeroelastic model to a level that can be used for control-oriented applications for the flight envelope. This is achieved by combining the techniques of piecewise linear basis, local basis interpolation, and balanced truncation, where the composition of local basis is achieved using a weighted sum approach.</p><h2 id="aeroelastic-loads-predictions-using-cfd-based-reduced-order-models">Aeroelastic loads predictions using CFD-based reduced order models</h2><p>By Philipp Bekemeyer (105)</p><p>An interesting POD approach is used. The snapshots for POD are not only the aerodynamic loading, but concatenated vectors of aerodynamic loading and structural displacements. This approach requires very few samples and handles the static aeroelastic trimming problem well. The code implementation is based on the <a href="http://www.helmholtz-analytics.de/helmholtz_analytics/EN/Software/_node.html" target="_blank" rel="noopener">SMARTy toolbox</a>. A noteworthy method in SMARTy is the <a href="https://www.tandfonline.com/doi/full/10.1080/10618562.2014.918695" target="_blank" rel="noopener">Isomap with interpolation</a> approach.</p><h2 id="modal-rotations-a-modal-based-method-for-large-structural-deformations">Modal rotations: A modal-based method for large structural deformations</h2><p>By Ariel Drachinsky (135)</p><p>A modal rotation method (MRM) is developed for the static analysis of slender structures accounting for large deformations. The modes are obtained from linear modal analysis as usual. However, the modes are not defined by displacements, but by curvatures. The curvature-based formulation enables a linearized evaluation of the bending rotation change based on nonlinear kinematics.</p><h2 id="reduced-order-time-spectral-model-for-the-ale-formulation-of-the-compressible-navier-stokes-equations">Reduced order time spectral model for the ALE formulation of the compressible Navier-Stokes equations</h2><p>By Fabrizio Di Donfrancesco (134)</p><p>The time spectral equations are projected on to a set of POD basis. However, the issue is that generating the basis requires the unsteady simulation, but the purpose of time spectral method is usually to avoid the computationally expensive unsteady simulation.</p><h1 id="flutter-analysis">Flutter Analysis</h1><h2 id="flutter-sensitivity-analysis-for-wing-planform-optimization">Flutter sensitivity analysis for wing planform optimization</h2><p>By Francesco Torrigiani (029)</p><p>The unsteady aerodynamic analysis is carried out with the boundary element method by <a href="https://ntrs.nasa.gov/search.jsp?R=19750004821" target="_blank" rel="noopener">Morino</a>, which accounts for generic 3D body shapes.</p><h2 id="analysis-of-light-dynamic-stall-using-dynamic-mode-decomposition">Analysis of light dynamic stall using dynamic mode decomposition</h2><p>By Wrik Mallik (036). An application of DMD.</p><h2 id="a-state-space-model-for-loads-analysis-based-on-tangential-interpolation">A state-space model for loads analysis based on tangential interpolation</h2><p>By David Martin (066)</p><p>The <a href="https://epubs.siam.org/doi/book/10.1137/1.9780898718713" target="_blank" rel="noopener">Loewner rational interpolation</a> is employed to develop a state-space model for the aerodynamics that</p><ol style="list-style-type: decimal"><li>Has complex poles - so that it works for transonic flow.</li><li>Does not need Hankel metrix for more efficient computation.</li><li>Works for delayed input (e.g.&#xA0;gust) and singularity (e.g.&#xA0;rigid modes that introduces infinite eigenvalues).</li><li>Describes distributed aerodynamic loading.</li></ol><h2 id="a-new-flutter-prediction-algorithm-to-avoid-p-k-method-shortcomings">A new flutter prediction algorithm to avoid p-k method shortcomings</h2><p>By Ludovic Colo (072)</p><p>For a nonlinear eigenvalue problem like flutter analysis, the conventional p-k method may fail when the eigen modes merge. This study develops a new block Newton algorithm based on the invariant pairs theory (e.g. <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/gamm.201490007" target="_blank" rel="noopener">here</a> and <a href="https://epubs.siam.org/doi/abs/10.1137/120885644?journalCode=sjmael" target="_blank" rel="noopener">here</a>). Dassault Aviation has systematically employed a hybrid p-k and block Newton methods for automated, robust, and efficient flutter analysis.</p><h2 id="structural-damping-models-for-passive-aeroelastic-control">Structural damping models for passive aeroelastic control</h2><p>By Marco Eugeni (085)</p><p>Three damping models suitable for finite-element-based aeroelastic analysis are compared: the viscous model, the hysteretic model, and a <a href="https://www.sciencedirect.com/science/article/pii/S0888327018307982" target="_blank" rel="noopener">generalized Biot model</a>.</p><h2 id="mechanisms-of-transonic-single-degree-of-freedom-flutter-of-a-laminar-airfoil">Mechanisms of transonic single degree of freedom flutter of a laminar airfoil</h2><p>By Marc Braune (132)</p><p>An energy transfer analysis is used to connect the effects of boundary layer transition, shock movement, and shock-boundary layer interaction to the aeroelastic instability and the LCO amplitude. It appears that the LCO is not due to a pure 1-DOF flutter mechanism, but introduced by the combination of the bending and heave motion.</p><h2 id="flutter-mechanisms-characterization-using-distributed-aeroelastic-energy-analysis">Flutter mechanisms characterization using distributed aeroelastic energy analysis</h2><p>By Michael Iovnovich (016)</p><p>The goal is to systematically classify and understand the flutter mechanisms of an aircraft with many jet store configurations. The concept of power per flutter cycle (PPC) is introduced and the PPC distribution indicates a quantitative approach to identifying the flutter mechanisms.</p><h1 id="panel-flutter">Panel Flutter</h1><h2 id="flutter-and-limit-cycle-oscillations-of-a-cantilevered-plate-in-supersonic.hypersonic-flow">Flutter and limit cycle oscillations of a cantilevered plate in supersonic.hypersonic flow</h2><p>By Kevin A. McHugh (017)</p><p>Extended the piston theory to account for the large slope effect due to the cantilevered configuration. However, the boundary layer effect is not included. The plan is to correlate the theoretical results with experiments.</p><h2 id="computational-study-for-the-design-of-a-hypersonic-panel-flutter-experiment">Computational study for the design of a hypersonic panel flutter experiment</h2><p>By Maxim Freydin (138)</p><p>A theoretical analysis of clamped panel flutter response, including the geometrical nonlinearity, non-ideally clamped boundary stiffness, distributed static pressure differential across the panel, and a temperature differential between the panel and its support. Flutter and LCO predictions are done by a linear eigenvalue method and direct time-marching solution in modal coordinates. Experiments are panned in the University of Southern Queensland. The panel is extremely thin, around 0.1 mm, and the experiment will run for approximately 200 ms.</p><h1 id="aerospace-systems">Aerospace Systems</h1><h2 id="aeroelastic-role-in-the-road-to-a-fully-automated-refuelling-system">Aeroelastic role in the road to a fully automated refuelling system</h2><p>By J. Barrera Rodr&#xED;guez (048)</p><p>This is an interesting paper describing the development of a <em>real</em> Automated Air-to-Air Refuelling (A3R) system in the industry. The system consists of an extensible mast with a &#x201C;ruddervator&#x201D; connected to the aircraft with a roll/pitch joint. Modeling difficulties include the elastic response of the mast, variable mass and the boundary conditions (free or attached to another aircraft). The structural response of the mast is modelled using the finite element method and the aerodynamic force of the ruddervator is modelled using the doublet lattice method. The other unmodelled effects, which may be nonlinear, include gravity, drag of mast, etc. These effects are identified from the flight data and incorporated into the model via a convolutional nonlinear forcing term.</p><h2 id="flight-mechanical-analysis-and-test-of-unmanned-multi-body-aircraft">Flight mechanical analysis and test of unmanned multi-body aircraft</h2><p>By An Chao (083)</p><p>Learned about the concept of Multi-body Aircraft (MBA) as a alternative to the aircraft with ultra-high aspect ratio. The MBA configuration alleviates the wing loading and its modeling does not require the nonlinear aeroelastic analysis. However, the MBA has its own instability modes that need to be mitigated.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;What I found interesting.&lt;/p&gt;
    
    </summary>
    
      <category term="digest" scheme="http://smanist.github.io/categories/digest/"/>
    
    
      <category term="conference" scheme="http://smanist.github.io/tags/conference/"/>
    
  </entry>
  
  <entry>
    <title>Trying Out RNN Regressor - Part I</title>
    <link href="http://smanist.github.io/2019/07/01/Trying-out-RNN-regressor-part-1/"/>
    <id>http://smanist.github.io/2019/07/01/Trying-out-RNN-regressor-part-1/</id>
    <published>2019-07-01T22:10:00.000Z</published>
    <updated>2019-07-02T01:47:17.588Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css"><p>I am almost new to this field. Still learning.</p><a id="more"></a><h1 id="introduction">Introduction</h1><p>In the field of engineering, frequently we need to do <a href="https://en.wikipedia.org/wiki/System_identification" target="_blank" rel="noopener">system identification</a> (SI), i.e.&#xA0;to infer the mathematical model of a dynamical system based on a set of time series data. A classical problem is the SI of a linear system <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mo>&#x2D9;</mo></mover></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mrow><mrow><mi mathvariant="bold">A</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mo>+</mo><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mrow><mrow><mi mathvariant="bold">C</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mo>+</mo><mrow><mrow><mi mathvariant="bold">D</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}\dot{\mathbf{h}}&amp;= {\mathbf{A}}{\mathbf{h}}+ {\mathbf{B}}{\mathbf{x}}\\{\mathbf{y}}&amp;= {\mathbf{C}}{\mathbf{h}}+ {\mathbf{D}}{\mathbf{x}}\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.4956500000000001em;"></span><span class="strut bottom" style="height:2.4913000000000007em;vertical-align:-0.9956500000000006em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.5643500000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">h</span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#x2D9;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span style="top:0.6356500000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.5643500000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">A</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="mbin">+</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span><span style="top:0.6356500000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">C</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="mbin">+</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">D</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> Given input <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{x}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span></span> and output <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{y}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span></span></span>, how does one determine the system matrices <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">A</mi></mrow></mrow><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">B</mi></mrow></mrow><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">C</mi></mrow></mrow><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">D</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{A}},{\mathbf{B}},{\mathbf{C}},{\mathbf{D}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">A</span></span></span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">B</span></span></span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">C</span></span></span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">D</span></span></span></span></span></span>? Note that the system states <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{h}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span></span></span></span> are not directly observed in the time series data, i.e.&#xA0;they are hidden. Over the long history of SI, many successful methods and algorithms have been developed. Some model the hidden states explicitly and some do not. Some can handle nonlinear systems and some do not. I am not an expert in SI and not going to talk about these algorithms.</p><p>In the machine learning community, it appears that people tend to reorganize and reformulate some old concepts into some &#x201C;new ideas&#x201D;. No offense. Indeed this is sometimes useful. In <a href="http://www.cs.toronto.edu/~hinton/csc2535/notes/lec10new.pdf" target="_blank" rel="noopener">Hinton2013</a>, several modeling methods for sequential data are divided into two categories: memoryless models and memoryful models. The memoryless models have limited memory window and the hidden state cannot be used efficiently. One example is the autoregressive model, which predicts the next term in a sequence from a fixed number of previous terms. Another example is the feed-forward neural nets, which generalize autoregressive models by using one or more layers of non-linear hidden units. The memoryful models infer the hidden state distribution at the cost of higher computational burden. One example is the linear systems algorithms that can be viewed as generative models with real-valued hidden states that cannot be observed directly. Another example is the hidden Markov models (HMM), which have a discrete one-of-N hidden state. In HMM, transitions between states are stochastic and controlled by a transition matrix. The outputs produced by a state are stochastic.</p><p>The last example of the memoryful models is the recurrent neural network (RNN), the topic of this post. It updates the hidden state in a deterministic nonlinear way. Compared to the aformentioned models, the RNN has the following advantages:</p><ol style="list-style-type: decimal"><li>Distributed hidden state allows the efficient storage of information about the past.</li><li>Non-linear dynamics allows the update of hidden state in complicated ways.</li><li>No need to infer hidden state, whose evolution is purely deterministic.</li><li>Parameters in the RNN, i.e.&#xA0;the weights, are shared, which makes the model compact.</li></ol><h1 id="mathematical-models-of-rnn">Mathematical Models of RNN</h1><h2 id="vanilla-rnn">Vanilla RNN</h2><p>This section is based on <a href="http://cs231n.stanford.edu/slides/2017/cs231n_2017_lecture10.pdf" target="_blank" rel="noopener">this</a>.</p><p>The RNN centers around the following equation that describes the evolution of the hidden state, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi></msub><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {\mathbf{h}}_t = {\mathbf{f}}_W({\mathbf{h}}_{t-1}, {\mathbf{x}}_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is an activation function with weights <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{W}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span>. The time steps <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.61508em;"></span><span class="strut bottom" style="height:0.61508em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">t</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit">t</span><span class="mbin">&#x2212;</span><span class="mord mathrm">1</span></span></span></span> makes the formula recurrent. The function <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{W}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span> may be shared between different layers/time steps.</p><p>A vanilla RNN is <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>tanh</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>h</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>x</mi><mi>h</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>y</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}{\mathbf{h}}_t &amp;= \tanh({\mathbf{W}}_{hh} {\mathbf{h}}_{t-1} + {\mathbf{W}}_{xh} {\mathbf{x}}_t) \\{\mathbf{y}}_t &amp;= {\mathbf{W}}_{hy} {\mathbf{h}}_t\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.4000000000000004em;vertical-align:-0.9500000000000004em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mop">tanh</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">x</span><span class="mord mathit mtight">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> It looks very much like the linear system discussed above, except that it has a nonlinear state equation.</p><p>There are multiple types of RNNs: one-to-one, one-to-many, many-to-one, many-to-many, etc. In other words, the inputs <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{x}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and outputs <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{y}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are not necessarily nonzero. For example, an RNN is many-to-one when all of its inputs are assumed to be nonzero and only one output is expected (e.g.&#xA0;at the end) - this could be the case for a sequence classification problem.</p><h2 id="gradient-problem">Gradient Problem</h2><p>There is an infamous issue with RNN: the gradient problem, which prevented the effective training of RNNs for a period of time.</p><p>The training of an RNN requires a proper definition of the error, or the scalar loss function <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span></span></span></span>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>E</mi><mo>=</mo><msub><mo>&#x2211;</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo>&#x2026;</mo><mi>s</mi></mrow></msub><msub><mi>E</mi><mi>t</mi></msub><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>t</mi></msub><mo separator="true">,</mo><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mo>&#xAF;</mo></mover></mrow><mi>t</mi></msub><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle E = \sum_{t=1\ldots s} E_t({\mathbf{y}}_t, {\bar{\mathbf{y}}}_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.050005em;"></span><span class="strut bottom" style="height:2.3171180000000002em;vertical-align:-1.2671130000000002em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.05764em;">E</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-limits reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:1.167113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span><span class="minner mtight">&#x2026;</span><span class="mord mathit mtight">s</span></span></span></span><span style="top:-0.000004999999999921734em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span><span style="top:-0.013440000000000007em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span></span></span></span> time steps are assumed, and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mo>&#xAF;</mo></mover></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\bar{\mathbf{y}}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58122em;"></span><span class="strut bottom" style="height:0.82566em;vertical-align:-0.24444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span><span style="top:-0.013440000000000007em;margin-left:0.11112em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> represent the ground truth.</p><p>The weights <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{W}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span> are computed by the gradient descent method, where the gradient is computed from the back propagation (BP) of the error. In other words, one needs to obtain the derivative of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span></span></span></span> w.r.t. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{W}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span> via the chain rule, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>E</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow></mfrac></mrow><mo>=</mo><msub><mo>&#x2211;</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x2026;</mo><mo separator="true">,</mo><mi>s</mi></mrow></msub><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mi>E</mi><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow></mfrac></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {\frac{\partial E}{\partial {\mathbf{W}}}} = \sum_{t=1,\ldots,s} {\frac{\partial E_t}{\partial {\mathbf{W}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.774661em;vertical-align:-1.403221em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathit" style="margin-right:0.05764em;">E</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-limits reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:1.167113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span><span class="mpunct mtight">,</span><span class="minner mtight">&#x2026;</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">s</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></span> where <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mi>E</mi><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow></mfrac></mrow><mo>=</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mi>E</mi><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>t</mi></msub></mrow></mfrac></mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow></mfrac></mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow></mfrac></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {\frac{\partial E_t}{\partial {\mathbf{W}}}} = {\frac{\partial E_t}{\partial {\mathbf{y}}_t}} {\frac{\partial {\mathbf{y}}_t}{\partial {\mathbf{h}}_t}} {\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{W}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.25188em;vertical-align:-0.8804400000000001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.6860000000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></span></p><p>Now, focus on the weights for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{h}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span></span></span></span>, i.e. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{W}}_{hh}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, which will be written as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{W}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span> for simplicity in the following. There is a &#x201C;double dependency&#x201D; in the gradient <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex">{\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{W}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8962079999999999em;"></span><span class="strut bottom" style="height:1.2412079999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">W</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.4100999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathbf mtight">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>: (1) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{h}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> itself depends on all the past states; (2) a past state depends on the states prior to that state, too. Mathematically, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow></mfrac></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mo>&#x2211;</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x2026;</mo><mo separator="true">,</mo><mi>t</mi></mrow></msub><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>k</mi></msub></mrow></mfrac></mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>k</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow></mfrac></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>k</mi></msub></mrow></mfrac></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mo>&#x220F;</mo><mrow><mi>i</mi><mo>=</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x2026;</mo><mo separator="true">,</mo><mi>t</mi></mrow></msub><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>i</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub></mrow></mfrac></mrow></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}{\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{W}}}} &amp;= \sum_{k=1,\ldots,t} {\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{h}}_k}} {\frac{\partial {\mathbf{h}}_k}{\partial {\mathbf{W}}}} \\{\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{h}}_k}} &amp;= \prod_{i=k+1,\ldots,t} {\frac{\partial {\mathbf{h}}_i}{\partial {\mathbf{h}}_{i-1}}}\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:3.059661em;"></span><span class="strut bottom" style="height:5.619322em;vertical-align:-2.559661em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.6882210000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><span style="top:1.1214400000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.6882210000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.202113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span><span class="mpunct mtight">,</span><span class="minner mtight">&#x2026;</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">t</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><span style="top:1.1214400000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mop op-limits"><span class="vlist"><span style="top:1.202113em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mathrm mtight">1</span><span class="mpunct mtight">,</span><span class="minner mtight">&#x2026;</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">t</span></span></span></span><span style="top:-0.000005000000000032756em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x220F;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.6859999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>i</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub></mrow></mfrac></mrow><mo>=</mo><mi mathvariant="normal">&#x39B;</mi><mo>[</mo><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msubsup><mo>]</mo><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {\frac{\partial {\mathbf{h}}_i}{\partial {\mathbf{h}}_{i-1}}} = \Lambda[{\mathbf{f}}_W&apos;]{\mathbf{W}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.265771em;vertical-align:-0.894331em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.6859999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x39B;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">]</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x39B;</mi></mrow><annotation encoding="application/x-tex">\Lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x39B;</span></span></span></span> makes the vector <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_W&apos;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.027223em;vertical-align:-0.275331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.275331em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> a diagonal matrix.</p><p>The gradient problem comes from the product in <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>k</mi></msub></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex">{\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{h}}_k}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8962079999999999em;"></span><span class="strut bottom" style="height:1.3470679999999997em;vertical-align:-0.4508599999999999em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.4100999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathbf mtight">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span>. For each term of the product <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">&#x2225;</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>k</mi></msub></mrow></mfrac></mrow><mo fence="true">&#x2225;</mo></mrow><mo>&#x2264;</mo><mo>&#x2225;</mo><mi mathvariant="normal">&#x39B;</mi><mo>[</mo><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msubsup><mo>]</mo><mo>&#x2225;</mo><mo>&#x2225;</mo><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mo>&#x2225;</mo><mo>&#x2264;</mo><msub><mi>&#x3B3;</mi><mi>f</mi></msub><msub><mi>&#x3B3;</mi><mi>W</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \left\lVert {\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{h}}_k}} \right\rVert \le \lVert\Lambda[{\mathbf{f}}_W&apos;]\rVert \lVert {\mathbf{W}}\rVert \le \gamma_f \gamma_W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.47398em;"></span><span class="strut bottom" style="height:2.424em;vertical-align:-0.9500199999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9500199999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:0.3440199999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.2619800000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.8679800000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9500199999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:0.3440199999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.2619800000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.8679800000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2264;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">&#x2225;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x39B;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">]</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">&#x2225;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">&#x2225;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">&#x2225;</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2264;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>&#x3B3;</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">\gamma_f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>&#x3B3;</mi><mi>W</mi></msub></mrow><annotation encoding="application/x-tex">\gamma_W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are the maximum singular values of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x39B;</mi><mo>[</mo><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msubsup><mo>]</mo></mrow><annotation encoding="application/x-tex">\Lambda[{\mathbf{f}}_W&apos;]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.027223em;vertical-align:-0.275331em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x39B;</span><span class="mopen">[</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.275331em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">]</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{W}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span>, respectively. For the product <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">&#x2225;</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>k</mi></msub></mrow></mfrac></mrow><mo fence="true">&#x2225;</mo></mrow><mo>&#x2264;</mo><mo>(</mo><msub><mi>&#x3B3;</mi><mi>f</mi></msub><msub><mi>&#x3B3;</mi><mi>W</mi></msub><msup><mo>)</mo><mrow><mi>t</mi><mo>&#x2212;</mo><mi>k</mi></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \left\lVert {\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{h}}_k}} \right\rVert \le (\gamma_f \gamma_W)^{t-k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.47398em;"></span><span class="strut bottom" style="height:2.424em;vertical-align:-0.9500199999999999em;"></span><span class="base displaystyle textstyle uncramped"><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9500199999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:0.3440199999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.2619800000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.8679800000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9500199999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:0.3440199999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.2619800000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.8679800000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2264;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></p><p>When <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is a function like <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>tanh</mi></mrow><annotation encoding="application/x-tex">\tanh</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mop">tanh</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>&#x3B3;</mi><mi>f</mi></msub></mrow><annotation encoding="application/x-tex">\gamma_f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> would be close to zero as the input moves away from zero. As for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{W}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>&#x3B3;</mi><mi>W</mi></msub></mrow><annotation encoding="application/x-tex">\gamma_W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05556em;">&#x3B3;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is probably either <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">&lt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mrel">&lt;</span><span class="mord mathrm">1</span></span></span></span> or <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">&gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mrel">&gt;</span><span class="mord mathrm">1</span></span></span></span>. Therefore, a sufficiently large <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi><mo>&#x2212;</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">t-k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit">t</span><span class="mbin">&#x2212;</span><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span>, i.e.&#xA0;time span of dependency, can cause two issues for the BP,</p><ol style="list-style-type: decimal"><li>Vanishing gradients: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">&#x2225;</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>k</mi></msub></mrow></mfrac></mrow><mo fence="true">&#x2225;</mo></mrow><mo>&#x2192;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\left\lVert {\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{h}}_k}} \right\rVert \rightarrow 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.167985em;"></span><span class="strut bottom" style="height:1.818em;vertical-align:-0.6500149999999999em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.6500149999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:0.044014999999999915em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.5619850000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.4100999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathbf mtight">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.6500149999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:0.044014999999999915em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.5619850000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mrel">&#x2192;</span><span class="mord mathrm">0</span></span></span></span>, making <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mi>E</mi><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow></mfrac></mrow><mo>&#x223C;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">{\frac{\partial E_t}{\partial {\mathbf{W}}}}\sim 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8962079999999999em;"></span><span class="strut bottom" style="height:1.2412079999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">W</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.4100999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mrel">&#x223C;</span><span class="mord mathrm">0</span></span></span></span>. In other words, the past states cannot be practically involved in BP.</li><li>Exploding gradients: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">&#x2225;</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>k</mi></msub></mrow></mfrac></mrow><mo fence="true">&#x2225;</mo></mrow><mo>&#x226B;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\left\lVert {\frac{\partial {\mathbf{h}}_t}{\partial {\mathbf{h}}_k}} \right\rVert \gg 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.167985em;"></span><span class="strut bottom" style="height:1.818em;vertical-align:-0.6500149999999999em;"></span><span class="base textstyle uncramped"><span class="minner textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.6500149999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:0.044014999999999915em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.5619850000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15122857142857138em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.4100999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathbf mtight">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.6500149999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:0.044014999999999915em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span style="top:-0.5619850000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size1"><span>&#x2225;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mrel">&#x226B;</span><span class="mord mathrm">1</span></span></span></span>, making <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mi>E</mi><mi>t</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow></mfrac></mrow><mo>&#x226B;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">{\frac{\partial E_t}{\partial {\mathbf{W}}}}\gg 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8962079999999999em;"></span><span class="strut bottom" style="height:1.2412079999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight" style="margin-right:0.01597em;">W</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.4100999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mrel">&#x226B;</span><span class="mord mathrm">1</span></span></span></span>. In other words, the BP may experience a computational overflow.</li></ol><p>Another way to see the gradient problem in the vanilla RNN is via the propagation of the variation/error of the hidden state <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{h}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span></span></span></span>. This way is somewhat hand-waving but more concise. The error of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{h}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msubsup><mo>&#x2299;</mo><mo>(</mo><mi>&#x3B4;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \delta {\mathbf{h}}_t = {\mathbf{f}}_W&apos; \odot (\delta {\mathbf{W}}{\mathbf{h}}_{t-1} + {\mathbf{W}}\delta {\mathbf{h}}_{t-1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8018919999999999em;"></span><span class="strut bottom" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2299;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#x2299;</mo></mrow><annotation encoding="application/x-tex">\odot</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.58333em;"></span><span class="strut bottom" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord">&#x2299;</span></span></span></span> is element-wise vector product and the variation associated with the input is ignored. The second term in the bracket represents the contribution of the error of the previous states to the error of the current state, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub><mo>&#x223C;</mo><mo>(</mo><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msubsup><mo>&#x2299;</mo><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><msup><mo>)</mo><mi>k</mi></msup><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mi>k</mi></mrow></msub></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \delta {\mathbf{h}}_t \sim ({\mathbf{f}}_W&apos;\odot {\mathbf{W}})^k \delta {\mathbf{h}}_{t-k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8991079999999999em;"></span><span class="strut bottom" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x223C;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2299;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> For situations discussed in the previous paragraph, the factor <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>W</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msubsup><mo>&#x2299;</mo><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><msup><mo>)</mo><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">({\mathbf{f}}_W&apos;\odot {\mathbf{W}})^k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:1.124439em;vertical-align:-0.275331em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.275331em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">W</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> can be (1) vanishing, so that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\delta{\mathbf{h}}_{t-k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> almost does not contribute to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\delta{\mathbf{h}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>; (2) exploding, so that the contribution of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\delta{\mathbf{h}}_{t-k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> overwhelms the contributions of the other states.</p><p>The issue of vanishing and exploding gradients does not mean the RNN model is impractical, but rather means that the gradient descent becomes increasingly inefficient when the temporal span of the dependencies increases.</p><p>There are some fixes to circumvent the gradient issue while retaining the vanilla RNN structure,</p><ol style="list-style-type: decimal"><li>For vanishing gradients, one can perform a proper initialization of the weights, and incorporate a more well-behaved activation function, such as the rectified linear unit (ReLU): <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo>(</mo><mi>x</mi><mo>)</mo><mo>=</mo><mi>max</mi><mo>(</mo><mn>0</mn><mo separator="true">,</mo><mi>x</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">f(x)=\max(0,x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathit">x</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop">max</span><span class="mopen">(</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathit">x</span><span class="mclose">)</span></span></span></span></li><li>For exploding gradient, one can do a clipping trick with a threshold <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span> for the gradient <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2207;</mi></mrow><annotation encoding="application/x-tex">\nabla</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x2207;</span></span></span></span>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msup><mi mathvariant="normal">&#x2207;</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>=</mo><mfrac><mrow><mi>T</mi></mrow><mrow><mo>&#x2225;</mo><mi mathvariant="normal">&#x2207;</mi><msup><mo>&#x2225;</mo><mn>2</mn></msup></mrow></mfrac><mi mathvariant="normal">&#x2207;</mi><mo separator="true">,</mo><mspace width="1em"></mspace><mrow><mi mathvariant="normal">i</mi><mi mathvariant="normal">f</mi></mrow><mspace width="1em"></mspace><mo>&#x2225;</mo><mi mathvariant="normal">&#x2207;</mi><msup><mo>&#x2225;</mo><mn>2</mn></msup><mo>&gt;</mo><mi>T</mi></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \nabla&apos; = \frac{T}{\lVert\nabla\rVert^2}\nabla,\quad \mathrm{if}\quad \lVert\nabla\rVert^2 &gt; T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.36033em;"></span><span class="strut bottom" style="height:2.29633em;vertical-align:-0.936em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathrm">&#x2207;</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mopen">&#x2225;</span><span class="mord mathrm">&#x2207;</span><span class="mclose"><span class="mclose">&#x2225;</span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2207;</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathrm">i</span><span class="mord mathrm" style="margin-right:0.07778em;">f</span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mopen">&#x2225;</span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2207;</span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">&#x2225;</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&gt;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.13889em;">T</span></span></span></span></span></li></ol><h2 id="long-short-term-memory">Long Short Term Memory</h2><p>A more systematic solution to the vanishing gradient problem is the Long Short Term Memory (LSTM) model (<a href="https://www.bioinf.jku.at/publications/older/2604.pdf" target="_blank" rel="noopener">Hochreiter1997</a>) <a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a>. It introduces a &#x201C;memory cell&#x201D; that enables the storage and access of information over long periods of time. The state equation for LSTM is now significantly expanded from the vanilla RNN, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">i</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mo>=</mo><mi>&#x3C3;</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>i</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>x</mi><mi>i</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mi>i</mi></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mo>=</mo><mi>&#x3C3;</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>f</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>x</mi><mi>f</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mi>f</mi></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">o</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mo>=</mo><mi>&#x3C3;</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>o</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>x</mi><mi>o</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mi>o</mi></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mo>=</mo><mi>tanh</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>g</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>x</mi><mi>g</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mi>g</mi></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>t</mi></msub><mo>&#x2299;</mo><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">i</mi></mrow></mrow><mi>t</mi></msub><mo>&#x2299;</mo><msub><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">o</mi></mrow></mrow><mi>t</mi></msub><mo>&#x2299;</mo><mi>tanh</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub><mo>)</mo></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{array}{rl}{\mathbf{i}}_t &amp;= \sigma({\mathbf{W}}_{hi} {\mathbf{h}}_{t-1} + {\mathbf{W}}_{xi} {\mathbf{x}}_t + {\mathbf{b}}_i) \\{\mathbf{f}}_t &amp;= \sigma({\mathbf{W}}_{hf} {\mathbf{h}}_{t-1} + {\mathbf{W}}_{xf} {\mathbf{x}}_t + {\mathbf{b}}_f) \\{\mathbf{o}}_t &amp;= \sigma({\mathbf{W}}_{ho} {\mathbf{h}}_{t-1} + {\mathbf{W}}_{xo} {\mathbf{x}}_t + {\mathbf{b}}_o) \\{\mathbf{g}}_t &amp;= \tanh( {\mathbf{W}}_{hg} {\mathbf{h}}_{t-1} + {\mathbf{W}}_{xg} {\mathbf{x}}_t + {\mathbf{b}}_g) \\{\mathbf{c}}_t &amp;= {\mathbf{f}}_t \odot {\mathbf{c}}_{t-1} + {\mathbf{i}}_t \odot {\mathbf{g}}_t \\{\mathbf{h}}_t &amp;= {\mathbf{o}}_t \odot \tanh({\mathbf{c}}_t)\end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:3.8500000000000005em;"></span><span class="strut bottom" style="height:7.200000000000001em;vertical-align:-3.35em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-r"><span class="vlist"><span style="top:-3.0100000000000007em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">i</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-1.8100000000000007em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.6100000000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">o</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5899999999999996em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:1.7899999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:2.99em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-3.0100000000000007em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">x</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:-1.8100000000000007em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">x</span><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:-0.6100000000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight">o</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">x</span><span class="mord mathit mtight">o</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">o</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:0.5899999999999996em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mop">tanh</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">x</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:1.7899999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">i</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:2.99em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">o</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mop">tanh</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3C3;</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span></span></span></span> is the sigmoid function acting as a switch and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">b</span></span></span></span></span></span> is a constant offset vector.</p><p>In the LSTM model, the current hidden state is no longer directly related to the current input and the previous hidden state. Rather, it is now an output from the memory cell <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{c}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. The memory cell is essentially a weighted sum of the past memory and the current information. In other words, it determines: (1) whether to activate the information from past steps, and (2) whether to overwrite the memory with the information from the current step. Specifically, three new gates are introduced,</p><ol style="list-style-type: decimal"><li>Input gate: Scale input to cell (write)</li><li>Output gate: Scale output from cell (read)</li><li>Forget gate: Scale old cell values (reset)</li></ol><p>The effect of the gates is better seen via the variation approach w.r.t. the hidden states, the memory cells, and the weights <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{W}}_{hg}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. Note that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{W}}_{hg}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> corresponds to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{W}}_{hh}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> in the vanilla version and will again be written as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{W}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span></span> below for simplicity. Also note that, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>&#x3B4;</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2299;</mo><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mo>)</mo><mo>=</mo><mi>&#x3B4;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2299;</mo><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mo>+</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2299;</mo><mi>&#x3B4;</mi><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \delta ({\mathbf{x}}\odot {\mathbf{y}}) = \delta {\mathbf{x}}\odot {\mathbf{y}}+ {\mathbf{x}}\odot \delta {\mathbf{y}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03785em;">&#x3B4;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2299;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2299;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2299;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span></span></span></span></span></p><p>The variations of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{c}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{h}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>t</mi></msub><mo>&#x2299;</mo><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mo stretchy="true">&#x203E;</mo></mover></mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">i</mi></mrow></mrow><mi>t</mi></msub><mo>&#x2299;</mo><mi>&#x3B4;</mi><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">o</mi></mrow></mrow><mi>t</mi></msub><mo>&#x2299;</mo><mi>tanh</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub><mo>)</mo><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">o</mi></mrow></mrow><mi>t</mi></msub><mo>&#x2299;</mo><msup><mi>tanh</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>&#x2299;</mo><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}\delta {\mathbf{c}}_t &amp;= {\mathbf{f}}_t\odot\delta {\mathbf{c}}_{t-1} + {\overline{\mathbf{W}}}\delta {\mathbf{h}}_{t-1} + {\mathbf{i}}_t\odot\delta {\mathbf{W}}{\mathbf{h}}_{t-1} \\\delta {\mathbf{h}}_t &amp;= \delta {\mathbf{o}}_t \odot \tanh({\mathbf{c}}_t) + {\mathbf{o}}_t \odot \tanh&apos; \odot \delta {\mathbf{c}}_t\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.473055em;"></span><span class="strut bottom" style="height:2.44611em;vertical-align:-0.973055em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.5869449999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6130549999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.5869449999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord displaystyle textstyle uncramped"><span class="mord overline"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span><span style="top:-0.80611em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped overline-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">i</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6130549999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">o</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mop">tanh</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">o</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mop"><span class="mop">tanh</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord">&#x2299;</span><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mover accent="true"><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mo stretchy="true">&#x203E;</mo></mover></mrow></mrow><annotation encoding="application/x-tex">{\overline{\mathbf{W}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8861100000000001em;"></span><span class="strut bottom" style="height:0.8861100000000001em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord overline"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span><span style="top:-0.80611em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped overline-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is a condensed term containing several weights, including <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{W}}_{hg}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. Note that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{W}}_{hg}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> only appears in the errors in the memory cell. Now, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\delta {\mathbf{h}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> propagates into <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\delta {\mathbf{c}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> but <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\delta {\mathbf{c}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> does not necessarily propagate into <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{h}}_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. Instead, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\delta {\mathbf{c}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> may be directly passed to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B4;</mi><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\delta {\mathbf{c}}_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03785em;">&#x3B4;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> without being affected by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{W}}_{hg}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, thus avoiding the products of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>g</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{W}}_{hg}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and the gradient problems.</p><h2 id="gated-recurrent-unit">Gated Recurrent Unit</h2><p>The gated recurrent unit (GRU) is another RNN variant <a href="https://arxiv.org/abs/1502.02367" target="_blank" rel="noopener">Chung2015</a>. It is similar to LSTM, but computationally more efficient, as there are less parameters and less complex structure.</p><p>Mathematically, GRU is represented as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">r</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>&#x3C3;</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>r</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>x</mi><mi>r</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mi>r</mi></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>&#x3C3;</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>z</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>x</mi><mi>z</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mi>z</mi></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mi>tanh</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>h</mi><mi>g</mi></mrow></msub><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">r</mi></mrow></mrow><mi>t</mi></msub><mo>&#x2299;</mo><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>)</mo><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">W</mi></mrow></mrow><mrow><mi>x</mi><mi>g</mi></mrow></msub><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>t</mi></msub><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mi>g</mi></msub><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>t</mi></msub><mo>&#x2299;</mo><msub><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mo>(</mo><mn>1</mn><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>t</mi></msub><mo>)</mo><mo>&#x2299;</mo><msub><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mi>t</mi></msub></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}{\mathbf{r}}_t &amp;= \sigma({\mathbf{W}}_{hr} {\mathbf{h}}_{t-1} + {\mathbf{W}}_{xr} {\mathbf{x}}_t + {\mathbf{b}}_r) \\{\mathbf{u}}_t &amp;= \sigma({\mathbf{W}}_{hz} {\mathbf{h}}_{t-1} + {\mathbf{W}}_{xz} {\mathbf{x}}_t + {\mathbf{b}}_z) \\{\mathbf{g}}_t &amp;= \tanh({\mathbf{W}}_{hg}({\mathbf{r}}_t\odot {\mathbf{h}}_{t-1}) + {\mathbf{W}}_{xg} {\mathbf{x}}_t + {\mathbf{b}}_g) \\{\mathbf{h}}_t &amp;= {\mathbf{u}}_t \odot {\mathbf{h}}_{t-1} + (1-{\mathbf{u}}_t) \odot {\mathbf{g}}_t\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.6500000000000004em;"></span><span class="strut bottom" style="height:4.800000000000001em;vertical-align:-2.1500000000000004em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.8100000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">r</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.6100000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:1.7900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.8100000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">x</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:-0.6100000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">x</span><span class="mord mathit mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.04398em;">z</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:0.5900000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mop">tanh</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">r</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">x</span><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:1.7900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2299;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mbin">&#x2299;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span></p><p>The GRU merges the cell state and hidden state, and thus <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{h}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span></span></span></span></span> replaces <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{c}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span></span></span></span> and the output gate <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">o</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{o}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">o</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is no longer needed. Next, the GRU combines the forget and input gates into a single &#x201C;update gate&#x201D; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{u}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, which enables the inclusion of long-term behaviors in the RNN. Finally, a reset gate <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">r</mi></mrow></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{r}}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">r</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is added to control the contribution of the previous states to the current prediction.</p><p>While many alternative LSTM architectures have been proposed, in <a href="https://arxiv.org/abs/1503.04069" target="_blank" rel="noopener">Greff2016</a>, it was found that the original LSTM performs reasonably well on various datasets and none of the eight investigated modifications (including GRU) significantly improves performance. Furthermore, it was found that the forget gate and the output activation function as its most critical components.</p><h1 id="example">Example</h1><h2 id="pytorch-windows-with-anaconda">PyTorch: Windows with Anaconda</h2><p>Among the popular machine learning frameworks, I chose PyTorch for its mild learning curve. I planed to try RNN on my Windows laptop, but it turns out PyTorch does not support Python 2 on Windows/Anaconda. So I did the following to install a minimal working PyTorch.</p><p>A Python 3 <code>environment</code> has to be created first by <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda create -n py36 python=3.6 anaconda</div></pre></td></tr></table></figure></p><p>After a lengthy installation, the environment is then deployed by <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda activate py36</div></pre></td></tr></table></figure></p><p>The command for installing PyTorch is found <a href="https://pytorch.org/get-started/locally/" target="_blank" rel="noopener">here</a>. In my case where a GPU is not available, the PyTorch ecosystem is installed by, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">conda install pytorch-cpu torchvision-cpu -c pytorch</div></pre></td></tr></table></figure></p><p>The Python 3 installation might alter the default browser for the Jupyter Notebook. To reset the browser, first fo the following in the command line, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">jupyter notebook --generate-config</div></pre></td></tr></table></figure></p><p>And next specify the path to the browser in the config file, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">c.NotebookApp.browser = u&apos;path_to_browser %s&apos;</div></pre></td></tr></table></figure></p><p>Note that <code>%s</code> has to be in the string.</p><h2 id="toy-problem">Toy Problem</h2><p>The dynamical system considered in this example is the forced Van der Pol (VdP) <a href="https://en.wikipedia.org/wiki/Van_der_Pol_oscillator#Forced_Van_der_Pol_oscillator" target="_blank" rel="noopener">oscillator</a>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mover accent="true"><mi>x</mi><mo>&#xA8;</mo></mover><mo>=</mo><mi>&#x3BC;</mi><mo>(</mo><mn>1</mn><mo>&#x2212;</mo><msup><mi>x</mi><mn>2</mn></msup><mo>)</mo><mover accent="true"><mi>x</mi><mo>&#x2D9;</mo></mover><mo>&#x2212;</mo><mi>x</mi><mo>+</mo><mi>A</mi><mi>sin</mi><mo>(</mo><mi>&#x3C9;</mi><mi>t</mi><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \ddot x = \mu (1-x^2) \dot x - x + A \sin(\omega t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8641079999999999em;"></span><span class="strut bottom" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord accent reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord mathit">x</span></span><span style="top:0em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xA8;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3BC;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">1</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mord accent reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord mathit">x</span></span><span style="top:0em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#x2D9;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">x</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">A</span><span class="mop reset-textstyle displaystyle textstyle uncramped">sin</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03588em;">&#x3C9;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">t</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>x</mi><mo>&#x2D9;</mo></mover></mrow><annotation encoding="application/x-tex">\dot x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.66786em;"></span><span class="strut bottom" style="height:0.66786em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord mathit">x</span></span><span style="top:0em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#x2D9;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">x</span></span></span></span> are considered the states of this second-order ODE. The first term on the RHS is a nonlinear damping term that introduced rich dynamical properties to the oscillator. The third term on the RHS is considered the input to the system. In this study, the following parameters are used, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>&#x3BC;</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>1</mn><mo separator="true">,</mo><mspace width="1em"></mspace><mi>A</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">.</mi><mn>2</mn><mo separator="true">,</mo><mspace width="1em"></mspace><mi>x</mi><mo>(</mo><mn>0</mn><mo>)</mo><mo>=</mo><mover accent="true"><mi>x</mi><mo>&#x2D9;</mo></mover><mo>(</mo><mn>0</mn><mo>)</mo><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mspace width="1em"></mspace><mi>t</mi><mo>&#x2208;</mo><mo>[</mo><mn>0</mn><mo separator="true">,</mo><mn>5</mn><mn>0</mn><mo>]</mo><mo separator="true">,</mo><mspace width="1em"></mspace><mi mathvariant="normal">&#x394;</mi><mi>t</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>2</mn><mn>5</mn></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \mu = 0.1,\quad A = 1.2,\quad x(0)=\dot x(0)=0,\quad t\in [0, 50],\quad \Delta t=0.25</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3BC;</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">0</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">.</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">1</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathit">A</span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">1</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">.</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">2</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathit">x</span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">0</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord accent reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord mathit">x</span></span><span style="top:0em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#x2D9;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">0</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">0</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathit">t</span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2208;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">0</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">5</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">0</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">]</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathrm">&#x394;</span></span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">t</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">0</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">.</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">2</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">5</span></span></span></span></span> Given the sinusoidal input associated with a certain value of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3C9;</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C9;</span></span></span></span>, one can numerically integrate the system to obtain the response of the VdP oscillator. The goal of this exercise is to fit an RNN based on the VdP responses for several <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3C9;</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C9;</span></span></span></span>&#x2019;s, such that the RNN can reproduce the VdP responses for some other <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3C9;</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C9;</span></span></span></span>&#x2019;s.</p><p>The code implementation is adapted from <a href="https://github.com/MorvanZhou/PyTorch-Tutorial/blob/master/tutorial-contents/403_RNN_regressor.py" target="_blank" rel="noopener">here</a>, and can be found from my github <a href="https://github.com/smanist/trying_out_rnn_regressor" target="_blank" rel="noopener">repo</a>. Four types of RNNs are examined,</p><ol style="list-style-type: decimal"><li>Vanilla RNN with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>tanh</mi></mrow><annotation encoding="application/x-tex">\tanh</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mop">tanh</span></span></span></span> as activation function.</li><li>Vanilla RNN with ReLU as activation function.</li><li>LSTM RNN</li><li>GRU RNN</li></ol><p>All the RNNs have one hidden layer with 32 states and one linear output layer. The RNNs are trained via the MSE loss function using the Adam algorithm with a learning rate of 0.01 and 10000 epochs. The training data set includes the VdP responses for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3C9;</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>3</mn><mi>&#x3C0;</mi><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>4</mn><mi>&#x3C0;</mi><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mi>&#x3C0;</mi><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>6</mn><mi>&#x3C0;</mi></mrow><annotation encoding="application/x-tex">\omega=0.3\pi,0.4\pi,0.5\pi,0.6\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C9;</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">3</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">4</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">6</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span></span></span></span>. The testing data sets includes the VdP responses for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3C9;</mi><mo>=</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>3</mn><mn>5</mn><mi>&#x3C0;</mi><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>4</mn><mn>5</mn><mi>&#x3C0;</mi><mo separator="true">,</mo><mn>0</mn><mi mathvariant="normal">.</mi><mn>5</mn><mn>5</mn><mi>&#x3C0;</mi></mrow><annotation encoding="application/x-tex">\omega=0.35\pi,0.45\pi,0.55\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C9;</span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">3</span><span class="mord mathrm">5</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">4</span><span class="mord mathrm">5</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span><span class="mpunct">,</span><span class="mord mathrm">0</span><span class="mord mathrm">.</span><span class="mord mathrm">5</span><span class="mord mathrm">5</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span></span></span></span>. In each training epoch, the data for gradient decent is a random segment (starts from beginning) of a VdP response randomly chosen from the training data set. A maximum of 120 time steps is used in the training. In other words, the last 80 time steps of the VdP response in the training data set are unseen by the RNN. Finally, the initial hidden states are set to be zero.</p><p>The results are shown in the figures below. The solid blue and red lines are the VdP responses found directly using numerical integration. The dashed lines are the RNN prediction. The vanilla RNNs do not do well in this problem. The failure probably can be explained the gradient vanishing problem that prevents the vanilla RNN to capture the long term periodic behavior. Both the LSTM and GRU do well. Note that the RNN predictions extrapolates well beyond the data used for training, as well as between the different values of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3C9;</mi></mrow><annotation encoding="application/x-tex">\omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C9;</span></span></span></span>&#x2019;s.</p><p>There are apprarently many tweaks and tunable parameters in the RNNs that can improve the prediction or generalize the model. For example,</p><ol style="list-style-type: decimal"><li>What are the optimal numbers of layers and hidden states for the RNN?</li><li>What is the best way to utilize the training data set?</li><li>How to take care of different initial conditions? Maybe via infering the proper initial hidden state in RNN?</li><li>How to efficiently train the RNN for a larger parameter space that includes, e.g. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BC;</mi><mo separator="true">,</mo><mi>A</mi><mo separator="true">,</mo><mi>&#x3C9;</mi></mrow><annotation encoding="application/x-tex">\mu, A, \omega</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BC;</span><span class="mpunct">,</span><span class="mord mathit">A</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C9;</span></span></span></span>?</li></ol><p>These might be done in a future post.</p><figure float="left"><img src="m0_pred.png" width="700px"><figcaption>Vanilla RNN with tanh.</figcaption></figure><figure float="left"><img src="m1_pred.png" width="700px"><figcaption>Vanilla RNN with ReLU.</figcaption></figure><figure float="left"><img src="m2_pred.png" width="700px"><figcaption>LSTM RNN.</figcaption></figure><figure float="left"><img src="m3_pred.png" width="700px"><figcaption>GRU RNN.</figcaption></figure><h1 id="more-references">More References</h1><ol style="list-style-type: decimal"><li><a href="https://ieeexplore.ieee.org/document/279181" target="_blank" rel="noopener">Bengio et al, &#x201C;Learning long-term dependencies with gradient descent is difficult&#x201D;</a></li><li><a href="http://proceedings.mlr.press/v28/pascanu13.pdf" target="_blank" rel="noopener">Pascanu et al, &#x201C;On the difficulty of training recurrent neural networks&#x201D;</a></li><li><a href="https://www.cs.ox.ac.uk/people/nando.defreitas/machinelearning/lecture11.pdf" target="_blank" rel="noopener">Recurrent Nets and LSTM</a></li><li><a href="https://www.cs.toronto.edu/~tingwuwang/rnn_tutorial.pdf" target="_blank" rel="noopener">RNN Tutorial</a></li><li><a href="https://danijar.com/tips-for-training-recurrent-neural-networks/" target="_blank" rel="noopener">Tips for training RNNs</a></li><li><a href="https://r2rt.com/non-zero-initial-states-for-recurrent-neural-networks.html" target="_blank" rel="noopener">Initial states for RNN</a></li></ol><div class="footnotes"><hr><ol><li id="fn1"><p>Note that the notation is slightly different from the engineering convention, so as to conform with the notation in RNN.<a href="#fnref1">&#x21A9;</a></p></li><li id="fn2"><p>One can see that even LSTM is not a recent concept.<a href="#fnref2">&#x21A9;</a></p></li></ol></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;I am almost new to this field. Still learning.&lt;/p&gt;
    
    </summary>
    
      <category term="digest" scheme="http://smanist.github.io/categories/digest/"/>
    
    
      <category term="rnn" scheme="http://smanist.github.io/tags/rnn/"/>
    
      <category term="time series" scheme="http://smanist.github.io/tags/time-series/"/>
    
  </entry>
  
  <entry>
    <title>Interesting Websites</title>
    <link href="http://smanist.github.io/2019/02/15/Interesting-websites/"/>
    <id>http://smanist.github.io/2019/02/15/Interesting-websites/</id>
    <published>2019-02-16T00:27:00.000Z</published>
    <updated>2019-02-24T02:48:36.432Z</updated>
    
    <content type="html"><![CDATA[<p>This is a gathering of websites that are interesting and useful.</p><p>The list is in alphabetical order and could be updated from time to time.</p><a id="more"></a><h2 id="amcharts"><a href="www.amcharts.com">amCharts</a></h2><p>The website provides a set of visualization tools, including an <a href="live.amcharts.com">online chart editor</a> and an <a href="pixelmap.amcharts.com">online map generator</a>. These applications are free and fully-functional. The free image has a website logo that can be removed by paying for a license.</p><p>But the most powerful tool from amCharts is its <a href="www.amcharts.com/download">libraries</a> for plugging interactive visualizations into a webpage. One can write a relatively simple JavaScript/JSON file (or TypeScript, which I am not familiar with) to generate a fancy complex image, such as chord diagrams, sankey diagrams, and annotated world maps.</p><p>The only inconvenient part is that the library is a little bit heavy if one only wants to make figures for a paper or presentation. The library does provide an export function, but requires some manual operations.</p><h2 id="coca-linggle-and-netspeak"><a href="corpus.byu.edu/coca/">COCA</a>, <a href="linggle.com">Linggle</a> and <a href="www.netspeak.org">Netspeak</a></h2><p>These are websites for improving English usage/writing by checking/finding the proper combination of words, i.e.&#xA0;phrases.</p><p>For example, on Linggle, one can find the best combination of words that looks native to English,</p><ol style="list-style-type: decimal"><li><code>*</code> for filling in a blank of a phrase with multiple words.</li><li><code>_</code> for filling in a blank of a phrase with one word.</li><li><code>?word</code> for checking if <code>word</code> is needed in the phrase.</li><li><code>word1/word2</code> for choosing the best word from <code>word1</code> and <code>word2</code> for the phrase.</li><li><code>pos.</code> for finding a word of the specified part of speech for the phrase. <code>pos.</code> can be v., n., adj., prop., det., conj., pron.</li></ol><p>COCA and Netspeak are other two websites for the similar purpose, and its usage is self-explanatory from the website instruction.</p><h2 id="wordart"><a href="wordart.com">Wordart</a></h2><p>The website is for generating a cloud of words, e.g.&#xA0;keywords of a research project. The resulting image can be highly-customized. One has to pay for high resolution image. However, I think the resolution of the free version is high enough for regular usage.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;This is a gathering of websites that are interesting and useful.&lt;/p&gt;
&lt;p&gt;The list is in alphabetical order and could be updated from time to time.&lt;/p&gt;
    
    </summary>
    
      <category term="pieces" scheme="http://smanist.github.io/categories/pieces/"/>
    
    
      <category term="language, visualization" scheme="http://smanist.github.io/tags/language-visualization/"/>
    
  </entry>
  
  <entry>
    <title>Rays v.s. Skates</title>
    <link href="http://smanist.github.io/2019/01/27/Rays_vs_Skates/"/>
    <id>http://smanist.github.io/2019/01/27/Rays_vs_Skates/</id>
    <published>2019-01-28T01:30:00.000Z</published>
    <updated>2019-01-28T15:56:58.606Z</updated>
    
    <content type="html"><![CDATA[<p>Flat fish flying in the water.</p><a id="more"></a><p>Recently I visited an aquarium and encountered with these &#x201C;flying&#x201D; fish, rays and skates. They looks the same to me: flat, kite-like fish.</p><p>In fact, rays and skates are dorsoventrally flattened fish that belong to the same superorder <a href="https://en.wikipedia.org/wiki/Batoidea" target="_blank" rel="noopener">Batoidea</a>, which contains four orders. Skates are in <a href="https://en.wikipedia.org/wiki/Rajiformes" target="_blank" rel="noopener">Rajiformes</a>, while rays are in <a href="https://en.wikipedia.org/wiki/Myliobatiformes" target="_blank" rel="noopener">Myliobatiformes</a>, <a href="https://en.wikipedia.org/wiki/Rhinopristiformes" target="_blank" rel="noopener">Rhinopristiformes</a>, <a href="https://en.wikipedia.org/wiki/Electric_ray" target="_blank" rel="noopener">Torpediniformes</a>. Historically, due to morphological reasons, some rays were classified as skates, and vice versa.</p><p>Furthermore, rays, skates, and their close relatives, sharks, are considered to be within a subclass of (primitive) fish called <a href="https://en.wikipedia.org/wiki/Elasmobranchii" target="_blank" rel="noopener">Elasmobranchii</a> in the class <a href="https://en.wikipedia.org/wiki/Chondrichthyes" target="_blank" rel="noopener">Chondrichthyes</a>. Chondrichthyes contains the cartilaginous fish. From wikipedia: They are jawed vertebrates with paired fins, paired nares, scales, a heart with its chambers in series, and skeletons made of cartilage rather than bone. In a word, these fish have soft skeletons <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. Furthermore, Elasmobranchs have five to seven pairs of gill clefts opening individually to the exterior, rigid dorsal fins and small placoid scales on the skin. The pelvic fins in males are modified to create claspers for the transfer of sperm. There is no swim bladder; instead, these fish maintain buoyancy with large livers rich in oil. Sometimes it is hard to differentiate rays and skates from sharks, as illustrated in this <a href="https://www.youtube.com/watch?v=iLwkfWuAMRo" target="_blank" rel="noopener">short video</a>. However, a rule of thumb is that, sharks have gill slits on the side, rays and skates have theirs on the bottom.</p><p>Now the diffeences between rays and skates. The major difference is in the reproductive strategies: Rays are viviparous while skates are oviparous. The skate eggs are a little peculiar, because they are released in hard rectangular cases nicknamed &#x201C;mermaid&#x2019;s purses&#x201D;. Morphologically, skates typically have a prominent dorsal fin while the dorsal fin is absent or greatly reduced in rays. Most rays are kite-shaped with whip-like tails having stinging spines (hence &#x201C;stingray&#x201D;) while skates have fleshier tails and lack spines <a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a>. While some rays have stings to protect them, the electric rays have kidney-shaped electric organs that are visible through the skin on the dorsal surface to generate and discharge a strong electric current to stun prey and for defense from potential predators. As for skates, they rely on thorny projections on their backs and tails to for protection. For more differences between rays and skates, see <a href="https://en.wikipedia.org/wiki/Skate_(fish)#Skates_versus_stingrays" target="_blank" rel="noopener">here</a>.</p><p>It is said that rays are generally much larger than skates. Nevertheless, the variance of the sizes of rays is huge. The largest ray (<a href="https://en.wikipedia.org/wiki/Giant_oceanic_manta_ray" target="_blank" rel="noopener">Manta birostris</a>) reaches up to 9 meters in width, while the smaller ray (<a href="https://en.wikipedia.org/wiki/Lesser_electric_ray" target="_blank" rel="noopener">Narcine bancroftii</a>) is only 20 cm. The sizes of skates are in between. The largest skate (<a href="https://en.wikipedia.org/wiki/Common_skate" target="_blank" rel="noopener">Dipturus batis</a>) reaches up to 2.5 meters in length, while the smaller skate (<a href="https://en.wikipedia.org/wiki/Raja_straeleni" target="_blank" rel="noopener">Raja straeleni</a>) reaches to a maximum total length of 68 cm.</p><p>The last interesting thing I would like to mention is the <a href="https://en.wikipedia.org/wiki/Osmoregulation" target="_blank" rel="noopener">osmoregulation</a> of cartilaginous fishes, i.e.&#xA0;the passive regulation of the osmotic pressure of an organism&#x2019;s body fluids for the water-salt balance. For adaptation to high-salinity marine environments, cartilaginous fishes adopt a unique urea-based osmoregulation strategy. Their kidneys reabsorb nearly all filtered urea from the primary urine, and this is an essential component of <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1469-185X.1936.tb00497.x" target="_blank" rel="noopener">urea retention</a> in their body fluid.</p><p>Due to urea retention, the meat of cartilaginous fishes is usually poisonous, due to the high content of urea and sometimes trimethylamine oxide. Nevertheless, human managed to process the meat, e.g.&#xA0;via fermentation, and eat without costing their lives. For example, <a href="https://en.wikipedia.org/wiki/Hongeo-hoe" target="_blank" rel="noopener">hongeo-hoe</a> from Korea is made from skate and emits a very strong ammonia-like odor. And <a href="https://en.wikipedia.org/wiki/H%C3%A1karl" target="_blank" rel="noopener">h&#xE1;karl</a> from Iceland is made from sharks and has a strong ammonia-rich smell and fishy taste. The ammonia produced during fermentation actually helps the preservation of the food. I personally have tried h&#xE1;karl, which tasted good if the ammonia smell is accepted. I like the texture.</p><p>References:</p><ol style="list-style-type: decimal"><li><a href="https://www.floridamuseum.ufl.edu/discover-fish/skates-rays/biology/" target="_blank" rel="noopener">Florida Museum</a></li></ol><div class="footnotes"><hr><ol><li id="fn1"><p>See more differences between cartilaginous and bony fishes <a href="https://en.wikipedia.org/wiki/Osteichthyes#Anchor:Bony/Cartilaginous" target="_blank" rel="noopener">here</a>.<a href="#fnref1">&#x21A9;</a></p></li><li id="fn2"><p>The spines of stingrays are often removed for safety reasons when displayed in aquariums.<a href="#fnref2">&#x21A9;</a></p></li></ol></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Flat fish flying in the water.&lt;/p&gt;
    
    </summary>
    
      <category term="pieces" scheme="http://smanist.github.io/categories/pieces/"/>
    
    
      <category term="zoology" scheme="http://smanist.github.io/tags/zoology/"/>
    
      <category term="food" scheme="http://smanist.github.io/tags/food/"/>
    
  </entry>
  
  <entry>
    <title>Notes on Julia</title>
    <link href="http://smanist.github.io/2018/12/21/Notes-on-Julia/"/>
    <id>http://smanist.github.io/2018/12/21/Notes-on-Julia/</id>
    <published>2018-12-21T16:30:00.000Z</published>
    <updated>2018-12-21T16:33:49.826Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.youtube.com/watch?v=8h8rQyEpiZA" target="_blank" rel="noopener">&#x201C;Looks like Python, feels like lisp, runs like C.&#x201D;</a></p><a id="more"></a><h1 id="introduction">Introduction</h1><p>As discussed in the <a href="https://smanist.github.io/2018/11/19/Julia-For-Mushin/">previous article</a>, I plan to explore the capability of Julia in scientific computing, esp. in applications like computational mechanics and optimization. I have gotten even more attracted to Julia when I heard that it has <a href="https://www.hpcwire.com/off-the-wire/julia-joins-petaflop-club/" target="_blank" rel="noopener">joined the Petaflop Club</a>: achieved peak performance exceeding one petaflop per second on supercomputers. Julia appears to be the only &#x201C;high-level&#x201D; language in the Petaflop club - the others are C, C++ and Fortran.</p><p>This article is a digest of the basics of Julia that I have learned recently. The syntax of Julia will not be discussed in detail, as it could be mastered by actaully writing the code - So there will not be many examples. Instead, in this article, I would focus more on the features and highlights of Julia. In addition, due to my background, I tend to highlight the similarities and differences between Julia and Python/C++.</p><h1 id="overview">Overview</h1><h2 id="two-language-problem">Two-Language Problem</h2><p>One of the goals of Julia is to solve the two-language problem: one can <a href="https://thebottomline.as.ucsb.edu/2018/10/julia-a-solution-to-the-two-language-programming-problem" target="_blank" rel="noopener">either have a programming language that&#x2019;s easy to use, or fast.</a></p><p>There are indeed some existing solutions, e.g.&#xA0;those from the Python ecosystem. In the standard <code>CPython</code> implementation, the Python code is <em>interpreted</em> as bytecodes that run on the virtual machine, which is of course slower than <em>compiled</em> machine code that runs on the actual machine. Three representative approaches to accelerate Python include <a href="https://pypy.org/" target="_blank" rel="noopener"><code>PyPy</code></a>, <a href="https://cython.org/" target="_blank" rel="noopener"><code>Cython</code></a>, and <a href="http://numba.pydata.org/" target="_blank" rel="noopener"><code>Numba</code></a>. PyPy is basically an implementation different from CPython using a <a href="https://en.wikipedia.org/wiki/Just-in-time_compilation" target="_blank" rel="noopener">just-in-time (JIT)</a> compiler. Cython generates C code from Python code - or wraps C libraries for Python <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. Numba compiles Python snippets in a JIT manner. I myself have mainly used Python with Cython-wrapped C++ library. So I am really using two languages to &#x201C;solve&#x201D; the two-language problem. The three approaches have been discussed and compared in <a href="https://www.quora.com/How-do-Cython-Numba-and-PyPy-compare-in-terms-of-performance-ease-of-use-and-restrictions" target="_blank" rel="noopener">this post</a>. These approaches are not perfect. To accelerate a given Python code, some extra work are involved, e.g.&#xA0;annotating the code using certain &#x201C;peculiar&#x201D; syntaxes.</p><p>The two-language problem had been even more challenging when the Julia project started in 2009, since the Python ecosystem has not matured enough to solve the problem. As one of the developers discussed in <a href="https://discourse.julialang.org/t/julia-motivation-why-werent-numpy-scipy-numba-good-enough/2236" target="_blank" rel="noopener">this post</a>: The initial version of <code>Cython</code> was released in 2007; The first working verion of <code>PyPy</code> was released in 2007; <code>Numpy</code> was yet not mature at the time; <code>Numba</code> would not be released until 2012. <a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></p><h2 id="solution-by-julia">Solution by Julia</h2><p>Julia is mainly written in Julia with some dependencies on C, Fortran, and assembly. However, in the core, there is a <a href="https://en.wikipedia.org/wiki/Scheme_(programming_language)" target="_blank" rel="noopener">Scheme</a> parser <code>FemtoLisp</code> and a <a href="https://en.wikipedia.org/wiki/LLVM" target="_blank" rel="noopener">LLVM</a> compiler in C++. They are responsible for gluing Julia and the underlying operating system together.</p><p>The Julia solution to the two-language problem is best described by the quote at the beginning of this article:</p><ol style="list-style-type: decimal"><li>Writes like Python: The user writes Julia like a high-level dynamic language.</li><li>Feels like Lisp: The Julia code is parsed into <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree" target="_blank" rel="noopener">abstract syntax trees</a> (ASTs) using FemtoLisp (<code>lowered</code>, <code>typed</code>).</li><li>Runs like C: The LLVM generates the <a href="https://en.wikipedia.org/wiki/Intermediate_representation" target="_blank" rel="noopener">intermediate representation</a> (IR) of the ASTs, which would run on the virtual machine (<code>llvm</code>), and compiles the IR into the native code optimized for the local machine (<code>native</code>) <a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a>.</li></ol><p>The user essentially only needs to care about writing their applications. The compiler takes care of the rest. Of course, the code would be faster if it is written with care taken for the parsing and compiling stages.</p><h2 id="key-features">Key Features</h2><p>As I understand, Julia as a <a href="https://en.wikipedia.org/wiki/Dynamic_programming_language" target="_blank" rel="noopener">dynamic programming language</a> is made distinct from the others by its <a href="https://en.wikipedia.org/wiki/Type_system" target="_blank" rel="noopener">type system</a> combined with <a href="https://en.wikipedia.org/wiki/Multiple_dispatch" target="_blank" rel="noopener">multiple dispatch</a>. Well, I am not a computer scientist, I could be wrong in this assertion and some of the concepts discussed in this section.</p><p>Dynamic languages are usually considered &#x201C;typeless&#x201D;. However, more precisely speaking, types do exist, but what lacks is type declaration. The user cannot explicitly instruct the compiler to specify certain types for certain values. On the other hand, in static languages, type declaration is mandatory. And that is one reason why static languages are usually faster than dynamic languages, as some optimizations of the machine code can be done based on the types. Cython and Numba are like patches of partial type declaration for accelerating Python. Julia takes a step further, as it has the complete type system and the <em>type inference</em> mechanism. Like static language, all the values in Julia can be assigned a type by the user. Like dynamic language, not all values require a type - the most suitable type can be <em>inferred</em> by the compiler.</p><p>Based on the type system, the multiple dispatch mechanism is enabled with <a href="https://en.wikipedia.org/wiki/Parametric_polymorphism" target="_blank" rel="noopener">parametric polymorphism</a>. In <a href="https://en.wikipedia.org/wiki/Polymorphism_(computer_science)" target="_blank" rel="noopener">polymorphism</a>, a single interface, or method, is provided to values of different types <a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a>. Typically, the polymorphic methods are stored in a <a href="https://en.wikipedia.org/wiki/Virtual_method_table" target="_blank" rel="noopener">virtual method table</a>, a.k.a. vtable. In the <em>run-time</em>, the specific method is chosen from the vtable. In single dispatch, the vtable is stored with the classes. The calling of a method can be written as <code>object.action(args)</code>, because the choice of polymorphic method is solely determined by the type of the calling object. In multiple dispatch, the vtable is stored with the method itself. The calling of a method should be better written as <code>action(objects, args)</code>, as is done in Julia, the choice of polymorphic method is determined by the types of all the arguments.</p><p>Multiple dispatch has two advantages. First, it is the direct reason for the high performance of Julia. For each polymorphic method, specialized low-level code is generated with all possible optimizations under the host machine. In the run-time, the most suitable/optimized method is called from the vtable. Second, multiple dispatch provides greater flexibility and reusability, as a method is not bound to a type. For example, suppose there is an existing method for LU decomposition for matrices of <code>Float64</code>. To do LU decomposition of matrices of rationals, one only need to define the elementary arithmetic operations for rationals, and call the same LU method. However, in single dispatch languages, one will need to not only define the elementary arithmetic operations, but also <em>rewriting</em> the LU method using the new rational type.</p><p>Besides the type system and multiple dispatch, another important feature of Julia is its <a href="https://en.wikipedia.org/wiki/Metaprogramming" target="_blank" rel="noopener">metaprogramming</a> capability: a program can be designed to read, generate, analyse or transform other programs, and even modify itself while running. The roles of code and data are more or less interchangeable. In Julia, everything is an expression that returns a value and an expression can take values and/or <em>expressions</em> as input. The metaprogramming capability directly stems from the lisp core of Julia, that enables the manipulation of the ASTs generated from the Julia code, e.g.&#xA0;using macros <a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a> - functions that acts on expressions. The metaprogramming capability allows the users to minimize the efforts and computational time for their applications.</p><h2 id="learning-materials">Learning materials</h2><p>The best learning material for Julia is probably its <a href="https://docs.julialang.org" target="_blank" rel="noopener">documentation</a>, which is always (expected to be) update-to-date, and contains both introductory and advanced topics. The official website also provides a <a href="https://julialang.org/learning/" target="_blank" rel="noopener">large list</a> of learning materials, including videos (e.g. <a href="https://www.youtube.com/watch?v=8h8rQyEpiZA" target="_blank" rel="noopener">this</a> and <a href="http://online.kitp.ucsb.edu/online/transturb17/gibson/rm/jwvideo.html" target="_blank" rel="noopener">this</a>), online documents, and books. Among these are two books that I recommend: (1) <em>Getting Started with Julia</em> by Ivo Balbaert, indeed good for getting started; (2) &#x201C;Julia High Performance&#x201D; by Avik Sengupta, a little advanced but very useful for beginners aiming for performant programs. Another book, &#x201C;Mastering Julia&#x201D; by Malcolm Sherrington, might be good for people who need immediate hands-on experiences. However, a notable issue is that, with the advent of the more stable 1.0 version, some of the syntaxes and claims in the books are outdated. So make sure to practice and verify everything read from the books.</p><p>Another good source of learning materials are the Julia code itself. As one of the books has suggested, there are several interesting folders in Julia to look at:</p><ol style="list-style-type: decimal"><li><code>base</code>: contains a great portion of the standard library and the coding style exemplary.</li><li><code>test</code>: has some code that illustrates how to write test scripts and use the Base.Test system.</li><li><code>examples</code>: gives Julia&#x2019;s take on some well-known old computing chestnuts.</li></ol><p>This article is mainly based on materials from <em>Getting Started with Julia</em> by Ivo Balbaert and the official documentation.</p><h1 id="more-on-features">More on Features</h1><h2 id="type-system">Type System</h2><h3 id="type-hierarchy">Type hierarchy</h3><p>Every value has a type and there are a lot of built-in types. These types are organized in tree, with the root, type <code>Any</code>. The types themselves are of type <code>DataType</code>. A type is either an abstract type or a concrete type. An abstract type can have a lot of children or subtypes but cannot be instantiated, while a concrete type is on the contrary. Essentially, an abstract type is only a name that groups multiple subtypes together, which works in a manner similar to <code>Union</code> that gives a type/alias to a user-specified group of types. Naturally, <code>Any</code> is the supertype of all types (including itself). The opposite of <code>Any</code> is a special type called <code>Union{}</code>, i.e.&#xA0;union of nothing. It is subtype of all other types (even the concrete ones). There is also a special type <code>Nothing</code>.</p><p>Here, it is stressed again: In the context of multiple dispatch, a subtype do not inherit any methods from its supertype. This is on the contrary to the object-oriented thinking.</p><h3 id="conversion-promotion-and-annotation">Conversion, promotion, and annotation</h3><p>Variables of different types can be converted to each other, if the corresponding <code>convert</code> method exists. There is also a built-in system called automatic type promotion to promote arguments of functions so as to match those of the existing functions. This is a key device that facilitates the multi-dispatch mechanism. Additionally, the combination of type promotion and <code>Union</code> could bring some convenience to the user. The user can define one function using data types from a user-defined union and save the effort of defining multiple similar functions for each data type from the union.</p><p>Variables can be associated to types using two operators for type annotation: <code>::</code> and <code>&lt;:</code>. Essentially, <code>var::T</code> asserts if the variable <code>var</code> is of type <code>T</code>. This is also used in the sense of a type declaration, but only in local scopes such as in functions. <code>var&lt;:T</code> asserts if the variable <code>var</code> is of the subtype of <code>T</code>. This can be used in, e.g.&#xA0;the restriction of types in composite types.</p><h3 id="composite-and-parametric-types">Composite and parametric types</h3><p>The composite types are the types composed of a set of named fields with an optional type annotation (by default <code>Any</code>). A composite type is similar to a struct in C. In fact, the keyword is <code>struct</code> too in Julia.</p><p>Composite types declared with struct are immutable; they cannot be modified after construction. This design has some advantages, including efficiency in storage and memory allocation, thread safety, and readability. Nevertheless, the contents of a mutable field in an immutable type can be changed, because only the reference is stored. It could be a good practice to define immutable types without mutable fields. When necessary, mutable composite types can be declared with the keywords <code>mutable struct</code>.</p><p>Composite types can be generalized via parametrization. A parametric type is conceptually similar to templates in C++ and creates a whole family of new possible concrete types. However, the new types are only compiled as needed at runtime. Finally, for better performance, always annotate the type of the fields in a composite type when possible.</p><p>As a side note, to see whether the two objects x and y are identical, they must be compared with the <code>is</code> function, The <code>is(x, y)</code> function can also be written with the triple-equal operator as <code>x === y</code>. The addresses in memory are compared to check whether they point to the same memory location</p><h3 id="constructors">Constructors</h3><p>Constructors creates and initializes an instance of a type. There is always a default (inner) constructor that comes with a type, if not otherwise specified. One can, of course, define a specific inner constructor in the type declaration, which <em>overrides</em> the default one. The inner constructors are the only constructors that has access to a special locally existent function called <code>new</code> that creates an object of the declared type. Once a type is declared, there is no way to add more inner constructor methods. Instead, one can only add outer constructors, that are defined just like regular methods (due to multiple dispatch). The outer constructors, ultimately, rely on calling one of the inner constructors to complete the instantiation.</p><p>Special inner constructors are needed in certain cases, e.g.&#xA0;when argument checking is necessary. A good practice is to combine outer constructors with a limited set of inner constructors.</p><h2 id="metaprogramming">Metaprogramming</h2><p>This is the part of Julia that feel like Lisp: &#x201C;code is data and data is code&#x201D;. Every piece of code is internally represented as an expression, <code>Expr</code>, which can be manipulated by other expressions. This characteristic of Julia, <a href="https://en.wikipedia.org/wiki/Homoiconicity" target="_blank" rel="noopener">homoiconicity</a>, enables the transformation and generation of the code. This is not unfamiliar, if one works with Lisp (e.g.&#xA0;in Emacs) and Mathematica.</p><p>The homoiconicity facilitates the <a href="https://en.wikipedia.org/wiki/Reflection_(computer_programming)" target="_blank" rel="noopener">reflection</a> capability of Julia. The structure of a program and its types can be explored programmatically just like any other data. This means that a running program can dynamically discover its own properties. Reflection is indispensable for tools that need to inspect the internals of the code objects programmatically, such as debugging and profiling.</p><h3 id="expressions">Expressions</h3><p>The Julia code is parsed by FemtoLisp as an AST, a tree representation of the abstract syntactic structure of the source code. The nodes of AST are all of type <code>Expr</code>. A formal definition of the <code>Expr</code> type is <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">type Expr</div><div class="line">    head::Symbol</div><div class="line">    args::Array{Any,1}</div><div class="line">end</div></pre></td></tr></table></figure></p><p>The <code>head</code> indicates the type of the expression, e.g. <code>:call</code> as a function call and <code>=</code> as assignment. The <code>args</code> is an array of <code>Symbol</code>s and (maybe) <code>Expr</code>s, which recursively represents the AST. One can get a formatted output of the AST of an expression using the <code>dump</code> function.</p><p>Expressions can be built directly using the constructor for <code>Expr</code>. However, to make life easier, one can create expressions using the quote operator <code>:</code> that treats its argument as data instead of code. It means &#x201C;prevented evaluation&#x201D; in a sense. The quote preceding a symbol makes a <code>Symbol</code>, e.g <code>:sym</code>. The quote preceding a bracketed expression makes an <code>Expr</code>, e.g <code>:(1+2)</code>.</p><p>A compound expression consists of multiple sub-expressions separated by <code>;</code>. The value of a compound expression is the value of the last sub-expression. For a larger compound expression, it is better to use the <code>quote-end</code> block instead of quote operator. Note that the evaluation of an expression is done in the global scope and the internal variables will be visible to the outside code.</p><p>Writing expressions is made even simpler with the interpolation operator <code>$</code>. The interpolation is evaluated once an expression is constructed at parse time. This is unlike the quotation itself, which is evaluated by <code>eval</code> at runtime.</p><h3 id="macros">Macros</h3><p>Macros are like functions, but instead of values, they take expressions, symbols or literals as input arguments. The evaluation of a macro means the expansion of the input expression. This expansion occurs at parse time when the AST is being built. This is different from a function, which takes the input values and returns the computed values at run-time.</p><p>A macro is hygenic, when it differentiates between the macro context and the calling context. The hygienity is important because the macros inject the code directly in the namespace in which they are called, which may clash with the existing methods in the same module. There are several rules for writing hygienic macros:</p><ol style="list-style-type: decimal"><li>Declare the variables used in the macro as local, so as not to conflict with the outer variables.</li><li>Use the escape function <code>esc</code> to make sure that an interpolated expression is not expanded, but instead is used literally.</li><li>Don&#x2019;t call <code>eval</code> inside a macro.</li></ol><p>Note that escaping is similar to <code>Hold</code> in Mathematica. An expression wrapped in this manner is left alone by the macro expander and simply pasted into the output verbatim. Therefore it will be resolved when the macro is called, instead of when it is defined.</p><h1 id="notes-on-the-usage">Notes on the Usage</h1><p>This section highlights some basic functionalities of Julia.</p><h2 id="general-behaviors-and-conventions">General Behaviors and Conventions</h2><p>Julia behaves similarly to Python in many senses, e.g.&#xA0;all names are just aliases bound to values. However, there are differences. For example, in Julia, arrays are 1-indexed. Negative index is not supported and the last index is <code>end</code>. Refer to <a href="https://docs.julialang.org/en/v1/manual/noteworthy-differences/" target="_blank" rel="noopener">this</a> for more differences between Julia and other languages.</p><p>Entities in Julia must start with a letter or an underscore <code>_</code>. Conventionally variable names consist of lowercase letters with long names separated by underscores rather than using camel case. Numbers can be separated by underscores for readability. It is a good practice to write constant variables in uppercase letters. The package names are kept upper camel case. <code>!</code> indicates a mutating function that modifies its the first argument.</p><p>Julia does not have line-continuation operators. It will read until the expression is finished.</p><p>Julia supports unicode, so that functions and variables can be named using special characters, e.g. <code>&#x2297;</code> instead of <code>*</code> for outer product, and <code>&#x3B1;</code> instead of <code>alpha</code> for a Greek symbol.</p><h2 id="data-structures">Data structures</h2><p>Concepts like strings, arrays, dictionaries, tuples, and sets all behave in a manner that is more or less similar to those in Python. Note that except string, all the rest are parametric types.</p><h3 id="strings">Strings</h3><p>Julia differentiates between single characters and strings. Strings can contain any number of characters and are specified using double quotes <code>&quot;</code> or triple double quotes <code>&quot;&quot;&quot;</code>. The character literals are specified using single quotes <code>&apos;</code>. <code>&quot;&quot;&quot;</code> is used (esp.) when there are double quotes in the string itself.</p><p>The strings are <em>immutable</em>, which means that they cannot be altered once they have been defined</p><p>Julia has an elegant string interpolation mechanism for constructing strings using the <code>$</code> operator (again). <code>$var</code> inside a string is replaced by the value of <code>var</code>, and <code>$(expr)</code> is replaced by the computed value of expression <code>expr</code>. The <code>@printf</code> macro takes a format string and one or more variables to substitute into this string while being formatted. It works in a manner similar to <code>printf</code> in C. In string interpolation, another <code>@sprintf</code> from <code>Printf</code> package is used.</p><p>Strings are joined by <code>*</code>, unlike <code>+</code> in Python. As a result, <code>^</code> applied on a string indicates an implicit multiplication.</p><p>Unicode characters in a string contains multiple bytes. Therefore, there are two ways to define the length of a string: (1) Number of bytes in string, <code>endof(str)</code>; (2) Number of characters in string, <code>length()</code>.</p><p>There are several special types of string.</p><ol style="list-style-type: decimal"><li><code>v&quot;&quot;</code> for version number, which can be compared.</li><li><code>r&quot;&quot;</code> for regular expressions, which can be used for pattern matching.</li><li><code>b&quot;&quot;</code> for byte array literal, which represents a string using <code>Uint8</code> values.</li></ol><h3 id="arrays">Arrays</h3><p>An array is of parametric type: <code>Array{Type,Dimension}</code>. For example, <code>Array{Int64,2}</code> means a 2-D array containing values of type <code>Int64</code>. Additionally, there are short-hands for vectors and matrices: <code>Array{Type,1} == Vector{Type}</code> and <code>Array{Type,2} == Matrix{Type}</code>.</p><p>The arrays are by default &#x201C;real&#x201D; arrays, meaning that the data is stored continuously in memory (<em>column-major</em>). This is in contrast to the list of lists in Python and vectors of vectors in C++. It is possible to create array of arrays in Julia, of course. However, the array would only contain the references to the underlying arrays.</p><p>There are multiple ways to create an array,</p><ol style="list-style-type: decimal"><li>Direct specification, e.g. <code>a=[1,2,3]</code>.</li><li>Using some methods, e.g. <code>collect(range(...))</code></li><li>List comprehension, e.g. <code>[i for i in 1:3]</code>. Multiple <code>for</code>&#x2019;s result in multi-D arrays.</li></ol><p>Note that due to the column-major storage, 1-D array is logically column vectors. Logically row vectors are essentially 1-by-N matrices. To create row vectors, separate the values by space instead of comma, e.g. <code>a=[1 2 3]</code>. Furthermore, a semicolon <code>;</code> indicates a new row, leading to a matrix, e.g. <code>a=[1 2 3;4 5 6]</code>.</p><p>In the creation of an array, constraining the type is often helpful for the performance. Using typed comprehensions everywhere for explicitness and safety in production code is certainly a best practice. For example, use <code>a=Int64[1,2,3]</code> instead of <code>a=[1,2,3]</code>. When dealing with large arrays, it is better to indicate the final number of elements for pre-allocation using the <code>sizehint</code> method to improve the performance. The memory of a large array can be freed by setting the array to <code>nothing</code>.</p><h3 id="dictionaries-and-enumerations">Dictionaries and enumerations</h3><p>A dictionary is of parametric type: <code>Dict{Type_key,Type_value}</code>. It is created by by <code>Dict(key=&gt;val, ...)</code>, where <code>=&gt;</code> is a pair operator. All the keys must have the same type, and the same is true for the values. The types can be specified at creation. A good practice is to use immutable types for the key, e.g.&#xA0;a <code>Symbol</code> <a href="#fn6" class="footnoteRef" id="fnref6"><sup>6</sup></a>.</p><p>Dictionaries are mutable. New key-value pairs can be appended to a dictionary without calling method like <code>update</code> in Python. Also, one can directly loop over keys, values, or key-value pairs of a dict. In Python, one need to call <code>iteritems</code> to loops over key-value pairs.</p><p>Julia does not provide a standard enumeration type. However, there is a <code>@enum</code> macro that creates a type that behaves like a <code>Enum</code>, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">@enum EnumName[::BaseType] key[=val] ...</div></pre></td></tr></table></figure></p><p>The data is stored as <code>Vector{Tuple{Symbol,Integer}}</code>.</p><h3 id="tuples">Tuples</h3><p>The type of a tuple is just a tuple of the types of the values it contains. Tuples are immutable, just like other languages. A tuple can be unpacked or deconstructed, e.g. <code>a, b = tuple1</code>. Notice that an error will not be raised if the left-hand side cannot take all the values of the tuple.</p><p>Finally, note that there is a type <code>NamedTuples</code>, which can be considered an ordered dictionary. Its underlying structure consists of a tuple of all the keys as <code>Symbol</code> and a tuple of all the values.</p><h2 id="control-flow">Control flow</h2><h3 id="basic-blocks">Basic Blocks</h3><p>One thing to be kept in mind is that, everything is an expression that returns a value. That means, structs like <code>if-else-end</code> and <code>try-except-end</code> all return a value, which can be assigned to a variable.</p><p>The familiar <code>if-elseif-else-end</code> syntax is used for conditionals. There are two short-hand versions: (1) Ternary operators: <code>a ? b : c</code>, and (2) Short-circuit evaluation <a href="#fn7" class="footnoteRef" id="fnref7"><sup>7</sup></a>,</p><ol style="list-style-type: decimal"><li><code>cond &amp;&amp; expr</code>, if cond=true, do expr</li><li><code>cond || expr</code>, if cond=false, do expr</li></ol><p>Like Python, Julia has no switch/case statement, and the language provides no built-in pattern matching</p><p>The familiar <code>while-end</code> and <code>for-end</code> syntaxes are used for loops, which can be combined with <code>break</code> and <code>continue</code>. For the <code>for</code> loop, the iteration can be done on a range, a string, an array, or any other iterable collection, just like Python. Furthermore, <code>enumerate</code> also exists in Julia. One thing special, though, is that multiple <code>for</code> loops can be combined into one block - this is how multi-for list comprehension works. Note that <code>for</code> loops are typically <em>faster</em> than vectorization in languages like Python. That is because (1) in Python, the implementation of vectorization (e.g.&#xA0;by Numpy) is faster than naive loops generated by the interpreter; (2) in Julia, vectorization requires extra memory allocation and is thus slower than naive loops. Nevertheless, list comprehension can be far slower than the <code>for</code> loops and vectorizations.</p><p>The exceptions can be handled using the familiar <code>try-catch-finally-end</code> construct. However, the <code>try-catch</code> should not be used in performance bottlenecks. Whenever possible, all possible exceptions should be handled via conditionals. There are 24 predefined exceptions that Julia can generate, as of writing. These exceptions can be <code>throw</code>&#x2019;d to interrupt the execution. User-defined exceptions can be created by deriving from the base type, <code>Exception</code>. Finally, Exceptions with error/warning/info messages are handled by the <code>error</code>, <code>warn</code>, and <code>info</code> methods.</p><h3 id="scopes">Scopes</h3><p>The <code>for</code>, <code>while</code>, and <code>try</code> blocks (but not the <code>if</code> blocks) all introduce a new scope. There are several things to note.</p><p>To create a new local binding for a variable, one should use the <code>let</code> block. This is similar to the <code>cell-var-from-loop</code> in Python discussed in a previous <a href="https://smanist.github.io/2018/04/19/Python-Linting/">article</a>, where a local variable is used in the definition of a function that would be used outside the current block.</p><p>The <code>for</code> loops and comprehensions differ in the way they scope an iteration variable. When <code>i</code> is initialized before a <code>for</code> loop, after executing a <code>for</code> loop iterating on <code>i</code>, the variable <code>i</code> will be updated. However, this is <em>not true</em> for comprehension.</p><h3 id="taskscoroutines">Tasks/Coroutines</h3><p>Julia also supports the <code>yield</code> mechanism, like Python. This can done by the combination of <code>put!</code> and <code>take!</code> methods associated with the <code>Channel</code> type. There is also a more fundamental <code>Task</code> type to define the task to be executed by <code>put!</code> and <code>take!</code>. There is also a convenient <code>@task</code> macro for creating a task from a function. <a href="#fn8" class="footnoteRef" id="fnref8"><sup>8</sup></a></p><p>Finally, note that currently Julia tasks are not scheduled to run on separate CPU cores (yet?).</p><h2 id="functions">Functions</h2><p>There are several ways for creating a function:</p><ol style="list-style-type: decimal"><li>Code block of <code>function-end</code></li><li>One-liner: function(variables) = expression</li><li>Anonymous function: function = variables -&gt; expression</li></ol><p>When the performance is important, try to use named functions instead of anonymous ones, because calling anonymous functions involves a huge overhead. Anonymous functions are mostly used when passing a function as an argument to another function, or as output of a function. That latter case is related to <a href="https://docs.julialang.org/en/v1.0/devdocs/functions/#Closures-1" target="_blank" rel="noopener">closures</a>.</p><p>The input and output of a function are essentially specified using tuples. There are three types of arguments: (1) Normal arguments; (2) Optional positional arguments; (3) Optional keyword arguments. A typical arglist would be <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">func(arg, pos_arg=val1; kw_arg=val2)</div></pre></td></tr></table></figure></p><p>Only the first two types of arguments, the positional ones, are considered in the multiple dispatch mechanism. The optional keyword arguments are mainly introduced for code clarity. The last positional argument can be &#x201C;spliced&#x201D;: <code>arg...</code>, meaning that it would take all the extra positional arguments into one tuple. Note that the splice operator <code>...</code>, or splat, can be also used to pass an array to a function as individual arguments rather than an array as a whole. This is similar to the <code>*</code> operator in Python.</p><p>It is important to realize that in Julia, all the arguments to functions (with the exception of plain data such as numbers and chars) are passed by reference. Their values are not copied when they are passed, which means they can be changed from inside the function, and the changes will be visible to the calling code.</p><p>Higher-order function in Julia just works like that in Python. There are methods like <code>map</code>, <code>filter</code>, and <code>broadcast</code>. Note that the short-hand for broadcast is the dot <code>.</code>. This is the underlying mechanism for <em>element-wise</em> operations in arrays, such as <code>.*</code>. Also, wise applications of the dot operator can avoid extra memory allocations in vectorized loops, or making a devectorized loop look like a vectorized one - See example #6 <a href="http://www.stochasticlifestyle.com/7-julia-gotchas-handle/" target="_blank" rel="noopener">here</a>.</p><p>Here are some general tips for writing performant functions/program:</p><ol start="0" style="list-style-type: decimal"><li>Refrain from using global variables. If unavoidable, make them constant, or at least annotate the types.</li><li>Split the complete program in functions, <em>small</em> functions, that work on local variables.</li><li>Types should be stable: Avoid changing the types of variables during execution.</li><li>Types could be inferred: Always type-annotate the arguments using concrete types or type unions.</li><li>The return type should only depend on the types of the arguments.</li><li>Avoid using the splat operator for dynamic lists of keyword arguments.</li></ol><h1 id="advanced-topics">Advanced Topics</h1><p>Two advanced topics in Julia are briefly touched here and will be investigated more in the future.</p><h2 id="calling-other-languages-from-julia">Calling other languages from Julia</h2><h3 id="shell">Shell</h3><p>Julia offers an efficient shell integration through the <code>run</code> function, which creates an object of type <code>Cmd</code> that is defined by enclosing a command string in backticks <code>`</code>. Julia forks commands as child processes from the Julia process. The <code>Cmd</code> object is not executed immediately. It can be run, connected to other commands via pipes, and read or write to it. The pipe operator <code>|&gt;</code> can be used to redirect the output of a <code>Cmd</code> as the input to the following <code>Cmd</code>, just like that in shell environment <a href="#fn9" class="footnoteRef" id="fnref9"><sup>9</sup></a>.</p><h3 id="c-and-fortran">C and Fortran</h3><p>Julia&#x2019;s LLVM compiler generates native code, the C functions can be called directly by Julia without any glue code. Calling a C function from Julia has exactly the same overhead as calling the same function from C code itself. However, care should be taken when dealing with arguments. First, one needs to work with pointer types, i.e.&#xA0;a native pointer Ptr{T} representing the memory address for a variable of type T. Second, the data consists of bits, e.g.&#xA0;Int8, Uint8, Int32, Float64, Bool, and Char, are considered <code>bitstype</code>. These will be viewed as contiguous byte arrays from C. The calling basically takes the following form, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">result = ccall( (:function, &quot;library&quot;), return_type, (tuple_of_argument_types,), arguments)</div></pre></td></tr></table></figure></p><p>Arguments to C functions are, in general, automatically converted, and the returned values in C types are also converted to Julia types. Arrays of Booleans are handled differently in C and Julia and cannot be passed directly, so they must be manually converted. The <code>ccall</code> function will also automatically ensure that all of its arguments will be preserved from garbage collection until the call returns.</p><p>Calling Fortran functions is similar. Just note that all inputs must be passed by reference. The support for C++ is more complex, see packages like <a href="https://github.com/Keno/Cxx.jl" target="_blank" rel="noopener">Cxx</a> and <a href="https://github.com/JuliaInterop/CxxWrap.jl" target="_blank" rel="noopener">CxxWrap</a>.</p><h3 id="python">Python</h3><p>Calling Python from Julia is done easily using the <code>PyCall</code> package. With the <code>@pyimport</code> macro, one can easily import any Python library, whose functions are called with the familiar dot notation.</p><h2 id="parallel-computing">Parallel Computing</h2><p>Julia&#x2019;s model for building a large parallel application works by means of a global distributed address space. This means that you can hold a reference to an object that lives on another machine participating in a computation. These references are easily manipulated and passed around between machines, making it simple to keep track of what&#x2019;s being computed where. Also, machines can be added in mid computation when needed.</p><p>Besides manually receiving and sending messages between processes, or workers, Julia also provides some useful wrappers.</p><h3 id="parallel-macro">Parallel macro</h3><p>The <code>@parallel</code> macro acts on a <code>for</code> loop, splitting the range, and distributing it to each process. It optionally takes a &#x201C;reducer&#x201D; as its first argument. If a reducer is specified, the results from each remote procedure will be aggregated using the reducer.</p><p>If the computational task is to apply a function to all elements in some collection, the parallel map operation can be applied using the <code>pmap</code> function <code>pmap(f, coll)</code>. It applies a function on each element of a collection in parallel, while preserving the order of the collection in the result.</p><h3 id="distributed-array">Distributed array</h3><p>When computations have to be done on a very large array (or arrays), the array can be distributed, so that each process works in parallel on a different part of the array. In this way, we can make use of the memory resources of multiple machines, and allow the manipulation of arrays that would be too large to fit on one machine.</p><p>The specific data type used here is called a distributed array or <code>DArray</code>; most operations behave exactly as on the normal Array type, so the parallelism is invisible. With <code>DArray</code>, each process has local access to just a part of the data, and no two processes share the same data.</p><h1 id="more-topics-for-later">More Topics for Later</h1><p>There are yet many more topics to talk about in Julia, e.g.</p><ol style="list-style-type: decimal"><li>Packages: Julia has a built-in package system with <code>git</code> capability.</li><li>Graphics: Plotting capability is typically enabled by interfacing to external packages, e.g.&#xA0;Matplotlib from Python.</li><li>Benchmark: There are some tools/packages for benchmarking, which are critical for developing real performant Julia code.</li><li>Performance notes: The whole book &#x201C;Julia High Performance&#x201D; by Avik Sengupta is devoted to this topic.</li></ol><p>These topics (and more) will probably be discussed in future posts.</p><div class="footnotes"><hr><ol><li id="fn1"><p>It is also possbile to <a href="https://cython.readthedocs.io/en/latest/src/userguide/pypy.html" target="_blank" rel="noopener">combine Cython and PyPy</a> for more acceleration. Yet, that requires tweaking the original code even more.<a href="#fnref1">&#x21A9;</a></p></li><li id="fn2"><p>This initial environment also has an influence on the design of Julia - maybe that is why arrays are column-majored instead of row-majored as in <code>Numpy</code>.<a href="#fnref2">&#x21A9;</a></p></li><li id="fn3"><p>Julia provides <a href="https://docs.julialang.org/en/v1.0/devdocs/reflection/#Intermediate-and-compiled-representations-1" target="_blank" rel="noopener">several methods</a> for inspecting the code generated at each stage: <code>code_lowered</code>, <code>code_typed</code>, <code>code_warntype</code>, <code>code_llvm</code>, <code>code_native</code>.<a href="#fnref3">&#x21A9;</a></p></li><li id="fn4"><p>Note that there is a subtle difference between polymorphism and <a href="https://en.wikipedia.org/wiki/Function_overloading" target="_blank" rel="noopener">overloading</a>. Both polymorphic and overloaded methods seem to be &#x201C;methods of the same name that behave differently depending on the arguments and their types.&#x201D; The difference is that the choice of overloaded methods is done in the <em>compilation</em>, while the choice of polymorphic methods is done in the <em>run-time</em>. An example in C++: methods of the same name in the same class are overloaded; virtual functions inherited between classes are polymorphic. Nevertheless, in Julia documentation, it seems the two concepts are not strictly differentiated.<a href="#fnref4">&#x21A9;</a></p></li><li id="fn5"><p>An often-noted difference between macros in Julia and languages like C and C++ is that, macros in the latter are expanded before any actual parsing or interpretation occurs.<a href="#fnref5">&#x21A9;</a></p></li><li id="fn6"><p>Note that the syntax <code>[key=&gt;val, ...]</code> now produces an array of <code>Pairs</code> and the syntax <code>{key=&gt;val, ...}</code> is deprecated.<a href="#fnref6">&#x21A9;</a></p></li><li id="fn7"><p>For non-short-circuit Boolean evaluations, use operators <code>&amp;</code> and <code>|</code>.<a href="#fnref7">&#x21A9;</a></p></li><li id="fn8"><p>Note that there was a <code>produce</code>-<code>consume</code> method combination, but they are already deprecated.<a href="#fnref8">&#x21A9;</a></p></li><li id="fn9"><p>The pipe operators <code>|&gt;</code> works not only with <code>Cmd</code> objects, but also other functions. Essentially it means passing preceding object as the argument to the following function.<a href="#fnref9">&#x21A9;</a></p></li></ol></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=8h8rQyEpiZA&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;“Looks like Python, feels like lisp, runs like C.”&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="http://smanist.github.io/categories/coding/"/>
    
    
      <category term="julia" scheme="http://smanist.github.io/tags/julia/"/>
    
  </entry>
  
  <entry>
    <title>Roast Beef</title>
    <link href="http://smanist.github.io/2018/12/02/Roast-beef/"/>
    <id>http://smanist.github.io/2018/12/02/Roast-beef/</id>
    <published>2018-12-02T20:30:00.000Z</published>
    <updated>2018-12-02T21:06:17.806Z</updated>
    
    <content type="html"><![CDATA[<p>An (on-going) experiment of roast beef.</p><a id="more"></a><h1 id="the-recipe">The recipe</h1><p>This recipe is based on multiple sources: <a href="https://www.allrecipes.com/video/1032/all-american-roast-beef/" target="_blank" rel="noopener">1</a>, <a href="https://www.simplyrecipes.com/recipes/roast_beef/" target="_blank" rel="noopener">2</a>, <a href="https://www.williams-sonoma.com/recipe/pan-roasted-beef-tenderloin-with-rosemary-and-garlic.html" target="_blank" rel="noopener">3</a>, <a href="https://www.myrecipes.com/recipe/pan-fried-beef-tenderloin" target="_blank" rel="noopener">4</a>.</p><h2 id="ingredients">Ingredients</h2><ol style="list-style-type: decimal"><li>Beef</li><li>Salt</li><li>Garlic</li><li>Pepper</li></ol><h2 id="steps">Steps</h2><h3 id="preparation">Preparation</h3><ol style="list-style-type: decimal"><li>Make sure the beef is at room temperature.</li><li>Rub the surface with salt and smashed garlic, and cover the beef using food wrap for 15-30 min.</li></ol><h3 id="option-1-using-frying-pan-only">Option 1: Using frying pan only</h3><ol style="list-style-type: decimal"><li>Recycle the garlic and fry at low heat.</li><li><em>Frying</em>: Fry the beef at high heat, 2 min for each side until brown.</li><li>Cover the pan with lid and turn off the heating, let the beef stand for 5 min.</li><li>Flip the meat and let stand for a few more minutes, at very low heat.</li><li>When the center temperature reaches 100 F, get the beef out.</li><li>Sprinkle pepper and wrap the beef with foil. Let stand for 30 min.</li></ol><h3 id="option-2-using-oven">Option 2: Using Oven</h3><ol style="list-style-type: decimal"><li><em>Tieing</em>: Tie the beef with kitchen twine with a 2-3 inch separation.</li><li><em>Roasting</em>: Roast the beef at 375 F until the center temperature reaches 150 F. Typically takes 20 min/pound.</li><li>Let the beef stand for 20 min.</li></ol><h3 id="variations">Variations</h3><p>One purpose of browning the surface is to &#x201C;lock&#x201D; the juice in the beef. This is done by (1) the Frying step in Option 1, or (2) the Tieing and Roasting steps in Option 2. There are two variants of Option 2. First, in the Roasting step, instead of roasting constantly at 375 F, lower the temperature to 225 F once the beef is browned. Note that this woudl take longer to finish. The second variant is to replace the Tieing and Roasting steps with the Frying step from Option 1.</p><h2 id="notes">Notes</h2><ol style="list-style-type: decimal"><li>In the rubbing step of preparation, one suggestion is to insert some garlic into the beef for better smell and taste.</li><li>In Option 1, the center temperature of 100 F results in rare to medium rare texture. Increase if necessary.</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;An (on-going) experiment of roast beef.&lt;/p&gt;
    
    </summary>
    
      <category term="pieces" scheme="http://smanist.github.io/categories/pieces/"/>
    
    
      <category term="life" scheme="http://smanist.github.io/tags/life/"/>
    
      <category term="food" scheme="http://smanist.github.io/tags/food/"/>
    
  </entry>
  
  <entry>
    <title>Julia for Mushin</title>
    <link href="http://smanist.github.io/2018/11/19/Julia-For-Mushin/"/>
    <id>http://smanist.github.io/2018/11/19/Julia-For-Mushin/</id>
    <published>2018-11-19T21:30:00.000Z</published>
    <updated>2018-11-19T21:44:12.693Z</updated>
    
    <content type="html"><![CDATA[<p>A plan to try out the <a href="https://julialang.org/" target="_blank" rel="noopener">Julia language</a>.</p><a id="more"></a><p>Three months ago, Version 1.0 of Julia was <a href="https://julialang.org/blog/2018/08/one-point-zero" target="_blank" rel="noopener">released</a>, marking the more-or-less maturing of this language, especially for the field of scientific computation. For Internet applications, some people say everything that can be done using Javascript will eventually be done using Javascript. I wonder if the same thing is true about Julia: In scientific computation, will everything that can be done using Julia eventually be done using Julia?</p><p>I am not wondering without a solid basis. Julia appears to be fast, maybe close to C, according to the <a href="https://julialang.org/benchmarks/" target="_blank" rel="noopener">official benchmark</a>. In the meanwhile, Julia is a dynamic language that is probably much easier to use than static languages like C. As the developer <a href="https://docs.julialang.org/en/v1/" target="_blank" rel="noopener">indicated</a>, Julia is developed in the hope to &#x201C;eliminate the performance trade-off and provide a single environment productive enough for prototyping and efficient enough for deploying performance-intensive applications&#x201D;.</p><p>I am particularly interested in a few features of Julia claimed by its developers: (1) Designed for parallelism and distributed computation; (2) Powerful type system where user-defined types are as fast and compact as built-ins; (3) Call C functions directly, without wrappers or special APIs. Item 1 indicates a certain level of automation in parallelizing the code. Item 2 indicates the efficient implementation of some computational techniques, such as automatic differentiation (AD). If that is true, a lot of troubles and pains in AD&#x2019;ing codes in C/C++/Fortran can be avoid. Item 3 could be a huge plus for a Cython user like me - I have been glueing C/C++ libraries using Python all the time. Nevertheless, if Julia is fast enough, maybe there is even no need for the acceleration using C/C++.</p><p>To try out and assess Julia, my short-term plan is to rewrite and expand the Python library <a href="https://smanist.github.io/2018/06/23/Multibody-short-range-interaction/">Mushin</a> that I developed earlier. The rewriting will be divided into the following steps/modules,</p><ol style="list-style-type: decimal"><li>Basics I: The computation of the element internal force vectors and stiffness matrices; the assembly of the element vectors and matrices; the solution of the nonlinear system of static mechanics.</li><li>Basics II: The inclusion of mass terms and the capability for solving dynamic problems.</li><li>Parallelization using MPI.</li><li>Optimization: Development of the adjoint of the problem using AD techniques.</li><li>Uncertainty quantification (UQ) of the time response.</li></ol><p>Modules 2, 3 and 4 depend on Module 1 and are parallel to each other. Module 5 depends on Modules 1 and 2. There are a few questions to consider in the implementation of these modules:</p><ol style="list-style-type: decimal"><li>How to implement sparse and distributed vectors and matrices? Would <a href="https://docs.julialang.org/en/v1/stdlib/SparseArrays" target="_blank" rel="noopener">SparseArrays</a> work?</li><li>More fundamentally, how to do large-scale linear algebra operations in Julia? Is there something that is AD-able and is like the <a href="https://www.mcs.anl.gov/petsc/" target="_blank" rel="noopener">PETSc</a> library for C?</li><li>How to solve a large scale nonlinear system? Would <a href="https://github.com/JuliaOpt/NLopt.jl" target="_blank" rel="noopener">NLopt</a> work?</li><li>How to AD the code? How would <a href="http://www.juliadiff.org/" target="_blank" rel="noopener">JuliaDiff</a> work?</li><li>Is it better to implement time integration manually, or directly use <a href="http://docs.juliadiffeq.org/" target="_blank" rel="noopener">DifferentialEquations</a>? What impact would be on the UQ applications?</li></ol><p>The ultimate goal of the short-term plan is to check if Julia is suitable for a computational library: fast, easy parallelization, easy AD and UQ. If everything works out, the long-term plan would be to develop a pure Julia library for general finite element analysis that is parallelized with AD and UQ capabilities enabled.</p><p>Finally a few notes on the basic aspects in AD. Start with <a href="https://en.wikipedia.org/wiki/Automatic_differentiation" target="_blank" rel="noopener">wiki</a>. Mathematically, forward and backward modes of AD are conceptually based on the tangent and dual vectors, respectively. There are basically two strategies for implementation: source code transformation (SCT) and operator overloading (OO). The AD results are usually compared with the <a href="https://blogs.mathworks.com/cleve/2013/10/14/complex-step-differentiation/" target="_blank" rel="noopener">complex step method</a>. There are a lot of resources on GitHub, for both SCT and OO.</p><p>Some references:</p><ol style="list-style-type: decimal"><li><a href="www.autodiff.org">Website</a>, a collection of libraries for AD.</li><li><a href="https://alexey.radul.name/ideas/2013/introduction-to-automatic-differentiation/" target="_blank" rel="noopener">Introduction to AD</a>.</li><li><a href="https://epubs.siam.org/doi/book/10.1137/1.9780898717761" target="_blank" rel="noopener">Evaluating Derivatives, Griewank2008</a>.</li><li><a href="https://www.springer.com/us/book/9780387303031" target="_blank" rel="noopener">Numerical Optimization, Nocedal2006</a>, a chapter is devoted to derivative evaluation, also including coloring scheme.</li><li><a href="https://ieeexplore.ieee.org/document/6426534/" target="_blank" rel="noopener">Andersson2012</a>, the library CasADi is presented and eight &#x201C;flavors&#x201D; of AD are discussed.</li><li><a href="https://arc.aiaa.org/doi/abs/10.2514/1.J052184" target="_blank" rel="noopener">Martins2013</a>.</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;A plan to try out the &lt;a href=&quot;https://julialang.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Julia language&lt;/a&gt;.&lt;/p&gt;
    
    </summary>
    
      <category term="plan" scheme="http://smanist.github.io/categories/plan/"/>
    
    
      <category term="mechanics" scheme="http://smanist.github.io/tags/mechanics/"/>
    
      <category term="julia" scheme="http://smanist.github.io/tags/julia/"/>
    
      <category term="numerical" scheme="http://smanist.github.io/tags/numerical/"/>
    
  </entry>
  
  <entry>
    <title>Tips On Scientific Posters</title>
    <link href="http://smanist.github.io/2018/11/19/Tips-On-Scientific-Posters/"/>
    <id>http://smanist.github.io/2018/11/19/Tips-On-Scientific-Posters/</id>
    <published>2018-11-19T19:30:00.000Z</published>
    <updated>2018-11-19T20:05:56.012Z</updated>
    
    <content type="html"><![CDATA[<p>Some feedback from my first poster presentation.</p><a id="more"></a><p>Recently I got a chance to present my research as a poster. It was fun to think about and make the poster, from which I have learned (what I think are) some basic guidelines. Thanks to <a href="http://www.principiae.be/pdfs/ERP-1.01.pdf" target="_blank" rel="noopener">Jean-luc Doumont</a>, specialists from a technical communication team, and my friends who criticized my poster.</p><h1 id="baseline-to-start-with">Baseline to Start With</h1><p>What summarizes the essentials of a poster, I think, is Doumont&#x2019;s Three laws of communication, originally from <a href="https://ieeexplore.ieee.org/abstract/document/1097811" target="_blank" rel="noopener">here</a>,</p><ol style="list-style-type: decimal"><li>Adapt to audience - They will not adapt to you</li><li>Maximize signal/noise ratio: remove distracting elements on poster</li><li>Maintain effective redundancy: Using both verbal and nonverbal explanations to make the poster self-explained.</li></ol><p>My understanding is that, a poster is considered successful if the audience can learn the complete set of information that the poster is intended to convey. Therefore, the poster should be carefully tailored and not as stuffed/technical/detailed as possible, since the audience may not be able to digest. Also, a certain level of noise and redundancy is necessary to ensure the effectiveness of the information transmission. Note that the three laws of communication are apparently applicable to not only posters but also papers and presentations.</p><p>The central idea in structuring the poster is that a poster is multi-scale. On the top level are the titles and captions, which are the most visible and eye-catching. The lower levels are the texts and figures, which might be read if the audience got interested. On each level, the information should be stated and developed into <em>messages</em> using short full sentences. These messages answer the questions of the audience at different levels of details: What is presented and <em>so what</em>? What is the gap between what people have and want? And where does the authors come in and what are their contributions? In my opinion, the idea of multi-scale presentation is similar to the <a href="https://en.wikipedia.org/wiki/Inverted_pyramid_(journalism)" target="_blank" rel="noopener">inverted pyramid</a> structure in journalism. The only difference is the ordering of visibility. A news article is more linear: the most visible part is at the beginning and the visibility decreases towards the end.</p><h1 id="format-for-navigation">Format for Navigation</h1><p>The multi-scale nature of the poster determines its layout. Two aspects should be considered: How it looks like as a whole, and how are the items relatively positioned? The basic rules are summarized as: (1) Proximity for relation; (2) Similarity for similar contents; (3) Prominence for importance. Particularly, the items, e.g.&#xA0;text boxes and figures, should be placed with alignment to grid lines to achieve a global level of &#x201C;harmony&#x201D;.</p><p>For text boxes, make sure to use a fixed set of fontsizes. Furthermore, be cautious of using boldface: Whatever words in bold should make sense on its own. This is another example of how a poster is multi-scale. Next, some people (Like Doumont) suggest no justifications for the text, while I used justification in my poster. I think this is scenario dependent. Finally, it might be beneficial to maximize the contrast, e.g.&#xA0;using color background with white boxes.</p><h1 id="figures-and-visuals">Figures and Visuals</h1><p>The basic principle is that the visuals should be informative, instead of merely decorative. They should be designed with high proportion of data to ink while remain <em>self-explained</em> via necessary and meaningful captions, legends, narratives, etc.</p><p>For figures in particular, I do recommend Doumont&#x2019;s suggestions:</p><ol style="list-style-type: decimal"><li>No need to use grids: Grids are for figures in the past era of printed materials.</li><li>Only label the significant numbers: Instead of using the conventional uniform axis ticks, which is a waste of ink and does no provide much information.</li><li>For posters, no need to include figure numbers: Waste of space and ink.</li></ol><h1 id="other-tips">Other Tips</h1><p>Think twice if the reference and acknowledgements should be put on the poster. They take some space but do not add much information to the poster. It might make more sense to carry the extra information via some external media. Doumont suggested something like a business card that can be distributed. People who are interested can look into the details themselves later. This time I tried to do things digitally and put a QR code on the poster that links to a temporary post on my website.</p><p>If PowerPoint is used for making the poster and producing the final PDF file, make sure the slides are <em>exported</em>, instead of <em>printed</em>, as PDF files. The figure resolution would be lost in printed PDF files. Also, whenever possible, use SVG format, instead of PNG format, for the figures. This reduces the file size of the slides while maintaining high resolution. However, note that in the exported PDF file, some features in the SVG figure might be rasterized.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Some feedback from my first poster presentation.&lt;/p&gt;
    
    </summary>
    
      <category term="digest" scheme="http://smanist.github.io/categories/digest/"/>
    
    
      <category term="career" scheme="http://smanist.github.io/tags/career/"/>
    
      <category term="communication" scheme="http://smanist.github.io/tags/communication/"/>
    
  </entry>
  
  <entry>
    <title>Professor Ni Naru III</title>
    <link href="http://smanist.github.io/2018/10/14/Professor-Ni-Naru-III/"/>
    <id>http://smanist.github.io/2018/10/14/Professor-Ni-Naru-III/</id>
    <published>2018-10-14T19:20:00.000Z</published>
    <updated>2018-11-19T17:58:24.226Z</updated>
    
    <content type="html"><![CDATA[<p>How to become a professor (in Engineering)? CV and cover letter for application.</p><a id="more"></a><p>These are notes from a workshop on writing CV and cover letters (CL).</p><p>First, think from institution&#x2019;s point of view: (1) They have spent great effort on creating the position, so the applicants are expected to customize the materials and show excitement for this particular institution. (2) Due to its large volume, the applications will be quickly skimmed and carefully read only when the applicant is seriously under consideration, so the materials are expected to be accessible to the general audience. In addition, the screening process will be in the order of CL, then CV, then research statement. So a certain level of redundancy is expected.</p><h1 id="cv">CV</h1><p>The CV should demonstrate one&#x2019;s strongest qualifications and the supporting details. Particularly, the following four aspects of the experiences shall be tailored based on the institution:</p><ol style="list-style-type: decimal"><li>Research: Include short introduction and key results. The research interests should be explained using a short narrative of research and brief conclusion with future program of research, which align with the department.</li><li>Teaching: Typically teahcing assistant experience. It should be supported by statistical summary of evaluation and highlights of contributions to the course.</li><li>Grant</li><li>Professional</li></ol><p>In addition, care should be taken for the following items:</p><ol style="list-style-type: decimal"><li>Include the dissertation title and advisor&#x2019;s name(s).</li><li>Awards: explain the abroad ones if necessary.</li><li>Publication: Differentiate between accepted, in press, submitted, under review, in progress.</li><li>Service and membership: List only those to whom contributed. Do not list those obtain by simply paying registration fees.</li><li>Reference info.: Include names, titles, institutions and contact info. for people who can provide info. on one&#x2019;s espertise, grant, collaboration.</li></ol><p>Some tips for writing the CV:</p><ol style="list-style-type: decimal"><li>Clear and concise.</li><li>Learn from CV&#x2019;s of peers and people slightly ahead of you.</li><li>Balance the heading and the contents.</li><li>Always tailor for institutional fit.</li><li>Show instead of tell, i.e.&#xA0;provide supporting details.</li><li>Present oneself as a future colleague, not a student.</li></ol><h1 id="cover-letter">Cover letter</h1><p>Answer two questions: (1) What is one&#x2019;s strength as future faculty, particularly in productivity, fundability, leadership; (2) What is one&#x2019;s strength for the particular position: show the fit.</p><p>There are four essentials in CL:</p><ol style="list-style-type: decimal"><li>Reputation: advisor, institution, contribution. This can be done in a short paragraph and serve as opening.</li><li>Fundability: research vision, past funding future ideas.</li><li>Productivity: funding, publication, patents.</li><li>Fit: research focus of the position, institutional culture, department colleagues. This serves as the closing.</li></ol><p>These essentials can be demonstrated in CL using the following structure:</p><ol style="list-style-type: decimal"><li>Opening: What position, where you currently are, area of expertise, strength.</li><li>Body: Research vision, relevancy, fundability, accomplishments to date and highlighted contributions. Teaching and advising experience.</li><li>Closing: Enthusiasm for position, colleagues, department and institution.</li></ol><p>A good practice is to start writing a CL even if one is not applying for a position soon. This helps one to identify the areas and interest, articulated in daily networking, and be prepared for (unexpected) interviews.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;How to become a professor (in Engineering)? CV and cover letter for application.&lt;/p&gt;
    
    </summary>
    
      <category term="digest" scheme="http://smanist.github.io/categories/digest/"/>
    
    
      <category term="faculty" scheme="http://smanist.github.io/tags/faculty/"/>
    
      <category term="career" scheme="http://smanist.github.io/tags/career/"/>
    
  </entry>
  
  <entry>
    <title>Peking Duck</title>
    <link href="http://smanist.github.io/2018/10/14/Peking-duck/"/>
    <id>http://smanist.github.io/2018/10/14/Peking-duck/</id>
    <published>2018-10-14T18:30:00.000Z</published>
    <updated>2018-12-02T20:32:44.499Z</updated>
    
    <content type="html"><![CDATA[<p>An (on-going) experiment of Peking-style scrispy skin duck.</p><a id="more"></a><h1 id="the-recipe">The recipe</h1><p>This recipe is mainly based on <a href="https://www.youtube.com/watch?v=gqXjCFNX6HQ" target="_blank" rel="noopener">The Ultimate Guide to Making Crispy, Amber-Hued Peking Duck at Home</a>.</p><p>I have tried the recipe twice, once for a duck and the other time for a chicken.</p><h2 id="ingredients">Ingredients</h2><ol style="list-style-type: decimal"><li>Lean duck</li><li>Chinese five-spice powder (or <a href="https://www.geniuskitchen.com/recipe/five-spice-powder-66216" target="_blank" rel="noopener">DIY</a>)</li><li>Salt</li><li>Soy sauce</li><li>Maltose syrup</li><li>Applewood (optional)</li></ol><h2 id="steps">Steps</h2><h3 id="day-1">Day 1</h3><ol style="list-style-type: decimal"><li>Clean the duck.</li><li>Coat the inside of the duck with five-spice powder (f.s.) and seal the body with a stick.</li><li>Separate the skin and the flesh of the duck.</li><li>Add salt, f.s., and soy sauce to water and boil for 5 min.</li><li>Poach the outside of the duck using the boiled water.</li><li>Mix soysauce with maltose syrup and coat the duck.</li><li>Now the duck has to be dried for a few days. It has to be somehow lift in the air, so that the extra sauce can drip down.</li></ol><h3 id="day-x">Day X</h3><ol style="list-style-type: decimal"><li>Smoke the duck inside a sealed container using the applewood for 30 min. I skipped this step as I could not find applewood.</li><li>Roast the duck by the following steps: (1) Roast for 30 min at 350F and hang for 5 min to remove fat; (2) Roast again for 30 min until the core temperature reaches 130F.</li><li>Bath the duck with hot oil at 390F until it is golden.</li></ol><h2 id="notes">Notes</h2><ol style="list-style-type: decimal"><li>In the video guide, a pump was used to blow the duck, which was very efficient. However, it is possible to manually separate the skin and the flesh - just be careful.</li><li>Make sure the wings and legs do not touch the body during the drying process.</li><li>In my experiment, the drying process was only one day. As a result, the skin of the final product was not so crispy.</li><li>The roast process depends on how fat the duck is. In the experiment, the duck was quite fat. As a result, the duck was hung at a higher frequency to remove the extra fat and oil.</li><li>To disassemble the duck, consider first remove the drum stick, then peel the skin off on the back, then cut through the legs, and finally cut out the breast.</li><li>The purpose of the maltose syrup is to provide a thick sauce base that can be applied onto the duck without dripping down too quickly. Moreover, the sugar in the syrup contributes significantly to the smell in the final product. When maltose syrup is not available, one can try to concentrate off-the-shelf pancake syrup: Boil the syrup for a few seconds and let it cool down slowly. Do not boil for too long time, otherwise the syrup would solidify.</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;An (on-going) experiment of Peking-style scrispy skin duck.&lt;/p&gt;
    
    </summary>
    
      <category term="pieces" scheme="http://smanist.github.io/categories/pieces/"/>
    
    
      <category term="life" scheme="http://smanist.github.io/tags/life/"/>
    
      <category term="food" scheme="http://smanist.github.io/tags/food/"/>
    
  </entry>
  
  <entry>
    <title>Karaage</title>
    <link href="http://smanist.github.io/2018/10/14/Karaage/"/>
    <id>http://smanist.github.io/2018/10/14/Karaage/</id>
    <published>2018-10-14T17:10:00.000Z</published>
    <updated>2018-11-19T18:00:03.146Z</updated>
    
    <content type="html"><![CDATA[<p>An (on-going?) experiment of Japanese-style fried chicken.</p><a id="more"></a><h1 id="the-recipe">The recipe</h1><h2 id="ingredients">Ingredients</h2><ol style="list-style-type: decimal"><li>Chiken thigh (boneless): 2 lb</li><li>Ginger: half of palm</li><li>Garlic clove: 6</li><li>Salt: Dependents on mood</li><li>Pepper: Dependents on mood</li><li>Shichimi togarashi (optional): 1 bottle/18 g</li><li>Soy sauce: Dependents on mood</li><li>Cooking rice wine: Dependents on mood</li><li>Egg: 4</li><li>Starch: depends on working condition</li><li>Flour: depends on working condition</li><li>Oil: depends on working condition</li></ol><h2 id="steps">Steps</h2><ol style="list-style-type: decimal"><li>Cut the chiken thigh to bite size.</li><li>Make the marinade sauce: Grind the garlic clove and ginger, and mix with salt, pepper, soy sauce, cooking rice wine. I also added shichimi togarashi (s.t.).</li><li>Marinate chicken in the sauce for 5 min.</li><li>Meanwhile, whisk the eggs.</li><li>Meanwhile, prepare the mixture of starch and flour with a ratio of 1:1.</li><li>Remove the marinade sauce on the chicken dice.</li><li>Roll the chicken dice in the powder mixture after dipping in the whisked egg.</li><li>Fry by repeating the following for 2-3 times: (1) Fry for 90 sec in 160-180C oil; (2) Stand for 60 sec while draining oil; (3) Break the crispy surface and fry again. At the last time, fry for 30 sec in 200C oil.</li></ol><h2 id="notes">Notes:</h2><ol style="list-style-type: decimal"><li>Do not fry too many chicken dices in one batch, so as to avoid the sudden drop in oil temperature.</li><li>The time for frying depends on the size of chicken. In practice, what I did was to (1) fry one batch until the surface of the chicken dice just turns light yellow over a time period of 60-90 sec; (2) let the batch stand for some time until another batch is finished; (3) fry the first batch again until the color is deeper or becomes golden.</li><li>The key is to control the oil temperature. Do not let the surface color change too quickly - that means the temperature is too high.</li><li>Remove solid wastes in the oil between batches.</li></ol><h1 id="references">References:</h1><ol style="list-style-type: decimal"><li><a href="https://norecipes.com/karaage-recipe/" target="_blank" rel="noopener">Recipe 1</a></li><li><a href="https://www.japanesecooking101.com/karaage-recipe/" target="_blank" rel="noopener">Recipe 2</a></li><li><a href="https://www.crunchyroll.com/todays-menu-for-the-emiya-family/episode-10-fried-chicken-yummy-even-when-its-cold-776019" target="_blank" rel="noopener">Recipe 3</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;An (on-going?) experiment of Japanese-style fried chicken.&lt;/p&gt;
    
    </summary>
    
      <category term="pieces" scheme="http://smanist.github.io/categories/pieces/"/>
    
    
      <category term="life" scheme="http://smanist.github.io/tags/life/"/>
    
      <category term="food" scheme="http://smanist.github.io/tags/food/"/>
    
  </entry>
  
  <entry>
    <title>Multi-Objective Optimization</title>
    <link href="http://smanist.github.io/2018/08/30/Multi-objective-optimization/"/>
    <id>http://smanist.github.io/2018/08/30/Multi-objective-optimization/</id>
    <published>2018-08-31T01:00:00.000Z</published>
    <updated>2018-09-03T20:38:48.995Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css"><p>An incomplete review.</p><a id="more"></a><h1 id="introduction">Introduction</h1><p>In a <a href="https://smanist.github.io/2018/06/12/Bayesian-optimization/">previous article</a>, we discussed Bayesian optimization for single objective problems. This article will discuss the multi-objective optimization (MO) and provide a partial review of the classical and the Bayesian MO algorithms.</p><h1 id="defining-a-multi-objective-optimization">Defining a multi-objective optimization</h1><p>Some of the mathematical contents follow this lecture <a href="https://cims.nyu.edu/~gn387/glp/lec1.pdf" target="_blank" rel="noopener">note</a>.</p><p>Formally, an MO is written as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mrow><msub><mo><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi><mspace width="0.16667em"></mspace><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></msub></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>=</mo><mo>[</mo><msub><mi>f</mi><mn>1</mn></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo separator="true">,</mo><mo>&#x22EF;</mo><mo separator="true">,</mo><msub><mi>f</mi><mi>n</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">.</mi></mrow></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>E</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>=</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>I</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>&#x2265;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>l</mi><mi>b</mi></mrow></msub><mo>&#x2264;</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2264;</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>u</mi><mi>b</mi></mrow></msub></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}    {\mathop{\mathrm{arg\,min}}\limits_{\mathbf{x}}} &amp;\quad {\mathbf{f}}({\mathbf{x}})=[f_1({\mathbf{x}}),\cdots,f_n({\mathbf{x}})] \\    {\mathrm{s.t.}}&amp;\quad {\mathbf{c}}_E({\mathbf{x}}) = 0 \\                 &amp;\quad {\mathbf{c}}_I({\mathbf{x}}) \ge 0 \\                 &amp;\quad {\mathbf{x}}_{lb} \le {\mathbf{x}}\le {\mathbf{x}}_{ub}\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.9172200000000004em;"></span><span class="strut bottom" style="height:5.334440000000001em;vertical-align:-2.41722em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-2.0772200000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mop op-limits"><span class="vlist"><span style="top:0.79444em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span style="top:5.551115123125783e-17em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm"><span class="mspace thinspace"></span><span class="mord mathrm">m</span></span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.3427800000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">s</span><span class="mord mathrm">.</span><span class="mord mathrm">t</span><span class="mord mathrm">.</span></span></span></span></span><span style="top:0.8572199999999996em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span style="top:2.05722em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-2.0772200000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mopen">[</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="minner">&#x22EF;</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span><span style="top:-0.3427800000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span><span style="top:0.8572199999999996em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mrel">&#x2265;</span><span class="mord mathrm">0</span></span></span><span style="top:2.05722em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.01968em;">l</span><span class="mord mathit mtight">b</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2264;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mrel">&#x2264;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mord mathit mtight">b</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> or simply writing the constraints as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2208;</mo><mrow><mrow><mi mathvariant="script">X</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{x}}\in{\mathcal{X}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mrel">&#x2208;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">X</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{X}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span></span></span></span> is the feasible design space.</p><p>Assume that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>f</mi><mi>i</mi><mo>&#x2217;</mo></msubsup></mrow><annotation encoding="application/x-tex">f_i^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.9414399999999999em;vertical-align:-0.247em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-left:-0.10764em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is the minimum attainable value of the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>th objective in the feasible design space, i.e. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>f</mi><mi>i</mi><mo>&#x2217;</mo></msubsup></mrow><annotation encoding="application/x-tex">f_i^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.9414399999999999em;vertical-align:-0.247em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-left:-0.10764em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is the solution to the single-objective optimization (SO) consisting of the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>th objective and all the constraints of the MO. The collection of all these solutions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>=</mo><mo>[</mo><msubsup><mi>f</mi><mn>1</mn><mo>&#x2217;</mo></msubsup><mo separator="true">,</mo><mo>&#x22EF;</mo><mo separator="true">,</mo><msubsup><mi>f</mi><mi>n</mi><mo>&#x2217;</mo></msubsup><mo>]</mo></mrow><annotation encoding="application/x-tex">{\mathbf{f}}^*=[f_1^*,\cdots,f_n^*]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mopen">[</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-left:-0.10764em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="minner">&#x22EF;</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-left:-0.10764em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">]</span></span></span></span> is defined as the ideal objective vector. In a typical MO problem, such a point is not attainable. That means no single solution exists that simultaneously optimizes each objective &#x2013; this is the fundamental problem in MO.</p><p>When <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">{\mathbf{f}}^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is unattainable, the objective functions are said to be conflicting and there exists a (possibly infinite) number of Pareto optimal solutions. A solution is called Pareto optimal if none of the objectives can be decreased without increasing some of the other objectives. Two Pareto optimal solutions are mutually nondominated. That means there exists some objectives in one solution that are smaller than those in the other solution.</p><p>The dominance is more precisely defined via the partial ordering, or the dominance relation between the design vectors <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{x}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span></span>. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{x}}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> dominates <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{x}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, denoted <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub><mo>&#x2AAF;</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{x}}_1\preceq{\mathbf{x}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.63597em;"></span><span class="strut bottom" style="height:0.7859700000000001em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2AAF;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, if (1) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub><mo>)</mo><mo>&#x2264;</mo><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">f_i({\mathbf{x}}_1)\leq f_i({\mathbf{x}}_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mrel">&#x2264;</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x22EF;</mo><mo separator="true">,</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">i=1,\cdots,n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="minner">&#x22EF;</span><span class="mpunct">,</span><span class="mord mathit">n</span></span></span></span> and (2) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2203;</mi><mi>j</mi><mo>&#x2208;</mo><mo>{</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x22EF;</mo><mo separator="true">,</mo><mi>n</mi><mo>}</mo></mrow><annotation encoding="application/x-tex">\exists j\in \{ 1,\cdots,n\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x2203;</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mrel">&#x2208;</span><span class="mopen">{</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="minner">&#x22EF;</span><span class="mpunct">,</span><span class="mord mathit">n</span><span class="mclose">}</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>f</mi><mi>j</mi></msub><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub><mo>)</mo><mo>&lt;</mo><msub><mi>f</mi><mi>j</mi></msub><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">f_j({\mathbf{x}}_1)&lt; f_j({\mathbf{x}}_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mrel">&lt;</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span>. The corresponding objective vectors are denoted <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mn>1</mn></msub><mo>&#x2AAF;</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_1\preceq{\mathbf{f}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2AAF;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. The dominance is strict, denoted <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub><mo>&#x227A;</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{x}}_1\prec{\mathbf{x}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5391em;"></span><span class="strut bottom" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x227A;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mn>1</mn></msub><mo>&#x227A;</mo><msub><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{f}}_1\prec{\mathbf{f}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x227A;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, if (2) is true for all <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span>&#x2019;s.</p><p>Using the dominance relation, a solution <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{x}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span></span></span></span> is (1) globally Pareto optimal if <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2AAF;</mo><msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow><annotation encoding="application/x-tex">{\mathbf{x}}\preceq{\mathbf{x}}&apos;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.887862em;vertical-align:-0.13597em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mrel">&#x2AAF;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2200;</mi><msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>&#x2208;</mo><mrow><mrow><mi mathvariant="script">X</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">\forall{\mathbf{x}}&apos;\in{\mathcal{X}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.790992em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x2200;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2208;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span></span></span></span>, (2) locally Pareto optimal if <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2203;</mi><mi>&#x3F5;</mi></mrow><annotation encoding="application/x-tex">\exists\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x2203;</span><span class="mord mathit">&#x3F5;</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2AAF;</mo><msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow><annotation encoding="application/x-tex">{\mathbf{x}}\preceq{\mathbf{x}}&apos;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.887862em;vertical-align:-0.13597em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mrel">&#x2AAF;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2200;</mi><msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo separator="true">,</mo><mo>&#x2225;</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2212;</mo><msup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>&#x2225;</mo><mo>&lt;</mo><mi>&#x3F5;</mi></mrow><annotation encoding="application/x-tex">\forall{\mathbf{x}}&apos;,\lVert{\mathbf{x}}-{\mathbf{x}}&apos;\rVert&lt;\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x2200;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mopen">&#x2225;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">&#x2225;</span><span class="mrel">&lt;</span><span class="mord mathit">&#x3F5;</span></span></span></span>. All globally (locally) Pareto optimal solutions form the global (local) <em>Pareto set</em> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="script">X</mi></mrow></mrow><mi>p</mi></msup></mrow><annotation encoding="application/x-tex">{\mathcal{X}}^p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and its image in the objective space is the global (local) <em>Pareto front</em> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span>.</p><p>The ideal objective vector <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">{\mathbf{f}}^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is more formally defined by setting its <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>th entry to be <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2217;</mo></msup><msub><mo>]</mo><mi>i</mi></msub><mo>=</mo><msub><mi>inf</mi><mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2208;</mo><msup><mrow><mrow><mi mathvariant="script">X</mi></mrow></mrow><mi>p</mi></msup></mrow></msub><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo separator="true">,</mo><mspace width="1em"></mspace><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x22EF;</mo><mo separator="true">,</mo><mi>n</mi></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle [{\mathbf{f}}^*]_i = \inf_{ {\mathbf{x}}\in{\mathcal{X}}^p } f_i({\mathbf{x}}),\quad i=1,\cdots,n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.521701em;vertical-align:-0.771701em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-limits reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:0.644331em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span><span class="mrel mtight">&#x2208;</span><span class="mord mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathcal mtight" style="margin-right:0.14643em;">X</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:2.7755575615628914e-17em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop">in<span style="margin-right:0.07778em;">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathit">i</span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">1</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="minner reset-textstyle displaystyle textstyle uncramped">&#x22EF;</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">n</span></span></span></span></span> Similarly, the nadir objective vector <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">{\mathbf{f}}^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is defined by setting its <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>th entry to be <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>n</mi></msup><msub><mo>]</mo><mi>i</mi></msub><mo>=</mo><msub><mi>sup</mi><mrow><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2208;</mo><msup><mrow><mrow><mi mathvariant="script">X</mi></mrow></mrow><mi>p</mi></msup></mrow></msub><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo separator="true">,</mo><mspace width="1em"></mspace><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x22EF;</mo><mo separator="true">,</mo><mi>n</mi></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle [{\mathbf{f}}^n]_i = \sup_{ {\mathbf{x}}\in{\mathcal{X}}^p } f_i({\mathbf{x}}),\quad i=1,\cdots,n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.716141em;vertical-align:-0.966141em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-limits reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:0.838771em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span><span class="mrel mtight">&#x2208;</span><span class="mord mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathcal mtight" style="margin-right:0.14643em;">X</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:8.326672684688674e-17em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop">sup</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathit">i</span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">1</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="minner reset-textstyle displaystyle textstyle uncramped">&#x22EF;</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">n</span></span></span></span></span> The ideal and nadir objective vectors define the lower and upper bounds of the Pareto front and thus can be used for normalization. The <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>th entry of the normalized objective vector is <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mo>[</mo><msup><mover accent="true"><mrow><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow></mrow><mo>&#xAF;</mo></mover><mi>p</mi></msup><msub><mo>]</mo><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>p</mi></msup><msub><mo>]</mo><mi>i</mi></msub><mo>&#x2212;</mo><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2217;</mo></msup><msub><mo>]</mo><mi>i</mi></msub></mrow><mrow><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>n</mi></msup><msub><mo>]</mo><mi>i</mi></msub><mo>&#x2212;</mo><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2217;</mo></msup><msub><mo>]</mo><mi>i</mi></msub></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle [\bar{ {\mathbf{f}}}^p]_i = \frac{ [{\mathbf{f}}^p]_i-[{\mathbf{f}}^*]_i }{ [{\mathbf{f}}^n]_i-[{\mathbf{f}}^*]_i }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.427em;"></span><span class="strut bottom" style="height:2.363em;vertical-align:-0.936em;"></span><span class="base displaystyle textstyle uncramped"><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord displaystyle textstyle cramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span><span style="top:-0.26343999999999995em;margin-left:0.33334em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mopen">[</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mopen">[</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mopen">[</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mopen">[</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> The utopian objective vector is defined as <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>u</mi></msup><mo>=</mo><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{f}}^u={\mathbf{f}}^*-{\mathbf{e}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">e</span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>[</mo><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><msub><mo>]</mo><mi>i</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">[{\mathbf{e}}]_i&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">[</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&gt;</span><span class="mord mathrm">0</span></span></span></span> for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x22EF;</mo><mo separator="true">,</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">i=1,\cdots,n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="minner">&#x22EF;</span><span class="mpunct">,</span><span class="mord mathit">n</span></span></span></span>, which is useful in some MO algorithms. This vector is too good to attain and hence utopian.</p><p>Finally, the individual minimum (IM) objective vectors <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>k</mi><mrow><mi>i</mi><mi>m</mi></mrow></msubsup><msubsup><mo>}</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup></mrow><annotation encoding="application/x-tex">\{ {\mathbf{f}}_k^{im} \}_{k=1}^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.824664em;"></span><span class="strut bottom" style="height:1.1077719999999998em;vertical-align:-0.2831079999999999em;"></span><span class="base textstyle uncramped"><span class="mopen">{</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are introduced to further characterize the Pareto front. Geometrically, they are the &#x201C;corners&#x201D; of a Pareto front, which attains the minimum value of at least one of the objectives. The <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span>th <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mrow><mi>i</mi><mi>m</mi></mrow></msup></mrow><annotation encoding="application/x-tex">{\mathbf{f}}^{im}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.824664em;"></span><span class="strut bottom" style="height:0.824664em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is defined as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>k</mi><mrow><mi>i</mi><mi>m</mi></mrow></msubsup><mo>&#x2208;</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo separator="true">,</mo><mspace width="1em"></mspace><mo>[</mo><msubsup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mi>k</mi><mrow><mi>i</mi><mi>m</mi></mrow></msubsup><msub><mo>]</mo><mi>k</mi></msub><mo>=</mo><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2217;</mo></msup><msub><mo>]</mo><mi>k</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {\mathbf{f}}_k^{im}\in{\mathcal{F}},\quad [{\mathbf{f}}_k^{im}]_k = [{\mathbf{f}}^*]_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8746639999999999em;"></span><span class="strut bottom" style="height:1.1246639999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2208;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mopen reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mopen">[</span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathit mtight">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> The IM objective vectors form the convex hull of individual minima (<em>CHIM</em>), which are used in some of the MO algorithms. In the 2-objective case, CHIM is a segment connecting the two IM objective vectors.</p><h1 id="classical-mo-algorithms">Classical MO algorithms</h1><p>Some of the discussion follows this lecture <a href="https://cims.nyu.edu/~gn387/glp/lec2.pdf" target="_blank" rel="noopener">note</a>.</p><p>Generating a point on the Pareto front typically requires solving an optimization problem and generating a set of Pareto points can be computationally expensive. Therefore, a common question to ask before solving an MO is: Is it necessary to solve the problem as an MO? If sufficient preference information on the objectives about the problem is available, the MO could be taken care of using <em>one</em> single-objective optimization (SO). This is the so-called <em>a priori</em> approach. The advantage is that the optimization only needs to be carried out once, but the disadvantages is that one needs to specify proper preferences over the objectives. The other type of method is the <em>a posteriori</em> approach, which works in a reversed manner. A representative set of Pareto front is generated first, typically via multiple runs of optimization, and the final design is identified within the solution sets. This approach is useful for problems having objectives with limited user knownledge.</p><p>Besides the a priori and a posteriori approaches, there are also non-preference and interactive methods. However, these will not be discussed in this article.</p><h2 id="a-priori-approach">A priori approach</h2><p>The a priori approach is closely related to the idea of <em>scalarization</em>, i.e.&#xA0;the aggregation of multiple objectives. Essentially, a utility function is required to quantify the preference over different solutions. A utility function satisfies (1) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub><mo>)</mo><mo>&lt;</mo><mi>u</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">u({\mathbf{x}}_1)&lt;u({\mathbf{x}}_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">u</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mrel">&lt;</span><span class="mord mathit">u</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> if <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub><mo>&#x227A;</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{x}}_1\prec{\mathbf{x}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.5391em;"></span><span class="strut bottom" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x227A;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and (2) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub><mo>)</mo><mo>=</mo><mi>u</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">u({\mathbf{x}}_1)=u({\mathbf{x}}_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">u</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">u</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> if <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub><mo>&#x2280;</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{x}}_1\nprec{\mathbf{x}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.70576em;"></span><span class="strut bottom" style="height:0.9115200000000001em;vertical-align:-0.20576em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel amsrm">&#x2280;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>2</mn></msub><mo>&#x2280;</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{x}}_2\nprec{\mathbf{x}}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.70576em;"></span><span class="strut bottom" style="height:0.9115200000000001em;vertical-align:-0.20576em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel amsrm">&#x2280;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>.</p><p>Two typical scalarization approaches are the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3F5;</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3F5;</span></span></span></span>-constraint method and the weighted metric method.</p><h3 id="&#x3B5;-constraint">&#x3B5;-constraint</h3><p>The <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3F5;</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3F5;</span></span></span></span>-constraint method is an effective approach for converting an MO into only one SO, if sufficient information is known about the optimization problem. Specifically, the idea is to optimize only one objective while making sure other objectives are not too large, i.e.&#xA0;below certain user-specified upper bounds. The utility function is simply <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>u</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>=</mo><msub><mi>f</mi><mi>j</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">u({\mathbf{x}})=f_j({\mathbf{x}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord mathit">u</span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi><mo>&#x2208;</mo><mo>{</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x22EF;</mo><mo separator="true">,</mo><mi>n</mi><mo>}</mo></mrow><annotation encoding="application/x-tex">j\in\{ 1,\cdots,n \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mrel">&#x2208;</span><span class="mopen">{</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="minner">&#x22EF;</span><span class="mpunct">,</span><span class="mord mathit">n</span><span class="mclose">}</span></span></span></span>. The method works by adding extra constraints to the SO, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mrow><msub><mo><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi><mspace width="0.16667em"></mspace><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></msub></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mi>u</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">.</mi></mrow></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2208;</mo><mrow><mrow><mi mathvariant="script">X</mi></mrow></mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><msub><mi>f</mi><mi>i</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>&#x2264;</mo><msub><mi>&#x3F5;</mi><mi>i</mi></msub><mo separator="true">,</mo><mspace width="1em"></mspace><mi>i</mi><mo>&#x2260;</mo><mi>j</mi><mo separator="true">,</mo><mi>i</mi><mo>&#x2208;</mo><mo>{</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x22EF;</mo><mo separator="true">,</mo><mi>n</mi><mo>}</mo></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}    {\mathop{\mathrm{arg\,min}}\limits_{\mathbf{x}}} &amp;\quad u({\mathbf{x}}) \\    {\mathrm{s.t.}}&amp;\quad {\mathbf{x}}\in{\mathcal{X}}\\                 &amp;\quad f_i({\mathbf{x}})\leq \epsilon_i,\quad i\neq j,i\in\{ 1,\cdots,n \}\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.3172200000000003em;"></span><span class="strut bottom" style="height:4.134440000000001em;vertical-align:-1.8172200000000003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.4772200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mop op-limits"><span class="vlist"><span style="top:0.79444em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span style="top:5.551115123125783e-17em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm"><span class="mspace thinspace"></span><span class="mord mathrm">m</span></span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.25722000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">s</span><span class="mord mathrm">.</span><span class="mord mathrm">t</span><span class="mord mathrm">.</span></span></span></span></span><span style="top:1.4572200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.4772200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit">u</span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span></span></span><span style="top:0.25722000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mrel">&#x2208;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span></span></span><span style="top:1.4572200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mrel">&#x2264;</span><span class="mord"><span class="mord mathit">&#x3F5;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit">i</span></span><span class="mrel">&#x2260;</span><span class="mord mathit" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mrel">&#x2208;</span><span class="mopen">{</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="minner">&#x22EF;</span><span class="mpunct">,</span><span class="mord mathit">n</span><span class="mclose">}</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> If the ranges of the objectives are known a priori, it is possible to obtain the complete Pareto front by excuting above procedure repeatedly with each run using a different set of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3F5;</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3F5;</span></span></span></span>&#x2019;s.</p><h3 id="weighted-metric">Weighted metric</h3><p>The weighted metric (WM) of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{f}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span></span> is defined as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>u</mi><mi>p</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>)</mo><mo>=</mo><msup><mrow><mo fence="true">(</mo><msubsup><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>w</mi><mi>i</mi></msub><mi mathvariant="normal">&#x2223;</mi><msub><mi>f</mi><mi>i</mi></msub><mo>&#x2212;</mo><msubsup><mi>f</mi><mi>i</mi><mrow><mi>r</mi><mi>e</mi><mi>f</mi></mrow></msubsup><msup><mi mathvariant="normal">&#x2223;</mi><mi>p</mi></msup><mo fence="true">)</mo></mrow><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mi>p</mi></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle u_p({\mathbf{f}}) = \left(\sum_{i=1}^n w_i|f_i-f_i^{ref}|^p\right)^{1/p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.8889999999999998em;"></span><span class="strut bottom" style="height:3.1666689999999997em;vertical-align:-1.277669em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner reset-textstyle displaystyle textstyle uncramped"><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.276864em;margin-left:-0.10764em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.4809079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathrm">&#x2223;</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">p</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-1.3639999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span><span class="mord mathrm mtight">/</span><span class="mord mathit mtight">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>&#x2208;</mo><mo>[</mo><mn>1</mn><mo separator="true">,</mo><mi mathvariant="normal">&#x221E;</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">p\in [1,\infty]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mrel">&#x2208;</span><span class="mopen">[</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">&#x221E;</span><span class="mclose">]</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">w_i&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&gt;</span><span class="mord mathrm">0</span></span></span></span> and typically <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_{i=1}^n w_i=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.0500099999999999em;vertical-align:-0.30001em;"></span><span class="base textstyle uncramped"><span class="mop"><span class="mop op-symbol small-op" style="top:-0.0000050000000000050004em;">&#x2211;</span><span class="msupsub"><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span>, and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mrow><mi>r</mi><mi>e</mi><mi>f</mi></mrow></msup></mrow><annotation encoding="application/x-tex">{\mathbf{f}}^{ref}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:0.849108em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is a reference point.</p><p>The figure illustrates two special cases. The first one is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span> (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi><msub><mi>M</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">WM_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10903em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> in the figure), in which case the method is equivalent to the weighted sum method. This approach guarantees to find the complete Pareto front if it is convex. However, such is not guaranteed for non-convex case. Moreover, a uniform distribtuion of weights typically does not result in a uniformly distributed Pareto set. The second case is <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>=</mo><mi mathvariant="normal">&#x221E;</mi></mrow><annotation encoding="application/x-tex">p=\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mrel">=</span><span class="mord mathrm">&#x221E;</span></span></span></span> (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi><msub><mi>M</mi><mi mathvariant="normal">&#x221E;</mi></msub></mrow><annotation encoding="application/x-tex">WM_\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10903em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">&#x221E;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> in the figure), where the method becomes the Tchebycheff metric. This approach guarantees to find the complete Pareto front no matter whether it is convex or not. However, the reference point has to satisfy <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mrow><mi>r</mi><mi>e</mi><mi>f</mi></mrow></msup><mo>&#x2AAF;</mo><msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">{\mathbf{f}}^{ref}\preceq{\mathbf{f}}^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:0.985078em;vertical-align:-0.13597em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2AAF;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>.</p><p>An extension of WM is the rotated WM, which will not be discussed in detail here.</p><figure float="left"><img src="pareto.png" width="700px"><figcaption>Illustration of the concepts associated with Pareto front and several MO algorithms.</figcaption></figure><h2 id="a-posteriori-approach">A posteriori approach</h2><p>The a posteriori approach is usually iterative and roughly fall into two categories. One is based on special formulations of mathematical programming, and can be considered an iterative a priori method that generates a Pareto point per iteration. The other, which is typically based on evolutionary algorithms (EAs), improves a set of (potential) Pareto points simultaneously per iteration.</p><h3 id="using-mathematical-programming">Using mathematical programming</h3><h4 id="two-objectives">Two objectives</h4><p>The two-objective problem has been studied extensively and is simpler than problems of more objectives. Two classical approaches are Normal Boundary Intersection (NBI) <a href="https://doi.org/10.1137/S1052623496307510" target="_blank" rel="noopener">Das1998</a> and (Normalized) Normal Constraint (NC) <a href="https://doi.org/10.1007/s00158-002-0276-1" target="_blank" rel="noopener">Messac2003</a>, as illustrated in the above figure. The NBI and NC can be considered the generalization of EC: Essentially, these methods convert the MO into an SO by introducing extra constraints and redefining the objective, so that the solution to the SO produces a point on the Pareto front. The extra constraints depends on a base point (or an anchor point) <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">b</span></span></span></span></span></span> on the CHIM, or the utopia line in two-objective case. A discrete approximation of the Pareto front is constructed by choosing various <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">b</span></span></span></span></span></span> along the utopia line and solving the resulting SO&#x2019;s. As the reader might have noted, these approaches require the knowledge of the IM&#x2019;s, which has to be solved before the application of the MO algorithms.</p><p>In the NBI formulation, the objective vector is constrained to be on a line defined by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">b</span></span></span></span></span></span> and a direction vector <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">n</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{n}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">n</span></span></span></span></span></span> that is normal to the utopia line. The MO is converted to an SO for finding the intersection between the Pareto front and the line constraint, and hence the name NBI. <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mrow><msub><mo><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi><mspace width="0.16667em"></mspace><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></msub></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mi>t</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">.</mi></mrow></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2208;</mo><mrow><mrow><mi mathvariant="script">X</mi></mrow></mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>=</mo><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>+</mo><mi>t</mi><mrow><mrow><mi mathvariant="bold">n</mi></mrow></mrow></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}    {\mathop{\mathrm{arg\,min}}\limits_{\mathbf{x}}} &amp;\quad t({\mathbf{x}}) \\    {\mathrm{s.t.}}&amp;\quad {\mathbf{x}}\in{\mathcal{X}}\\                 &amp;\quad {\mathbf{f}}={\mathbf{b}}+t{\mathbf{n}}\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.3172200000000003em;"></span><span class="strut bottom" style="height:4.134440000000001em;vertical-align:-1.8172200000000003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.4772200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mop op-limits"><span class="vlist"><span style="top:0.79444em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span style="top:5.551115123125783e-17em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm"><span class="mspace thinspace"></span><span class="mord mathrm">m</span></span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.25722000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">s</span><span class="mord mathrm">.</span><span class="mord mathrm">t</span><span class="mord mathrm">.</span></span></span></span></span><span style="top:1.4572200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.4772200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit">t</span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span></span></span><span style="top:0.25722000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mrel">&#x2208;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span></span></span><span style="top:1.4572200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="mbin">+</span><span class="mord mathit">t</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">n</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span></p><p>In the NC formulation, the objective is constrained to be on a half-plane defined by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{b}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">b</span></span></span></span></span></span> and a direction vector <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">t</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{t}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.63492em;"></span><span class="strut bottom" style="height:0.63492em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">t</span></span></span></span></span></span> aligned with the utopia line. The MO is converted to an SO for finding the minimum of one of the objectives (the second objective in the illustrated case) given the extra constraint. <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mrow><msub><mo><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi><mspace width="0.16667em"></mspace><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></msub></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><msub><mi>f</mi><mn>1</mn></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">.</mi></mrow></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>&#x2208;</mo><mrow><mrow><mi mathvariant="script">X</mi></mrow></mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mo>(</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">b</mi></mrow></mrow><mo>)</mo><mo>&#x22C5;</mo><mrow><mrow><mi mathvariant="bold">t</mi></mrow></mrow><mo>&#x2265;</mo><mn>0</mn></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}    {\mathop{\mathrm{arg\,min}}\limits_{\mathbf{x}}} &amp;\quad f_1({\mathbf{x}}) \\    {\mathrm{s.t.}}&amp;\quad {\mathbf{x}}\in{\mathcal{X}}\\                 &amp;\quad ({\mathbf{f}}-{\mathbf{b}})\cdot{\mathbf{t}}\geq 0\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.3172200000000003em;"></span><span class="strut bottom" style="height:4.134440000000001em;vertical-align:-1.8172200000000003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.4772200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mop op-limits"><span class="vlist"><span style="top:0.79444em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span><span style="top:5.551115123125783e-17em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm"><span class="mspace thinspace"></span><span class="mord mathrm">m</span></span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.25722000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">s</span><span class="mord mathrm">.</span><span class="mord mathrm">t</span><span class="mord mathrm">.</span></span></span></span></span><span style="top:1.4572200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.4772200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span></span></span><span style="top:0.25722000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mrel">&#x2208;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14643em;">X</span></span></span></span></span><span style="top:1.4572200000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mopen"><span class="mspace quad"></span><span class="mopen">(</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mbin">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">b</span></span></span><span class="mclose">)</span><span class="mbin">&#x22C5;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">t</span></span></span><span class="mrel">&#x2265;</span><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> In [Messac2003], a normalization step is applied before solving the SO, which slightly simplifies the normal constraint.</p><h4 id="three-or-more-objectives">Three or more objectives</h4><p>The ideas of NBI and NC are easily extended to the cases of more objectives, as have been done in [Das1998] and [Messac2003]. However, both methods may not be able to explore the complete Pareto front, resulting in some unobtainable regions. This is illustrated in the figure below: Assuming the objective space is a sphere centered at the origin, the Pareto front <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span> is an octant of the sphere (Green) and the CHIM is an equilateral triangle (Blue). However, the projection of the Pareto front on the CHIM plane, which is defined as CHIM+, is a region encompassed by three arcs (Red). That means, using a base point on the CHIM, one can only obtain solutions encompassed by the black dashed lines on the Pareto front.</p><p>As a remedy, <a href="https://doi.org/10.2514/1.8977" target="_blank" rel="noopener">Messac2004</a> proposed an improved NBI algorithm to explore the complete Pareto front by adding more base points outside the CHIM, i.e.&#xA0;on the CHIM+. Another approach, Directed Search Domain (DSD), is proposed in <a href="https://doi.org/10.1080/0305215X.2010.497185" target="_blank" rel="noopener">Erfani2011</a>. In DSD, the NBI constraint is replaced by cone constraints that is able to explore the complete Pareto front by expanding or rotating the cone. The Messac2004 and Erfani2011 algorithms are more like patches to the classical NBI and NC algorithms. These &#x201C;patched&#x201D; algorithms contain empirical parameters that have to be tuned and there is no guarantee of finding the complete Pareto front.</p><p>More systematic algorithms are proposed in <a href="https://doi.org/10.1137/080729013" target="_blank" rel="noopener">MG2009</a> as Successive Pareto Optimization (SPO) and in <a href="https://doi.org/10.1007/s00158-011-0729-5" target="_blank" rel="noopener">Motta2012</a> as Modified NBI and NC [Motta2012]. The two methods share a similar idea as recursive construction of the Pareto front. To solve an MO of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span> objectives, i.e.&#xA0;find the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span>-dimensional Pareto front <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span> problems of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>&#x2212;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span><span class="mbin">&#x2212;</span><span class="mord mathrm">1</span></span></span></span> objectives are solved to generate the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span> Pareto fronts <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">\partial{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span> of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo><mi>n</mi><mo>&#x2212;</mo><mn>1</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">(n-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathit">n</span><span class="mbin">&#x2212;</span><span class="mord mathrm">1</span><span class="mclose">)</span></span></span></span> dimensions, which are the boundaries of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span>. Subsequently, a set of base points are distributed uniformly between these boundaries, so as to cover the CHIM+ (almost) evenly and capture the <em>complete</em> Pareto front <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span>. Finally, at the recursion boundary, the SO&#x2019;s associated with the objectives are solved to determine the IM&#x2019;s.</p><p>Take a 3-objective problem for example, as shown in the figure below. First, the IM&#x2019;s are found. Next, the NBI procedure is applied to find <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mrow><mn>1</mn><mn>3</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\partial{\mathcal{F}}_{13}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span><span class="mord mathrm mtight">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> for the MO associated with objectives 1 and 3. Same procedures are done for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mrow><mn>1</mn><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\partial{\mathcal{F}}_{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mrow><mn>2</mn><mn>3</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\partial{\mathcal{F}}_{23}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span><span class="mord mathrm mtight">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. Finally, base points will be distributed over CHIM+, which is emcompassed by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mrow><mn>1</mn><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\partial{\mathcal{F}}_{12}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mrow><mn>1</mn><mn>3</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\partial{\mathcal{F}}_{13}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span><span class="mord mathrm mtight">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mrow><mn>2</mn><mn>3</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\partial{\mathcal{F}}_{23}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span><span class="mord mathrm mtight">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> <a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>, to identify the complete Pareto front by applying the NBI procedure again.</p><figure float="left"><img src="obj3.gif" width="700px"><figcaption>Illustration of Pareto front of three objectives.</figcaption></figure><h3 id="using-evolutionary-algorithm">Using evolutionary algorithm</h3><p>There are two out-standing EAs in this category, which are Non-dominated Sorting Genetic Algorithm-II (NSGA-II) in <a href="https://doi.org/10.1109/4235.996017" target="_blank" rel="noopener">Deb2002</a> and Strength Pareto Evolutionary Algorithm 2 (SPEA-2) in <a href="https://doi.org/10.3929/ethz-a-004284029" target="_blank" rel="noopener">Zitzler2001</a>. It appears they have become standard evolutionary algorithms for MO, against which new algorithms will be compared. However, I am not going to talk too much about EAs, which are not my favorite. Some introductory materials are found <a href="https://cims.nyu.edu/~gn387/glp/lec3.pdf" target="_blank" rel="noopener">here</a>. A comparison of evolutional algorithms for MO is found in, for example, <a href="https://doi.org/10.1162/106365600568202" target="_blank" rel="noopener">Zitzler2000</a> and <a href="https://doi.org/10.1162/EVCO_a_00009" target="_blank" rel="noopener">Bader2011</a>.</p><p>Nevertheless, one important thing to learn from the EAs is the construction of the fitness function of a Pareto solution - How much it is dominating others, or how much it is improving the Pareto front? This requires the proper definition of indicators describing the quality of the Pareto front. These indicators have a broader range of application in, for example, the assessment of convergence and the construction of acquisition functions in Bayesian MO algorithms. In <a href="https://doi.org/10.1109/TEVC.2003.810758" target="_blank" rel="noopener">Zitzler2003</a>, a number of criteria for the quality of the Pareto solution are gathered and compared. Three commonly used criteria include: The <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3F5;</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3F5;</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and hypervolume indicators.</p><p>The <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3F5;</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3F5;</span></span></span></span>-indicator characterizes the minimum separation between two Pareto solutions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{G}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span></span></span></span>. The additive form is, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>I</mi><mi>&#x3F5;</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo separator="true">,</mo><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow><mo>)</mo><mo>=</mo><msub><mi>inf</mi><mrow><mi>&#x3F5;</mi></mrow></msub><mo>{</mo><mi mathvariant="normal">&#x2200;</mi><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mo>&#x2208;</mo><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow><mi mathvariant="normal">&#x2203;</mi><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2208;</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo>:</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>+</mo><mi>&#x3F5;</mi><mo>&#x2AAF;</mo><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mo>}</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle I_\epsilon({\mathcal{F}}, {\mathcal{G}}) = \inf_{\epsilon}\{\forall{\mathbf{g}}\in{\mathcal{G}}\exists{\mathbf{f}}\in{\mathcal{F}}: {\mathbf{f}}+\epsilon\preceq {\mathbf{g}}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.45em;vertical-align:-0.7em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">&#x3F5;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-limits reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:0.6em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">&#x3F5;</span></span></span></span><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop">in<span style="margin-right:0.07778em;">f</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">{</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2200;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2208;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2203;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2208;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">:</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3F5;</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2AAF;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">}</span></span></span></span></span> The multiplicative form is defined in a similar manner.</p><p>The <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> indicator was initially developed in <a href="https://pdfs.semanticscholar.org/41e3/e93b35b4286a9d5310af0b898769e052ef93.pdf" target="_blank" rel="noopener">Hansen1998</a> for the case that the Pareto solutions are measured using a set of utility functions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">U</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{U}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">U</span></span></span></span></span></span>, e.g.&#xA0;the WM functions parameterized by the weight vectors <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">w</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{w}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">w</span></span></span></span></span></span>. The utility fuctions are assigned some weights, or &#x201C;probablities&#x201D; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>(</mo><mi>u</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">p(u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord mathit">u</span><span class="mclose">)</span></span></span></span>, representing the preference information. The indicator is defined as the weighted or expected improvement of the best value of utility functions, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>I</mi><mrow><msub><mi>R</mi><mn>2</mn></msub></mrow></msub><mo>(</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo separator="true">,</mo><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow><mo separator="true">;</mo><mrow><mrow><mi mathvariant="script">U</mi></mrow></mrow><mo>)</mo><mo>=</mo><msub><mo>&#x222B;</mo><mrow><mi>u</mi><mo>&#x2208;</mo><mrow><mrow><mi mathvariant="script">U</mi></mrow></mrow></mrow></msub><mo>[</mo><msup><mi>u</mi><mo>&#x2217;</mo></msup><mo>(</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo>)</mo><mo>&#x2212;</mo><msup><mi>u</mi><mo>&#x2217;</mo></msup><mo>(</mo><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow><mo>)</mo><mo>]</mo><mi>p</mi><mo>(</mo><mi>u</mi><mo>)</mo><mi>d</mi><mi>u</mi></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle I_{R_2}({\mathcal{F}}, {\mathcal{G}}; {\mathcal{U}}) = \int_{u\in{\mathcal{U}}}[u^*({\mathcal{F}})-u^*({\mathcal{G}})]p(u)du</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.36em;"></span><span class="strut bottom" style="height:2.29962em;vertical-align:-0.93962em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">U</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop reset-textstyle displaystyle textstyle uncramped"><span class="mop op-symbol large-op" style="margin-right:0.44445em;top:-0.0011249999999999316em;">&#x222B;</span><span class="msupsub"><span class="vlist"><span style="top:0.91225em;margin-right:0.05em;margin-left:-0.44445em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">u</span><span class="mrel mtight">&#x2208;</span><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathcal mtight" style="margin-right:0.09931em;">U</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">]</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">p</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">u</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">d</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">u</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>u</mi><mo>&#x2217;</mo></msup><mo>(</mo><mi mathvariant="normal">&#x25A1;</mi><mo>)</mo><mo>=</mo><mi>inf</mi><mo>{</mo><mi>u</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>)</mo><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>&#x2208;</mo><mi mathvariant="normal">&#x25A1;</mi><mo>}</mo></mrow><annotation encoding="application/x-tex">u^*(\Box)=\inf\{ u({\mathbf{f}}),{\mathbf{f}}\in\Box \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord mathrm">&#x25A1;</span><span class="mclose">)</span><span class="mrel">=</span><span class="mop">in<span style="margin-right:0.07778em;">f</span></span><span class="mopen">{</span><span class="mord mathit">u</span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mrel">&#x2208;</span><span class="mord mathrm">&#x25A1;</span><span class="mclose">}</span></span></span></span>. When there is only one utility function, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>I</mi><mrow><msub><mi>R</mi><mn>2</mn></msub></mrow></msub><mo>(</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo separator="true">,</mo><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow><mo>)</mo><mo>=</mo><msup><mi>u</mi><mo>&#x2217;</mo></msup><mo>(</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo>)</mo><mo>&#x2212;</mo><msup><mi>u</mi><mo>&#x2217;</mo></msup><mo>(</mo><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">I_{R_2}({\mathcal{F}},{\mathcal{G}})=u^*({\mathcal{F}})-u^*({\mathcal{G}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.00773em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mclose">)</span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span><span class="mclose">)</span></span></span></span>.</p><p>The (binary) hypervolume indicator is defined as the &#x201C;size&#x201D; of the margin between two Pareto solutions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{G}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span></span></span></span>, if one dominates the other. More formally, it is the measure <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x39B;</mi></mrow><annotation encoding="application/x-tex">\Lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x39B;</span></span></span></span> of the set containing points that are dominated by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span> but not by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{G}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span></span></span></span>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>I</mi><mi>H</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo separator="true">,</mo><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow><mo>)</mo><mo>=</mo><mi mathvariant="normal">&#x39B;</mi><mo>{</mo><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mo>&#x2AB0;</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo>&#x2227;</mo><mrow><mrow><mi mathvariant="bold">h</mi></mrow></mrow><mo>&#x2AAF;</mo><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow><mo>}</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle I_H({\mathcal{F}}, {\mathcal{G}}) = \Lambda\{ {\mathbf{h}}|{\mathbf{h}}\succeq{\mathcal{F}}\wedge {\mathbf{h}}\preceq{\mathcal{G}}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.08125em;">H</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x39B;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">{</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2AB0;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2227;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2AAF;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">}</span></span></span></span></span></p><p>As mentioned above, there are two typical applications of these binary indicators. The first one is for convergence check. One can set one input to be the true Pareto solution (for benchmark problems), or a set consisting of the Utopian point (for real problems). The second application is to construct a <em>unary</em> indicator as the utility function of a potential solution <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{f}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span></span> by setting <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo>=</mo><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow><mo>&#x222A;</mo><mo>{</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>}</mo></mrow><annotation encoding="application/x-tex">{\mathcal{F}}={\mathcal{G}}\cup\{ {\mathbf{f}}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span><span class="mbin">&#x222A;</span><span class="mopen">{</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mclose">}</span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">G</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{G}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.78055em;vertical-align:-0.09722em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.0593em;">G</span></span></span></span></span></span> is a reference Pareto solution.</p><h1 id="bayesian-mo-algorithms">Bayesian MO algorithms</h1><p>The algorithms to be discussed in this section are considered Bayesian because the optimization process generates the solution based on the observed samples of the objective functions, instead of the objective functions themselves as in classical methods. This bares the same idea as in the Bayesian SO algorithms. A surrogate has to be constructed using the observed samples as a replacement of the objective functions, or their utility function. During the optimization, the exploitation and exploration strategy has to be incorporated so as to account for the uncertainty of the surrogate model, as was done in Bayesian SO algorithms.</p><p>The Bayesian MO algorithms have deep roots in the classical methods. Depending on how classical methods are utilized, the algorithms are classified into the indirect and the direct methods.</p><h2 id="indirect-methods">Indirect methods</h2><p>In the indirect methods, no special acquisition functions are developed for MO. Instead, the MO is converted to an SO as was done in the classical methods, such as WS and SPO. In a sense, the utility function in a classical method is directly used as an acqusition function. The resulting SO is solved using a BO algorithm, which is usually referred to as inner optimization.</p><p>One such example is the ParEGO algorithm in <a href="https://doi.org/10.1109/TEVC.2005.851274" target="_blank" rel="noopener">Knowles2006</a>. This is probably the first important Bayesian MO algorithm. The utility function is developed using the augmented Tchebycheff function, which is a combination of the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>u</mi><mi mathvariant="normal">&#x221E;</mi></msub></mrow><annotation encoding="application/x-tex">u_\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">&#x221E;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>u</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">u_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">u</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> functions, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>u</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>)</mo><mo>=</mo><msub><mi>max</mi><mi>i</mi></msub><msub><mi>w</mi><mi>i</mi></msub><msub><mi>f</mi><mi>i</mi></msub><mo>+</mo><mi>&#x3C1;</mi><msubsup><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mi>w</mi><mi>i</mi></msub><msub><mi>f</mi><mi>i</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle u({\mathbf{f}}) = \max_i w_i f_i + \rho \sum_{i=1}^n w_i f_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.6513970000000002em;"></span><span class="strut bottom" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">u</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-limits reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:0.6276640000000001em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:1.3877787807814457e-16em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop">max</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3C1;</span><span class="mop op-limits reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3C1;</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3C1;</span></span></span></span> is a small positive value typically set to 0.05. In each run, a random weight vector is generated and a point on the Pareto front is found. A noteworthy disadvantage of ParEGO is that the uniformity of the Pareto solution is not guaranteed. Using a similar idea, the algorithms of EC, NBI, NC are easily combined with Bayesian SO algorithms.</p><p>A major disadvantage of the indirect method is that, in the inner optimization, the BO algorithm would cost multiple evaluations of the black-box objective functions only to find one point on the Pareto front. A more efficient approach would be the direct method, which produces one point on the Pareto front <em>per</em> evaluation.</p><h2 id="direct-methods">Direct methods</h2><p>In the direct methods, the BO algorithm is executed with special MO acquisition functions.</p><h3 id="two-historical-methods">Two historical methods</h3><p>One precursor in this category is <a href="https://doi.org/10.1109/CEC.2005.1554959" target="_blank" rel="noopener">Jeong2005</a>. The MO is carried out using an evolutionary algorithm, where the fitness is defined as the expected improvements (EI) of the single objectives.</p><p>Another MO acquisition function is developed in <a href="https://doi.org/10.2514/1.16875" target="_blank" rel="noopener">Keane2006</a>. It is the first paper extending EI and probablity of improvement (PoI) of SO to MO. The EI was defined as the product of the PoI and an Euclidean distance-based improvement function. However, the formulation is limited to the 2-objective case.</p><h3 id="two-modern-methods">Two modern methods</h3><p>Later, the concept of hypervolume is introduced into the development of MO acquisition functions. It is mainly developed into two families.</p><p>One family is the SMS-EGO method proposed in <a href="https://doi.org/10.1007/978-3-540-87700-4_78" target="_blank" rel="noopener">Ponweiser2008</a>. It is an extension of the classical acqusition function of lower confidence bound (LCB), i.e.&#xA0;the improvement of HV due to LCB. In addition, a penalty is added to points that do not improve the Pareto front and an additive epsilon-dominance term is added to points close to Pareto front to smooth the distribution of the acquisition function. It was shown to outperform ParEGO and standard EAs like NSGA-II and SPEA-2. This method is easy to implement and has been widely used.</p><p>The other family is based on the S-metric expected improvement (SExI). It is the hypervolume version of EI for MO, originally proposed in <a href="https://core.ac.uk/download/pdf/46906138.pdf" target="_blank" rel="noopener">Emmerich2005</a>, as an extension of the classical EI for SO. The formulation is straight-forward by replacing the improvement function with the unary hypervolume indocator, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>E</mi><mi>I</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>=</mo><mo>&#x222B;</mo><mi>I</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>)</mo><mi>p</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo separator="true">;</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mi>d</mi><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle EI({\mathbf{x}}) = \int I({\mathbf{f}})p({\mathbf{f}};{\mathbf{x}})d{\mathbf{f}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.36em;"></span><span class="strut bottom" style="height:2.22225em;vertical-align:-0.86225em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.05764em;">E</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.07847em;">I</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-symbol large-op reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.44445em;top:-0.0011249999999999316em;">&#x222B;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.07847em;">I</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">p</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">d</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>I</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>)</mo><mo>=</mo><msub><mi>I</mi><mi>H</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo>&#x222A;</mo><mo>{</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow><mo>}</mo><mo separator="true">,</mo><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">I({\mathbf{f}}) = I_H({\mathcal{F}}\cup\{ {\mathbf{f}}\}, {\mathcal{F}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07847em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.08125em;">H</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mbin">&#x222A;</span><span class="mopen">{</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span><span class="mclose">}</span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span><span class="mclose">)</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">F</span></span></span></span></span></span> is the Pareto front of the current iteration.</p><p>In [Emmerich2005], the algorithm was called SMS-EMOA (i.e.&#xA0;solved using an evolutionary algorithm) and the integration of hypervolume was carried out using Monte Carlo method. In a later paper, <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.216.2154&amp;rep=rep1&amp;type=pdf" target="_blank" rel="noopener">Emmerich2008</a>, an exact integration method is proposed for SExI. However, the computational complexity of the exact ingration method grows exponentially with the problem dimension and number of Pareto points.</p><p>The algorithm complexity of SExI definitely limits the spread of its application. There are even survey papers that skipped this algorithm in the numerical comparison section due to complexity in the implementation. Nevertheless, the SExI algorithm is improved in <a href="https://doi.org/10.1007/978-3-319-15892-15" target="_blank" rel="noopener">Hupkens2015</a>, which claimed to be the fastest algorithm for the 2D and 3D cases. For the general case, however, the fastest algorithm is proposed in <a href="https://doi.org/10.1007/s10898-013-0118-2" target="_blank" rel="noopener">Couckuyt2014</a>, which is based on the <a href="http://www.wfg.csse.uwa.edu.au/hypervolume/" target="_blank" rel="noopener">WFG algorithm</a>. In [Couckuyt2014], the new algorithm is also applied to the MO version of PoI, which is easier to implement than SExI and appears to be equally effective.</p><h3 id="comparison">Comparison</h3><p>The aforementioned algorithms have been systematically compared in the literature. In <a href="https://doi.org/10.1007/978-3-642-15844-5_72" target="_blank" rel="noopener">Wagner2010</a>, the algorithms from [Jeong2005], [Knowles2006], [Keane2006], [Ponweiser2008], and [Emmerich2008] are compared. Three necessary conditions are proposed to detect conceptual problems in the formulations while four desirable properties are identified. It is concluded that [Keane2006] is <em>problematic</em>. [Ponweiser2008] satisfies the essential conditions for acquisition function, but has disadvantages like non-smooth distribution of acquisition function. [Emmerich2008] has the most desirable properties, but is hard to implement.</p><p>In <a href="https://doi.org/10.1007/978-3-642-37140-0_56" target="_blank" rel="noopener">Zaefferer2013</a>, four algorithms are compared: [Keane2006], [Emmerich2008], [Ponweiser2008], and an evolutional algorithm MSPOT (<em>which I do not care</em>), with SMS-EMOA as the baseline. [Keane2006] was found to be worse than the baseline, which agrees with the discussion in [Wagner2010]. The rest outperformed the baseline, but there was no decisive difference.</p><h3 id="further-development">Further development</h3><p>More algorithms and enhancements are developed in the literature since the proposal of SMS-EGO.</p><h4 id="multi-point-proposal">Multi-point proposal</h4><p>With the advent of parallel computing, the idea of multi-point proposal was proposed, e.g.&#xA0;in <a href="https://doi.org/10.1109/TEVC.2009.2033671" target="_blank" rel="noopener">Zhang2009</a>. The idea is to find multiple candidate design vectors that improves the Pareto front and evaluate the black-box function at these new points simultaneously, exploiting the parallelism of the modern computers.</p><p>In <a href="https://doi.org/10.1007/978-3-319-15934-8_5" target="_blank" rel="noopener">Horn2015</a>, algorithms like [Jeong2005], [Knowles2006] and [Ponweiser2008] are compared and extended with multi-point proposal. The major finding was that, for some algorithms, the multi-point variants did not significantly deteriorate the results. They even improved the approximation quality in some cases. Moreover, the change from the EI to the LCB could improve the results of the internal optimization within ParEGO.</p><h4 id="informatics-based-approaches">Informatics-based approaches</h4><p>This family of approaches are more recent and more &#x201C;Bayesian&#x201D; in the sense that a stronger statistical flavor is involved. Typical examples are stepwise uncertainty reduction (SUR) <a href="https://doi.org/10.1007/s11222-014-9477-x" target="_blank" rel="noopener">Picheny2015</a> and Predictive Entropy Search (PES) <a href="https://dl.acm.org/citation.cfm?id=3045548" target="_blank" rel="noopener">Hern&#xE1;ndez-Lobato2016</a>. The idea is to pick a new point at each iteration to maximize the &#x201C;information gain&#x201D; to the current Pareto front. The information gain is typically measured using the Shannon entropy. These methods claim themselves to be &#x201C;intuitive, statistically consistent and efficient&#x201D;, as an alternative to the classical &#x201C;sensible heuristic&#x201D; approaches, such as the hypervolume EI. For academic problems, these methods do seem to be comparable to methods like SMS-EGO. However, the computational cost appears to be higher and the implementation seems to be more complex than all the methods discussed above.</p><h1 id="computer-implementations">Computer implementations</h1><p>I have not found many implementations for Bayesian MO algorithms. Two working libraries I found are <a href="https://github.com/GPflow/GPflowOpt" target="_blank" rel="noopener">GPflowOpt</a> and <a href="http://sumo.intec.ugent.be/SUMO" target="_blank" rel="noopener">SUMO</a>. There are some libraries for evolutionary MO algorithms, such as <a href="http://esa.github.io/pygmo/" target="_blank" rel="noopener">PyGMO</a> and <a href="https://github.com/Project-Platypus/Platypus" target="_blank" rel="noopener">Platypus</a>, but without surrogate capabilities. Probably these libraries can be incorporated into some BO framework for MO purposes.</p><p>Finally, for the evaluation of these libraries, there are a few standard test cases to play with:</p><ol style="list-style-type: decimal"><li>MOP: <a href="https://doi.org/10.1145/298151.298382" target="_blank" rel="noopener">VanVeldhuizen1999</a></li><li>ZDT: <a href="https://doi.org/10.1162/106365600568202" target="_blank" rel="noopener">Zitzler2000</a></li><li>DTLZ: <a href="https://doi.org/10.1007/1-84628-137-7_6" target="_blank" rel="noopener">Deb2005</a></li></ol><div class="footnotes"><hr><ol><li id="fn1"><p>A precise description is that the base points are distributed on a surface encompassed by the boundaries. The specific definition of this surface is algorithm-dependent. The projection of this surface on the CHIM plane is identical to the CHIM+. Therefore, the projection of the base points are also expected to cover the CHIM+ (almost) evenly.<a href="#fnref1">&#x21A9;</a></p></li></ol></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;An incomplete review.&lt;/p&gt;
    
    </summary>
    
      <category term="digest" scheme="http://smanist.github.io/categories/digest/"/>
    
    
      <category term="optimization" scheme="http://smanist.github.io/tags/optimization/"/>
    
      <category term="numerical" scheme="http://smanist.github.io/tags/numerical/"/>
    
      <category term="bayesian" scheme="http://smanist.github.io/tags/bayesian/"/>
    
      <category term="multi-objective" scheme="http://smanist.github.io/tags/multi-objective/"/>
    
  </entry>
  
  <entry>
    <title>Lewis Overthrust</title>
    <link href="http://smanist.github.io/2018/07/29/Lewis-Overthrust/"/>
    <id>http://smanist.github.io/2018/07/29/Lewis-Overthrust/</id>
    <published>2018-07-30T00:00:00.000Z</published>
    <updated>2018-07-30T23:16:42.587Z</updated>
    
    <content type="html"><![CDATA[<p>Where to play with huge snowpatches in summer?</p><a id="more"></a><p>-In mountains of high altitude and/or high latitude. Maybe high enough that even glaciers exist. The Glacier National Park (GNP) is one such place to go.</p><h1 id="introduction">Introduction</h1><p>The glaciers are indeed an essential ingredient of the spectacular scenes in GNP. Yet, the scenes could be given an extra layer of &#x201C;awesomeness&#x201D; if the long geological history were taken into account. In a sense, the GNP is the result of the interactions between the terrain, the glacier, the climate, the fauna and flora, etc. over billions of years. And the most fascinating part is probably how the stage was &#x201C;prepared&#x201D; for these interactions by tectonic processes.</p><p>This stage is the Lewis Overthrust. And its formation is vividly explained in a booklet <strong>&#x201C;Rocks, Ice, and Water - The Geology of Waterton-Glacier Park&#x201D;</strong>, by David D. Alt and Donald W. Hyndman, 1973. I think it would be better to directly present the excerpt of this book (pp.&#xA0;21-24), instead of myself, a layman, trying to explain the geological mechanisms.</p><h1 id="the-lewis-overthrust-fault---the-beginning-of-mountains">The Lewis Overthrust Fault - The Beginning of Mountains</h1><p>Geologists normally expect to find sedimentary rocks stacked in the order they were deposited with the oldest layers at the bottom of the pile and the youngest on top. In Waterton-Glacier Park this expectable order of rock layers is dramatically reversed; Precambrian sedimentary rocks deposited more than one billion years ago are now on top of Cretaceous sedimentary rocks laid down only 70 million years ago! Apparently a slab of Precambrian sedimentary rock several thousand feet thick slid eastward some tens of miles over the much younger Cretaceous sedimentary rocks. The surface on which the sliding movement occurred is called the Lewis Overthrust Fault. Geologists have marvelled at this situation, and attempted to understand it, ever since they first recognized it in the years near the beginning of the twentieth century.</p><p>For many years geologists argued that a strong force from the west must have pushed the slab of Precambrian sedimentary rock eastward onto the plains. But this vision poses problems: pushing such a long, thin slab of rock from behind without crumpling it is an undertaking similar to pushing a large carpet across a floor without wrinkling it. The rocks, like the carpet, are not strong enough to withstand the necessary force without folding, and the friction in the sliding surface makes it difficult for movement to occur. The Precambrian slab in Waterton-Glacier Park is not crumpled, neither is there evidence in the area west of the Park of any geologic event that could have exerted a strong eastward push. So it is difficult to imagine how this enormous slab of rock was pushed into its present position.</p><p>Now most geologists are convinced that overthrust faults do not move in response to a push from behind but instead slide downhill under the pull of gravity. This eliminates the problem of understanding how the overthrust slab could withstand a force without crumpling because every particle of rock feels the tug of gravity individually.</p><p>The problem of overcoming friction in the sliding surface of the fault still remains. If water in the pores of the rock is under sufficient pressure, it will support the rocks above enabling them to move with very little friction. This might have happened in the Cretaceous rocks but would have been most unlikely in the much older Precambrian formations because they were probably much too dry by the time movement occurred on the Lewis Overthrust fault. Some geologists contend that the Precambrian rocks moved because certain layers were weak enough to flow like a viscous fluid carrying the rocks above. They imagine the rocks behaving somewhat like a layer cake filled with soft frosting.</p><p>Thousands of feet of sedimentary rocks had accumulated in the region of Waterton-Glacier Park by the end of Cretaceous time. Layer after layer of sandstone, mudstone and limestone deposited over a period of many hundreds of millions of years while the region was a level plain flooded at times by shallow seas. The quiet years ended about 70-90 million years ago, during Cretaceous time while giant dinosaurs still roamed the earth.</p><p>Processes operating deep within the earth slowly raised the continental crust of western North America, with its burden of sedimentary rocks, several thousand feet vertically upward forming a broad crustal arch that had its crest about 100 miles west of Waterton-Glacier Park. Thousands of feet of interlayered limestone, sandstone, and mudstone slowly slanted eastward as uplift proceeded. Tilting such a thick pile of sedimentary rocks, some layers strong and others weak, is somewhat like tilting a thick stack of heavily-buttered pancakes. In both cases the entire stack will eventually begin to slide downward on one or more of the weak layers. That is probably what happened about 50-60 million years ago all along the eastern front of the northern Rockies.</p><p>Somewhere deep within the pile of sedimentary rocks a weak layer yielded under the strain and the rocks above began to glide slowly eastward down the flank of the broad regional arch still rising in the earth&#x2019;s crust. The huge slab of Precambrian sedimentary rock that is now Waterton-Glacier Park slid an unknown distance eastward, probably more than 30 miles. It moved at least ten miles across the soft sands and muds deposited in the shallow Cretaceous sea that had receded only a few million years previously.</p><p>As the mass of Precambrian sedimentary rock slowly slid eastward, large gaps opened behind it. The same sort of thing happens when slabs of snow slide down a roof leaving gaps where the moving snow detached itself from the stationary mass that remained behind &#x2013; or the upper end of a glacier pulls away from the mountain at its head. The North Fork Valley, along the western margin of Waterton-Glacier Park, appears to be such a gap pulled open behind the Precambrian slab as it moved eastward on the Lewis Overthrust. It is approximately ten miles wide, probably not enough to account for all the displacement on the Lewis Overthrust fault. In order to find another gap to account for more displacement we must go farther west to the broad Flathead Valley and suggest that the Whitefish Range, west of the North Fork Valley, may also have slid eastward.</p><p>Early geologists interpreted the North Fork Valley quite differently, arguing that it is a downdropped block of the earth&#x2019;s crust. Rocks in the southern end of the valley, where the bedrock valley floor is exposed, do suggest that the valley floor has dropped vertically downward. But there are reasons to believe that the floor of a pull-apart valley might drop so the two explanations are not incompatible.</p><p>Mountain ranges north and south of Waterton-Glacier Park also consist of large slabs of rock that slid eastward as the earth&#x2019;s crust arched up to the west. But these ranges do not consist of a single large slab. Instead, they are made of many smaller slabs stacked on each other like a row of fallen dominoes. This kind of structure is also found in part of the eastern portion of Waterton Park.</p><p>More references:</p><ol style="list-style-type: decimal"><li><a href="https://en.wikipedia.org/wiki/Lewis_Overthrust" target="_blank" rel="noopener">Wikipedia</a>, where a few illustrative figures are provided.</li><li><a href="https://www.nationalparkreservations.com/glacier-national-park-and-the-lewis-overthrust/" target="_blank" rel="noopener">Glacier National Park and the Lewis Overthrust</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Where to play with huge snowpatches in summer?&lt;/p&gt;
    
    </summary>
    
      <category term="pieces" scheme="http://smanist.github.io/categories/pieces/"/>
    
    
      <category term="mechanics" scheme="http://smanist.github.io/tags/mechanics/"/>
    
      <category term="geology" scheme="http://smanist.github.io/tags/geology/"/>
    
      <category term="glacier" scheme="http://smanist.github.io/tags/glacier/"/>
    
  </entry>
  
  <entry>
    <title>Solving a Multibody Short-Range Interaction Problem</title>
    <link href="http://smanist.github.io/2018/06/23/Multibody-short-range-interaction/"/>
    <id>http://smanist.github.io/2018/06/23/Multibody-short-range-interaction/</id>
    <published>2018-06-24T00:00:00.000Z</published>
    <updated>2018-06-24T19:39:17.082Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css"><p>When multiple bodies interact with their neighbours according to a graph.</p><a id="more"></a><h1 id="introduction">Introduction</h1><p>Recently I wrote a code for solving a certain type of multibody problems - just for fun. One instance of such problem is the truss structure, which can be viewed as a set of points connected by bars that can only deform axially. A graph specifies the connectivity of the points - only the points that are connected interact with each other. Another instance of the problem is certain particle system that appear in material science. The particles only interact with their neighbours. Now the problem is essentially determining the equilibrium geometrical configuration of the multi-body system when it is subject to an external excitation. Such equilibrium can be determined via a certain energy principle, if there is any.</p><p>Mathematically, the problem is stated as follows. Suppose a multibody system is composed of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span> points <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mi>i</mi></msub><mo>}</mo></mrow><annotation encoding="application/x-tex">\{ {\mathbf{x}}_i\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">{</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">}</span></span></span></span> with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">M</span></span></span></span> point pairs <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>{</mo><msub><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><mi>i</mi></msub><mo>=</mo><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>2</mn></mrow></msub><mo>)</mo><mo>}</mo></mrow><annotation encoding="application/x-tex">\{ {\mathbf{e}}_i=({\mathbf{x}}_{i1},{\mathbf{x}}_{i2})\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">{</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mclose">}</span></span></span></span>. The energy <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">U</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{U}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">U</span></span></span></span></span></span> of the multibody system is defined as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mi mathvariant="script">U</mi></mrow></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mo>)</mo><mo>=</mo><msubsup><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></msubsup><mi>U</mi><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>2</mn></mrow></msub><mo>)</mo><mo>&#x2261;</mo><msubsup><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>M</mi></msubsup><msub><mi>U</mi><mi>i</mi></msub></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {\mathcal{U}}({\mathbf{u}}) = \sum_{i=1}^M U({\mathbf{x}}_{i1},{\mathbf{x}}_{i2}) \equiv \sum_{i=1}^M U_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.8283360000000002em;"></span><span class="strut bottom" style="height:3.106005em;vertical-align:-1.277669em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">U</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-limits reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.10903em;">U</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2261;</span><span class="mop op-limits reset-textstyle displaystyle textstyle uncramped"><span class="vlist"><span style="top:1.1776689999999999em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.000005000000000143778em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span><span class="mop op-symbol large-op">&#x2211;</span></span></span><span style="top:-1.2500050000000003em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10903em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>U</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">U_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10903em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is the energy of the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>th point pair and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{u}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span></span></span></span> is a vector containing all the states of the points. Next, assume the external excitation is conservative, i.e.&#xA0;there exists a scalar function <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">V</mi></mrow></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">{\mathcal{V}}({\mathbf{u}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="mclose">)</span></span></span></span> such that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&#x2212;</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="script">V</mi></mrow></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex">-{\frac{\partial {\mathcal{V}}}{\partial {\mathbf{u}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8801079999999999em;"></span><span class="strut bottom" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord">&#x2212;</span><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">u</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathcal mtight" style="margin-right:0.08222em;">V</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> is the external force acting on the points. The system achieves equilibrium at its stationary point, i.e.&#xA0;when the gradient of total energy <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x3A0;</mi><mo>=</mo><mrow><mrow><mi mathvariant="script">U</mi></mrow></mrow><mo>+</mo><mrow><mrow><mi mathvariant="script">V</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">\Pi={\mathcal{U}}+{\mathcal{V}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x3A0;</span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">U</span></span></span><span class="mbin">+</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span></span></span></span></span> becomes zero, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo>=</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi mathvariant="normal">&#x3A0;</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow></mrow></mfrac></mrow><mo>=</mo><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {\mathbf{g}}({\mathbf{u}}^*) = {\frac{\partial \Pi}{\partial {\mathbf{u}}}} = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathrm">&#x3A0;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">0</span></span></span></span></span></p><h1 id="solution-schemes">Solution schemes</h1><h2 id="naive-newton-scheme">Naive Newton scheme</h2><p>In simple cases, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">{\mathbf{u}}^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.688696em;"></span><span class="strut bottom" style="height:0.688696em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is a minimum point near the initial state. One can employ any standard optimization algorithms to solve the problem, i.e.&#xA0;to minimize <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x3A0;</mi></mrow><annotation encoding="application/x-tex">\Pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x3A0;</span></span></span></span> w.r.t. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{u}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.44444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span></span></span></span>. Particularly, given the gradient <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{g}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.63888em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span></span></span></span> and the Jacobian <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">J</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{J}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">J</span></span></span></span></span></span> of the energy, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mi mathvariant="bold">J</mi></mrow></mrow><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo>=</mo><mfrac><mrow><msup><mi mathvariant="normal">&#x2202;</mi><mn>2</mn></msup><mi mathvariant="normal">&#x3A0;</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msup><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mn>2</mn></msup></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {\mathbf{J}}({\mathbf{u}}^*) = \frac{\partial^2 \Pi}{\partial {\mathbf{u}}^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.491108em;"></span><span class="strut bottom" style="height:2.177108em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">J</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x3A0;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> the minimum is found via the Newton-Raphson (NR) procedure, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">J</mi></mrow></mrow><mi>i</mi></msub><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>i</mi></msub><mo>+</mo><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}{\mathbf{J}}_i{\Delta\mathbf{u}}_i &amp;= -{\mathbf{g}}_i \\{\mathbf{u}}_{i+1} &amp;= {\mathbf{u}}_i + {\Delta\mathbf{u}}_i\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.4000000000000004em;vertical-align:-0.9500000000000004em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">J</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mbin mtight">+</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{u}}_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is the initial guess of the solution.</p><p>By applying the NR procedure to a series of external forces, one obtains the equilibrium path of the system, or the displacement-load curve in structural analysis.</p><h2 id="nonlinear-schemes">Nonlinear schemes</h2><p>There are exceptions that cannot be solved using the naive Newton scheme. Such exceptions occur typically when (1) the initial state is far from the solution, or/and (2) the equilibrium path contains limit points. There are two types of limit points. At a load limit point, a nonzero displacement increment results in a zero load increment. Or put in a different way, increasing (or decreasing) the load would result in the increase/decrease of the displacement on the two sides of the limit point. The case of displacement limit point is the reverse.</p><p>People have developed various solution schemes to tackle these issues. A review of these schemes is provided in <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.654.2545&amp;rep=rep1&amp;type=pdf" target="_blank" rel="noopener">Leon2011</a>. (Also check its Figure 1 for an illustration of the displacement and load limit points.)</p><p>To introduce these schemes, in the following we consider only the case where the external excitation is linear, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mo>&#x2212;</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="script">V</mi></mrow></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow></mrow></mfrac></mrow><mo>=</mo><mi>&#x3BB;</mi><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle -{\frac{\partial {\mathcal{V}}}{\partial {\mathbf{u}}}} = \lambda{\mathbf{f}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.08222em;">V</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3BB;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{f}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span></span> is a constant vector and the value of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BB;</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BB;</span></span></span></span> determines the magnitude of the external force. In such case, the total energy of the system is written as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">&#x3A0;</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mo separator="true">,</mo><mi>&#x3BB;</mi><mo>)</mo><mo>=</mo><mrow><mrow><mi mathvariant="script">U</mi></mrow></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mo>)</mo><mo>&#x2212;</mo><mi>&#x3BB;</mi><msup><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>T</mi></msup><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \Pi({\mathbf{u}},\lambda) = {\mathcal{U}}({\mathbf{u}}) - \lambda {\mathbf{u}}^T{\mathbf{f}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x3A0;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3BB;</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.09931em;">U</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3BB;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span></span></span></p><h3 id="n1-dimensional-space-formulation">N+1 dimensional space formulation</h3><p>Assume that the NR iteration starts at the previous equilibrium point. Treating <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BB;</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BB;</span></span></span></span> as an unknown, in the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.65952em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span>th NR iteration, the linear system is augmented as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">J</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd><mtd><mrow><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>i</mi><mi>T</mi></msubsup></mrow></mtd><mtd><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mi>i</mi></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>H</mi><mi>i</mi></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{bmatrix}{\mathbf{J}}_i &amp; -{\mathbf{f}}\\{\mathbf{c}}_i^T &amp; b_i\end{bmatrix}\begin{bmatrix}{\Delta\mathbf{u}}_i \\{\Delta\lambda}_i\end{bmatrix}=\begin{bmatrix}-{\mathbf{g}}_i \\H_i\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.4756655em;"></span><span class="strut bottom" style="height:2.4513310000000006em;vertical-align:-0.9756655000000005em;"></span><span class="base displaystyle textstyle uncramped"><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6356655em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">J</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6156655000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-0.6356655em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span><span style="top:0.6156655000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span> where the last row and the coefficients <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{c}}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">H_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are introduced to constrain <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BB;</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BB;</span></span></span></span> and close the linear system. Different choices of these coefficients give rise to different solution schemes.</p><p>The solution of the augmented system is expressed as, due to <a href="https://onlinelibrary.wiley.com/doi/full/10.1002/nme.1620140811" target="_blank" rel="noopener">Batoz1979</a>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mi>i</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><msub><mi>H</mi><mi>i</mi></msub><mo>&#x2212;</mo><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>i</mi><mi>T</mi></msubsup><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>g</mi><mi>i</mi></mrow></msub></mrow><mrow><mi>b</mi><mo>+</mo><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>i</mi><mi>T</mi></msubsup><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mi>i</mi></mrow></msub></mrow></mfrac></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>i</mi></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mi>i</mi></msub><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mi>i</mi></mrow></msub><mo>+</mo><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>g</mi><mi>i</mi></mrow></msub></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}{\Delta\lambda}_i &amp;= \frac{H_i - {\mathbf{c}}_i^T{\Delta\mathbf{u}}_{gi}}{b + {\mathbf{c}}_i^T{\Delta\mathbf{u}}_{fi}} \\{\Delta\mathbf{u}}_i &amp;= {\Delta\lambda}_i{\Delta\mathbf{u}}_{fi} + {\Delta\mathbf{u}}_{gi}\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.108785em;"></span><span class="strut bottom" style="height:3.7175700000000003em;vertical-align:-1.6087850000000001em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.5904540000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:1.248785em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.5904540000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.713131em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathit">b</span><span class="mbin">+</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.27686399999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.34480000000000005em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.258664em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span><span style="top:1.248785em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">J</mi></mrow></mrow><mi>i</mi></msub><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>g</mi><mi>i</mi></mrow></msub><mo>=</mo><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">g</mi></mrow></mrow><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{J}}_i{\Delta\mathbf{u}}_{gi}=-{\mathbf{g}}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.972218em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">J</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord">&#x2212;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">J</mi></mrow></mrow><mi>i</mi></msub><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mi>i</mi></mrow></msub><mo>=</mo><mrow><mrow><mi mathvariant="bold">f</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{J}}_i{\Delta\mathbf{u}}_{fi}={\mathbf{f}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">J</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span></span></span></span></span>.</p><h3 id="simple-incremental-schemes">Simple incremental schemes</h3><p>A naive choice of the constraint for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BB;</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BB;</span></span></span></span> is that <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>i</mi></msub><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mspace width="1em"></mspace><msub><mi>b</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mspace width="1em"></mspace><msub><mi>H</mi><mn>1</mn></msub><mo>=</mo><mrow><mover accent="true"><mi>&#x3BB;</mi><mo>&#xAF;</mo></mover></mrow></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>H</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mspace width="1em"></mspace><mi>i</mi><mo>&#x2265;</mo><mn>2</mn></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}{\mathbf{c}}_i=0,\quad b_i=1,\quad H_1={\bar\lambda}\\H_i=0,\quad i\geq 2\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.4000000000000004em;vertical-align:-0.9500000000000004em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord"><span class="mspace quad"></span><span class="mord mathit">b</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord"><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord mathit">&#x3BB;</span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit">i</span></span><span class="mrel">&#x2265;</span><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> This corresponds to the <em>incremental loading</em> (IL) scheme, which prescribes the load increment <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mover accent="true"><mi>&#x3BB;</mi><mo>&#xAF;</mo></mover></mrow></mrow><annotation encoding="application/x-tex">{\bar\lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8312199999999998em;"></span><span class="strut bottom" style="height:0.8312199999999998em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord mathit">&#x3BB;</span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> at the first iteration. As a result, the load parameter is fixed for the rest of iterations. Near the load limit point, the IL scheme would either fail or result in the snap-through behavior - the solution &#x201C;jumps&#x201D; to an equilibrium point far away from the previous solution and results in a non-smooth equilibrium path. Such behavior cannot be avoided unless the direction of the load increment is reversed at the load limit point. Similarly there is <em>incremental displacement</em> scheme which prescribes the displacement increment and suffers from the displacement limit point.</p><h3 id="arc-length-schemes">Arc length schemes</h3><p>The family of <em>arc length</em> (AL) schemes are developed to overcome the limitations of the incremental schemes at limit points. These schemes have been widely used in engineering applications, esp. commercial computater-aided engineering software. The key idea is to introduce an <em>arc length</em> constraint that simultaneously controls the increments in the displacement and load, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>T</mi></msup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mo>+</mo><mi>&#x3BC;</mi><msup><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mn>2</mn></msup><mo>=</mo><msup><mrow><mi mathvariant="normal">&#x394;</mi><mi>s</mi></mrow><mn>2</mn></msup></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {\Delta\mathbf{u}}^T{\Delta\mathbf{u}}+ \mu{\Delta\lambda}^2 = {\Delta s}^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.0857709999999998em;vertical-align:-0.19444em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3BC;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">s</span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> Different values of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BC;</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BC;</span></span></span></span> result in the variants of the schemes: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BC;</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\mu=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BC;</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span> for spherical AL method, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BC;</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mu=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BC;</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span> for cylindrical AL method, and the most general, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BC;</mi><mo>&gt;</mo><mn>0</mn><mo separator="true">,</mo><mi>&#x3BC;</mi><mo>&#x2260;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\mu&gt;0,\mu\neq 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.716em;"></span><span class="strut bottom" style="height:0.9309999999999999em;vertical-align:-0.215em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BC;</span><span class="mrel">&gt;</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathit">&#x3BC;</span><span class="mrel">&#x2260;</span><span class="mord mathrm">1</span></span></span></span> for elliptical AL method.</p><p>For the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">N+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span> formulation, the AL constraint is rewritten as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mn>1</mn><mi>T</mi></msubsup><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>i</mi></msub><mo>+</mo><mi>&#x3BC;</mi><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mn>1</mn></msub><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mi>i</mi></msub><mo>=</mo><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mi>s</mi></mrow><mi>i</mi><mn>2</mn></msubsup></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {\Delta\mathbf{u}}_1^T{\Delta\mathbf{u}}_i + \mu{\Delta\lambda}_1{\Delta\lambda}_i = {\Delta s}_i^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8913309999999999em;"></span><span class="strut bottom" style="height:1.138331em;vertical-align:-0.247em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3BC;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">s</span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>s</mi></mrow><mn>1</mn></msub><mo>=</mo><mrow><mi mathvariant="normal">&#x394;</mi><mi>s</mi></mrow></mrow><annotation encoding="application/x-tex">{\Delta s}_1={\Delta s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">s</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">s</span></span></span></span></span> the prescribed AL and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>s</mi></mrow><mi>i</mi></msub><mo>=</mo><mn>0</mn><mo separator="true">,</mo><mi>i</mi><mo>&#x2265;</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">{\Delta s}_i=0,i\geq 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">s</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mrel">&#x2265;</span><span class="mord mathrm">2</span></span></span></span>. The coefficients <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{c}}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">b</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">H_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.08125em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are then determined accordingly. The final expression for load increments is the following, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mi>i</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mo>&#xB1;</mo><mfrac><mrow><mrow><mi mathvariant="normal">&#x394;</mi><mi>s</mi></mrow></mrow><mrow><msqrt><mrow><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow></msub><mo>+</mo><mi>&#x3BC;</mi></mrow></msqrt></mrow></mfrac><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mspace width="1em"></mspace><mi>i</mi><mo>=</mo><mn>1</mn></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x2212;</mo><mfrac><mrow><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>g</mi><mi>i</mi></mrow></msub></mrow><mrow><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mi>i</mi></mrow></msub><mo>+</mo><mi>&#x3BC;</mi><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mn>1</mn></msub></mrow></mfrac><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mspace width="1em"></mspace><mi>i</mi><mo>&#x2265;</mo><mn>2</mn></mrow></mtd></mtr></mtable></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {\Delta\lambda}_i = \left\{\begin{array}{ll}\pm\frac{ {\Delta s}}{ \sqrt{ {\Delta\mathbf{u}}_{f1}^T{\Delta\mathbf{u}}_{f1}+\mu}}, &amp;\quad i=1 \\-\frac{ {\Delta\mathbf{u}}_{f1}^T{\Delta\mathbf{u}}_{gi}}{ {\Delta\mathbf{u}}_{f1}^T{\Delta\mathbf{u}}_{fi}+\mu{\Delta\lambda}_1}, &amp;\quad i\geq 2\end{array}\right.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:3.195722em;"></span><span class="strut bottom" style="height:5.891444em;vertical-align:-2.695722em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:1.5500099999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23A9;</span></span></span><span style="top:1.5500099999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:1.2500099999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:0.9500099999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:-0.000010000000000287557em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23A8;</span></span></span><span style="top:-1.1500100000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:-1.4500100000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:-1.7500100000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:-2.0500200000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23A7;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-1.835392em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">&#xB1;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:1.0678675000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord sqrt"><span class="sqrt-sign" style="top:0.01213249999999988em;"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size2">&#x221A;</span></span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.3013079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.3448em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord mathit">&#x3BC;</span></span></span><span style="top:-1.0978675em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">s</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mpunct">,</span></span></span><span style="top:1.545175em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.7131310000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.3013079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.3448em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord mathit">&#x3BC;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.8092159999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-1.835392em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit">i</span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span><span style="top:1.545175em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit">i</span></span><span class="mrel">&#x2265;</span><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></p><p>A noteworthy issue of the above scheme is that the sign of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">{\Delta\lambda}_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is unspecified. One way to determine the sign is to pick the new increment that is &#x201C;closest to&#x201D; the previous solution, as discussed in <a href="https://scholar.harvard.edu/files/vasios/files/ArcLength.pdf" target="_blank" rel="noopener">this document</a>. Another way to overcome the issue of direction determination is the linearization of the AL scheme, which replaces the AL constraint with a normal plane constraint.</p><h3 id="generalized-displacement-control-scheme">Generalized displacement control scheme</h3><p>The <a href="https://arc.aiaa.org/doi/pdf/10.2514/3.10529" target="_blank" rel="noopener">Yang1990</a> scheme is another scheme that bears a similar geometrical interpretation like the linearized AL scheme. Yet, initially, its derivation was to ensure the numerical stability of the <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">N+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="mbin">+</span><span class="mord mathrm">1</span></span></span></span> dimensional space solution. A generalized stiffness parameter GSP is proposed, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mi>G</mi><mi>S</mi><mi>P</mi><mo>=</mo><mfrac><mrow><mo>(</mo><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>f</mi><mn>0</mn></msubsup><msup><mo>)</mo><mi>T</mi></msup><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>f</mi><mn>0</mn></msubsup></mrow><mrow><mo>(</mo><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow><mn>0</mn></msubsup><msup><mo>)</mo><mi>T</mi></msup><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow></msub></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle GSP = \frac{ ({\Delta\mathbf{u}}_f^0)^T{\Delta\mathbf{u}}_f^0}{ ({\Delta\mathbf{u}}_{f1}^0)^T{\Delta\mathbf{u}}_{f1}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.650547em;"></span><span class="strut bottom" style="height:2.773963em;vertical-align:-1.123416em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">G</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.05764em;">S</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.13889em;">P</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mopen">(</span><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.3013079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.3448em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.8092159999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>f</mi><mn>0</mn></msubsup></mrow><annotation encoding="application/x-tex">{\Delta\mathbf{u}}_f^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is the first iteration from the first increment and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow><mn>0</mn></msubsup></mrow><annotation encoding="application/x-tex">{\Delta\mathbf{u}}_{f1}^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is the first iteration from the previous increment. At the first increment, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>f</mi><mn>0</mn></msubsup><mo>=</mo><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow><mn>0</mn></msubsup></mrow><annotation encoding="application/x-tex">{\Delta\mathbf{u}}_f^0={\Delta\mathbf{u}}_{f1}^0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. Initially <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mi>S</mi><mi>P</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">GSP=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">G</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span> and GSP increases/decreases as the structure stiffens/softens. A negative value of GSP means that the equilibrium path passed the load limit point and the load direction should be reversed. Refer to Figure 2 in [Yang1990] for a geometrical illustration of the effect of GSP.</p><p>The introduction of GSP leads to the following definition of the load increment, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mrow><mi mathvariant="normal">&#x394;</mi><mi>&#x3BB;</mi></mrow><mi>i</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mi>s</mi><mi>g</mi><mi>n</mi><mrow><mi mathvariant="normal">&#x394;</mi><mi>s</mi></mrow><msqrt><mrow><mi mathvariant="normal">&#x2223;</mi><mi>G</mi><mi>S</mi><mi>P</mi><mi mathvariant="normal">&#x2223;</mi></mrow></msqrt><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mspace width="1em"></mspace><mi>i</mi><mo>=</mo><mn>1</mn></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x2212;</mo><mfrac><mrow><mo>(</mo><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow><mn>0</mn></msubsup><msup><mo>)</mo><mi>T</mi></msup><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>g</mi><mi>i</mi></mrow></msub></mrow><mrow><mo>(</mo><msubsup><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mn>1</mn></mrow><mn>0</mn></msubsup><msup><mo>)</mo><mi>T</mi></msup><msub><mrow><mi mathvariant="normal">&#x394;</mi><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mrow><mi>f</mi><mi>i</mi></mrow></msub></mrow></mfrac><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mspace width="1em"></mspace><mi>i</mi><mo>&#x2265;</mo><mn>2</mn></mrow></mtd></mtr></mtable></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {\Delta\lambda}_i = \left\{\begin{array}{ll}sgn{\Delta s}\sqrt{ |GSP|}, &amp;\quad i=1 \\-\frac{ ({\Delta\mathbf{u}}_{f1}^0)^T{\Delta\mathbf{u}}_{gi}}{ ({\Delta\mathbf{u}}_{f1}^0)^T{\Delta\mathbf{u}}_{fi}}, &amp;\quad i\geq 2\end{array}\right.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.35002em;"></span><span class="strut bottom" style="height:4.2000399999999996em;vertical-align:-1.8500199999999998em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">&#x3BB;</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing mult"><span class="vlist"><span style="top:0.9500099999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23A9;</span></span></span><span style="top:0.9500099999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:-0.000010000000000287557em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23A8;</span></span></span><span style="top:-1.1500100000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23AA;</span></span></span><span style="top:-1.4500200000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="delimsizinginner delim-size4"><span>&#x23A7;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-1.3250414999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">n</span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord mathit">s</span></span><span class="mord sqrt"><span class="sqrt-sign" style="top:-0.09388000000000007em;"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size1">&#x221A;</span></span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathrm">&#x2223;</span><span class="mord mathit">G</span><span class="mord mathit" style="margin-right:0.05764em;">S</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mord mathrm">&#x2223;</span></span></span><span style="top:-0.90388em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mpunct">,</span></span></span><span style="top:0.6855054999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mopen">(</span><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.3013079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.3448em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle cramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.8092159999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x394;</span><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-1.3250414999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit">i</span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span><span style="top:0.6855054999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit">i</span></span><span class="mrel">&#x2265;</span><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mi>g</mi><mi>n</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">.</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">sgn=1.0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">n</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mord mathrm">.</span><span class="mord mathrm">0</span></span></span></span> and its sign changes whenever GSP becomes negative - and thus the load direction is automatically reversed at load limit point.</p><h1 id="application-to-geometrically-nonlinear-truss">Application to geometrically nonlinear truss</h1><h2 id="formulation">Formulation</h2><p>For the geometrically nonlinear truss, the energy between one pair of points is, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>E</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mn>2</mn></mrow></mfrac><mfrac><mrow><mi>k</mi></mrow><mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi></mrow></mfrac><mo>(</mo><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><msup><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><mo>&#x2212;</mo><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><msup><mo>)</mo><mn>2</mn></msup></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle E_i = \frac{1}{2} \frac{k}{||{\mathbf{l}}||} (||{\mathbf{l}}&apos;|| - ||{\mathbf{l}}||)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.30744em;vertical-align:-0.936em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">l</span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">l</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">l</span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x2223;</span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>2</mn></mrow></msub><mo>&#x2212;</mo><msub><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{l}}={\mathbf{x}}_{i2}-{\mathbf{x}}_{i1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">l</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>2</mn></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msubsup><mo>&#x2212;</mo><msubsup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>1</mn></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">{\mathbf{l}}&apos;={\mathbf{x}}_{i2}&apos;-{\mathbf{x}}_{i1}&apos;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.010556em;vertical-align:-0.258664em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">l</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.258664em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">2</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.258664em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, and superscript &#x2019; means new states of the points. The gradient and the Jacobian of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>E</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">E_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> only depend on <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>i</mi><mi>T</mi></msubsup><mo>=</mo><mo>[</mo><msubsup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>1</mn></mrow><mi>T</mi></msubsup><mo separator="true">,</mo><msubsup><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mrow><mi>i</mi><mn>2</mn></mrow><mi>T</mi></msubsup><mo>]</mo></mrow><annotation encoding="application/x-tex">{\mathbf{u}}_i^T=[{\mathbf{x}}_{i1}^T,{\mathbf{x}}_{i2}^T]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.0999949999999998em;vertical-align:-0.258664em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.258664em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mopen">[</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.258664em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.258664em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mord mathrm mtight">2</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">]</span></span></span></span>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mi>E</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>i</mi></msub></mrow></mfrac></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mi>k</mi><mn>1</mn></msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow></mrow></mtd></mtr><mtr><mtd><mrow><mfrac><mrow><msup><mi mathvariant="normal">&#x2202;</mi><mn>2</mn></msup><msub><mi>E</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><msubsup><mrow><mrow><mi mathvariant="bold">u</mi></mrow></mrow><mi>i</mi><mn>2</mn></msubsup></mrow></mfrac></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msub><mi>k</mi><mn>1</mn></msub><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><mi>I</mi></mrow></mtd><mtd><mrow><mo>&#x2212;</mo><mi>I</mi></mrow></mtd></mtr><mtr><mtd><mrow><mo>&#x2212;</mo><mi>I</mi></mrow></mtd><mtd><mrow><mi>I</mi></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>T</mi></msup></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}{\frac{\partial E_i}{\partial {\mathbf{u}}_i}} &amp;= k_1 {\mathbf{L}}\\\frac{ \partial^2 E_i}{ \partial {\mathbf{u}}_i^2} &amp;= k_1\begin{bmatrix}I &amp; -I \\ -I &amp; I\end{bmatrix}+ k_2 {\mathbf{L}}{\mathbf{L}}^T\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.580706em;"></span><span class="strut bottom" style="height:4.661412em;vertical-align:-2.080706em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.2092660000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><span style="top:1.1178420000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.6859999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">u</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.27686399999999994em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span style="top:-0.34480000000000005em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.05764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.2092660000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span></span></span><span style="top:1.1178420000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">&#x2212;</span><span class="mord mathit" style="margin-right:0.07847em;">I</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord">&#x2212;</span><span class="mord mathit" style="margin-right:0.07847em;">I</span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07847em;">I</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>T</mi></msup></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mo>[</mo><mo>&#x2212;</mo><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><msup><mo>)</mo><mi>T</mi></msup><mo separator="true">,</mo><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><msup><mo>)</mo><mi>T</mi></msup><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>k</mi><mn>1</mn></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi>k</mi></mrow><mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi></mrow></mfrac><mrow><mo fence="true">(</mo><mn>1</mn><mo>&#x2212;</mo><mfrac><mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi></mrow><mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><msup><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi></mrow></mfrac><mo fence="true">)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow><msub><mi>k</mi><mn>2</mn></msub></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi>k</mi></mrow><mrow><mi mathvariant="normal">&#x2223;</mi><mi mathvariant="normal">&#x2223;</mi><msup><mrow><mrow><mi mathvariant="bold">l</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mi mathvariant="normal">&#x2223;</mi><msup><mi mathvariant="normal">&#x2223;</mi><mn>3</mn></msup></mrow></mfrac></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}{\mathbf{L}}^T &amp;= [-({\mathbf{l}}&apos;)^T, ({\mathbf{l}}&apos;)^T] \\k_1 &amp;= \frac{k}{||{\mathbf{l}}||} \left(1 - \frac{||{\mathbf{l}}||}{||{\mathbf{l}}&apos;||}\right) \\k_2 &amp;= \frac{k}{||{\mathbf{l}}&apos;||^3}\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:3.2294004999999997em;"></span><span class="strut bottom" style="height:5.958800999999999em;vertical-align:-2.7294004999999997em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-2.3380694999999996em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.5280695000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:1.7934004999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03148em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-2.3380694999999996em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mopen">[</span><span class="mord">&#x2212;</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">l</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">l</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">]</span></span></span><span style="top:-0.5280695000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">l</span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord mathrm">1</span><span class="mbin">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">l</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">l</span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:1.7934004999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">&#x2223;</span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">l</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord mathrm">&#x2223;</span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">3</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.2300000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> The gradient and Jacobian of the whole system are assembled from those of the point pairs.</p><h2 id="case-study">Case study</h2><p>The star dome 24-bar truss is a typical problem that contains various nonlinear behaviors. The description of the problem can be found <a href="https://www.researchgate.net/figure/a-Star-Dome-Space-Truss-with-24-bars-and-b-Equilibrium-paths_fig5_324993551" target="_blank" rel="noopener">here</a>. The star dome is loaded at the center and experiences several load and displacement limit points during the loading process. The initial configuration (red dot-dashed line) and several typical deformation are shown in Figure 1. The displacement-load curve of the center node is presented in Figure 2.</p><figure float="left"><img src="sd0.png" width="350px"> <img src="sd1.png" width="350px"> <img src="sd2.png" width="350px"> <img src="sd3.png" width="350px"><figcaption>Figure 1.</figcaption></figure><figure float="left"><img src="ld.png" width="500px"><figcaption>Figure 2. y-axis is the vertical force.</figcaption></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;When multiple bodies interact with their neighbours according to a graph.&lt;/p&gt;
    
    </summary>
    
      <category term="digest" scheme="http://smanist.github.io/categories/digest/"/>
    
    
      <category term="optimization" scheme="http://smanist.github.io/tags/optimization/"/>
    
      <category term="mechanics" scheme="http://smanist.github.io/tags/mechanics/"/>
    
      <category term="numerical" scheme="http://smanist.github.io/tags/numerical/"/>
    
      <category term="solver" scheme="http://smanist.github.io/tags/solver/"/>
    
  </entry>
  
  <entry>
    <title>Bayesian Optimization</title>
    <link href="http://smanist.github.io/2018/06/12/Bayesian-optimization/"/>
    <id>http://smanist.github.io/2018/06/12/Bayesian-optimization/</id>
    <published>2018-06-12T22:00:00.000Z</published>
    <updated>2018-06-14T01:33:43.396Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css"><p>How to solve an optimization problem when the objective function and/or the constraints are expensive/impossible to compute?</p><a id="more"></a><h1 id="introduction">Introduction</h1><h2 id="the-problem">The problem</h2><p>The objective function is expensive to compute when it is, for example, the lift-to-drag ratio of an aircraft wing using a computational fluid dynamics (CFD) solver, or nonlinear deformation of composite structure using a finite element (FE) solver. The objective function is impossible to compute when it is, for example, data obtained from experiments.</p><p>The optimization problem is written formally as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi><mspace width="0.16667em"></mspace><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></msub></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mi>J</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo separator="true">;</mo><mrow><mrow><mi mathvariant="bold">U</mi></mrow></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">.</mi></mrow></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>E</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo separator="true">;</mo><mrow><mrow><mi mathvariant="bold">U</mi></mrow></mrow><mo>)</mo><mo>=</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>I</mi></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo separator="true">;</mo><mrow><mrow><mi mathvariant="bold">U</mi></mrow></mrow><mo>)</mo><mo>&#x2265;</mo><mn>0</mn></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}    {\mathrm{arg\,min}}_{\mathbf{d}}&amp;\quad J({\mathbf{d}};{\mathbf{U}}) \\    {\mathrm{s.t.}}&amp;\quad {\mathbf{c}}_E({\mathbf{d}};{\mathbf{U}}) = 0 \\                &amp;\quad {\mathbf{c}}_I({\mathbf{d}};{\mathbf{U}}) \ge 0\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.05em;"></span><span class="strut bottom" style="height:3.6000000000000005em;vertical-align:-1.5500000000000007em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.2099999999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm"><span class="mspace thinspace"></span><span class="mord mathrm">m</span></span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">d</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.00999999999999951em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">s</span><span class="mord mathrm">.</span><span class="mord mathrm">t</span><span class="mord mathrm">.</span></span></span></span></span><span style="top:1.1900000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.2099999999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.09618em;">J</span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mpunct">;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">U</span></span></span><span class="mclose">)</span></span></span><span style="top:-0.00999999999999951em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mpunct">;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">U</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span><span style="top:1.1900000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mpunct">;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">U</span></span></span><span class="mclose">)</span><span class="mrel">&#x2265;</span><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{d}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span></span></span></span> is the vector of design variables, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>E</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{c}}_E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>I</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{c}}_I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.44444em;"></span><span class="strut bottom" style="height:0.59444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are the aggregated equality and inequality constraint functions, respectively. The state variables <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">U</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{U}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">U</span></span></span></span></span></span> are those implicitly involved in the evaluation of the objective and constraint functions. Examples of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">U</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{U}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">U</span></span></span></span></span></span> are the flow variables in a CFD solver or the displacement field in the structural FE solver.</p><p>In above cases, in order to solve the optimization problem during a practical time period, the number of evaluation of the objective function has to be limited in the optimization algorithm. There are two limitations on the optimization algorithm: (1) The design space cannot be explored by carrying out numerous <em>direct</em> evaluation of the objective function; (2) The derivative of the objective function w.r.t. design variables cannot be computed using the finite difference approach. These limitations prevent the direct application of any gradient-free or gradient-based algorithms to the optimization problem.</p><h2 id="surrogate-based-optimization">Surrogate-based optimization</h2><p>To overcome the limitations, one approach is to use surrogate-based optimization (SBO). The SBO algorithms typically contain two key ingredients, a surrogate model and an acquisition function. The surrogate model is employed to approximate the expensive objective function. Since the surrogate is computationally efficient, it allows for fast evaluation of approximated objective function as well as its derivative w.r.t. the design variables. The acquisition function is a criterion for selecting the points in the design space that is potentially a solution to the optimization problem. The acquisition function is designed to take into account of both <em>exploration</em>, i.e.&#xA0;sampling from areas of high uncertainty, and <em>exploitation</em>, i.e.&#xA0;sampling from areas likely to contain the minimizer of the objective function.</p><p>The general procedure of SBO is as follows,</p><ol style="list-style-type: decimal"><li>Step 1: Generate a sample data set <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">D</mi></mrow></mrow><mo>=</mo><mo>{</mo><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>J</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mrow><mi>E</mi><mi>i</mi></mrow></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mrow><mi>I</mi><mi>i</mi></mrow></msub><mo>)</mo><msubsup><mo>}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><msub><mi>N</mi><mi>s</mi></msub></mrow></msubsup></mrow><annotation encoding="application/x-tex">{\mathcal{D}}=\{({\mathbf{d}}_i, J_i, {\mathbf{c}}_{Ei}, {\mathbf{c}}_{Ii})\}_{i=1}^{N_s}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9232309999999999em;"></span><span class="strut bottom" style="height:1.200095em;vertical-align:-0.276864em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.02778em;">D</span></span></span><span class="mrel">=</span><span class="mopen">{</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.09618em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist"><span style="top:0.276864em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.44489999999999996em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.10903em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> by evaluating the objective and constraint functions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>J</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mrow><mi>E</mi><mi>i</mi></mrow></msub><mo separator="true">,</mo><msub><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mrow><mi>I</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">J_i, {\mathbf{c}}_{Ei}, {\mathbf{c}}_{Ii}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.09618em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> at a few sample points <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{d}}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> in the design space.</li><li>Step 2: Generate surrogates <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>J</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msup><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">J^{sur}({\mathbf{d}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>E</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msubsup><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">{\mathbf{c}}_E^{sur}({\mathbf{d}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.025331em;vertical-align:-0.275331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.275331em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose">)</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>I</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msubsup><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">{\mathbf{c}}_I^{sur}({\mathbf{d}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.025331em;vertical-align:-0.275331em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.275331em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose">)</span></span></span></span> using the sample data set <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="script">D</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathcal{D}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.02778em;">D</span></span></span></span></span></span>.</li><li>Step 3: Find the design point <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">{\mathbf{d}}^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> by solving an optimization problem that consists of the surrogates and acquisition function.</li><li>Step 4: Evaluate the objective and constraint functions <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>J</mi><mo>&#x2217;</mo></msup><mo separator="true">,</mo><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>E</mi><mo>&#x2217;</mo></msubsup><mo separator="true">,</mo><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>I</mi><mo>&#x2217;</mo></msubsup></mrow><annotation encoding="application/x-tex">J^*, {\mathbf{c}}_E^*, {\mathbf{c}}_I^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.688696em;"></span><span class="strut bottom" style="height:0.939723em;vertical-align:-0.251027em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.251027em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.251027em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> at the new design point <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">{\mathbf{d}}^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>.</li><li>Step 5: Update the surrogate using the sample data set augmented with the new design point <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="script">D</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>=</mo><mrow><mrow><mi mathvariant="script">D</mi></mrow></mrow><mo>&#x222A;</mo><mo>{</mo><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo separator="true">,</mo><msup><mi>J</mi><mo>&#x2217;</mo></msup><mo separator="true">,</mo><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>E</mi><mo>&#x2217;</mo></msubsup><mo separator="true">,</mo><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>I</mi><mo>&#x2217;</mo></msubsup><mo>)</mo><mo>}</mo></mrow><annotation encoding="application/x-tex">{\mathcal{D}}^*={\mathcal{D}}\cup \{({\mathbf{d}}^*,J^*,{\mathbf{c}}_E^*,{\mathbf{c}}_I^*)\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1.0010270000000001em;vertical-align:-0.251027em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.02778em;">D</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathcal" style="margin-right:0.02778em;">D</span></span></span><span class="mbin">&#x222A;</span><span class="mopen">{</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.251027em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.251027em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mclose">}</span></span></span></span>.</li><li>Step 6: Repeat steps 3-5 until the convergence or stopping conditions are reached.</li></ol><p>One category of SBO is the one-shot approach, which only contains steps 1-4. In the one-shot approach, the acquisition function is the surrogate itself. The issue is that the initial sample set does not necessarily represent well the distribution of the objective function over the whole design space. As a result, the optimal solution found by the algorithm may be far off from the true value of objective function. The other category of SBO is the updating approach that, of course, contains all the six steps. This is the category where the Bayesian optimization lies.</p><h1 id="bayesian-optimization">Bayesian optimization</h1><h2 id="concepts">Concepts</h2><p>Bayesian optimization (BO) is essentially the six-step SBO procedure with a statistical interpretation. Adapted from <a href="https://en.wikipedia.org/wiki/Bayesian_optimization" target="_blank" rel="noopener">wikipedia</a>: The expensive function is treated as a random function with a prior distribution, which captures the beliefs about the behavior of the function. The prior distribution is updated using the data set to form the the posterior distribution over the objective function. The posterior distribution is used to construct an acquisition function that determines the next design point.</p><p>The two precursors of BO are <a href="http://fluidsengineering.asmedigitalcollection.asme.org/article.aspx?articleid=1431594" target="_blank" rel="noopener">Kushner1964</a> and <a href="https://link.springer.com/chapter/10.1007%2F978-3-662-38527-2_55" target="_blank" rel="noopener">Mockus1975</a>. A good review of BO is provided in <a href="https://arxiv.org/abs/1012.2599" target="_blank" rel="noopener">Brochu2010</a>. The Gaussian process regression (GPR) model is a popular choice for the surrogate model in BO. Some outstanding the GPR-based BO algorithms include, but not limited to,</p><ol style="list-style-type: decimal"><li>BayesOpt: <a href="https://github.com/rmcantin/bayesopt" target="_blank" rel="noopener">code</a>, <a href="https://rmcantin.bitbucket.io/html/" target="_blank" rel="noopener">doc</a>, <a href="https://arxiv.org/abs/1405.7430" target="_blank" rel="noopener">paper</a>.</li><li>HIPS/spearmint: <a href="https://github.com/HIPS/Spearmint" target="_blank" rel="noopener">code</a>.</li><li>GPyOpt: <a href="https://github.com/SheffieldML/GPyOpt" target="_blank" rel="noopener">code</a>, <a href="http://sheffieldml.github.io/GPyOpt/" target="_blank" rel="noopener">doc</a></li><li>GPflowOpt: <a href="https://github.com/GPflow/GPflowOpt" target="_blank" rel="noopener">code</a>, <a href="https://gpflowopt.readthedocs.io/en/latest/" target="_blank" rel="noopener">doc</a>, <a href="https://arxiv.org/abs/1711.03845" target="_blank" rel="noopener">paper</a></li></ol><p>Besides GPR, there are BO algorithms using other surrogate models, such as those in SMAC (<a href="http://www.cs.ubc.ca/labs/beta/Projects/SMAC/" target="_blank" rel="noopener">code</a>, <a href="https://www.cs.ubc.ca/~hutter/papers/10-TR-SMAC.pdf" target="_blank" rel="noopener">paper</a>). A list of implementations of BO is provided <a href="https://rmcantin.bitbucket.io/html/relsoft.html" target="_blank" rel="noopener">here</a>. Finally, note that in the engineering community, the BO algorithm tends to appear by the name efficient global optimization (EGO) algorithm <a href="https://link.springer.com/article/10.1023/A:1008306431147" target="_blank" rel="noopener">Jones1998</a>, <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.2.4697&amp;rep=rep1&amp;type=pdf" target="_blank" rel="noopener">Sasena2002</a>.</p><p>Next, the key components of BO, the surrogate model and the acquisition function, as well as the treatment of constraints will be discussed.</p><h2 id="surrogate-model">Surrogate model</h2><p>In this and the following sections, the discussion will be based on the GPR model. The prediction of the GPR model at a new design point <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">{\mathbf{d}}^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> follows a Gaussian probability distribution, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msup><mi>J</mi><mo>&#x2217;</mo></msup><mo>=</mo><msup><mi>J</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msup><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo>&#x223C;</mo><mrow><mrow><mi mathvariant="script">N</mi></mrow></mrow><mo>(</mo><mi>&#x3BC;</mi><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo separator="true">,</mo><mrow><msup><mi>&#x3C3;</mi><mn>2</mn></msup></mrow><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo>)</mo><mo separator="true">,</mo><mspace width="1em"></mspace><mrow><mi mathvariant="normal">o</mi><mi mathvariant="normal">r</mi></mrow><mspace width="1em"></mspace><mi>P</mi><mo>(</mo><msup><mi>J</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msup><mo>=</mo><msup><mi>J</mi><mo>&#x2217;</mo></msup><mo>)</mo><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><msqrt><mrow><mn>2</mn><mi>&#x3C0;</mi><mrow><msup><mi>&#x3C3;</mi><mn>2</mn></msup></mrow></mrow></msqrt></mrow></mfrac><mi>exp</mi><mrow><mo fence="true">(</mo><mo>&#x2212;</mo><mfrac><mrow><mo>(</mo><msup><mi>J</mi><mo>&#x2217;</mo></msup><mo>&#x2212;</mo><mi>&#x3BC;</mi><msup><mo>)</mo><mn>2</mn></msup></mrow><mrow><mn>2</mn><mrow><msup><mi>&#x3C3;</mi><mn>2</mn></msup></mrow></mrow></mfrac><mo fence="true">)</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle J^* = J^{sur}({\mathbf{d}}^*) \sim {\mathcal{N}}(\mu({\mathbf{d}}^*), {\sigma^2}({\mathbf{d}}^*)),\quad\mathrm{or}\quad P(J^{sur}=J^*)=\frac{1}{\sqrt{2\pi{\sigma^2}}}\exp\left(-\frac{(J^*-\mu)^2}{2{\sigma^2}}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.491108em;"></span><span class="strut bottom" style="height:2.441138em;vertical-align:-0.95003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x223C;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathcal" style="margin-right:0.14736em;">N</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3BC;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathrm">o</span><span class="mord mathrm">r</span></span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.13889em;">P</span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.8450540000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord sqrt"><span class="sqrt-sign" style="top:-0.11505399999999999em;"><span class="style-wrap reset-textstyle textstyle uncramped">&#x221A;</span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mord mathrm">2</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C0;</span><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.875054em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mop reset-textstyle displaystyle textstyle uncramped">exp</span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm">2</span><span class="mord textstyle cramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:-0.289em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord mathit">&#x3BC;</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3BC;</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3BC;</span></span></span></span> is the predicted value of objective function and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msup><mi>&#x3C3;</mi><mn>2</mn></msup></mrow></mrow><annotation encoding="application/x-tex">{\sigma^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> is the variance, i.e.&#xA0;the uncertainty of the prediction. The details of GPR models have been discussed in the previous articles and will be skipped.</p><h2 id="acquisition-function-for-unconstrained-optimization">Acquisition function for unconstrained optimization</h2><p>The BO is initially developed for unconstrained problems. Surveys of acquisition functions for such problems can be found in, for example, [Sasena2002] and <a href="https://dash.harvard.edu/handle/1/17467236" target="_blank" rel="noopener">Gelbart2015</a>. There are three basic acquisition functions: (1) Probability Improvement (PI) [Kushner1964], (2) Expected Improvement (EI) <a href="https://link.springer.com/article/10.1007/BF01099263" target="_blank" rel="noopener">Mockus1994</a>, <a href="http://www.csd.uwo.ca/~dlizotte/publications/lizotte_phd_thesis.pdf" target="_blank" rel="noopener">Lizotte2008</a>, (3) Lower Confidence Bound (LCB) <a href="https://ieeexplore.ieee.org/document/271617/" target="_blank" rel="noopener">Cox1992</a>. Besides the basic ones, there are acquisition functions based on Thompson Sampling and the information theory (entropy). In general, it appears that the acquisition functions are evolving towards (1) finding multiple candidate points in one iteration, (2) taking advantage of parallel computing via techniques like asynchronization. Nonetheless, this article will focus only on the three basic acquisition functions.</p><h3 id="pi">PI</h3><p>Defined as the probability of the new design point <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">{\mathbf{d}}^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> to offer a better value of the objective function <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>J</mi><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">J^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.688696em;"></span><span class="strut bottom" style="height:0.688696em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> than the minimum objective function in the sample data set <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>J</mi><mrow><mi>min</mi></mrow></msub><mo>=</mo><mi>min</mi><mo>{</mo><msub><mi>J</mi><mi>i</mi></msub><mo>}</mo></mrow><annotation encoding="application/x-tex">J_{\min}=\min\{J_i\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.09618em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mop mtight">min</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mop">min</span><span class="mopen">{</span><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.09618em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">}</span></span></span></span>. <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>C</mi><mrow><mi>P</mi><mi>I</mi></mrow></msub><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo>=</mo><mi>P</mi><mo>(</mo><msup><mi>J</mi><mo>&#x2217;</mo></msup><mo>&#x2264;</mo><msub><mi>J</mi><mrow><mi>min</mi></mrow></msub><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle C_{PI}({\mathbf{d}}^*) = P(J^*\le J_{\min})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">P</span><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.13889em;">P</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">&#x2264;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.09618em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mop mtight">min</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span></p><h3 id="ei">EI</h3><p>Defined as the expectation of the improvement in the objective function at the new design point. In the literature, EI has been generalized to include user-specified parameters that control the exploitation-exploration trade-off. The generalized EI is written as, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>C</mi><mrow><mi>E</mi><mi>I</mi></mrow></msub><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo>=</mo><mrow><mrow><mi mathvariant="double-struck">E</mi></mrow></mrow><mo>[</mo><mi>I</mi><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo>]</mo><mo separator="true">,</mo><mspace width="1em"></mspace><mi>I</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo><mo>=</mo><mi>max</mi><mo>(</mo><mn>0</mn><mo separator="true">,</mo><mo>(</mo><msub><mi>J</mi><mrow><mi>min</mi></mrow></msub><mo>&#x2212;</mo><msup><mi>J</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msup><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo><mo>&#x2212;</mo><mi>&#x3B6;</mi><mi>&#x3C3;</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo><msup><mo>)</mo><mi>g</mi></msup><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle C_{EI}({\mathbf{d}}^*) = {\mathbb{E}}[I({\mathbf{d}}^*)],\quad I({\mathbf{d}}) = \max(0,(J_{\min}-J^{sur}({\mathbf{d}})-\zeta\sigma({\mathbf{d}}))^g)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbb">E</span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.07847em;">I</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">]</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped"><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.07847em;">I</span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop reset-textstyle displaystyle textstyle uncramped">max</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">0</span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.09618em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mop mtight">min</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.07378em;">&#x3B6;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03588em;">&#x3C3;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mclose reset-textstyle displaystyle textstyle uncramped"><span class="mclose">)</span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">g</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B6;</mi><mo>&#x2265;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\zeta\ge 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07378em;">&#x3B6;</span><span class="mrel">&#x2265;</span><span class="mord mathrm">0</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>&#x2265;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">g\ge 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mrel">&#x2265;</span><span class="mord mathrm">1</span></span></span></span> are the user-specified parameters. The classical form of EI is obtained with <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B6;</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\zeta=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07378em;">&#x3B6;</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">g=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span>. A larger <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span></span></span></span> or <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B6;</mi></mrow><annotation encoding="application/x-tex">\zeta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07378em;">&#x3B6;</span></span></span></span> will put more weight on the exploration. Note that when <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B6;</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\zeta=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07378em;">&#x3B6;</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">g=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>, EI reduces to PI. For a GPR model, the closed-form expression is available for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>E</mi><mi>I</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{EI}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. For the case <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">g=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span>, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mi>C</mi><mrow><mi>E</mi><mi>I</mi></mrow></msub><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msubsup><mo>&#x222B;</mo><mn>0</mn><mi mathvariant="normal">&#x221E;</mi></msubsup><mi>I</mi><mi>P</mi><mo>(</mo><msup><mi>J</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msup><mo>=</mo><msub><mi>J</mi><mrow><mi>min</mi></mrow></msub><mo>&#x2212;</mo><mi>&#x3B6;</mi><mi>&#x3C3;</mi><mo>&#x2212;</mo><mi>I</mi><mo>)</mo><mi>d</mi><mi>I</mi></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">{</mo><mtable><mtr><mtd><mrow><mi>&#x3C3;</mi><mo>[</mo><mi>z</mi><mi mathvariant="normal">&#x3A6;</mi><mo>(</mo><mi>z</mi><mo>)</mo><mo>+</mo><mi>&#x3D5;</mi><mo>(</mo><mi>z</mi><mo>)</mo><mo>]</mo><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mspace width="1em"></mspace><mi>&#x3C3;</mi><mo>&gt;</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow><mn>0</mn><mo separator="true">,</mo></mrow></mtd><mtd><mrow><mspace width="1em"></mspace><mi>&#x3C3;</mi><mo>=</mo><mn>0</mn></mrow></mtd></mtr></mtable></mrow></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}  C_{EI}({\mathbf{d}}^*) &amp;= \int_0^\infty I P(J^{sur}=J_{\min}-\zeta\sigma-I) dI \\                &amp;=  \left\{  \begin{array}{ll}    \sigma [z\Phi(z) + \phi(z)],&amp;\quad \sigma &gt; 0 \\    0,&amp;\quad \sigma = 0  \end{array}  \right.\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.58614em;"></span><span class="strut bottom" style="height:4.67228em;vertical-align:-2.08614em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.2261399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span style="top:1.13611em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.2261399999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;top:-0.0011249999999999316em;">&#x222B;</span><span class="msupsub"><span class="vlist"><span style="top:0.91225em;margin-left:-0.44445em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">0</span></span></span><span style="top:-0.9739999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x221E;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.09618em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mop mtight">min</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord mathit" style="margin-right:0.07378em;">&#x3B6;</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="mbin">&#x2212;</span><span class="mord mathit" style="margin-right:0.07847em;">I</span><span class="mclose">)</span><span class="mord mathit">d</span><span class="mord mathit" style="margin-right:0.07847em;">I</span></span></span><span style="top:1.13611em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">{</span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="mopen">[</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mord mathrm">&#x3A6;</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit">&#x3D5;</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mclose">]</span><span class="mpunct">,</span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">0</span><span class="mpunct">,</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span></span><span class="mrel">&gt;</span><span class="mord mathrm">0</span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span></span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>z</mi><mo>=</mo><mfrac><mrow><msub><mi>J</mi><mrow><mi>min</mi></mrow></msub><mo>&#x2212;</mo><mi>&#x3B6;</mi><mi>&#x3C3;</mi><mo>&#x2212;</mo><mi>&#x3BC;</mi></mrow><mrow><mi>&#x3C3;</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">z=\frac{J_{\min}-\zeta\sigma-\mu}{\sigma}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9322159999999999em;"></span><span class="strut bottom" style="height:1.277216em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.04398em;">z</span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03588em;">&#x3C3;</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.44610799999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.09618em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mop mtight">min</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.07378em;">&#x3B6;</span><span class="mord mathit mtight" style="margin-right:0.03588em;">&#x3C3;</span><span class="mbin mtight">&#x2212;</span><span class="mord mathit mtight">&#x3BC;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span>, and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">&#x3A6;</mi></mrow><annotation encoding="application/x-tex">\Phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">&#x3A6;</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3D5;</mi></mrow><annotation encoding="application/x-tex">\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">&#x3D5;</span></span></span></span> are the cummulative distribution and probability density functions, respectively. The gradient of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>E</mi><mi>I</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{EI}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> w.r.t. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{d}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span></span></span></span> for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3C3;</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sigma&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.64444em;"></span><span class="strut bottom" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="mrel">&gt;</span><span class="mord mathrm">0</span></span></span></span> is, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><msub><mi>C</mi><mrow><mi>E</mi><mi>I</mi></mrow></msub></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow></mfrac></mrow><mo>=</mo><mo>&#x2212;</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>&#x3BC;</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow></mfrac></mrow><mi mathvariant="normal">&#x3A6;</mi><mo>(</mo><mi>z</mi><mo>)</mo><mo>+</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>&#x3C3;</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow></mfrac></mrow><mo>[</mo><mi>&#x3D5;</mi><mo>(</mo><mi>z</mi><mo>)</mo><mo>&#x2212;</mo><mi>&#x3B6;</mi><mi mathvariant="normal">&#x3A6;</mi><mo>(</mo><mi>z</mi><mo>)</mo><mo>]</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {\frac{\partial C_{EI}}{\partial {\mathbf{d}}}} = - {\frac{\partial \mu}{\partial {\mathbf{d}}}}\Phi(z) + {\frac{\partial \sigma}{\partial {\mathbf{d}}}}[\phi(z)-\zeta\Phi(z)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">d</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">d</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathit">&#x3BC;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x3A6;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.04398em;">z</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">d</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">[</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3D5;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.04398em;">z</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.07378em;">&#x3B6;</span><span class="mord mathrm reset-textstyle displaystyle textstyle uncramped">&#x3A6;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.04398em;">z</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mclose reset-textstyle displaystyle textstyle uncramped">]</span></span></span></span></span> where the computation of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>&#x3BC;</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex">{\frac{\partial \mu}{\partial {\mathbf{d}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9322159999999999em;"></span><span class="strut bottom" style="height:1.277216em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">d</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.44610799999999995em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathit mtight">&#x3BC;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>&#x3C3;</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex">{\frac{\partial \sigma}{\partial {\mathbf{d}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8801079999999999em;"></span><span class="strut bottom" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">d</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathit mtight" style="margin-right:0.03588em;">&#x3C3;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> has been discussed in a previous <a href="https://smanist.github.io/2018/06/08/Gaussian-process-regressor-addendum/">article</a>.</p><p>For the case <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B6;</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\zeta=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07378em;">&#x3B6;</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span></span>, refer to P. 64 of [Sasena2002].</p><h3 id="lcb">LCB</h3><p>Defined using the LCB concept, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>C</mi><mrow><mi>L</mi><mi>C</mi><mi>B</mi></mrow></msub><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo>=</mo><mi>&#x3BC;</mi><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo><mo>&#x2212;</mo><mi>&#x3B6;</mi><mi>&#x3C3;</mi><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>&#x2217;</mo></msup><mo>)</mo></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle C_{LCB}({\mathbf{d}}^*) = \mu({\mathbf{d}}^*) - \zeta\sigma({\mathbf{d}}^*)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">L</span><span class="mord mathit mtight" style="margin-right:0.07153em;">C</span><span class="mord mathit mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">&#x3BC;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mbin reset-textstyle displaystyle textstyle uncramped">&#x2212;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.07378em;">&#x3B6;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.03588em;">&#x3C3;</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span></span></span></span></span> where the probability of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>J</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msup><mo>&lt;</mo><msub><mi>C</mi><mrow><mi>L</mi><mi>C</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">J^{sur}&lt;C_{LCB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&lt;</span><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">L</span><span class="mord mathit mtight" style="margin-right:0.07153em;">C</span><span class="mord mathit mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is a constant controlled by the user-specified parameter <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B6;</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\zeta&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07378em;">&#x3B6;</span><span class="mrel">&gt;</span><span class="mord mathrm">0</span></span></span></span>. A larger <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>&#x3B6;</mi></mrow><annotation encoding="application/x-tex">\zeta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07378em;">&#x3B6;</span></span></span></span> will put more weight on the exploration. The gradient of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>L</mi><mi>C</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{LCB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">L</span><span class="mord mathit mtight" style="margin-right:0.07153em;">C</span><span class="mord mathit mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> w.r.t. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{d}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span></span></span></span> is straight-forward.</p><h3 id="discussion">Discussion</h3><p>The PI acquisition function is purely exploitation, which is undesirable for global optimization. The EI and LCB acquisition functions are high when <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>J</mi><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">J^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.688696em;"></span><span class="strut bottom" style="height:0.688696em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> approaches the optimum point, or the uncertainty of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>J</mi><mo>&#x2217;</mo></msup></mrow><annotation encoding="application/x-tex">J^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.688696em;"></span><span class="strut bottom" style="height:0.688696em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mbin mtight">&#x2217;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is high. Therefore, both <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>E</mi><mi>I</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{EI}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>L</mi><mi>C</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{LCB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">L</span><span class="mord mathit mtight" style="margin-right:0.07153em;">C</span><span class="mord mathit mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> achieve a balance between exploitation and exploration.</p><p>The exploitation-exploration trade-off of EI and LCB functions can be further tuned by the cooling scheme. In the cooling scheme, the optimization starts with a large user-specified parameter for more exploration and gradually decreases the parameter to focus on exploitation. However, the effect of this scheme is controversial [Sasena2002] and [Brochu2010].</p><h2 id="treatment-of-constraints">Treatment of constraints</h2><p>The acquisition functions discussed in the previous section work well with optimization problems without constraints or with box constraints only. For more complex constraints, there are two types of treatments. The first type is the direct approach. As suggested in [Sasena2002], the objective and constraint functions are replaced with the surrogates, and the following problem is solved, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="normal">a</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">g</mi><mspace width="0.16667em"></mspace><mi mathvariant="normal">m</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">n</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></msub></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><mi>C</mi><mo>(</mo><msup><mi>J</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msup><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mrow><mi mathvariant="normal">s</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">.</mi></mrow></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>E</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msubsup><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo><mo>=</mo><mn>0</mn></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mspace width="1em"></mspace><msubsup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mi>I</mi><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msubsup><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo><mo>&#x2265;</mo><mn>0</mn></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}    {\mathrm{arg\,min}}_{\mathbf{d}}&amp;\quad C(J^{sur}, {\mathbf{d}}) \\    {\mathrm{s.t.}}&amp;\quad {\mathbf{c}}_E^{sur}({\mathbf{d}}) = 0 \\                &amp;\quad {\mathbf{c}}_I^{sur}({\mathbf{d}}) \ge 0\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.05em;"></span><span class="strut bottom" style="height:3.6000000000000005em;vertical-align:-1.5500000000000007em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.2099999999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm"><span class="mspace thinspace"></span><span class="mord mathrm">m</span></span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.24444em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">d</span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-0.00999999999999951em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathrm">s</span><span class="mord mathrm">.</span><span class="mord mathrm">t</span><span class="mord mathrm">.</span></span></span></span></span><span style="top:1.1900000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.2099999999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit" style="margin-right:0.07153em;">C</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.09618em;">J</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose">)</span></span></span><span style="top:-0.00999999999999951em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">0</span></span></span><span style="top:1.1900000000000006em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mord"><span class="mspace quad"></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose">)</span><span class="mrel">&#x2265;</span><span class="mord mathrm">0</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> Similar to [Sasena2002] is the expected violation (EV) method <a href="https://arc.aiaa.org/doi/pdf/10.2514/6.2000-4891" target="_blank" rel="noopener">Audet2000</a>: The optimization is carried out by filling the design space using latin hypercube sampling and filtering out infeasible candidate points using the so-called EV function, which takes the same form of EI. Essentially, the constraint surrogates <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msup></mrow><annotation encoding="application/x-tex">{\mathbf{c}}^{sur}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.664392em;"></span><span class="strut bottom" style="height:0.664392em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are replaced by <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>E</mi><mi>V</mi></mrow></msub><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">c</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi><mi>r</mi></mrow></msup><mo separator="true">,</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">C_{EV}({\mathbf{c}}^{sur}, {\mathbf{d}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05764em;">E</span><span class="mord mathit mtight" style="margin-right:0.22222em;">V</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">c</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose">)</span></span></span></span>.</p><p>The other type is the indirect approach, which is further divided into two categories, as discussed in [Gelbart2015]. In the first category, the constrained problem is converted to an unconstrained one using classical (non-BO) methods. Three representative approaches are,</p><ol style="list-style-type: decimal"><li>Barrier methods: The iterates are <em>prevented</em> from leaving the feasible region by augmenting the objective function with a barrier function, which causes the objective to grow to infinity at the boundary of the feasible region.</li><li>Penalty methods: The objective function is augmented with a penalty term, which <em>still allows</em> the iterates to leave the feasible region but the iterates become feasible as the penalty increases to infinity in the process of optimization.</li><li>Augmented Lagrangian methods: The problem is solved via the Lagrangian form augmented with the extra term in penalty methods, while the Lagrangian multipliers are controlled by the penalty parameters.</li></ol><p>In the second category of indirect approach, the acquisition function is modified to incorporate the constraint surrogates. two representative approaches are,</p><ol style="list-style-type: decimal"><li>Modified EI methods: An example is the EI with constraints (EIC) <a href="https://www.jstor.org/stable/4356058" target="_blank" rel="noopener">Schonlau1998</a>. The EI for the objective function is augmented to take account of the constraints. In EIC, the EI is multiplied by the probability that the constraints are satisfied, so that the improvement (almost) only occurs at feasible candidate points.</li><li>Marginalization integral (MI) methods: Examples are integrated expected conditional improvement <a href="https://www.researchgate.net/publication/45913547_Optimization_Under_Unknown_Constraints" target="_blank" rel="noopener">Gramacy2011</a> and expected volume minimization <a href="http://proceedings.mlr.press/v33/picheny14.pdf" target="_blank" rel="noopener">Picheny2014</a>. The acqusition function at <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{d}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span></span></span></span> is defined using an integral over the whole design space, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><msub><mi>C</mi><mrow><mi>M</mi><mi>I</mi></mrow></msub><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo><mo>=</mo><mo>&#x222B;</mo><mi>F</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo separator="true">,</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>)</mo><mi>h</mi><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>)</mo><mi>d</mi><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle C_{MI}({\mathbf{d}}) = \int F({\mathbf{d}},{\mathbf{d}}&apos;)h({\mathbf{d}}&apos;)d{\mathbf{d}}&apos;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.36em;"></span><span class="strut bottom" style="height:2.22225em;vertical-align:-0.86225em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mop op-symbol large-op reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.44445em;top:-0.0011249999999999316em;">&#x222B;</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped" style="margin-right:0.13889em;">F</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mpunct reset-textstyle displaystyle textstyle uncramped">,</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">h</span><span class="mopen reset-textstyle displaystyle textstyle uncramped">(</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose reset-textstyle displaystyle textstyle uncramped">)</span><span class="mord mathit reset-textstyle displaystyle textstyle uncramped">d</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo separator="true">,</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">F({\mathbf{d}},{\mathbf{d}}&apos;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> is a measure of improvement at <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow><annotation encoding="application/x-tex">{\mathbf{d}}&apos;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> given observation at <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{d}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">h({\mathbf{d}}&apos;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> is the probability that the constraints are satisfied at <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow><annotation encoding="application/x-tex">{\mathbf{d}}&apos;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.751892em;"></span><span class="strut bottom" style="height:0.751892em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. The maximizer of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>C</mi><mrow><mi>M</mi><mi>I</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{MI}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.07153em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">M</span><span class="mord mathit mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> provides the best <em>overall</em> improvement in the design space. The inclusion of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">d</mi></mrow></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">h({\mathbf{d}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">h</span><span class="mopen">(</span><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">d</span></span></span><span class="mclose">)</span></span></span></span> encourages picking candidate points likely to be feasible, while <em>still permits</em> the picking of points in infeasible region that may provide improvement over the whole design space.</li></ol><p>In terms of programming, the direct approach is probably the easiest one to implement. Particularly, the non-BO indirect approaches may be applied to solve the subproblems derived from the the direct approach, if standard packages for numerical optimization are employed. The challenge in the MI methods is the integration over the design space, which could be intractable in higher dimensions.</p><h2 id="miscellaneous-topics">Miscellaneous topics</h2><h3 id="choice-of-optimization-algorithms">Choice of optimization algorithms</h3><p>No matter which algorithm is used, eventually the BO process boils down to a series of non-convex optimization subproblems. It is hard to find the global optimum of a non-convex function. One choice is to use the evolutionary algorithms, or some so-called global algorithms like the DIRECT, which are claimed to be able to find the global optimum given sufficiently many iterations. Another choice is to apply the algorithms for convex optimization, especially the gradient-based ones, with multiple restarts.</p><p>I personally prefer the latter. Both choices <em>do not</em> guarantee the convergence to global optimum. The convergence rate of the former is much slower than the latter, especially in high-dimensional space. In practice, multiple restarts usually result in a good global sub-optimal point that is sufficient for the engineering purposes. A merit of the former, though, is that some algorithms can handle disjoint feasible regions.</p><h3 id="relearn-rate-of-the-surrogate">Relearn rate of the surrogate</h3><p>The training of the surrogates could become expensive as the number of samples increases. Also, contrary to intuition, updating the hyperparameters of the surrogate at every iteration may be unnecessary or even counterproductive <a href="http://www.jmlr.org/papers/v12/bull11a.html" target="_blank" rel="noopener">Bull2011</a>. A better strategy is to introduce a <em>relearn rate</em>: Update the sample data set in the surrogate every iteration, but update the hyperparameters every <em>few</em> iterations.</p><p>In practice, the effectiveness of this strategy depends on the quality of the surrogate implementation. If the current hyperparameters are far off from the converged values, keeping the current hyperparameters would reduce the convergence rate of the whole BO algorithm. As for the GPR model, the update of sample data set has been discussed in a previous <a href="https://smanist.github.io/2018/06/08/Gaussian-process-regressor-addendum/">article</a>.</p><h1 id="final-note">Final note</h1><p>To be fair, it is worth mentioning the existence of adjoint-based optimization. This methodology applies to optimization problems constrained by partial differential equations (PDEs). One can incorporate the <em>adjoint</em> capability in their PDE solver and enable the direct gradient calculation of the expensive objective and constraint functions. This approach applies to optimization problems involving CFD and FE solvers. The adjoint method would be a different (but interesting) story that I will discuss in future.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;How to solve an optimization problem when the objective function and/or the constraints are expensive/impossible to compute?&lt;/p&gt;
    
    </summary>
    
      <category term="digest" scheme="http://smanist.github.io/categories/digest/"/>
    
    
      <category term="optimization" scheme="http://smanist.github.io/tags/optimization/"/>
    
      <category term="kriging" scheme="http://smanist.github.io/tags/kriging/"/>
    
      <category term="surrogate model" scheme="http://smanist.github.io/tags/surrogate-model/"/>
    
  </entry>
  
  <entry>
    <title>Gaussian Process Regressor - Addendum</title>
    <link href="http://smanist.github.io/2018/06/08/Gaussian-process-regressor-addendum/"/>
    <id>http://smanist.github.io/2018/06/08/Gaussian-process-regressor-addendum/</id>
    <published>2018-06-08T18:00:00.000Z</published>
    <updated>2018-06-12T20:58:55.007Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css"><p>A collection of extra topics as a sequel to the GPR series.</p><a id="more"></a><h1 id="updating-scheme">Updating scheme</h1><p>Consider a scenario where a GP model is trained using a large sample data set (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span> points). Recall from the <a href="https://smanist.github.io/2017/09/22/Gaussian-process-regressor-part-1/">first</a> and the <a href="https://smanist.github.io/2017/09/26/Gaussian-process-regressor-part-2/">second</a> articles, the training process determines the hyperparameters and generates a number of coefficient matrices for the efficient computation of the predictive mean and variance. Now suppose a few new samples (<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">M</span></span></span></span> points, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mo>&#x226A;</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">M\ll N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mrel">&#x226A;</span><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span>) are to be appended to the data set. The question is, does one simply retrain the GP model?</p><p>Not necessarily. The new samples can reduce the prediction error and the overall uncertainty but may have limited effect on the hyperparameters. Therefore, with a few new samples, one can update the GP model by keeping the old hyperparameters and recomputing the coefficient matrices, including <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{L}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">F</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{Q}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">Q</span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{R}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">R</span></span></span></span></span></span>.</p><p>Strictly speaking, the addition of new samples will result in the recomputation of everything, even though the hyperparameters remain the same: The std and mean of the samples are modified, so is the correlation matrix <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{K}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span></span></span></span>, and so are the follow-up matrix decompositions. However, now that <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mo>&#x226A;</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">M\ll N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.10903em;">M</span><span class="mrel">&#x226A;</span><span class="mord mathit" style="margin-right:0.10903em;">N</span></span></span></span>, one can assume that the std and mean of the new sample data set are the same as those of the old one. As a result, the portion of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{K}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span></span></span></span> associated with the old sample data set remains the same, and the new coefficient matrices can be computed via <em>partial</em> matrix decompositions, which could save considerable amount of time - dropping from <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><msup><mi>N</mi><mn>3</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(N^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">3</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span> to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><msup><mi>N</mi><mn>2</mn></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">O(N^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span>.</p><p>The new covariance matrix is <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub></mrow></mtd><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>n</mi></mrow></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>n</mi><mi>s</mi></mrow></msub></mrow></mtd><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>n</mi><mi>n</mi></mrow></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {\mathbf{K}}= \begin{bmatrix}{\mathbf{K}}_{ss} &amp; {\mathbf{K}}_{sn} \\{\mathbf{K}}_{ns} &amp; {\mathbf{K}}_{nn}\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.45em;"></span><span class="strut bottom" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{K}}_{ss}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is the matrix associated with the old data set, whose Cholesky factor <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{L}}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is known. Matrices <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>n</mi><mi>s</mi></mrow></msub><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>n</mi></mrow><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">{\mathbf{K}}_{ns}={\mathbf{K}}_{sn}^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.088331em;vertical-align:-0.247em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>n</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{K}}_{nn}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> are due to the new samples. The Cholesky factor <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{L}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span></span></span></span> of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{K}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span></span></span></span> is obtained via the following procedure of partial Cholesky decomposition,</p><ol style="list-style-type: decimal"><li>Cholesky decomposition: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>n</mi><mi>n</mi></mrow></msub><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>n</mi></msub><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>n</mi><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">{\mathbf{K}}_{nn}={\mathbf{L}}_n{\mathbf{L}}_n^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.088331em;vertical-align:-0.247em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>.</li><li>Linear solve: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mi>s</mi><mi>n</mi></mrow></msub><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>s</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{L}}_{sn} = {\mathbf{L}}_s^{-1}{\mathbf{K}}_{sn}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></li><li>Assemble the Cholesky factor, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>s</mi></msub></mrow></mtd><mtd><mrow><mrow><mrow><mi mathvariant="bold">O</mi></mrow></mrow></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mi>s</mi><mi>n</mi></mrow><mi>T</mi></msubsup></mrow></mtd><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>n</mi></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {\mathbf{L}}= \begin{bmatrix}{\mathbf{L}}_s &amp; {\mathbf{O}}\\{\mathbf{L}}_{sn}^T &amp; {\mathbf{L}}_n\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.4756655em;"></span><span class="strut bottom" style="height:2.4513310000000006em;vertical-align:-0.9756655000000005em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6356655em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6156655000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-0.6356655em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">O</span></span></span></span></span><span style="top:0.6156655000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></li></ol><p>Next, the new <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">F</span></span></span></span></span></span> matrix is <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow><mo>=</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mo>=</mo><msup><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>s</mi></msub></mrow></mtd><mtd><mrow><mrow><mrow><mi mathvariant="bold">O</mi></mrow></mrow></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mi>s</mi><mi>n</mi></mrow><mi>T</mi></msubsup></mrow></mtd><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>n</mi></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>s</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>n</mi></msub></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable><mtr><mtd><mrow><msub><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow><mi>s</mi></msub></mrow></mtd></mtr><mtr><mtd><mrow><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>n</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>n</mi></msub><mo>&#x2212;</mo><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mi>s</mi><mi>n</mi></mrow><mi>T</mi></msubsup><msub><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow><mi>s</mi></msub><mo>)</mo></mrow></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {\mathbf{F}}= {\mathbf{L}}^{-1}{\mathbf{H}}=\begin{bmatrix}{\mathbf{L}}_s &amp; {\mathbf{O}}\\{\mathbf{L}}_{sn}^T &amp; {\mathbf{L}}_n\end{bmatrix}^{-1}\begin{bmatrix}{\mathbf{H}}_s \\{\mathbf{H}}_n\end{bmatrix} =\begin{bmatrix}{\mathbf{F}}_s \\{\mathbf{L}}_n^{-1} ({\mathbf{H}}_n - {\mathbf{L}}_{sn}^T{\mathbf{F}}_s)\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.5407735000000002em;"></span><span class="strut bottom" style="height:2.516439000000001em;vertical-align:-0.9756655000000005em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">F</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner reset-textstyle displaystyle textstyle uncramped"><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6356655em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6156655000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist"><span style="top:-0.6356655em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">O</span></span></span></span></span><span style="top:0.6156655000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-1.0896655000000002em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6099999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.5900000000000003em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="minner displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist"><span style="top:-0.6356655em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6156655000000004em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">n</span></span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span> where <a href="https://en.wikipedia.org/wiki/Block_matrix#Block_matrix_inversion" target="_blank" rel="noopener">block matrix inversion</a> is used and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow><mi>s</mi></msub><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mi>s</mi><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msubsup><msub><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{F}}_s={\mathbf{L}}_s^{-1}{\mathbf{H}}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.061108em;vertical-align:-0.247em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is known from the old model.</p><p>Finally, since <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow><mi>s</mi></msub><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mi>s</mi></msub><msub><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">{\mathbf{F}}_s={\mathbf{Q}}_s{\mathbf{R}}_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">R</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> is known, one can utilize the <a href="http://www.ams.org/journals/mcom/1976-30-136/S0025-5718-1976-0431641-8/" target="_blank" rel="noopener">QR update algorithm</a> to obtain the QR decomposition of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">F</span></span></span></span></span></span>. Such algorithm has been implemented in standard packages for scientific computation, such as <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.linalg.qr_insert.html" target="_blank" rel="noopener">scipy.linalg.qr_insert</a>.</p><p>With the new coefficient matices <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{L}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">L</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{F}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">F</span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{Q}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.8805499999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">Q</span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow></mrow><annotation encoding="application/x-tex">{\mathbf{R}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68611em;"></span><span class="strut bottom" style="height:0.68611em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">R</span></span></span></span></span></span>, the GP model is updated with the new sample data set.</p><h1 id="gradients">Gradients</h1><p>In some scenarios where a GP model is involved, the gradients of the mean and the variance w.r.t. the input are required. One example is the surrogate-based optimization, where the GP model is used as the surrogate and the gradient-based algorithm is chosen to find the optima. It is necessary to compute the gradient analytically (or using automatic differentiation), instead of using finite difference. The latter could destabilize the iterations of gradient descent near some &#x201C;singularity&#x201D; points at which the GP model is ill-defined.</p><p>Note that, in the trivial treatment of the multiple output case, the process variances <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow></mrow><annotation encoding="application/x-tex">{\sigma_f^2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.2333239999999999em;vertical-align:-0.4192159999999999em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.2831079999999999em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span> of the output are determined independently. Therefore, it is sufficient to consider the single output case. From the first <a href="https://smanist.github.io/2017/09/22/Gaussian-process-regressor-part-1/">article</a> of the GPR series, the mean and variance at a single point are, respectively, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mi>m</mi><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msup><mrow><mover accent="true"><mrow><mi mathvariant="bold">g</mi></mrow><mo>&#xAF;</mo></mover></mrow><mi>T</mi></msup><mrow><msub><mrow><mi mathvariant="bold">k</mi></mrow><mi>u</mi></msub></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>+</mo><msup><mrow><mover accent="true"><mrow><mi mathvariant="bold">b</mi></mrow><mo>&#xAF;</mo></mover></mrow><mi>T</mi></msup><mrow><msub><mrow><mi mathvariant="bold">h</mi></mrow><mi>u</mi></msub></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mrow><mrow><msup><mi>&#x3C3;</mi><mn>2</mn></msup></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow><mo>&#x2212;</mo><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><msub><mrow><mi mathvariant="bold">k</mi></mrow><mi>u</mi></msub></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><msup><mo>]</mo><mn>2</mn></msup><mo>+</mo><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mi>T</mi></mrow></msup><mo>[</mo><mrow><msub><mrow><mi mathvariant="bold">h</mi></mrow><mi>u</mi></msub></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>&#x2212;</mo><msup><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow><mi>T</mi></msup><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><msub><mrow><mi mathvariant="bold">k</mi></mrow><mi>u</mi></msub></mrow><mo>(</mo><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow><mo>)</mo><mo>]</mo><mo>]</mo><msup><mo>]</mo><mn>2</mn></msup></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>&#x2261;</mo><mrow><msubsup><mi>&#x3C3;</mi><mi>f</mi><mn>2</mn></msubsup></mrow><mo>&#x2212;</mo><msubsup><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><mn>1</mn><mi>T</mi></msubsup><msub><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><mn>1</mn></msub><mo>+</mo><msubsup><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><mn>2</mn><mi>T</mi></msubsup><msub><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><mn>2</mn></msub></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}m({\mathbf{x}}) &amp;= {\bar\mathbf{g}}^T{\mathbf{k}_u}({\mathbf{x}}) + {\bar\mathbf{b}}^T{\mathbf{h}_u}({\mathbf{x}}) \\{\sigma^2}({\mathbf{x}}) &amp;= {\sigma_f^2}- [{\mathbf{L}}^{-1}{\mathbf{k}_u}({\mathbf{x}})]^2 + [{\mathbf{R}}^{-T} [{\mathbf{h}_u}({\mathbf{x}}) - {\mathbf{F}}^T[{\mathbf{L}}^{-1}{\mathbf{k}_u}({\mathbf{x}})]]]^2 \\         &amp;\equiv {\sigma_f^2}- {\mathbf{e}}_1^T{\mathbf{e}}_1 + {\mathbf{e}}_2^T{\mathbf{e}}_2\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.1662144999999997em;"></span><span class="strut bottom" style="height:3.8324289999999994em;vertical-align:-1.6662144999999997em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.2426635em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord mathit">m</span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span></span></span><span style="top:0.00866750000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span></span></span><span style="top:1.2831064999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.2426635em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span style="top:-0.013440000000000007em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.44521999999999984em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span></span></span><span style="top:0.00866750000000005em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mbin">&#x2212;</span><span class="mopen">[</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mopen">[</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">R</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">[</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">h</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">x</span></span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mclose">]</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:1.2831064999999997em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">&#x2261;</span><span class="mord displaystyle textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:0.24700000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msub><mrow><mi mathvariant="bold">k</mi></mrow><mi>u</mi></msub></mrow><mo>=</mo><msub><mrow><mrow><mi mathvariant="bold">K</mi></mrow></mrow><mrow><mi>s</mi><mi>u</mi></mrow></msub></mrow><annotation encoding="application/x-tex">{\mathbf{k}_u}={\mathbf{K}}_{su}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">K</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span><span class="mord mathit mtight">u</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><msub><mrow><mi mathvariant="bold">h</mi></mrow><mi>u</mi></msub></mrow><mo>=</mo><msubsup><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mi>u</mi><mi>T</mi></msubsup></mrow><annotation encoding="application/x-tex">{\mathbf{h}_u}={\mathbf{H}}_u^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8413309999999999em;"></span><span class="strut bottom" style="height:1.088331em;vertical-align:-0.247em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> and <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mrow><mover accent="true"><mrow><mi mathvariant="bold">b</mi></mrow><mo>&#xAF;</mo></mover></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msup><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">Q</mi></mrow></mrow><mi>T</mi></msup><mo>(</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>)</mo><mo>]</mo></mrow></mtd></mtr><mtr><mtd><mrow><mrow><mover accent="true"><mrow><mi mathvariant="bold">g</mi></mrow><mo>&#xAF;</mo></mover></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mi>T</mi></mrow></msup><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mo>(</mo><msub><mrow><mrow><mi mathvariant="bold">y</mi></mrow></mrow><mi>s</mi></msub><mo>&#x2212;</mo><mrow><mrow><mi mathvariant="bold">H</mi></mrow></mrow><mrow><mover accent="true"><mrow><mi mathvariant="bold">b</mi></mrow><mo>&#xAF;</mo></mover></mrow><mo>)</mo><mo>]</mo></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}{\bar\mathbf{b}}&amp;= {\mathbf{R}}^{-1} [{\mathbf{Q}}^T({\mathbf{L}}^{-1}{\mathbf{y}}_s)] \\{\bar\mathbf{g}}&amp;= {\mathbf{L}}^{-T} [{\mathbf{L}}^{-1} ({\mathbf{y}}_s-{\mathbf{H}}{\bar\mathbf{b}})]\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.501331em;"></span><span class="strut bottom" style="height:2.502662em;vertical-align:-1.001331em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-0.6100000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:0.6413309999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span style="top:-0.013440000000000007em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-0.6100000000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">R</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">Q</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span><span style="top:0.6413309999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">[</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf" style="margin-right:0.01597em;">y</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">H</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mclose">]</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span></p><p>The gradient of the mean is computed in a straight-forward manner, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mi>m</mi></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow><mo>=</mo><msup><mrow><mover accent="true"><mrow><mi mathvariant="bold">g</mi></mrow><mo>&#xAF;</mo></mover></mrow><mi>T</mi></msup><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msub><mrow><mi mathvariant="bold">k</mi></mrow><mi>u</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow><mo>+</mo><msup><mrow><mover accent="true"><mrow><mi mathvariant="bold">b</mi></mrow><mo>&#xAF;</mo></mover></mrow><mi>T</mi></msup><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msub><mrow><mi mathvariant="bold">h</mi></mrow><mi>u</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle {\frac{\partial m}{\partial {\mathbf{x}}}} = {\bar\mathbf{g}}^T{\frac{\partial {\mathbf{k}_u}}{\partial {\mathbf{x}}}} + {\bar\mathbf{b}}^T{\frac{\partial {\mathbf{h}_u}}{\partial {\mathbf{x}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.37144em;"></span><span class="strut bottom" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord mathit">m</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mrel reset-textstyle displaystyle textstyle uncramped">=</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathbf" style="margin-right:0.01597em;">g</span></span></span><span style="top:-0.013440000000000007em;margin-left:0.05556em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mbin reset-textstyle displaystyle textstyle uncramped">+</span><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord accent"><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle cramped"><span class="mord mathbf">b</span></span></span><span style="top:-0.26343999999999995em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="accent-body"><span>&#xAF;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.44521999999999984em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped reset-textstyle displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msub><mrow><mi mathvariant="bold">k</mi></mrow><mi>u</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex">{\frac{\partial {\mathbf{k}_u}}{\partial {\mathbf{x}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8962079999999999em;"></span><span class="strut bottom" style="height:1.2412079999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.4100999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathbf mtight">k</span></span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msub><mrow><mi mathvariant="bold">h</mi></mrow><mi>u</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow></mrow><annotation encoding="application/x-tex">{\frac{\partial {\mathbf{h}_u}}{\partial {\mathbf{x}}}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8962079999999999em;"></span><span class="strut bottom" style="height:1.2412079999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathbf mtight">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.4100999999999999em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight" style="margin-right:0.05556em;">&#x2202;</span><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathbf mtight">h</span></span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span></span> are obtained from the regression and mean functions, respectively.</p><p>The computation of the gradient of the variance is a little bit more involved, <span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle scriptlevel="0" displaystyle="true"><mtable><mtr><mtd><mrow><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msup><mi>&#x3C3;</mi><mn>2</mn></msup></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mo>&#x2212;</mo><mn>2</mn><msubsup><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><mn>1</mn><mi>T</mi></msubsup><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msub><mrow><mi mathvariant="bold">k</mi></mrow><mi>u</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow><mo>+</mo><mn>2</mn><msubsup><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><mn>2</mn><mi>T</mi></msubsup><msup><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mi>T</mi></mrow></msup><mrow><mo fence="true">(</mo><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msub><mrow><mi mathvariant="bold">h</mi></mrow><mi>u</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow><mo>&#x2212;</mo><msup><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow><mi>T</mi></msup><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msub><mrow><mi mathvariant="bold">k</mi></mrow><mi>u</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow><mo fence="true">)</mo></mrow></mrow></mtd></mtr><mtr><mtd><mrow></mrow></mtd><mtd><mrow><mrow></mrow><mo>=</mo><mo>&#x2212;</mo><mn>2</mn><mo>[</mo><msup><mrow><mrow><mi mathvariant="bold">L</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mi>T</mi></mrow></msup><mo>(</mo><mrow><mrow><mi mathvariant="bold">F</mi></mrow></mrow><mrow><mrow><mi mathvariant="bold">r</mi></mrow></mrow><mo>+</mo><msub><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><mn>1</mn></msub><mo>)</mo><msup><mo>]</mo><mi>T</mi></msup><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msub><mrow><mi mathvariant="bold">k</mi></mrow><mi>u</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow><mo>+</mo><mn>2</mn><msup><mrow><mrow><mi mathvariant="bold">r</mi></mrow></mrow><mi>T</mi></msup><mrow><mfrac><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><msub><mrow><mi mathvariant="bold">h</mi></mrow><mi>u</mi></msub></mrow></mrow><mrow><mi mathvariant="normal">&#x2202;</mi><mrow><mrow><mi mathvariant="bold">x</mi></mrow></mrow></mrow></mfrac></mrow></mrow></mtd></mtr></mtable></mstyle></mrow><annotation encoding="application/x-tex">\displaystyle \begin{aligned}{\frac{\partial {\sigma^2}}{\partial {\mathbf{x}}}} &amp;= - 2{\mathbf{e}}_1^T{\mathbf{L}}^{-1}{\frac{\partial {\mathbf{k}_u}}{\partial {\mathbf{x}}}} + 2{\mathbf{e}}_2^T{\mathbf{R}}^{-T}\left({\frac{\partial {\mathbf{h}_u}}{\partial {\mathbf{x}}}} - {\mathbf{F}}^T{\mathbf{L}}^{-1}{\frac{\partial {\mathbf{k}_u}}{\partial {\mathbf{x}}}}\right) \\          &amp;= - 2[{\mathbf{L}}^{-T}({\mathbf{F}}{\mathbf{r}}+ {\mathbf{e}}_1)]^T {\frac{\partial {\mathbf{k}_u}}{\partial {\mathbf{x}}}} + 2{\mathbf{r}}^T{\frac{\partial {\mathbf{h}_u}}{\partial {\mathbf{x}}}}\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:2.499289em;"></span><span class="strut bottom" style="height:4.498578em;vertical-align:-1.999289em;"></span><span class="base displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mtable"><span class="col-align-r"><span class="vlist"><span style="top:-1.008181em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">&#x3C3;</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><span style="top:1.3132890000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="col-align-l"><span class="vlist"><span style="top:-1.008181em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord">&#x2212;</span><span class="mord mathrm">2</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mbin">+</span><span class="mord mathrm">2</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.247em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span style="top:-0.4129999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">R</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="minner displaystyle textstyle uncramped"><span class="mopen style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mbin">&#x2212;</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">F</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mclose style-wrap reset-textstyle textstyle uncramped" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span><span style="top:1.3132890000000002em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"></span><span class="mrel">=</span><span class="mord">&#x2212;</span><span class="mord mathrm">2</span><span class="mopen">[</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">L</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.41300000000000003em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mopen">(</span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">F</span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">r</span></span></span><span class="mbin">+</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">k</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span><span class="mbin">+</span><span class="mord mathrm">2</span><span class="mord"><span class="mord displaystyle textstyle uncramped"><span class="mord displaystyle textstyle uncramped"><span class="mord mathbf">r</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.413em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord displaystyle textstyle uncramped"><span class="mord reset-textstyle displaystyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.686em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle cramped"><span class="mord textstyle cramped"><span class="mord mathbf">x</span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.677em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathrm" style="margin-right:0.05556em;">&#x2202;</span><span class="mord textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathbf">h</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">u</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></span></span> where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mrow><mi mathvariant="bold">r</mi></mrow></mrow><mo>=</mo><msup><mrow><mrow><mi mathvariant="bold">R</mi></mrow></mrow><mrow><mo>&#x2212;</mo><mn>1</mn></mrow></msup><msub><mrow><mrow><mi mathvariant="bold">e</mi></mrow></mrow><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">{\mathbf{r}}={\mathbf{R}}^{-1}{\mathbf{e}}_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.964108em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">r</span></span></span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">R</span></span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathbf">e</span></span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>. The computation is organized so as to minimize the number of linear solves of the triangular matrices.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;A collection of extra topics as a sequel to the GPR series.&lt;/p&gt;
    
    </summary>
    
      <category term="digest" scheme="http://smanist.github.io/categories/digest/"/>
    
    
      <category term="kriging" scheme="http://smanist.github.io/tags/kriging/"/>
    
      <category term="surrogate model" scheme="http://smanist.github.io/tags/surrogate-model/"/>
    
      <category term="machine learning" scheme="http://smanist.github.io/tags/machine-learning/"/>
    
  </entry>
  
  <entry>
    <title>Professor Ni Naru II</title>
    <link href="http://smanist.github.io/2018/05/27/Professor-Ni-Naru-II/"/>
    <id>http://smanist.github.io/2018/05/27/Professor-Ni-Naru-II/</id>
    <published>2018-05-27T16:00:00.000Z</published>
    <updated>2018-05-28T01:54:02.758Z</updated>
    
    <content type="html"><![CDATA[<p>How to become a professor (in Engineering)? Cases and examples.</p><a id="more"></a><p>In short, there are more than one road to Rome. Yet, the general principles agree with those in the previous article.</p><h2 id="the-panelists">The panelists</h2><h3 id="prof.m">Prof.&#xA0;M</h3><p>(Tenured, female) Did undergrad in UIUC and worked in industry for 10 years before going to grad school. In the stage of PhD/PostDoc, she was thinking about back to industry afterwards. Yet, the Dean offered a chance in a newly-developed program in engineering education. That is how she ended up to be a faculty member.</p><h3 id="prof.j">Prof.&#xA0;J</h3><p>(Tenured, female) Directly became a tenure-track AP after PhD. What surprised her was that (1) she had to be hands off the direct research (such as coding) and focus on writing proposals, and (2) high level of interdisciplinary research (univ. dependent). Two mistakes she wished to have avoided in the AP period are that (1) continuing dissertation research (only) and (2) not knowing the field - resulting in, e.g.&#xA0;journal rejection. Her major tip is that an AP should <em>identify the field of impact and research vision</em>, so that he/she can focus on one core area due to the limited timeframe of the tenure process.</p><p>She was able to gave birth to a baby while striving for tenure. Having a baby is beneficial in the sense that it makes the life becomes more focused. Work has to be done when the baby is still in daycare.</p><h3 id="prof.c">Prof.&#xA0;C</h3><p>(Fresh AP, female) Worked as Postdoc in a NL before becoming an AP. That is probably how she developed a strong publication record.</p><h3 id="prof.k">Prof.&#xA0;K</h3><p>(Senior AP, female) She applied for a faculty position to over 30 institutions when she graduated and received around 10 interviews. Now what she thinks is that she should have applied to less places so that the time and energy are more focused. During the negotiation, she was able to convince the dept. to create two courses based on her research work, which are potentially beneficial for her later-on research. Two more tips she offered:</p><ol style="list-style-type: decimal"><li>Do not be afraid to ask for resources.</li><li>It is natural and okay to have no experience in the beginning.</li></ol><h3 id="prof.l">Prof.&#xA0;L</h3><p>(Just tenured, male) He was hired through an interdisciplinary program between several depts. Now he is running a lab with around 10 grad students and some undergrads. Two things he found challenging: (1) dealing with a few superviors, (2) motivating the students. Concerning work-life balance, he suggested using the conferences as a means for family vacations.</p><h3 id="prof.s">Prof.&#xA0;S</h3><p>(Senior AP, male) He and his spouse were hired utilizing the dual-career program offered by the univ. He pointed out that the lab should be treated as a small business. The AP needs to be hands-off the &#x201C;field work&#x201D; and let the students do the labor. Also, one cannot always do what one wants.</p><h2 id="q-a">Q &amp; A</h2><h3 id="writing-research-statement">Writing research statement</h3><p>The key is to balance the old and new projects. The RS works as research proposals, presenting the new ideas and the start-up budget. This also indicates how one becomes independent from the advisor. The RS also shows the existing technical asset of one person, represented by the old projects. Anyways, make sure the RS receives feedback from the peers and mentors before application.</p><h3 id="start-up-package">Start-up package</h3><p>It is basically university dependent. Keep in mind that, during the negotiation, the dept. on the AP&#x2019;s side against the univ. in some aspects. A few suggestions: (1) Have a flexible requirement of the necessities. (2) Confirm what courses to teach. (3) Make sure any communication be recorded and all the requirements be written.</p><h3 id="getting-tenure">Getting tenure</h3><p>First of all, check the memos on tenure requirements and talk to senior faculty members for mentoring. Typically, a tier 1 research university focuses on research, but bad teaching would annihilate the tenure.</p><h3 id="as-a-mentor">As a mentor</h3><p>The role of a mentor is about not just academics, but also the overall well-being, such as the student&#x2019;s career development. Taking undergrads is usually the starting point of a new AP. Two suggestions: (1) utilize existing univ. program support, (2) avoid people aiming for recommendation letters - maybe give a one-year observation period.</p><p>Always note that the team chemistry is vital for the lab and the tenure.</p><h3 id="time-management">Time management</h3><p>The key is to prioritize the schedule and do not become deadline-driven. A typical work load of 50 hrs a week is decomposed as 60-70% for R, 20-30% for T, and the rest for S. 60% of time would be spent in course preparation.</p><h3 id="work-life-balance">Work-life balance</h3><p>First, &#x201C;balance&#x201D; itself should be well defined. It could mean a fixed time frame for life and work. Apparently, the understanding of the family and the partner is paramount. Especially the kids would force the AP to optimize the time management. There are univ. guidelines for faculty with family, which could be exploited.</p><h3 id="reasons-to-transit-from-nl-to-univ.">Reasons to transit from NL to univ.</h3><ol style="list-style-type: decimal"><li>Family factor</li><li>Desire to interact with students and have more impact on people.</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;How to become a professor (in Engineering)? Cases and examples.&lt;/p&gt;
    
    </summary>
    
      <category term="digest" scheme="http://smanist.github.io/categories/digest/"/>
    
    
      <category term="faculty" scheme="http://smanist.github.io/tags/faculty/"/>
    
      <category term="career" scheme="http://smanist.github.io/tags/career/"/>
    
  </entry>
  
  <entry>
    <title>Professor Ni Naru I</title>
    <link href="http://smanist.github.io/2018/05/26/Professor-Ni-Naru-I/"/>
    <id>http://smanist.github.io/2018/05/26/Professor-Ni-Naru-I/</id>
    <published>2018-05-26T16:00:00.000Z</published>
    <updated>2018-05-28T01:11:19.037Z</updated>
    
    <content type="html"><![CDATA[<p>How to become a professor (in Engineering)? General talk.</p><a id="more"></a><p>This is the digest of several seminars I attended recently. These are the info. provided by several professors from university, and filtered by my notes. I am not responsible for any biases.</p><p>Before any discussion in the details, one thing that I think should be kept in mind throughout the academic career is to form the research identity verbally</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&quot;I, Professor X, would like to be known for ...&quot;</div></pre></td></tr></table></figure><h2 id="how-does-faculty-search-happen">How does faculty search happen?</h2><p>Before diving into the applicants&#x2019; perspective, let&#x2019;s examine the perspective of the department. Bascially, the dept. would look for a candidate that fits into the departmental culture. The following are the typical steps:</p><ol style="list-style-type: decimal"><li>Apply to the univ. for slots of new faculty positions. The slots may be prescribed special purposes, e.g.&#xA0;an AP in computer science specializing in machine learning.</li><li>Set up the search committee (which is common place for the AP to do service).</li><li>Solicit applications via advertisement, faculty network, and direct scouting.</li><li>Review applications.</li><li>Remote interview and evaluate (with rubrics).</li><li>On-site interview for finalists.</li><li>Discuss and decide on the final choice(s) and submit to college or univ. for approval.</li><li>Send out the offer and negotiate with the candidate.</li></ol><p>Next, from the applicants&#x2019; perspective, the faculty search happens as follows,</p><ol style="list-style-type: decimal"><li>Step zero is to develop a good research record and reputation.</li><li>Prepare for application: CV, reference letters (RL), teaching and research statements (TS &amp; RS), cover letter (CL), set up the personal website for showcase. For TS and RS, it is important to have outsider review and emphasis on the <em>mutual</em> institutional fit.</li><li>Wait: from application deadline to interview.</li><li>Develop job talk and/or chalk talk. Two things to cover: &#x201C;What is done&#x201D; and &#x201C;What to be done&#x201D;. Make sure to balance the depth and breadth and maintain accessibility for people outside the field. When there is &#x201C;chalk talk&#x201D;, it may be also used to check the teaching capability of the candidate and how one would run a lab.</li><li>Interview: Several things to keep in mind: Explain to the diverse audience about the accomplishment and goals. Study the background of the people in department. Enjoy and learn - the interview is not necessarily the last one.</li><li>Wait: from interview to decision notification.</li><li>Negotiate if given an offer.</li></ol><p>Like the dept., it is advisable that the applicant check if departmental culture fits himself/herself. Or put in this way, the job of faculty is a long-term endeavor that involves the person and the dept. As a result, the faculty search is essentially a process of mutual fitting.</p><h2 id="before-faculty">Before faculty</h2><h3 id="a-rough-time-line">A rough time line</h3><p>Before getting a faculty position:</p><ol style="list-style-type: decimal"><li>Explore - 2 years prior: Search job listing and conduct informal interviews.</li><li>Prepare - 1 year prior: Prepare the documents CV, RL, TS/RS, CL and have them reviewed, esp. if the univ. provides such resources.</li><li>Execute - 6 months prior: Prepare for the interview and review the offer with faculty and specialists from the univ.</li></ol><p>As for the background in PostDoc, the institutional reputation does matter. However, getting experience in mentoring and proposal writing (in a maybe lower level of univ.) is more important than joining in famous labs.</p><h3 id="national-labs">National labs</h3><p>Chances are that one goes for national labs (NL) before becoming a faculty member. There are pros and cons.</p><p>Pros:</p><ol style="list-style-type: decimal"><li>NL provides funded postdocs and intership with generous benefits.</li><li>World-class equipments for experimentalist and computational scientists.</li><li>Work with reputed scientists, which forms the network beneficial for future research, funding, collaboration, and recognition.</li><li>Chances for publication.</li></ol><p>Cons:</p><ol style="list-style-type: decimal"><li>Limitations in immigration status.</li><li>Publication could be delayed due to bureacratic process or clearance issues.</li><li>Lesser feeling of contribution as the research project is usually done collectively.</li><li>Limited freedom to select the research topic.</li><li>Limited chance for teaching, although possible if there are nearby univs.</li></ol><p>To initialize the connection with NL, networking is important. Less than 50% of NL positions are publicly advertised and more are filled by recommendation of univ. faculties, or through networking during conferences.</p><h2 id="during-tenure-track">During tenure-track</h2><h3 id="a-rough-time-line-1">A rough time line</h3><ol style="list-style-type: decimal"><li>Year 1: R and T are the focus. S should be minimum. Especially extra time is needed to develop a course.</li><li>Year 2-3: R goes up and T goes down. Esp. R weighs in due to the mid-term review. S slightly increases and the AP becomes more experienced.</li><li>Year 4-6: R continues to increase for the final tenure review. S stays more or less the same level.</li></ol><h3 id="proposals">Proposals</h3><p>Writing proposals will be the major task of the new faculty. Practically, he/she needs to pay for students, lab expenses, faculty salary, and travel/logistic costs.</p><p>Before application, one needs to understand the mission of the funding agency. One basic way is to watch out for the solicitation of the agency, e.g.&#xA0;request for information (RFI), request for proposal (RFP), and broad agency anouncement (BAA). However, more importantly, talk to the manager directly. The manager is indeed the key person associated with the proposal. He/she creates the program, picks the proposal winners, and reports the progress to his/her boss. The general procedure/loop would be (1) present the idea to the manager, (2) let manager criticize or express his/her needs, (3) correct the proposal. One tip is to expect rejections but learn about the feedback.</p><p>Check out the <a href="https://en.wikipedia.org/wiki/George_H._Heilmeier" target="_blank" rel="noopener">Heilmeier Catechism</a> when working on the proposal.</p><ol style="list-style-type: decimal"><li>What are you trying to do? Articulate your objectives using absolutely no jargon.</li><li>How is it done today, and what are the limits of current practice?</li><li>What&#x2019;s new in your approach and why do you think it will be successful?</li><li>Who cares? If you&#x2019;re successful, what difference will it make?</li><li>What are the risks and the payoffs?</li><li>How much will it cost?</li><li>How long will it take?</li><li>What are the midterm and final &#x201C;exams&#x201D; to check for success?</li></ol><p>The proposal requires some initial input data obtained based on the start-up funding. A suggested writing order is as follows: Summary of the ideas, deliverables and timeline, budget, background, introduction &amp; conlusion, abstract (most important and thus the last). Make sure to write about the broader impact.</p><p>A rule is suggested: Seek advice from people who are busy. They are busy because their advices are so valuable that people keep him/her occupied.</p><h3 id="service-responsibilities">Service responsibilities</h3><p>Service occurs in two aspects. First, within the campus, there are opportunities in the college/univ., dept., and outreach levels. Second, externally, the service includes professional committees, editorial work, proposal review, and journal review.</p><p>A few things to think about for the choice of service: High-visibility, networking opportunities, potential impact on R &amp; T. Some good examples are graduate student search committee and proposal review committee. The caveats in service include non-measurable time cost and distraction from R &amp; T, e.g.&#xA0;travelling for external services. Finally, it is better to <em>actively</em> seek and choose the service, instead of passively getting assigned the job.</p><h3 id="miscellaneous">Miscellaneous</h3><p>About growing research team: Be careful about the structure and size, hire the excellent ones and double-think about postdocs and undergrads. <em>Be aware of the common practices in the dept.</em></p><p>About whether to continue work of PhD/postdoc: A first question to ask is that whether the area is saturated? Continuted work provides potential early wins, but one eventually needs to branch to new areas.</p><p>About time management: A few things to consider - (1) When and how to collaborate. (2) Whether to outsource. (3) Respect other&#x2019;s time. (4) Identify the deadline and the key time nodes. (5) Try not to reinvent the wheels.</p><p>About branding of research: Note the Pygmalion effect, i.e.&#xA0;expectation enhances performance. Sustaining the brand gives positive feedback on publication, citation and impact, students, and sustainable funding.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;How to become a professor (in Engineering)? General talk.&lt;/p&gt;
    
    </summary>
    
      <category term="digest" scheme="http://smanist.github.io/categories/digest/"/>
    
    
      <category term="faculty" scheme="http://smanist.github.io/tags/faculty/"/>
    
      <category term="career" scheme="http://smanist.github.io/tags/career/"/>
    
  </entry>
  
  <entry>
    <title>Images in Hexo</title>
    <link href="http://smanist.github.io/2018/04/22/Images-in-Hexo/"/>
    <id>http://smanist.github.io/2018/04/22/Images-in-Hexo/</id>
    <published>2018-04-23T01:00:00.000Z</published>
    <updated>2018-04-24T01:04:57.819Z</updated>
    
    <content type="html"><![CDATA[<p>Displaying images in Hexo with Markdown.</p><a id="more"></a><h2 id="file-locations-of-the-images">File locations of the images</h2><p>This is straightforward and is discussed in the official <a href="https://hexo.io/docs/asset-folders.html" target="_blank" rel="noopener">documentation</a>. There are two ways. One is to put all images in the so-called <code>global asset folder</code>, <code>source/images</code>, and all posts will need to refer to the images using the path <code>/images/[FILENAME]</code>. The other way is to enable the <code>post asset folder</code> by setting the following flag in <code>_config.yml</code>, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">post_asset_folder: true</div></pre></td></tr></table></figure></p><p>In this case, the images will be stored separately in a folder of the same name as the post file name. In the post, the image is inserted using the path <code>[FILENAME]</code>. A similar discussion can be found <a href="https://yoheikoga.github.io/2016/04/05/How-to-put-pictures-and-change-sizes-on-your-Hexo-Blog/" target="_blank" rel="noopener">here</a>.</p><h2 id="displaying-the-images">Displaying the images</h2><h3 id="using-markdown">Using Markdown</h3><p>The image capabilities of Markdown depends on its implementation. The basic approach can be found <a href="https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet#images" target="_blank" rel="noopener">here</a> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">![](FILENAME [TEXT])</div></pre></td></tr></table></figure></p><p>Some implementations of Markdown support the sizing of the image as discussed <a href="https://stackoverflow.com/questions/14675913/changing-image-size-in-markdown" target="_blank" rel="noopener">here</a>. <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">![](FILENAME [TEXT] WIDTHx[HEIGHT])</div></pre></td></tr></table></figure></p><p>Unfortunately, it seems the current Markdown engine <code>pandoc</code> does not support the sizing.</p><p>An example is shown as follows,</p><div class="figure"><img src="avatar.jpeg" title="An example image."></div><h3 id="using-html">Using HTML</h3><p>The HTML can be embedded into Markdown. So fancier image displaying can be achieved using HTML snippets. Note that there is also another approach that is based on CSS (<a href="https://stackoverflow.com/questions/255170/markdown-and-image-alignment#answer-5054055" target="_blank" rel="noopener">an example</a>). However, CSS more or less makes the file structure more complicated.</p><p>The basic format is, but not limited to, <figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;img src=FILENAME [width=WIDTH] [height=HEIGHT] [hspace=HSPACE] [align=&lt;&quot;right&quot;|&quot;left&quot;&gt;] [title=TITLETEXT] [style=STYLESTR]&gt;</div></pre></td></tr></table></figure></p><p>Note that one can use the <code>style</code> keyword to define the size and alignment, etc. For example, <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">style=&quot;width:WIDTH; height:HEIGHT; float:&lt;right|left&gt;&quot;</div></pre></td></tr></table></figure></p><p>Finally, <code>&lt;img&gt;</code> can be combined with <code>&lt;p&gt;&lt;/p&gt;</code>, <code>&lt;figure&gt;&lt;/figure&gt;</code>, etc to achieve other formatting purposes.</p><p>The following are some examples. Hover the cursor on the image to see the title.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;img src=&quot;avatar.jpeg&quot; title=&quot;A regular image&quot; width=&quot;20px&quot; height=&quot;20px&quot;&gt;</div></pre></td></tr></table></figure><p><img src="avatar.jpeg" title="A regular image" width="20px" height="20px"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;img src=&quot;avatar.jpeg&quot; title=&quot;Image with right alignment&quot; width=&quot;20px&quot; align=&quot;right&quot;&gt;</div></pre></td></tr></table></figure><p><img src="avatar.jpeg" title="Image with right alignment" width="20px" align="right"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;img src=&quot;avatar.jpeg&quot; title=&quot;Right alignment using style&quot; style=&quot;float:right; width:20px;&quot;&gt;</div></pre></td></tr></table></figure><p><img src="avatar.jpeg" title="Right alignment using style" style="float:right; width:20px;"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;img src=&quot;avatar.jpeg&quot; title=&quot;Multiple images on one line&quot; width=&quot;20px&quot; hspace=&quot;20px&quot;&gt;</div><div class="line">&lt;img src=&quot;avatar.jpeg&quot; width=&quot;20px&quot;&gt;</div></pre></td></tr></table></figure><p><img src="avatar.jpeg" title="Multiple images on one line" width="20px" hspace="20px"> <img src="avatar.jpeg" width="20px"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;p align=&quot;center&quot;&gt;</div><div class="line">  &lt;img src=&quot;avatar.jpeg&quot; title=&quot;Multiple images using p with center alignment&quot; width=&quot;20px&quot;&gt;</div><div class="line">  &lt;img src=&quot;avatar.jpeg&quot; width=&quot;20px&quot;&gt;</div><div class="line">&lt;/p&gt;</div></pre></td></tr></table></figure><p align="center"><img src="avatar.jpeg" title="Multiple images using p with center alignment" width="20px"> <img src="avatar.jpeg" width="20px"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;figure float=&quot;left&quot;&gt;</div><div class="line">  &lt;img src=&quot;avatar.jpeg&quot; title=&quot;Image 1 with a caption&quot; width=&quot;20px&quot;&gt;</div><div class="line">  &lt;img src=&quot;avatar.jpeg&quot; title=&quot;Image 2 with a caption&quot; width=&quot;20px&quot;&gt;</div><div class="line">  &lt;figcaption&gt;An image with a caption.&lt;/figcaption&gt;</div><div class="line">&lt;/figure&gt;</div></pre></td></tr></table></figure><figure float="left"><img src="avatar.jpeg" title="Image 1 with a caption" width="20px"> <img src="avatar.jpeg" title="Image 2 with a caption" width="20px"><figcaption>Images with a caption.</figcaption></figure><p>More references:</p><ol style="list-style-type: decimal"><li><a href="https://gist.github.com/DavidWells/7d2e0e1bc78f4ac59a123ddf8b74932d" target="_blank" rel="noopener">HTML alignment</a></li><li><a href="https://stackoverflow.com/questions/24319505/how-can-one-display-images-side-by-side-in-a-github-readme-md" target="_blank" rel="noopener">HTML multiple images on the same line</a></li><li><a href="https://www.w3schools.com/tags/tag_figcaption.asp" target="_blank" rel="noopener">HTML image with a caption</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Displaying images in Hexo with Markdown.&lt;/p&gt;
    
    </summary>
    
      <category term="coding" scheme="http://smanist.github.io/categories/coding/"/>
    
    
      <category term="hexo" scheme="http://smanist.github.io/tags/hexo/"/>
    
  </entry>
  
</feed>
